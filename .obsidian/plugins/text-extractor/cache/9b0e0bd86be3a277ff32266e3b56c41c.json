{"path":"Books and Papers/Probability and Statistics/Dimitri P. Bertsekas, John N. Tsitsiklis - Introduction to Probability, 2nd Edition  -Athena Scientific (2008).pdf","text":"Introduction to Probability SECOND EDITION Dimitri P. Bertsekas and John N. Tsitsiklis Massachusetts Institute of Technology WWW site for book information and orders http://www.athenasc.com ~ Athena Scientific, Belmont, Massachusetts Athena Scientific Post Office Box 805 Nashua, NH 03061-0805 U.S.A. Email: info@athenasc.com WWW: http://www.athenasc.com Cover Design: Ann Gallager © 2002, 2008 Dimitri P. Bertsekas and John N. Tsitsiklis All rights reserved. No part of this book may be reproduced in any form by any electronic or mechanical means (including photocopying, recording, or informa­ tion storage and retrieval) without permission in writing from the publisher. Publisher's Cataloging-in-Publication Data Bertsekas, Dimitri P., Tsitsiklis, John N. Introduction to Probability Includes bibliographical references and index L Probabilities. 2. Stochastic Processes. I. Title. QA273.B475 2008 519.2 - 21 Library of Congress Control Number: 2002092 167 ISBN 978-1-886529-23-6 To the memory of Pantelis Bertsekas and Nikos Tsitsiklis Preface Probability is common sense reduced to calculation Laplace This book is an outgrowth of our involvement in teaching an introductory prob­ ability course (\"Probabilistic Systems Analysis'�) at the Massachusetts Institute of Technology. The course is attended by a large number of students with diverse back­ grounds, and a broad range of interests. They span the entire spectrum from freshmen to beginning graduate students, and from the engineering school to the school of management. Accordingly, we have tried to strike a balance between simplicity in exposition and sophistication in analytical reasoning. Our key aim has been to develop the ability to construct and analyze probabilistic models in a manner that combines intuitive understanding and mathematical precision. In this spirit, some of the more mathematically rigorous analysis has been just sketched or intuitively explained in the text. so that complex proofs do not stand in the way of an otherwise simple exposition. At the same time, some of this analysis is developed (at the level of advanced calculus) in theoretical prob­ lems, that are included at the end of the corresponding chapter. FUrthermore, some of the subtler mathematical issues are hinted at in footnotes addressed to the more attentive reader. The book covers the fundamentals of probability theory (probabilistic mod­ els, discrete and continuous random variables, multiple random variables, and limit theorems), which are typically part of a first course on the subject. It also contains, in Chapters 4-6 a number of more advanced topics, from which an instructor can choose to match the goals of a particular course. In particular, in Chapter 4, we develop transforms, a more advanced view of conditioning, sums of random variables, least squares estimation, and the bivariate normal distribu- v vi Preface tion. Furthermore, in Chapters 5 and 6, we provide a fairly detailed introduction to Bernoulli, Poisson, and Markov processes. Our M.LT. course covers all seven chapters in a single semester, with the ex­ ception of the material on the bivariate normal (Section 4.7) , and on continuous­ time Markov chains (Section 6.5) . However, in an alternative course, the material on stochastic processes could be omitted, thereby allowing additional emphasis on foundational material, or coverage of other topics of the instructor's choice. Our most notable omission in coverage is an introduction to statistics. While we develop all the basic elements of Bayesian statistics, in the form of Bayes' rule for discrete and continuous models, and least squares estimation, we do not enter the subjects of parameter estimation, or non-Bayesian hypothesis testing. The problems that supplement the main text are divided in three categories: (a) Theoretical problems: The theoretical problems (marked by *) constitute an important component of the text, and ensure that the mathematically oriented reader will find here a smooth development without major gaps. Their solutions are given in the text, but an ambitious reader may be able to solve many of them, especially in earlier chapters, before looking at the solutions. (b) Problems in the text: Besides theoretical problems, the text contains several problems, of various levels of difficulty. These are representative of the problems that are usually covered in recitation and tutorial sessions at M.LT., and are a primary mechanism through which many of our students learn the material. Our hope is that students elsewhere will attempt to solve these problems, and then refer to their solutions to calibrate and enhance their understanding of the material. The solutions are posted on the book's www site http://www.athenasc.com/probbook.html (c) Supplementary problems: There is a large (and growing) collection of ad­ ditional problems, which is not included in the book, but is made available at the book's www site. Many of these problems have been assigned as homework or exam problems at M.I.T., and we expect that instructors elsewhere will use them for a similar purpose. While the statements of these additional problems are publicly accessible, the solutions are made available from the authors only to course instructors. We would like to acknowledge our debt to several people who contributed in various ways to the book. Our writing project began when we assumed re­ sponsibility for a popular probability class at M.LT. that our colleague Al Drake had taught for several decades. We were thus fortunate to start with an organi­ zation of the subject that had stood the test of time, a lively presentation of the various topics in AI's classic textbook, and a rich set of material that had been used in recitation sessions and for homework. We are thus indebted to Al Drake Preface vii for providing a very favorable set of initial conditions. We are thankful to the several colleagues who have either taught from the draft of the book at various universities or have read it, and have provided us with valuable feedback. In particular, we thank Ibrahim Abou Faycal, Gustavo de Veciana. Eugene Feinberg, Bob Gray, Muriel Medard, Jason Papastavrou, Ilya Pollak, David Tse, and Terry Wagner. The teaching assistants for the M.LT. class have been very helpful. They pointed out corrections to various drafts, they developed problems and solutions suitable for the class, and through their direct interaction with the student body, they provided a robust mechanism for calibrating the level of the material. Reaching thousands of bright students at MJ. T. at an early stage in their studies was a great source of satisfaction for us. We thank them for their valu­ able feedback and for being patient while they were taught from a textbook-in­ progress. Last but not least, we are grateful to our families for their support through­ out the course of this long project . Dimitri P. Bertsekas, dimitrib@mit.edu John N. Tsitsiklis, jnt@mit.edu Cambridge, Mass., May 2002 v iii Preface Preface to the Second Edition This is a substantial revision of the 1st edition, involving a reorganization of old material and the addition of new material. The length of the book has increased by about 25 percent. The main changes are the following: (a) Two new chapters on statistical inference have been added. one on Bayesian and one on classical methods. Our philosophy has been to focus on the main concepts and to facilitate understanding of the main methodologies through some key examples. (b) Chapters 3 and 4 have been revised, in part to accommodate the new material of the inference chapters and in part to streamline the presenta­ tion. Section 4.7 of the 1st edition (bivariate normal distribution) has been omitted from the new edition, but is available at the book's website. (c) A number of new examples and end-of-chapter problems have been added. The main objective of the new edition is to provide flexibility to instructors in their choice of material, and in particular to give them the option of including an introduction to statistical inference. Note that Chapters 6-7, and Chapters 8- 9 are mutually independent, thus allowing for different paths through the book. Furthermore, Chapter 4 is not needed for Chapters 5-7, and only Sections 4.2-4.3 from Chapter 4 are needed for Chapters 8 and 9. Thus, some possible course offerings based on this book are: (a) Probability and introduction to statistical inference: Chapters 1-3, Sections 4.2-4.3, Chapter 5, Chapters 8-9. (b) Probability and introduction to stochastic processes: Chapters 1-3 and 5-7, with possibly a few sections from Chapter 4. We would like to express our thanks to various colleagues who have con­ tributed valuable comments on the material in the 1st edition and/or the or­ ganization of the material in the new chapters. Ed Coffman, Munther Dahleh, Vivek Goyal, Anant Sahai, David Tse, George Verghese, Alan Willsky, and John Wyatt have been very helpful in this regard. Finally, we thank Mengdi Wang for her help with figures and problems for the new chapters. Dimitri P. Bertsekas, dimitrib@mit.edu John N. Tsitsiklis, jnt@mit.edu Cambridge, Mass. , June 2008 Contents 1. Sample Space and Probability 1.1 . Sets . . . . . . . . . 1.2. Probabilistic Models . . . . . 1.3. Conditional Probability . . . 1.4. Total Probability Theorem and Bayes' Rule 1.5. Independence . . . . . . 1.6. Counting ..... . . 1. 7. Summary and Discussion Problems .. ..... . 2. Discrete Random Variables 2.1 . Basic Concepts . . . . . 2.2. Probability Mass Functions 2.3. Functions of Random Variables 2.4. Expectation, Mean, and Variance 2.5. Joint PMFs of �lultiple Random Variables 2.6. Conditioning . . . . . . 2.7. Independence .. ... . 2.8. Summary and Discussion Problems .... .. . . 3. General Random Variables 3.1. Continuous Random Variables and PDFs 3.2. Cumulative Distribution Functions 3.3. Normal Random Variables .... .. . 3.4. Joint PDFs of Multiple Random Variables 3.5. Conditioning ..... . 3.6. The Continuous Bayes' Rule .. ... . . p. 1 . p. 3 . p. 6 p. 18 p. 28 p. 34 p. 44 p.51 p. 53 p. 71 p. 72 p. 74 p. 80 p. 81 p. 92 p. 97 p. 109 p. 115 p. 119 p. 139 p.I40 p.I48 p.I53 p.I58 p.I64 p.I78 ix x 3.7. Summary and Discussion Problems .. ... . . . 4. Further Topics on Random Variables 4. 1. Derived Distributions . . . . . . . 4.2. Covariance and Correlation 4.3. Conditional Expectation and Variance Revisited 4.4. Transforms .. .. ...... .. ... . 4.5. Sum of a Random Number of Independent Random Variables 4.6. Summary and Discussion Problems .. ..................... . 5. Limit Theorems . 5.1. Markov and Chebyshev Inequalities 5.2. The Weak Law of Large Numbers 5.3. Convergence in Probability . . . . 5.4. The Central Limit Theorem 5.5. The Strong Law of Large Numbers 5.6. Summary and Discussion Problems ........... . 6. The Bernoulli and Poisson Processes . . . . 6.1. The Bernoulli Process . . 6.2. The Poisson Process 6.3. Summary and Discussion Problems .. .. . .. . 7. Markov Chains 7. 1. Discrete-Time Markov Chains 7.2. Classification of States . . . . 7.3. Steady-State Behavior . . . . 7.4. Absorption Probabilities and Expected Time to Absorption 7.5. Continuous-Time Markov Chains 7.6. Summary and Discussion Problems ....... . . 8. Bayesian Statistical Inference 8. 1. Bayesian Inference and the Posterior Distribution 8.2. Point Estimation, Hypothesis Testing, and the MAP Rule 8.3. Bayesian Least Mean Squares Estimation 8.4. Bayesian Linear Least Mean Squares Estimation . . . . Contents p. 182 p. 184 p. 201 p. 202 p. 217 p.222 p. 229 p. 240 p. 244 p. 246 p.263 p. 265 p. 269 p. 271 p. 273 p. 280 p. 282 p. 284 p. 295 p. 297 p. 309 p. 324 p. 326 p. 339 p. 340 p. 346 p. 352 p. 362 p. 369 p. 378 p. 380 p. 407 p. 412 p. 420 p. 430 p. 437 Contents 8.5. Summary and Discussion Problems .... ... . 9. Classical Statistical Inference . 9. 1. Classical Parameter Estimation 9.2. Linear Regression . . . . 9.3. Binary Hypothesis Testing 9.4. Significance Testing . . . 9.5. Summary and Discussion Problems ...... . . Index . . . xi p. 444 p. 446 p. 459 p. 462 p. 477 p. 486 p. 496 p. 505 p. 507 p. 521 1 Sample Space and Probability 1.1. Sets . . . . . . . . . 1.2. Probabilistic Models . . 1.3. Conditional Probability Contents 1.4. Total Probability Theorem and Bayes' Rule 1.5. Independence . . . . . . 1.6. Counting ...... . 1.7. Summary and Discussion Problems ....... . . p. 3 . p. 6 p. 18 p. 28 p. 34 p. 44 p. 51 p. 53 1 2 Sample Space and Probability Chap. 1 \"Probability\" is a very useful concept, but can be interpreted in a number of ways. As an illustration, consider the following. A patient is admitted to the hospital and a potentially life-saving drug is administered. The following dialog takes place between the nurse and a concerned relative. RELATIVE: Nurse, what is the probability that the drug will work? NURSE: I hope it works, we'll know tomorrow. RELATIVE: Yes, but what is the probability that it will? NURSE: Each case is different, we have to wait. RELATIVE: But let's see, out of a hundred patients that are treated under similar conditions, how many times would you expect it to work? NURSE (somewhat annoyed): I told you, every person is different, for some it works, for some it doesn't. RELATIVE (insisting) : Then tell me, if you had to bet whether it will work or not, which side of the bet would you take? NURSE (cheering up for a moment): I'd bet it will work. RELATIVE (somewhat relieved) : OK, now, would you be willing to lose two dollars if it doesn't work, and gain one dollar if it does? NURSE (exasperated): What a sick thought! You are wasting my time! In this conversation, the relative attempts to use the concept of probability to discuss an uncertain situation. The nurse's initial response indicates that the meaning of \"probability\" is not uniformly shared or understood, and the relative tries to make it more concrete. The first approach is to define probability in terms of frequency of occurrence, as a percentage of successes in a moderately large number of similar situations. Such an interpretation is often natural. For example, when we say that a perfectly manufactured coin lands on heads \"with probability 50%,\" we typically mean \"roughly half of the time.\" But the nurse may not be entirely wrong in refusing to discuss in such terms. What if this was an experimental drug that was administered for the very first time in this hospital or in the nurse's experience? While there are many situations involving uncertainty in which the fre­ quency interpretation is appropriate, there are other situations in which it is not. Consider, for example, a scholar who asserts that the Iliad and the Odyssey were composed by the same person, with probability 90%. Such an assertion conveys some information, but not in terms of frequencies, since the subject is a one-time event . Rather, it is an expression of the scholar's subjective be­ lief. One might think that subjective beliefs are not interesting, at least from a mathematical or scientific point of view. On the other hand, people often have to make choices in the presence of uncertainty, and a systematic way of making use of their beliefs is a prerequisite for successful, or at least consistent, decision making. Sec. 1.1 Sets 3 In fact, the choices and actions of a rational person can reveal a lot about the inner-held subjective probabilities, even if the person does not make conscious use of probabilistic reasoning. Indeed, the last part of the earlier dialog was an attempt to infer the nurse's beliefs in an indirect manner. Since the nurse was willing to accept a one-for-one bet that the drug would work, we may infer that the probability of success was judged to be at least 50%. Had the nurse accepted the last proposed bet (two-for-one), this would have indicated a success probability of at least 2/3. Rather than dwelling further on philosophical issues about the appropriate­ ness of probabilistic reasoning, we will simply take it as a given that the theory of probability is useful in a broad variety of contexts, including some where the assumed probabilities only reflect subjective beliefs. There is a large body of successful applications in science, engineering, medicine, management, etc., and on the basis of this empirical evidence, probability theory is an extremely useful tool. Our main objective in this book is to develop the art of describing un­ certainty in terms of probabilistic models, as well as the skill of probabilistic reasoning. The first step, which is the subject of this chapter, is to describe the generic structure of such models and their basic properties. The models we consider assign probabilities to collections (sets) of possible outcomes. For this reason, we must begin with a short review of set theory. 1.1 SETS Probability makes extensive use of set operations, so let us introduce at the outset the relevant notation and terminology. A set is a collection of objects, which are the elements of the set. If S is a set and x is an element of S, we write xES. If x is not an element of S, we write x � S. A set can have no elements, in which case it is called the empty set, denoted by 0. Sets can be specified in a variety of ways. If S contains a finite number of elements, say Xl, X2, .. . , Xn, we write it as a list of the elements, in braces: For example, the set of possible outcomes of a die roll is {I, 2, 3, 4,5, 6}, and the set of possible outcomes of a coin toss is {H, T} , where H stands for \"heads\" and T stands for \"tails.\" If S contains infinitely many elements Xl, X2, ..• , which can be enumerated in a list (so that there are as many elements as there are positive integers) we write S = {x I , X2, .. . }, and we say that S is countably infinite. For example, the set of even integers can be written as {O, 2, -2, 4, -4, .. . }, and is count ably infinite. 4 Sample Space and Probability Chap. 1 Alternatively, we can consider the set of all x that have a certain property P, and denote it by {x I x satisfies Pl· (The symbol \"I\" is to be read as \"such that.\" ) For example, the set of even integers can be written as {k I k /2 is integer}. Similarly, the set of all scalars x in the interval [0, 1] can be written as {x I 0 ::; x � I}. Note that the elements x of the latter set take a continuous range of values, and cannot be written down in a list (a proof is sketched in the end-of-chapter problems) ; such a set is said to be uncountable. If every element of a set S is also an element of a set T, we say that S is a subset of T, and we write SeT or T ::J S. If SeT and T C S, the two sets are equal, and we write S = T. It is also expedient to introduce a universal set, denoted by f2, which contains all objects that could conceivably be of interest in a particular context. Having specified the context in terms of a universal set f2, we only consider sets S that are subsets of f2. Set Operations The complement of a set S, with respect to the universe f2, is the set {x E f2 I x � S} of all elements of f2 that do not belong to S, and is denoted by Sc. Note that f2C = 0. The union of two sets S and T is the set of all elements that belong to S or T (or both), and is denoted by S U T. The intersection of two sets S and T is the set of all elements that belong to both S and T, and is denoted by S n T. Thus, S U T = {x I xE S or x E T}, and S n T = {x I xES and x E T} . In some cases, we will have to consider the union or the intersection of several, even infinitely many sets, defined in the obvious way. For example, if for every positive integer n, we are given a set Sn, then 00 U Sn = S 1 U S2 U . . . = {x I x E Sn for some n} , n=1 and 00 n Sn = SI n S2 n .. . = {x I x E Sn for all n} . n=1 Two sets are said to be disjoint if their intersection is empty. More generally, several sets are said to be disjoint if no two of them have a common element. A collection of sets is said to be a partition of a set S if the sets in the collection are disjoint and their union is S. 1.1 5 If x yare two we use y) to of x The set of scalars (real numbers) denoted by �: the set (or i.e .. the two-dimensiona1 plane (or three-dimensional space, (or . respectively ) . ...-.\"..,'\"-J ...... A ...... \"\"\"''-& operat ions are to visualize in terms as in 1.1. Q 1.1: The shaded The shaded (f) The sets S, of Venn is S n T. (b) is S U T. (c) The (d) T C is the complement of S. (e) The sets S. T. and U are disjoint. and U form a of the set n. are nr\\1r'\\C!'O, ...... '£],TlII·'''''-' of the Su u S u (T u U) = (S u T) u U, Sn(TuU) == (5nT)U(SnU). ) c == S. SuO = O. particularly are 5 u (T n U) :::: (5 U T) n (S u U). 5 n == 0. 5nO = S. which state To suppose x E (Un )c. Then. x ¢ 1 which n, we have x 1:: Sn. Thus, x belongs to the complement 1 6 Sn. and x E nn S�. This IS by '-£..1\"\"\".-00\": argument for is probabilistic It must in .......... , .... ,... ... ,.,. two main ingredients are a • experime nt . • IS SampJe Probability Chap. 1 an that we discuss in this 1 set of possible tC()mleS of an or probability law must satisfy 1.2: The main of a Every probabi listic model involves an will one out of �\"\"\"\"\"'r� aU possible outcomes is called the oi:::!III:,.IL.JLJl.JI. .. .lJI.'I;;i model. the experiment, denoted n. A subset of the sample space , that is, a collection of possible Sec. 1.2 Probabilistic Models 7 outcomes, is called an event. t There is no restriction on what constitutes an experiment. For example, it could be a single toss of a coin, or three tosses, or an infinite sequence of tosses. However, it is important to note that in our formulation of a probabilistic modeL there is only one experiment. So, three tosses of a coin constitute a single experiment . rather than three experiments. The sample space of an experiment may consist of a finite or an infinite number of possible outcomes. Finite sample spaces are conceptually and math­ ematically simpler. Still, sample spaces with an infinite number of elements are quite common. As an example, consider throwing a dart on a square target and viewing the point of impact as the outcome. Choosing an Appropriate Sample Space Regardless of their number. different elements of the sample space should be distinct and mutually exclusive, so that when the experiment is carried out there is a unique outcome. For example, the sample space associated with the roll of a die cannot contain \"l or 3\" as a possible outcome and also \"l or 4\" as another possible outcome. If it did, we would not be able to assign a unique outcome when the roll is a 1. A given physical situation may be modeled in several different ways, de­ pending on the kind of questions that we are interested in. Generally, the sample space chosen for a probabilistic model must be collectively exhaustive, in the sense that no matter what happens in the experiment , we always obtain an out­ come that has been included in the sample space. In addition, the sample space should have enough detail to distinguish between all outcomes of interest to the modeler, while avoiding irrelevant details. Example 1.1. Consider two alternative games, both involving ten successive coin tosses: Game 1: We receive $1 each time a head comes up. Game 2: We receive $1 for every coin toss. up to and including the first time a head comes up. Then. we receive $2 for every coin toss. up to the second time a head comes up. More generally, the dollar amount per toss is doubled each time a head comes up. t Any collection of possible outcomes, including the entire sample space nand its complement, the empty set 0, may qualify as an event. Strictly speaking, however, some sets have to be excluded. In particular, when dealing with probabilistic models involving an uncountably infinite sample space. there are certain unusual subsets for which one cannot associate meaningful probabilities. This is an intricate technical issue, involving the mathematics of measure theory. Fortunately, such pathological subsets do not arise in the problems considered in this text or in practice. and the issue can be safely ignored. 8 a Probabili ty 1 Models space by means of 3 ... 2 .. 1 1 2 3 .:) 1.3: of sample space of an o v ' .... or· ....... involving two rolls of a 4-sided die. The possible outcomes are all the ordered pairs of the form (i. j). where i is the result of the roll, and j is the result of the second. These outcomes can be in a 2-dimensional as in the on the or they can be described by the tree on the right. which U\\.,oll,-, lUI character of the outcome 1\"1'\\'� ... 0<c::nr'\\nr1c: to a leaf of the tree and is associated with the path from the root to that shaded area on the left is the event {(1,4), (2 , 4) , (3,4), (4,4)} that the result of the second roll is 4. That same event can be described by the set of leaves highlighted on the right. Note also that every node of the tree can be identified with an the set of all leaves downstream from that node . For the node labeled a 1 can be identified with the event {(l. 1), (1,2). (1,3), (1, 4)} that the result of th e first roB is 1. ,In.,,, ... ,..,,::.£> we have complete the on the ..., ............... �J\"' .. \"'\" model: we C,,\",'lIr-g n with an experiment. now introd uce a law . Sec. 1.2 Probabilistic Models 9 Intuitively, this specifies the \"likelihood\" of any outcome, or of any set of possible outcomes (an event. as we have called it earlier). More precisely. the probability law assigns to every event A. a number P(A) , called the probability of A. satisfying the following axioms. Probability Axioms L (Nonnegativity) P(A) > 0, for every event A. 2. (Additivity) If A and B are two disjoint events, then the probability of their union satisfies P(A U B) = P(A) + P(B). More generally, if the sample space has an infinite number of elements and Al , A2 , ... is a sequence of disjoint events, then the probability of their union satisfies 3. (Normalization) The probability of the entire sample space n is equal to 1, that is, p(n) = 1. In order to visualize a probability law. consider a unit of mass which is i'spread\" over the sample space. Then, P(A) is simply the total mass that was assigned collectively to the elements of A. In terms of this analogy, the additivity axiom becomes quite intuitive: the total mass in a sequence of disjoint events is the sum of their individual masses. A more concrete interpretation of probabilities is in terms of relative fre­ quencies: a statement such as P(A) = 2/3 often represents a belief that event A will occur in about two thirds out of a large number of repetitions of the exper­ iment. Such an interpretation, though not always appropriate, can sometimes facilitate our intuitive understanding. It will be revisited in Chapter 5, in our study of limit theorems. There are many natural properties of a probability law. which have not been included in the above axioms for the simple reason that they can be derived from them. For example, note that the normalization and additivity axioms imply that 1 = p(n) = p(n U 0) = p(n) + P(0) = 1 + P(0) . and this shows that the probability of the empty event is 0: P(0) = o. 10 Sample Space and Probability Chap. 1 As another example, consider three disjoint events AI , A2, and A3. We can use the additivity axiom for two disjoint events repeatedly, to obtain P(A1 U A2 U A3) = P(A1 U (A2 U A3)) = P(At) + P(A2 U A3) = P(AI ) + P(A2) + P(A3). Proceeding similarly, we obtain that the probability of the union of finitely many disjoint events is always equal to the sum of the probabilities of these events. More such properties will be considered shortly. Discrete Models Here is an illustration of how to construct a probability law starting from some common sense assumptions about a model. Example 1.2. Consider an experiment involving a single coin toss. There are two possible outcomes, heads (H) and tails (T). The sample space is n = {H, T}, and the events are {H. T}, {H}, {T}, 0. If the coin is fair, i.e. , if we believe that heads and tails are \"equally likely,\" we should assign equal probabilities to the two possible outcomes and specify that P( {H}) = P( {T}) = 0.5. The additivity axiom implies that P({H, T}) = P({H}) + P({T}) = 1, which is consistent with the normalization axiom. Thus, the probability law is given by P ( {H, T}) = 1, p( {H}) = 0.5. P({T}) = 0.5, P(0) = 0, and satisfies all three axioms. Consider another experiment involving three coin tosses. The outcome will now be a 3-long string of heads or tails. The sample space is n = {HHH, HHT, HTH, HTT, THH, THT, TTH, TTT}. We assume that each possible outcome has the same probability of 1/8. Let us construct a probability law that satisfies the three axioms. Consider, as an example. the event A = {exactly 2 heads occur} = {HHT, HTH, THH}. Using additivity, the probability of A is the sum of the probabilities of its elements: P({HHT, HTH. THH}) = P({HHT}) + P({HTH}) + P({THH}) 111 =8 + 8 + 8 3 - 8 Sec. 1 .2 Probabilistic Models 11 Similarly, the probability of any event is equal to 1/8 times the number of possible outcomes contained in the event. This defines a probability law that satisfies the three axioms. By using the additivity axiom and by generalizing the reasoning in the preceding example� we reach the following conclusion. Discrete Probability Law If the sample space consists of a finite number of possible outcomes, then the probability law is specified by the probabilities of the events that consist of a single element. In particular, the probability of any event {SI' S2, .. . , Sn} is the sum of the probabilities of its elements: P ( { SI , S2, ... , Sn}) = P (SI) + P (S2) + ... + P (sn) . Note that we are using here the simpler notation P(Si) to denote the prob­ ability of the event {Si}, instead of the more precise P( {Si}) . This convention will be used throughout the remainder of the book. In the special case where the probabilities P(SI ), ... , P(sn) are all the same (by necessity equal to lin, in view of the normalization axiom) , we obtain the following. Discrete Uniform Probability Law If the sample space consists of n possible outcomes which are equally likely (Le., all single-element events have the same probability) , then the proba­ bility of any event A is given by P(A) = number of elements of A . n Let us provide a few more examples of sample spaces and probability laws. Example 1.3. Consider the experiment of rolling a pair of 4-sided dice (cf. Fig. 1.4). We assume the dice are fair, and we interpret this assumption to mean that each of the sixteen possible outcomes [pairs (i, j), with i. j = 1, 2. 3, 4] has the same probability of 1/ 16. To calculate the probability of an event, we must count the number of elements of the event and divide by 16 (the total number of possible are some event sum ( IS ... ·i ............... 1.4: Various events in the and their calculated in way: is = 8/ = 1 = = - - is to ) of a of 4-sided to the discrete uniform law. 1 1.2 Models probability larger than 1. Therefore, the probability of any event that consists of a satisfies the three probability axioms and a at a given time, and will between 0 and 1 with will 15 delays is to Jet area. law satisfies the three probability axioms. The event that Romeo and Juliet wi1l meet is the shaded region in 1 and its probability is calculated to 7/16. y 1.5: The event Al that Romeo and Juliet will arrive within 15 minutes of each other (d. ). h; lVl = { y) Ilx - yl � and is shaded in the The area of M is 1 minus the area of the two unshaded ....... 1'\".-.. ..... or 1 - (3/4) . (3/4) = 7/16. the of is 7/16. t U]engthl! a subset S of [0, 1] is the integral \"nice\" sets S, in the usual calculus sense. imply the whole the normalization axiom. zero 14 Sample Space and Probability Chap. 1 Properties of Probability Laws Probability laws have a number of properties, which can be deduced from the axioms. Some of them are summarized below. Some Properties of Probability Laws Consider a probability law, and let A, B, and C be events. (a) If A c B, then P(A) :s; P(B). (b) P(A U B) = P(A) + P(B) - P(A n B) . (c) P(A U B) :s; P(A) + P(B). (d) P(A U B U C) = P(A) + p(Ae n B) + p(Ae n Be n C). These properties, and other similar ones, can be visualized and verified graphically using Venn diagrams, as in Fig. 1.6. Note that property (c) can be generalized as follows: n P(AI U A2 U .. . U An) :s; L P(Ai). i=I To see this, we apply property (c) to the sets Al and A2 U . . . U An, to obtain We also apply property (c) to the sets A2 and A3 U . . . U An , to obtain We continue similarly, and finally add. Models and Reality The framework of probability theory can be used to analyze uncertainty in a wide variety of physical contexts. Typically, this involves two distinct stages. (a) In the first stage, we construct a probabilistic model by specifying a prob­ ability law on a suitably defined sample space. There are no hard rules to guide this step, other than the requirement that the probability law con­ form to the three axioms. Reasonable people may disagree on which model best represents reality. In many cases, one may even want to use a some­ what \"incorrect\" model, if it is simpler than the \"correct\" one or allows for tractable calculations. This is consistent with common practice in science 1 a involves a tween accuracy, sinlplicity, tractability. Sometimes, a model is chosen on of statistical 9. or Tn.\"', ..... \"\"\",.., nlethods, which will Visualization and verification of various properties of Venn If A C then B is the union of the two .... u,;;\" IUlJ,I\" events A and AC n B; see (a).. by the we + AC n B) 2 P(A), where the inequality follows from the nonnegativity axiom. and verifies prop­ (a). From (b), we can express the events A u Band B as unions of events; B= n the additivity we have Au = P( n nB)+p(ACn from the first and terms. we obtain nrr\\l'\"\\ortv (b). Using also the fact n B), u B) � P(A) + P(B). From diagram (c) 1 we see that the event A u B u C can be union of three disjoint events: AUBUC=Au(ACnB)u as a consequence of the axiom. 16 1 (b) we work within a fully probabilistic AAA'-' ............ � derive the probabilities erties. While the the full of IS no room it is calculation though: ..... � ... \".�'-' ... �'-' ....... or ambiguous ........... ' ............ � is shown Fig. 1 presented by L. F. Bertrand in 1889. illustrates the a model. Consider a circle and an inscribed in the circle. What is the that the than the side of the The answer here depends on the of \"randomly chosen.\" The two methods illustrated in parts (a) and (b) of the figure lead to contradictory results. In (a). we take a radius of the such as and we choose a C on that radius. with all being equally l ikely. We then draw the chord through C that is to AB. From geometry. AB intersects the at the of AB. so the that the of the chord IS than the side is 1/2. In (b), we take a point on the such as the vertex V 1 we draw the tangent to the circle through V, and we draw a line through V that forms a random � with the with all likely. We consider the chord obtained the intersection of this line with the circle. From plpmpnt!:! the of is of between 1r /3 and 2-rr /3. Since 4> t akes values between 0 and 11\". that the length of the chord is greater than the side is 1/3, Sec. 1.2 Probabilistic Models 17 A Brief History of Probability • B.C.E. Games of chance were popular in ancient Greece and Rome, but no scientific development of the subject took place, possibly because the number system used by the Greeks did not facilitate algebraic calculations. The development of probability based on sound scientific analysis had to await the development of the modern arithmetic system by the Hindus and the Arabs in the second half of the first millennium, as well as the flood of scientific ideas generated by the Renaissance. • 16th century. Girolamo Cardano, a colorful and controversial Italian mathematician, publishes the first book describing correct methods for cal­ culating probabilities in games of chance involving dice and cards. • 17th century. A correspondence between Fermat and Pascal touches upon several interesting probability questions and motivates further study in the field. • 18th century. Jacob Bernoulli studies repeated coin tossing and introduces the first law of large numbers, which lays a foundation for linking theoreti­ cal probability concepts and empirical fact. Several mathematicians. such as Daniel Bernoulli, Leibnitz, Bayes, and Lagrange, make important contribu­ tions to probability theory and its use in analyzing real-world phenomena. De Moivre introduces the normal distribution and proves the first form of the central limit theorem. • 19th century. Laplace publishes an influential book that establishes the importance of probability as a quantitative field and contains many original contributions, including a more general version of the central limit theo­ rem. Legendre and Gauss apply probability to astronomical predictions, using the method of least squares, thus pointing the way to a vast range of applications. Poisson publishes an influential book with many original con­ tributions, including the Poisson distribution. Chebyshev, and his students Markov and Lyapunov, study limit theorems and raise the standards of mathematical rigor in the field. Throughout this period, probability theory is largely viewed as a natural science, its primary goal being the explanation of physical phenomena. Consistently with this goal, probabilities are mainly interpreted as limits of relative frequencies in the context of repeatable ex­ periments. • 20th century. Relative frequency is abandoned as the conceptual foun­ dation of probability theory in favor of a now universally used axiomatic system, introduced by Kolmogorov. Similar to other branches of mathe­ matics, the development of probability theory from the axioms relies only on logical correctness, regardless of its relevance to physical phenomena. Nonetheless, probability theory is used pervasively in science and engineer­ ing because of its ability to describe and interpret most types of uncertain phenomena in the real world. 18 Sample Space and Probability Chap. 1 1.3 CONDITIONAL PROBABILITY Conditional probability provides us with a way to reason about the outcome of an experiment, based on partial information. Here are some examples of situations we have in mind: (a) In an experiment involving two successive rolls of a die, you are told that the sum of the two rolls is 9. How likely is it that the first roll was a 6? (b) In a word guessing game, the first letter of the word is a ·t\". What is the likelihood that the second letter is an \"h\" ? (c) How likely is it that a person has a certain disease given that a medical test was negative? (d) A spot shows up on a radar screen. How likely is it to correspond to an aircraft? In more precise terms, given an experiment, a corresponding sample space, and a probability law, suppose that we know that the outcome is within some given event B. We wish to quantify the likelihood that the outcome also belongs to some other given event A. We thus seek to construct a new probability law that takes into account the available knowledge: a probability law that for any event A. specifies the conditional probability of A given B. denoted by P(A I B). We would like the conditional probabilities P (A I B) of different events A to constitute a legitimate probability law, which satisfies the probability axioms. The conditional probabilities should also be consistent with our intuition in im­ portant special cases, e.g., when all possible outcomes of the experiment are equally likely. For example. suppose that all six possible outcomes of a fair die roll are equally likely. If we are told that the outcome is even, we are left with only three possible outcomes. namely, 2. 4, and 6. These three outcomes were equally likely to start with, and so they should remain equally likely given the additional knowledge that the outcome was even. Thus, it is reasonable to let P(the outcome is 61 the outcome is even) = �. This argument suggests that an appropriate definition of conditional probability when all outcomes are equally likely, is given by P (A I B) = number of elements of An B . number of elements of B Generalizing the argument, we introduce the following definition of condi­ tional probability: P(A I B) = P(A n B) P(B) , Sec. 1.3 Conditional Probability 19 where we assume that P(B) > 0; the conditional probability is undefined if the conditioning event has zero probability. In words, out of the total probability of the elements of B, P(A I B) is the fraction that is assigned to possible outcomes that also belong to A. Conditional Probabilities Specify a Probability Law For a fixed event B, it can be verified that the conditional probabilities P(A I B) form a legitimate probability law that satisfies the three axioms. Indeed, non­ negativity is clear. FUrthermore, P(O I B) = P(O n B) = P(B) = P(B) P(B) 1, and the normalization axiom is also satisfied. To verify the additivity axiom, we write for any two disjoint events Al and A2, P(A u A I B) = P ( (AI u A2) n B) 1 2 P(B) P((A1 n B) u (A2 n B)) P(B) P(AI n B) + P(A2 n B) P(B) P(A 1 n B) P(A2 n B) = P(B) + P(B) = P(AI I B) + P(A21 B), where for the third equality, we used the fact that Al n B and A2 n B are disjoint sets, and the additivity axiom for the (unconditional) probability law. The argument for a countable collection of disjoint sets is similar. Since conditional probabilities constitute a legitimate probability law, all general properties of probability laws remain valid. For example, a fact such as P(A U C) :S P(A) + P(C) translates to the new fact P(A U C I B) :S P(A I B) + P(C I B). Let us also note that since we have P(B I B) = P(B)/P(B) = 1, all of the con­ ditional probability is concentrated on B. Thus, we might as well discard all possible outcomes outside B and treat the conditional probabilities as a proba­ bility law defined on the new universe B. Let us summarize the conclusions reached so far. 20 Sample Space and Probability Chap. 1 Properties of Conditional Probability • The conditional probability of an event A, given an event B with P(B) > 0, is defined by P(A I B) = P(A n B) P(B) , and specifies a new (conditional) probability law on the same sample space n. In particular, all properties of probability laws remain valid for conditional probability laws. • Conditional probabilities can also be viewed as a probability law on a new universe B, because all of the conditional probability is concen­ trated on B. • If the possible outcomes are finitely many and equally likely, then P(A I B) = number of elements of A n B . number of elements of B Example 1.6. We toss a fair coin three successive times. We wish to find the conditional probability P(A I B) when A and B are the events A = {more heads than tails come up}, B = {1st toss is a head}. The sample space consists of eight sequences. n = {HHH. HHT. HTH, HTT, THH, THT. TTH, TTT}. which we assume to be equally likely. The event B consists of the four elements H H H, H HT. HT H. HTT, so its probability is P(B) = �. The event A n B consists of the three elements H H H. H HT. HT H, so its proba­ bility is P(A n B) = �. Thus, the conditional probability P(A I B) is P(A I B) = P(A n B) = 3/8 = � P(B) 4/8 4' Because all possible outcomes are equally likely here, we can also compute P(A I B) using a shortcut. We can bypass the calculation of P(B) and P(An B), and simply 1 A is 3) eleInents of B (which is 4) , to obtain saIne result 3/4. 1 A IS we assume possible outcomes are equally likely. Let and Y be the result of the 1st and the 2nd roll: respectively. We wish to determine the conditional probability P(A I B), where A = { Y)= = { and m takes each of the values l. 2. 3� we can and P(B) by counting the nUlnber of el e lnents of A n Band B. respectively, and by 16. Alternative]y, we can directly divide the number of elenlents of y see 1 1.8: Sample space of an involving two rolls of a 4-sided die. 1 . The event B = { Y) = consists of the set. The set A = { Y) = m} with B two AIDrnDnrc if m = 3 or m = 4. one element if m = 2, and no element if Tn = 1. we have { 2/5. p( {max(X. Y) = m} I B) = 1 if m = 3 or m = 4. ifm = 2. O. if m =-= 1. it C. and an .•.•. \"\"\"'£A, team, caB it N, are asked to separately design a new product within a month. From past experience we know that: (a) The probability that team C is successful is 2/3. (b) The probability that teanl N is is 1/2. (c) at one teanl is sw:ceSSI is 22 Sample Space and Probability Chap. 1 Assuming that exactly one successful design is produced, what is the probability that it was designed by team N? There are four possible outcomes here, corresponding to the four combinations of success and failure of the two teams: SS: both succeed, FF: both fail, SF: C succeeds, N fails, FS: C fails, N succeeds. We were given that the probabilities of these outcomes satisfy 2 P(SS) + P(SF) = 3' 1 P(SS) + P(FS) = 2' P(SS) + P(SF) + P(FS) = �. From these relations, together with the normalization equation P(SS) + P(SF) + P(FS) + P(FF) = 1, we can obtain the probabilities of individual outcomes: 5 P(SS) = 12 ' 1 P(SF) = 4' 1 P(FS) = 12 ' The desired conditional probability is 1 P(FS I {SF, FS}) = 1 12 1 4 + 12 1 P(FF) = 4' Using Conditional Probability for Modeling When constructing probabilistic models for experiments that have a sequential character, it is often natural and convenient to first specify conditional prob­ abilities and then use them to determine unconditional probabilities. The rule p(AnB) = P(B)P(A I B), which is a restatement of the definition of conditional probability, is often helpful in this process. Example 1.9. Radar Detection. If an aircraft is present in a certain area, a radar detects it and generates an alarm signal with probability 0.99. If an aircraft is not present. the radar generates a (false) alarm, with probability 0. 10. We assume that an aircraft is present with probability 0.05. What is the probability of no aircraft presence and a false alarm? What is the probability of aircraft presence and no detection? A sequential representation of the experiment is appropriate here, as shown in Fig. 1.9. Let A and B be the events A = {an aircraft is present}, B = {the radar generates an alarm} , 1 Probability is not }. B(' ;;;;;;; { the radar does not generate an alarm}. The given probabilities are recorded along the corresponding branches of the tree de- scribing the sanlple space, 8.::) shown in 1. 9. Each possible ou tcome corresponds to a leaf of the to of UAJ..,1Jvl,U. '''.,'-& with root to the I\"A .· .. ..,.'� ...... f' ..... rI desired probabilit ies are P(not present , false alarm) = P (present, no detection ) = n B) = P(AC)P(B l AC) = 0.95 · 0. 10 = 0.095, n Be ) = P(A)P (BC I A) = 0.05 · 0.01 ;;;;;;; 0.0005. (b) of the for the radar detection Extending the preced ing example, for calculati ng a of set up tree so an event is with a view the occurrence of the event as a sequence of stepsl namely, the tree. of leaf. (c ) We obtai n the of a by multiplying probabilities along ,.. .... � • .,.,c>C:- r.. .. ,{,�,n','lJL ...... � path of the tree. 24 1 In mathematical terms, we are dealing with an event A which occurs if and only if one of events AI l . .. � An has occurred, ! A = Al n A2 n ... n An . occurrence A is as an occurrence of AI . by the occurrence of of A3 , it is as a path n branches, corresponding to the events AI , ... , An. probability of A is given by the following ru le (see also Fig. 1.10) . n The multiplication rule can be verified by writing (ni=l ) = t ) . ---- 1.10: Visualization of the multiplication rule . The intersection event A = Al n n .. . n An i� a.s�ociated with a on a tree that desc ri bes the We associate the branches of this with the events . ... . A n. and we record next to probabi lities. The final node the path corresponds to the intersect ion event A! and its is obtai ned multiplying the conditional recorded along the branches of the path 1 n A2 n··· n ) ;;;; P(AdP(A21 A d · · · n n·.· n A n-d · Note any intermed iate node along the pat h also to some i nter- sect ion event and its is conditional probabil ities up to that node. For example, the event Al n A2 n A3 to the node shown in figure. and its is n we Sec. 1.3 Conditional Probability 25 and by using the definition of conditional probability to rewrite the right-hand side above as For the case of just two events, Al and A2 , the multiplication rule is simply the definition of conditional probability. Example 1.10. Three cards are drawn from an ordinary 52-card deck without replacement (drawn cards are not placed back in the deck). We wish to find the probability that none of the three cards is a heart. We assume that at each step, each one of the remaining cards is equally likely to be picked. By symmetry, this implies that every triplet of cards is equally likely to be drawn. A cumbersome approach, which we will not use, is to count the number of all card triplets that do not include a heart, and divide it with the number of all possible card triplets. Instead, we use a sequential description of the experiment in conjunction with the multiplication rule (cf. Fig. 1. 11). Define the events Ai = {the ith card is not a heart}. i= 1. 2. 3. We will calculate P(A1 n A2 n A3), the probability that none of the three cards is a heart, using the multiplication rule We have 39 P(Ad = 52 ' since there are 39 cards that are not hearts in the 52-card deck. Given that the first card is not a heart, we are left with 51 cards. 38 of which are not hearts, and Finally, given that the first two cards drawn are not hearts. there are 37 cards which are not hearts in the remaining 50-card deck. and These probabilities are recorded along the corresponding branches of the tree de­ scribing the sample space. as shown in Fig. 1.11. The desired probability is now obtained by mUltiplying the probabilities recorded along the corresponding path of the tree: 39 38 37 P(A1 nA2 nA3) = _. -.- . 52 51 50 1.11: Sequential descri pt ion 3-card se- 1. 10. 1 Note that once the probabilities are recorded along the tree1 the probability events can be '.HA\" &&A''''''4 (1 st is not a heart and 2nd is a heart) = 39 . 1 3, 13 and 2nd are not 3rd is a = _._m_ 52 51 50 consist ing of 4 grad uate and 4 a to Inean that given assign tnent of SOlne students to certain slots , any of the remai ning students is equally likely to be to any of the We then win We have 1 2 are 1, and 3 are different groups} , 1. P( A ) = � 1 15 ' since there are 12 student slots in are 15 slots 8 ) = 14 ' 1. 3 are 8 there are 14 si nce are 4 student slots in 1.12 : Sequential tion of the in the stu- dent problem of Example 1.11 . 4 ) = 1 3 ' other than those of 27 are 13 slots, 1, 3. desi red is is by multiplying the '\"''V ............. \".'V , ... ..... ' probabilities along corresponding path of the tree in Fig. 1.12. 1. Monty Problem. This is a much puzzle� based on an old American game show . are told that a prize is equaUy likely to beh ind any one to one A you one of making sure that the prize is not behind it. At this poi nt, you can st ick to your initial choice, or switch to the other unopened door. You win the prize if it lies behind your final v ............... of a the ( a) Stick to your initial choice . (b) Switch to the other unopened door. (c) You first point to door 1. If do or 2 is opened , you do not switch. If door 3 is opened , you Which is the best strategy? To answer the question, let us calculate the probability no you win or not , and the probability equal ly likely to be behind door . the of wi]] .... \"'.-........ , ....... is 1J\"\" _ u.�.&.:J'V \"-\"'-.lA ... ....... the 2/3) , is 28 Sample Space and Probability Chap. 1 another door without a prize has been opened for you, you will get to the winning door once you switch. Thus. the probability of winning is now 2/3, so (b) is a better strategy than (a) . Consider now strategy (c) . Under this strategy, there is insufficient informa­ tion for determining the probability of winning. The answer depends on the way that your friend chooses which door to open. Let us consider two possibilities. Suppose that if the prize is behind door 1, your friend always chooses to open door 2. (If the prize is behind door 2 or 3, your friend has no choice.) If the prize is behind door 1. your friend opens door 2, you do not switch, and you win. If the prize is behind door 2, your friend opens door 3, you switch. and you win. If the prize is behind door 3. your friend opens door 2. you do not switch, and you lose. Thus, the probability of winning is 2/3. so strategy (c) in this case is as good as strategy (b) . Suppose now that if the prize is behind door 1. your friend is equally likely to open either door 2 or 3. If the prize is behind door 1 (probability 1/3). and if your friend opens door 2 (probability 1/2), you do not switch and you win (probability 1/6). But if your friend opens door 3, you switch and you lose. If the prize is behind door 2, your friend opens door 3. you switch, and you win (probability 1/3). If the prize is behind door 3, your friend opens door 2, you do not switch and you lose. Thus. the probability of winning is 1/6 + 1/3 = 1/2, so strategy (c) in this case is inferior to strategy (b). 1.4 TOTAL PROBABILITY THEOREM AND BAYES' RULE In this section, we explore some applications of conditional probability. We start with the following theorem. which is often useful for computing the probabilities of various events. using a \"divide-and-conquer\" approach. Total Probability Theorem Let AI , ... ,An be disjoint events that form a partition of the sample space (each possible outcome is included in exactly one of the events AI, ... , An) and assume that P(Ai ) > 0, for all i. Then, for any event B, we have P(B) = P(A 1 n B) + ... + P(An n B) = P(AdP(B I Ad + ... + P(An )P(B I An). The theorem is visualized and proved in Fig. 1.13. Intuitively, we are par­ titioning the sample space into a number of scenarios (events) Ai . Then, the probability that B occurs is a weighted average of its conditional probability under each scenario, where each scenario is weighted according to its (uncondi­ tional) probability. One of the uses of the theorem is to compute the probability of various events B for which the conditional probabilities P(B I Ai) are known or 1.4 29 to The key is to choose appropriately the A I ..... An. and choice is by problem structure. Here are some exalnples. 1. 13: Visualization and verification of the total theorem . The events , . . . . form a of the space. so the event B can be decomposed into the disjoint union of its intersections n B with the �ets B = I n B) u ... u ( Arl n Using the addit i v i ty ax iom. it follows that the P (B) = P(A I n B) + ... + n B) . the de fin it ion cond itional P(Ai nB)= B ) = P(A t )P ( B I A d + ... + ) . B I ). For an alternat ive view. consider an equivalent seq uential model . as shown on the right . The probabi lity of the leaf Ai n B is the prod uct )P(B I ) of the probabilities along path lead ing to that The event B consists of the th ree leaves and is obtai n ed by their enter a chess tournament where your of winning (call type 1). 0.4 a the players (call them type 1 and against the remaining quarter of the pl ayers ( call them type 3 ) . You play a ganle agai nst a randomly chosen opponent . What is P(At) = 0.5, Also . let be the event of wi nning. We have I A d = 0. 3 . B I A 2) = 0.4. z. P(A;J) = 0.25. P ( B I ) = 0.5. 30 Sample Space and Probability Thus, by the total probability theorem, the probability of winning is PCB) = P (At)P(B I Ad + P(A2)P(B I A2) + P(A3)P(B I A3) = 0.5 . 0.3 + 0.25 . 0.4 + 0.25 . 0.5 = 0.375. Chap. 1 Example 1.14. You roll a fair four-sided die. If the result is 1 or 2, you roll once more but otherwise, you stop. What is the probability that the sum total of your rolls is at least 4? Let Ai be the event that the result of first roll is i, and note that peAt ) = 1/4 for each i. Let B be the event that the sum total is at least 4. Given the event AI, the sum total will be at least 4 if the second roll results in 3 or 4, which happens with probability 1/2. Similarly, given the event A2, the sum total will be at least 4 if the second roll results in 2, 3, or 4, which happens with probability 3/4. Also, given the event A3, you stop and the sum total remains below 4. Therefore, 1 P(B I Ad = 2 ' By the total probability theorem. 11 13 1 1 9 PCB) = - . - + . - + -· 0 + - . 1 = . 4 2 4 4 4 4 16 The total probability theorem can be applied repeatedly to calculate proba­ bilities in experiments that have a sequential character, as shown in the following example. Example 1.15. Alice is taking a probability class and at the end of each week she can be either up-to-date or she may have fallen behind. If she is up-to-date in a given week, the probability that she will be up-to-date (or behind) in the next week is 0.8 (or 0.2, respectively) . If she is behind in a given week, the probability that she will be up-to-date (or behind) in the next week is 0.4 (or 0.6, respectively) . Alice is (by default) up-to-date when she starts the class. What is the probability that she is up-to-date after three weeks? Let Ui and Bi be the events that Alice is up-to-date or behind, respectively, after i weeks. According to the total probability theorem, the desired probability P(U3) is given by The probabilities P(U2) and P(B2) can also be calculated using the total probability theorem: P(U2) = P(UdP(U2 1 Ud + P(BdP(U2 1 Bd = P(Ud · 0.8 + P(Bd · 0.4, P(B2) = P(Ut)P(B2 1 ud + P(Bt }P(B21 Bd = P(Ut} ·0.2 + P(Bt ) ·0.6. Sec. 1.4 Total Probability Theorem and Bayes ' Rule Finally, since Alice starts her class up-to-date, we have P(Ud = 0.8, P(B1 ) = 0.2. We can now combine the preceding three equations to obtain P(U2) = 0.8 · 0.8 + 0.2 · 0.4 = 0.72, P(B2 ) = 0.8 · 0.2 + 0.2 · 0.6 = 0.28, and by using the above probabilities in the formula for P(U3): P(U3 ) = 0.72 ·0.8 + 0.28 ·0.4 = 0.688. 31 Note that we could have calculated the desired probability P(U3) by con­ structing a tree description of the experiment, then calculating the probability of every element of U3 using the multiplication rule on the tree, and adding. However. there are cases where the calculation based on the total probability theorem is more convenient. For example. suppose we are interested in the probability P(U20) that Alice is up-to-date after 20 weeks. Calculating this probability using the multipli­ cation rule is very cumbersome. because the tree representing the experiment is 20 stages deep and has 220 leaves. On the other hand, with a computer, a sequential calculation using the total probability formulas P(Uz+d = P(Ud ·0.8 + P(Bi ) ·0.4. P(BHd = P(Ui ) ·0.2 + P(Bi ) ·0.6. and the initial conditions P(U1 ) = 0.8. P(B1 ) = 0.2. is very simple. Inference and Bayes' Rule The total probability theorem is often used in conjunction with the following celebrated theorem, which relates conditional probabilities of the form P(A I B) with conditional probabilities of the form P(B I A), in which the order of the conditioning is reversed. Bayes' Rule Let AI , A2 , ... , An be disjoint events that form a partition of the sample space, and assume that P(Ai ) > 0, for all i. Then, for any event B such that P(B) > 0, we have P(A . I B) = P(Ai)P(B 1 Ai ) t P(B) P(Ai)P(B 1 Ai) - P(AI )P(B 1 AI) + ... + P(An)P(B 1 An ) ' we 1. 14: An of the inference context that is im plicit in rule. We observe a shade in a person's (this is event the \"effect\" ) and we wan t to estimate the likelihood of three mutually exclusive and collectively exh austive potential causes : cause 1 (event AI ) is that there is a malignant tumor, cause 2 ) is that there is a tumor I and cause 3 ( eve nt corresPoll1ds to reasons ot her than a tu mo r . We assu me that we know the probabili ties P( A i) and P(B I ) , i = 1. 2. 3. t hat we see a shade B occurs). rule the of the var ious causes as peAl )P(B I Ai ) P(Ai I B) = - P - ( A - 1 -------------- ) A -3-) ! i= 1. 2, 3 . For an al ternat ive consider an model, as show n on t he right . The probabil ity I B) o f a malignant tumor is the probabi l ity of the first highlighted leaf. which is P(A 1 n B) . divided by the total probabi lity of the leaves. which is P(B). To note by of ( B I A d = (Ai I B)P {B) . This yields the first total probability follows from is used are a . ... ...... .. .L .... J ..... ... 1 that Inay result in a certain \"effect .\" We observe the effect , and we to infer a effect B has been observed , we cause to P(Ai I B) as the of event Ai given the information, to be distinguished from P{Ad 1 which we call the Sec. 1.4 Total Probability Theorem and Bayes ' Rule 33 Example 1. 16. Let us return to the radar detection problem of Example 1.9 and Fig. 1.9. Let A = {an aircraft is present} , B {the radar generates an alarm} . We are given that peA) = 0.05, PCB I A) = 0.99, Applying Bayes' rule, with Al = A and A2 AC, we obtain P (aircraft present I alarm) = peA I B) _ P(A)P(B I A) - PCB) P(A)P(B I A) P(A)P(B I A) + P(k- )P(B l Ac) 0.05 · 0.99 0.05 · 0.99 + 0.95 · 0.1 :::::: 0.3426. Example 1. 11. Let us return to the chess problem of Example 1. 13. Here. At is the event of getting an opponent of type i, and peAl ) = 0.5, P(A3) = 0.25. Also, B is the event of winning, and PCB I Ad = 0.3. PCB I A3 ) = 0.5. Suppose that you win. What is the probability peAl I B) that you had an opponent of type I? Using Bayes' rule, we have P(Al )P(B I Ad peAl I B) = P(At )P(B I Ad + P(A2 )P(B I A2) + P(A3)P{B I A3) 0.5 · 0.3 - �������--��� 0.5 . 0.3 + 0.25 . 0.4 + 0.25 . 0.5 = 0.4. Example 1.18. The False-Positive Puzzle. A test for a certain rare disease is assumed to be correct 95% of the time: if a person has the disease, the test results are positive with probability 0.95, and if the person does not have the disease, the test results are negative with probability 0.95. A random person drawn from 34 Sample Space and Probability Chap. 1 a certain population has probability 0.001 of having the disease. Given that the person just tested positive, what is the probability of having the disease? If A is the event that the person has the disease, and B is the event that the test results are positive, the desired probability. P{A I B), is P{A)P(B I A) P(A I B) = P(A)P(B I A) + P{Ac)P{B l Ac) 0.001 · 0.95 0.001 · 0.95 + 0.999 . 0.05 = 0.0187. Note that even though the test was assumed to be fairly accurate, a person who has tested positive is still very unlikely (less than 2%) to have the disease. According to The Economist (February 20th. 1999). 80% of those questioned at a leading American hospital substantially missed the correct answer to a question of this type; most qf them thought that the probability that the person has the disease is 0.95! 1.5 INDEPENDENCE We have introduced the conditional probability P(A I B) to capture the partial information that event B provides about event A. An interesting and important special case arises when the occurrence of B provides no such information and does not alter the probability that A has occurred, i.e. , P(A I B) = P(A). When the above equality holds. we say that A is independent of B. Note that by the definition P(A I B) = P(A n B)/P(B) , this is equivalent to P(A n B) = P(A)P (B) . We adopt this latter relation as the definition of independence because it can be used even when P(B) = 0, in which case P(A I B) is undefined. The symmetry of this relation also implies that independence is a symmetric property; that is, if A is independent of B, then B is independent of A, and we can unambiguously say that A and B are independent events. Independence is often easy to grasp intuitively. For example, if the occur­ rence of two events is governed by distinct and noninteracting physical processes, such events will turn out to be independent. On the other hand, independence is not easily visualized in terms of the sample space. A common first thought is that two events are independent if they are disjoint, but in fact the oppo­ site is true: two disjoint events A and B with P(A) > 0 and P(B) > 0 are never independent, since their intersection An B is empty and has probability O. Sec. 1.5 Independence 35 For example, an event A and its complement Ac are not independent [unless P(A) = 0 or P(A) = 1], since knowledge that A has occurred provides precise information about whether Ac has occurred. Example 1.19. Consider an experiment involving two successive rolls of a 4-sided die in which all 16 possible outcomes are equally likely and have probability 1/ 16. (a) Are the events Ai = {1st roll results in i}, Bj = {2nd roll results in j} , independent? We have P(Ai n Bj ) = P (the outcome of the two rolls is (i, j)) = 1� ' P Ai = number of elements of At ( ) total number of possible outcomes P(B .) = number of elements of B) ) total number of possible outcomes 4 16 ' 4 16 · We observe that P(Ai n B) ) = P(Ai)P(Bj), and the independence of At and Bj is verified. Thus, our choice of the discrete uniform probability law implies the independence of the two rolls. (b) Are the events A = {1st roll is a I}, B = {sum of the two rolls is a 5}, independent? The answer here is not quite obvious. We have and also P(A n B) = P (the result of the two rolls is (1,4)) = 1� ' P(A = number of elements of A _ ..!. ) total number of possible outcomes 16 The event B consists of the outcomes (l,4), (2,3), (3,2) , and (4, 1). and P(B) = number of elements of B 4 total number of possible outcomes 16 · Thus, we see that P(A n B) independent. ( c) Are the events P(A)P(B) , and the events A and B are A = {maximum of the two rolls is 2}, B = {minimum of the two rolls is 2}, 36 Sample Space and Probability Chap. 1 independent? Intuitively. the answer is \"no\" because the minimum of the two rolls conveys some information about the maximum. For example, if the minimum is 2, the maximum cannot be 1. More precisely, to verify that A and B are not independent, we calculate and also P( A n B) = P (the result of the two rolls is (2,2)) = 116, P A = number of elements of A = �. () total number of possible outcomes 16 PCB) = number of elements of B 156' total number of outcomes We have P(A)P(B) = 15/(16)2, so that P(A n B) =I- P(A)P(B). and A and B are not independent. We finally note that, as mentioned earlier, if A and B are independent, the occurrence of B does not provide any new information on the probability of A occurring. It is then intuitive that the non-occurrence of B should also provide no information on the probability of A. Indeed. it can be verified that if A and B are independent, the same holds true for A and Be (see the end-of-chapter problems) . Conditional Independence We noted earlier that the conditional probabilities of events, conditioned on a particular event. form a legitimate probability law. We can thus talk about independence of various events with respect to this conditional law. In particular, given an event G. the events A and B are called conditionally independent if P(A n B I G) peA I G)P(B I G) . To derive an alternative characterization of conditional independence, we use the definition of the conditional probability and the multiplication rule, to write P(A BIG) = p(A n BnG) n P(G) P(G)P(B I G)P(A I Bn G) P(G) = P(B I G)P(A I Bn G). We now compare the preceding two expressions. and after eliminating the com­ mon factor P (B I G) , assumed nonzero. we see that conditional independence is the same as the condition P(A IBn G) = peA I G) . Sec. 1.5 Independence 37 In words, this relation states that if C is known to have occurred, the additional knowledge that B also occurred does not change the probability of A. Interestingly, independence of two events A and B with respect to the unconditional probability law. does not imply conditional independence, and vice versa, as illustrated by the next two examples. Example 1.20. Consider two independent fair coin tosses, in which all four possible outcomes are equally likely. Let HI = {1st toss is a head}, H2 = {2nd toss is a head}, D = {the two tosses have different results}. The events HI and H2 are (unconditionally) independent. But 1 P(H1 1 D) = 2' P(HI n H2 1 D) = 0, so that P(HI n H2 1 D) =f P(H1 I D)P(H2 1 D) , and HI , H2 are not conditionally independent. This example can be generalized. For any probabilistic model, let A and B be independent events, and let C be an event such that P(C) > 0, P(A I C) > 0, and P(B I C) > 0, while An B n C is empty. Then, A and B cannot be conditionally independent (given C) since P(A n B I C) = 0 while P(A I C) P(B I C) > O. Example 1.21. There are two coins, a blue and a red one. We choose one of the two at random, each being chosen with probability 1/2, and proceed with two independent tosses. The coins are biased: with the blue coin, the probability of heads in any given toss is 0.99, whereas for the red coin it is O.Ol. Let B be the event that the blue coin was selected. Let also Hi be the event that the ith toss resulted in heads. Given the choice of a coin, the events Hl and H2 are independent. because of our assumption of independent tosses. Thus, P(H1 n H2 1 B) = P(Hl I B)P(H2 1 B) = 0.99 . 0.99. On the other hand, the events HI and H2 are not independent. Intuitively, if we are told that the first toss resulted in heads, this leads us to suspect that the blue coin was selected, in which case, we expect the second toss to also result in heads. Mathematically, we use the total probability theorem to obtain P(HI ) = P(B)P(H1 I B) + P(BC)P(H1 I BC) = � ·0.99 + � ·0.01 = �, as should be expected from symmetry considerations. Similarly, we have P(H2) = 1/2. Now notice that P(H1 n H2 ) = P(B)P(HI n H2 1 B) + P(BC)P(H1 n H2 1 BC) 1 1 1 = 2 ·0.99 · 0.99 + 2 ·0.01 · 0.01 � \"2' 38 Sample Space and Probability Chap. 1 Thus, P(H1 n H2) =f. P(H1 )P(H2), and the events Hl and H2 are dependent, even though they are conditionally independent given B. We now summarize. Independence • Two events A and B are said to be independent if P{A n B) = P(A)P{B). If in addition, P{B) > 0, independence is equivalent to the condition P{A I B) = P(A) . • If A and B are independent, so are A and Be. • Two events A and B are said to be conditionally independent, given another event e with P( e) > 0, if p(A n B I e) = P(A le)p(B Ie). If in addition, P(B n e) > 0, conditional independence is equivalent to the condition P(A IBn e) = P(A I e). • Independence does not imply eonditional independence, and vice versa. Independence of a Collection of Events The definition of independence can be extended to multiple events. Definition of Independence of Several Events We say that the events At , A2 , .•• , An are independent if for every subset S of {1, 2, . . . ,n}. Sec. 1.5 Independence 39 For the case of three events, AI , A2 , and A3, independence amounts to satisfying the four conditions P(A1 n A2 ) = P(AI) P(A2), P(A1 n A3) = P(At ) P(A3), P(A2 n A3) = P(A2 ) P(A3) , P(A1 n A2 n A3) = P(A1 ) P(A2 ) P(A3). The first three conditions simply assert that any two events are independent, a property known as pairwise independence. But the fourth condition is also important and does not follow from the first three. Conversely, the fourth condition does not imply the first three; see the two examples that follow. Example 1.22. Pairwise Independence does not Imply Independence. Consider two independent fair coin tosses, and the following events: HI = { 1st toss is a head} , H2 = { 2nd toss is a head} , D = {the two tosses have different results} . The events HI and H2 are independent, by definition. To see that HI and D are independent, we note that P(D I H ) = P(HI n D) = 1/4 = ! = P(D). 1 P(HI ) 1/2 2 Similarly, H2 and D are independent. On the other hand, we have 111 P(HI n H2 n D) = 0 =1= 2 . 2 . 2 = P(H. )P(H2)P(D) , and these three events are not independent. Example 1.23. The Equality P(A1 n A2 n A3) = P(At) P(A2 ) P(A3) is not Enough for Independence. Consider two independent rolls of a fair six-sided die, and the following events: We have A = { lst roll is 1, 2, or 3} , B = { lst roll is 3, 4, or 5} , C = { the sum of the two rolls is 9}. 1 1 1 P(A n B) = 6 =1= 2 . 2 = P(A)P(B) , 11 4 P(A n C) = 36 =1= 2 . 36 = P(A)P(C), 11 4 P(B n C) = 12 =1= 2 . 36 = P(B)P(C). the events are events AI , or see ind icates the of three n n 1 U n n 1 ..... \",,,,,,,.,,,,,, no two u ) t U ) ; 1. 24 . The number next to each link Series and connections Sec. 1.5 Independence 41 This is a typical problem of assessing the reliability of a system consisting of components that can fail independently. Such a system can often be divided into subsystems, where each subsystem consists in turn of several components that are connected either in series or in parallel; see Fig. 1. 15(b). Let a subsystem consist of components 1, 2, . .. , m, and let Pi be the prob­ ability that component i is up (\"succeeds'l ). Then, a series subsystem succeeds if all of its components are up, so its probability of success is the product of the probabilities of success of the corresponding components, i.e .. P(series subsystem succeeds) = PIP2 ... pm · A parallel subsystem succeeds if any one of its components succeeds, so its prob­ ability of failure is the product of the probabilities of failure of the corresponding components, i.e. , P(parallel subsystem succeeds) = 1 - P(parallel subsystem fails) = 1 - (1 - P 1 ) (1 - P2) . . . (1 - Pm ) . Returning now to the network of Fig. 1. 15(a), we can calculate the probabil­ ity of success (a path from A to B is available) sequentially, using the preceding formulas, and starting from the end. Let us use the notation X ---+ Y to denote the event that there is a (possibly indirect) connection from node X to node Y. Then. P(C ---+ B) = 1 - ( 1 - P(C ---+ E and E ---+ B)) ( l - P(C ---+ F and F ---+ B)) = 1 - (1 - pCEPEB ) ( l - PC FPFB ) = 1 - (1 - 0.8 . 0.9)(1 - 0.95 . 0.85) = 0.946, P(A ---+ C and C ---+ B) = P(A ---+ C)P(C ---+ B) = 0.9·0.946 = 0.851. P(A ---+ D and D ---+ B) = P(A ---+ D)P(D ---+ B) = 0.75 · 0.95 = 0.712, and finally we obtain the desired probability P(A ---+ B) = 1 - ( 1 - P(A ---+ C and C ---+ B)) ( l - P(A ---+ D and D ---+ B)) = 1 - (1 - 0.851)(1 - 0.712) = 0.957. Independent Trials and the Binomial Probabilities If an experiment involves a sequence of independent but identical stages, we say that we have a sequence of independent trials. In the special case where there are only two possible results at each stage, we say that we have a sequence of independent Bernoulli trials. The two possible results can be anything, e.g. , \"it rains\" or \"it doesn't rain,\" but we will often think in terms of coin tosses and refer to the two results as \"heads\" (H) and \"tails\" (T) . 42 1 Consider an that consists of n tosses of a which the probability of IS p, P is some number between OL In this means AI ! ! •••• An are ... . U.'-.L\"\" LJ\"\" .. ... - dent , where Ai = { ith toss is a head}. can description, as shown outcome tai ls has probabil ity n of tosses. u ..................... that ..... \"-\"JLU. a ....... ,U.LJ n. by means of a condi tional n-Iong k from 0 1.16: of an three lnc1lp.np.n- dent tosses of a coin. the branches of the tree . we record the r-Ar .. oc' ......... ,rl conditional probabilit ies, and by the multiplication rule, the probability of ob­ taining a particular 3-toss sequence is calculated by multiplying the probabilities recorded the of the tree. probability p( k) = P(k ............... ' ........ come in an n-toss which will play an important role showed above the probabi1ity of any sequence k .................... u IS (1 - , so we have p(k) == (n k) (1 - p)n -k: Sec. 1.5 Independence 43 where we use the notation (�) = number of distinct n-toss sequences that contain k heads. The numbers (�) (read as \"n choose k\") are known as the binomial coeffi­ cients, while the probabilities p( k) are known as the binomial probabilities. Using a counting argument, to be given in Section 1.6, we can show that (n) n! k k! (n -k)!' k = 0, 1, ... ,n, where for any positive integer i we have i! = 1 . 2· . . (i - 1) . i, and, by convention, O! = 1. An alternative verification is sketched in the end-of­ chapter problems. Note that the binomial probabilities p(k) must add to 1, thus showing the binomial formula t G)pk(l - p)n-k = 1. k=O Example 1.25. Grade of Service. An internet service provider has installed c modems to serve the needs of a population of n dialup customers. It is estimated that at a given time, each customer will need a connection with probability p, independent of the others. What is the probability that there are more customers needing a connection than there are modems? Here we are interested in the probability that more than c customers simul­ taneously need a connection. It is equal to n L p(k), k =c+ l where are the binomial probabilities. For instance, if n = 100, p = 0. 1, and c = 15, the probability of interest turns out to be 0.0399. This example is typical of problems of sizing a facility to serve the needs of a homogeneous population, consisting of independently acting customers. The problem is to select the facility size to guarantee a certain probability (sometimes called grade of service) that no user is left unserved. 44 Sample Space and Probability Chap. 1 1.6 COUNTING The calculation of probabilities often involves counting the number of outcomes in various events. We have already seen two contexts where such counting arises. (a) When the sample space n has a finite number of equally likely outcomes, so that the discrete uniform probability law applies. Then, the probability of any event A is given by P( A) _ number of elements of A - number of elements of n' and involves counting the elements of A and of n. (b) When we want to calculate the probability of an event A with a finite number of equally likely outcomes, each of which has an already known probability p. Then the probability of A is given by P(A) = p. (number of elements of A) . and involves counting the number of elements of A. An example of this type is the calculation of the probability of k heads in n coin tosses (the binomial probabilities) . We saw in the preceding section that the probability of each distinct sequence involving k heads is easily obtained, but the calculation of the number of all such sequences, to be presented shortly, requires some thought. While counting is in principle straightforward, it is frequently challenging; the art of counting constitutes a large portion of the field of combinatorics. In this section, we present the basic principle of counting and apply it to a number of situations that are often encountered in probabilistic models. The Counting Principle The counting principle is based on a divide-and-conquer approach, whereby the counting is broken down into stages through the use of a tree. For example, consider an experiment that consists of two consecutive stages. The possible results at the first stage are al, a2, ... ,am; the possible results at the second stage are bl, b2, . . . , bn. Then, the possible results of the two-stage experiment are all possible ordered pairs (ai, bj), i 1, ... , m, j = 1, ... , n. Note that the number of such ordered pairs is equal to mn. This observation can be generalized as follows (see also Fig. 1. 17). 1 1. 17: Illustration of the basic pri nciple . The co unting is carried (r = 4 in the The first has nl resu lts. Fo r every res ult at the first i - 1 stages , there are nl results at the ith stage. The number of leaves is nl n2 . . . n\\'\". This is the desired count . '-''V ......... ''..,;> '\"'..., of r Suppose (a) are nl possible results at the first 45 (b) For every possible result at the first stage, there are n2 possible results the second stage . (c) for any the i- I ,,0.,;::; . ..... .;:1. there are ni number of possible results of the r-stage process is Example 1 The Number of Telephone Numbers. A local telephone number is a 7- digit sequence, but the first digit has to be different from 0 or 1 . How disti nct telep hone numbers are there? We can vis ualize choice of a seque nce as a tot al of 7 .;:1\"'0.';::;'<;;;;::1 U,,\", lI.IIJ H:..;, a process ! we and a of one out of 1 0 a for 46 Sample Space and Probability the first stage where we only have 8 choices. Therefore, the answer is 8 . 10 . 10 · . . 10 = 8 . 106 . \"'-.\".-' 6 times Chap. 1 Example 1.27. The Number of Subsets of an n-Element Set. Consider an n-element set {Sl , S2 , .. ' ,Sn }. How many subsets does it have (including itself and the empty set)? We can visualize the choice of a subset as a sequential process where we examine one element at a time and decide whether to include it in the set or not. We have a total of n stages, and a binary choice at each stage. Therefore the number of subsets is 2 . 2 . . . 2 = 2n . '-......-\" n times It should be noted that the Counting Principle remains valid even if each first-stage result leads to a different set of potential second-stage results, etc. The only requirement is that the number of possible second-stage results is constant, regardless of the first-stage result. In what follows, we will focus primarily on two types of counting arguments that involve the selection of k objects out of a collection of n objects. If the order of selection matters, the selection is called a permutation, and otherwise, it is called a combination. We will then discuss a more general type of counting, involving a partition of a collection of n objects into multiple subsets. k-permutations We start with n distinct objects, and let k be some positive integer, with k � n. We wish to count the number of different ways that we can pick k out of these n objects and arrange them in a sequence, i.e. , the number of distinct k-object sequences. We can choose any of the n objects to be the first one. Having chosen the first, there are only n - 1 possible choices for the second; given the choice of the first two, there only remain n - 2 available objects for the third stage, etc. When we are ready to select the last (the kth) object, we have already chosen k - 1 objects, which leaves us with n - (k - 1) choices for the last one. By the Counting Principle, the number of possible sequences, called k-permutations, IS n( n - 1) . . . (n _ k + 1) = _n(-'----n_-_1----=-)_· _. '.,.:...( n __ k_+_1...:..,.)(.:.....-n_-_k----=-)_ •• _. _2 _. 1 (n - k) .. · 2·1 n! (n - k) ! ' In the special case where k = n, the number of possible sequences, simply called permutations, is n(n - l)(n - 2) ... 2 . 1� = n! . (Let k = n in the formula for the number of k-permutations, and recall the convention O! = 1 .) Sec. 1.6 Counting 47 Example 1.28. Let us count the number of words that consist of four distinct letters. This is the problem of counting the number of 4-permutations of the 26 letters in the alphabet. The desired number is n! 26! (n _ k)! = 22! = 26 · 25 · 24 · 23 = 358, 800. The count for permutations can be combined with the Counting Principle to solve more complicated counting problems. Example 1.29. You have nl classical music CDs, n2 rock music CDs, and n3 country music CDs. In how many different ways can you arrange them so that the CDs of the same type are contiguous? We break down the problem in two stages, where we first select the order of the CD types, and then the order of the CDs of each type. There are 3! ordered se­ quences of the types of CDs (such as classical/rock/country, rock/country/classical, etc.), and there are nl ! (or n2!. or n3!) permutations of the classical (or rock. or country, respectively) CDs. Thus for each of the 3! CD type sequences, there are nl ! n2! n3! arrangements of CDs. and the desired total number is 3! nl ! n2 ! n3 !. Suppose now that you offer to give ki out of the n. CDs of each type i to a friend, where ki < ni , i = 1. 2. 3. What is the number of all possible arrangements of the CDs that you are left with? The solution is similar, except that the number of (ni - ki)-permutations of CDs of type i replaces ni l in the estimate, so the number of possible arrangements is Combinations There are n people and we are interested in forming a committee of k. How many different committees are possible? More abstractly, this is the same as the problem of counting the number of k-element subsets of a given n-element set. Notice that forming a combination is different than forming a k-permutation. because in a combination there is no ordering of the selected elements. For example, whereas the 2-permutations of the letters A, B, C, and D are AB. BA, AC , CA, AD, DA, BC. CB, BD. DB, CD, DC, the combinations of two out of these four letters are AB, AC, AD, BC, BD. CD. In the preceding example, the combinations are obtained from the per­ mutations by grouping together \"duplicates\" ; for example, AB and BA are not 48 Sample Space and Probability Chap. 1 viewed as distinct, and are both associated with the combination AB. This rea­ soning can be generalized: each combination is associated with k! \"duplicate\" k-permutations, so the number n!/(n - k) ! of k-permutations is equal to the number of combinations times k! . Hence, the number of possible combinations, is equal to n! k! (n- k) ! ' Let us now relate the above expression to the binomial coefficient, which was denoted by G) and was defined in the preceding section as the number of n-toss sequences with k heads. We note that specifying an n-toss sequence with k heads is the same as selecting k elements (those that correspond to heads) out of the n-element set of tosses: i.e. : a combination of k out of n objects. Hence, the binomial coefficient is also given by the same formula and we have n! k! (n-k)! ' Example 1.30. The number of combinations of two out of the four letters A, B. C, and D is found by letting n = 4 and k = 2. It is (4)_ �_6 2 - 2! 2! - , consistent with the listing given earlier. It is worth observing that counting arguments sometimes lead to formulas that are rather difficult to derive algebraically. One example is the binomial formula t G)P'(1 -p)n-k = 1. k=O discussed in Section 1 .5. In the special case where p = 1/2, this formula becomes t G) = 2n, k=O and admits the following simple interpretation. Since G) is the number of k­ element subsets of a given n-element subset. the sum over k of (�) counts the number of subsets of all possible cardinalities. It is therefore equal to the number of all subsets of an n-element set. which is 2n. Example 1.31. We have a group of n persons. Consider clubs that consist of a special person from the group (the club leader) and a number (possibly zero) of Sec. 1.6 Counting 49 additional club members. Let us count the number of possible clubs of this type in two different ways, thereby obtaining an algebraic identity. There are n choices for club leader. Once the leader is chosen, we are left with a set of n - 1 available persons, and we are free to choose any of the 2n-1 subsets. Thus the number of possible clubs is n2n-1 • Alternatively, for fixed k, we can form a k-person club by first selecting k out of the n available persons [there are G) choices] . We can then select one of the members to be the leader (there are k choices) . By adding over all possible club sizes k, we obtain the number of possible clubs as L�=l k(�) , thereby showing the identity Partitions Recall that a combination is a choice of k elements out of an n-element set without regard to order. Thus, a combination can be viewed as a partition of the set in two: one part contains k elements and the other contains the remaining n - k. We now generalize by considering partitions into more than two subsets. We are given an n-element set and nonnegative integers nl , n2 ,· ... nr . whose sum is equal to n. We consider partitions of the set into r disjoint subsets. with the ith subset containing exactly ni elements. Let us count in how many ways this can be done. We form the subsets one at a time. We have C� J ways of forming the first subset. Having formed the first subset, we are left with n - nl elements. We need to choose n2 of them in order to form the second subset, and we have (n�;l ) choices, etc. Using the Counting Principle for this r-stage process, the total number of choices is which is equal to n! (n - nI )! nd (n - nI )! n2 ! (n - nl - n2 )! (n - nl - ... - nr- I) ! We note that several terms cancel and we are left with n! This is called the multinomial coefficient and is usually denoted by 50 Sample Space and Probability Chap. 1 Example 1.32. Anagrams. How many different words (letter sequences) can be obtained by rearranging the letters in the word TATTOO? There are six positions to be filled by the available letters. Each rearrangement corresponds to a partition of the set of the six positions into a group of size 3 (the positions that get the letter T) , a group of size 1 (the position that gets the letter A), and a group of size 2 (the positions that get the letter 0). Thus, the desired number is ---,---- 6 -,-- ! ---.,. = 1 . 2 . 3 . 4 . 5 . 6 = 60 1! 2!3! 1 · 1 · 2 · 1 · 2 · 3 . It is instructive to derive this answer using an alternative argument. (This argument can also be used to rederive the multinomial coefficient formula: see the end-of-chapter problems.) Let us write TATTOO in the form TI AT2T301 02 pretending for a moment that we are dealing with 6 distinguishable objects. These 6 objects can be rearranged in 6! different ways. However, any of the 3! possible permutations of T1 , T2, and T3 , as well as any of the 2! possible permutations of 01 and 02 , lead to the same word. Thus, when the subscripts are removed, there are only 6!/(3! 2!) different words. Example 1.33. A class consisting of 4 graduate and 12 undergraduate students is randomly divided into four groups of 4. What is the probability that each group includes a graduate student? This is the same as Example 1.11 in Section 1.3, but we will now obtain the answer using a counting argument. We first determine the nature of the sample space. A typical outcome is a particular way of partitioning the 16 students into four groups of 4. We take the term \"randomly\" to mean that every possible partition is equally likely, so that the probability question can be reduced to one of counting. According to our earlier discussion, there are ( 16 ) 16! 4, 4, 4, 4 4! 4! 4!4! different partitions, and this is the size of the sample space. Let us now focus on the event that each group contains a graduate student. Generating an outcome with this property can be accomplished in two stages: (a) Take the four graduate students and distribute them to the four groups; there are four choices for the group of the first graduate student, three choices for the second, two for the third. Thus, there is a total of 4! choices for this stage. (b) Take the remaining 12 undergraduate students and distribute them to the four groups (3 students in each). This can be done in 1 2! 3! 3! 3! 3! different ways. By the Counting Principle, the event of interest can occur in 4! 12! 3! 3! 3! 3! Sec. 1. 7 Summary and Discussion different ways. The probability of this event is 4! 12! 3! 3! 3! 3! 16! 4! 4! 4! 4! After some cancellations, we find that this is equal to 12 ·8·4 15 ·14· 13 ' consistent with the answer obtained in Example 1.11. Here is a summary of all the counting results we have developed. Summary of Counting Results • Permutations of n objects: n!. • k-permutations of n objects: n!/(n - k)!. • Combinations of k out of n objects: (�) = k! (n n� k) !· • Partitions of n objects into r groups, with the ith group having ni objects: SUMMARY AND DISCUSSION A probability problem can usually be broken down into a few basic steps: 51 (a) The description of the sample space, that is, the set of possible outcomes of a given experiment. (b) The (possibly indirect) specification of the probability law (the probability of each event). (c) The calculation of probabilities and conditional probabilities of various events of interest . The probabilities of events must satisfy the nonnegativity, additivity, and nor­ malization axioms. In the important special case where the set of possible out­ comes is finite, one can just specify the probability of each outcome and obtain 52 Sample Space and Probability Chap. 1 the probability of any event by adding the probabilities of the elements of the event. Given a probability law, we are often interested in conditional probabilities, which allow us to reason based on partial information about the outcome of the experiment. We can view conditional probabilities as probability laws of a special type, under which only outcomes contained in the conditioning event can have positive conditional probability. Conditional probabilities can be derived from the (unconditional) probability law using the definition P(A I B) = P(A n B)/P (B) . However, the reverse process is often convenient, that is, first specify some conditional probabilities that are natural for the real situation that we wish to model, and then use them to derive the (unconditional) probability law. We have illustrated through examples three methods for calculating prob­ abilities: (a) The counting method. This method applies to the case where the num­ ber of possible outcomes is finite, and all outcomes are equally likely. To calculate the probability of an event, we count the number of elements of the event and divide by the number of elements of the sample space. (b) The sequential method. This method applies when the experiment has a sequential character, and suitable conditional probabilities are specified or calculated along the branches of the corresponding tree (perhaps using the counting method) . The probabilities of various events are then obtained by multiplying conditional probabilities along the corresponding paths of the tree, using the multiplication rule. (c) The divide-and-conquer method. Here, the probabilities P(B) of vari­ ous events B are obtained from conditional probabilities P(B I Ai ), where the Ai are suitable events that form a partition of the sample space and have known probabilities P(A i ) . The probabilities P(B) are then obtained by using the total probability theorem. Finally, we have focused on a few side topics that reinforce our main themes. We have discussed the use of Bayes' rule in inference, which is an important application context . We have also discussed some basic principles of counting and combinatorics, which are helpful in applying the counting method. Problems 53 PR OBLEMS SECTION 1.1. Sets Problem 1. Consider rolling a six-sided die. Let A be the set of outcomes where the roll is an even number. Let B be the set of outcomes where the roll is greater than 3. Calculate and compare the sets on both sides of De �lorgan's laws Problem 2. Let A and B be two sets. (a) Show that (b) Show that ( A n B) C = A C u BC• (c) Consider rolling a fair six-sided die. Let A be the set of outcomes where the roll is an odd number. Let B be the set of outcomes where the roll is less than 4. Calculate the sets on both sides of the equality in part (b) , and verify that the equality holds. Problem 3. * Prove the identity Solution. If x belongs to the set on the left, there are two possibilities. Either x E A, in which case x belongs to all of the sets A U BlI • and therefore belongs to the set on the right. Alternatively. x belongs to all of the sets Bn in which case. it belongs to all of the sets A U Bn. and therefore again belongs to the set on the right. Conversely. if x belongs to the set on the right. then it belongs to Au Bn for all n. If x belongs to A. then it belongs to the set on the left. Otherwise. x must belong to every set Bn and again belongs to the set on the left. Problem 4.* Cantor's diagonalization argument. Show that the unit interval [0, 1] is uncountable. i.e., its elements cannot be arranged in a sequence. Solution. Any number x in [0. 1] can be represented in terms of its decimal expansion. e.g., 1/3 = 0.3333 ···. Note that most numbers have a unique decimal expansion, but there are a few exceptions. For example, 1/2 can be represented as 0.5000 · . . or as 0.49999 · . '. It can be shown that this is the only kind of exception, i.e .. decimal expansions that end with an infinite string of zeroes or an infinite string of nines. 54 Sample Space and Probability Chap. 1 Suppose, to obtain a contradiction, that the elements of [0, :1.] can be arranged in a sequence Xl , X2 , X3, •.. , so that every element of [0, 1] appears in the sequence. Consider the decimal expansion of Xn : where each digit a� belongs to {O, 1, ... ,9}. Consider now a number y constructed as follows. The nth digit of y can be 1 or 2, and is chosen so that it is different from the nth digit of Xn . Note that y has a unique decimal expansion since it does not end with an infinite sequence of zeroes or nines. The number y differs from each Xn , since it has a different nth digit. Therefore, the sequence Xl , X2, ••• does not exhaust the elements of [0, 1], contrary to what was assumed. The contradiction establishes that the set [0, 1] is uncountable. SECTION 1.2. Probabilistic Models Problem 5. Out of the students in a class, 60% are geniuses, 70% love chocolate, and 40% fall into both categories. Determine the probability that a randomly selected student is neither a genius nor a chocolate lover. Problem 6. A six-sided die is loaded in a way that each even face is twice as likely as each odd face. All even faces are equally likely, as are all odd faces. Construct a probabilistic model for a single roll of this die and find the probability that the outcome is less than 4. Problem 7. A four-sided die is rolled repeatedly, until the first time (if ever) that an even number is obtained. What is the sample space for this experiment? Problem 8. You enter a special kind of chess tournament, in which you play one game with each of three opponents, but you get to choose the order in which you play your opponents, knowing the probability of a win against each. You win the tournament if you win two games in a row, and you want to maximize the probability of winning. Show that it is optimal to play the weakest opponent second, and that the order of playing the other two opponents does not matter. Problem 9. A partition of the sample space n is a collection of disjoint events 81 , ... ,8n such that n = U� 1 8i . (a) Show that for any event A, we have n P (A) = L P (A n 8i ) . i= l (b) Use part (a) to show that for any events A, B, and C, we have P (A) = P (A n B) + P(A n C) + P (A n BC n CC) - P(A n B n C) . Problem 10. Show the formula p( (A n BC) u (AC n B)) = P(A) + P(B) - 2P(A n B), Problems 55 which gives the probability that exactly one of the events A and B will occur. [Compare with the formula P(A U B) = P(A) + P(B) - P(A n B), which gives the probability that at least one of the events A and B will occur.] Problem 11.* Bonferroni's inequality. (a) Prove that for any two events A and B, we have P(A n B) � P(A) + P(B) - 1. (b) Generalize to the case of n events AI, A2 , . .. , An , by showing that P(AI n A2 n··· n An ) � P(AI ) + P(A2) + .. . + P(An ) - ( n - 1). Solution. We have P(A U B) = P(A) + P(B) - P(A n B) and P(A U B) :::; 1. which implies part (a) . For part (b) , we use De Morgan's law to obtain 1- P(AI n· ·· nAn) = P((A I n··· n An r) = P(A� U··· UA�) :::; P(A� ) + . . . + P(A� ) = (1- P(Ad) + .. . + (1 - P(An )) = n - P(AI) - ... - P(An ). Problem 12.* The inclusion-exclusion formula. Show the following generaliza­ tions of the formula P(A U B) = P(A) + P(B) - P(A n B). (a) Let A, B, and C be events. Then, P(AuBuC) = P(A)+P(B)+P(C) -p (AnB) -p(BnC)-p(AnC)+p(AnBnC). (b) Let Al, A2 , .. . ,An be events. Let 81 = {i ll :::; i :::; n}, 82 = {(il , i2) ll :::; il < i2 :::; n}, and more generally, let 8m be the set of all m-tuples (il, ... , im) of indices that satisfy 1 ::; il < i2 < .. . < im ::; n. Then. P (Uk=I Ak ) = L P(At ) - L P(Ai l n Ai2 ) Solution. (a) We use the formulas P(X U Y) = P(X) + P(Y) - P(X n Y) and (A UB)n C=(AnC)U(BnC). We have P(A U B U C) = P(A U B) + P(C) - P ((A U B) n C) = P(A U B) + P(C) - P((A n C) U (B n C)) = P(A U B) + P(C) - P(A n C) - P(B n C) + P(A n B n C) = P(A) + P(B) - P(A n B) + P(C) - P(A n C) - P(B n C) + P(A n B n C) = P(A) + P(B) + P(C) - P(A n B) - P(B n C) - P(A n C) + p(A n B nC). 56 Sample Space and Probability Chap. 1 (b) Use induction and verify the main induction step by emulating the derivation of part (a). For a different approach, see the problems at the end of Chapter 2. Problem 13.* Continuity property of probabilities. (a) Let A I , A2 , ... be an infinite sequence of events, which is \"monotonically increas­ ing,\" meaning that An C An+l for every n. Let A = U;:='=IAn . Show that P(A) = limn_oo P(An). Hint: Express the event A as a union of countably many disjoint sets. (b) Suppose now that the events are \"monotonically decreasing,\" i.e. , An+l C An for every n. Let A = n�= I An . Show that P(A) = limn_oo P(An ). Hint: Apply the result of part (a) to the complements of the events. (c) Consider a probabilistic model whose sample space is the real line. Show that p([O, (0)) = lim P ([O, nj), n -oc and lim P ([n, (0)) = 0. n-oo Solu tion. (a) Let BI = Al and, for n 2: 2, Bn = An n A�- l ' The events Bn are disjoint, and we have Uk=I Bk = An, and Uk= I Bk = A. We apply the additivity axiom to obtain 00 n P(A) = � P(Bk ) = lim � P(Bk) = lim P(Uk=I Bk ) = lim P(An ). L n-oc L n-oo n-oo k=l k= l (b) Let Cn = A� and C = AC . Since An+l C An , we obtain Cn C Cn+l , and the events Cn are increasing. Furthermore, C = AC = (n�= I An)C = U�=lA� = U�=lCn . Using the result from part (a) for the sequence Cn, we obtain 1 - P(A) = P(AC ) = P(C) = lim P(Cn ) = lim (1 - P(An)) , n-x n-oo from which we conclude that P(A) = limn_x P(An ). (c) For the first equality, use the result from part (a) with An = [O, n] and A = [0, (0). For the second, use the result from part (b) with An = [n, (0) and A = n� I An = 0. SECTION 1.3. Conditional Probability Problem 14. We roll two fair 6-sided dice. Each one of the 36 possible outcomes is assumed to be equally likely. (a) Find the probability that doubles are rolled. (b) Given that the roll results in a sum of 4 or less, find the conditional probability that doubles are rolled. (c) Find the probability that at least one die roll is a 6. (d) Given that the two dice land on different numbers, find the conditional probability that at least one die roll is a 6. Problem 15. A coin is tossed twice. Alice claims that the event of two heads is at least as likely if we know that the first toss is a head than if we know that at least one Problems 57 of the tosses is a head. Is she right? Does it make a difference if the coin is fair or unfair? How can we generalize Alice's reasoning? Problem 16. We are given three coins: one has heads in both faces, the second has tails in both faces, and the third has a head in one face and a tail in the other. We choose a coin at random, toss it, and the result is heads. What is the probability that the opposite face is tails? Problem 17. A batch of one hundred items is inspected by testing four randomly selected items. If one of the four is defective, the batch is rejected. What is the probability that the batch is accepted if it contains five defectives? Problem 18. Let A and B be events. Show that P(A n B I B) = P (A I B), assuming that P(B) > O. SECTION 1.4. Total Probability Theorem and Bayes' Rule Problem 19. Alice searches for her term paper in her filing cabinet. which has several drawers. She knows that she left her term paper in drawer j with probability Pi > O. The drawers are so messy that even if she correctly guesses that the term paper is in drawer i. the probability that she finds it is only di . Alice searches in a particular drawer. say drawer i. but the search is unsuccessful. Conditioned on this event, show that the probability that her paper is in drawer j, is given by Pi Pi(l - di) if j ¥= i. 1 - p, di . if j = i. Problem 20. How an inferior player with a superior strategy can gain an advantage. Borb b about to play a two-game che:s:s match with an opponent, and wants to find the strategy that maximizes his winning chances. Each game ends with either a win by one of the players, or a draw. If the score is tied at the end of the two games, the match goes into sudden-death mode, and the players continue to play until the first time one of them wins a game (and the match). Boris has two playing styles. timid and bold, and he can choose one of the two at will in each game. no matter what style he chose in previous games. With timid play. he draws with probability Pd > 0, and he loses with probability 1 - Pd . With bold play. he wins with probability pw , and he loses with probability 1 - pw ' Boris will always play bold during sudden death, but may switch style between games 1 and 2. (a) Find the probability that Boris wins the match for each of the following strategies: (i) Play bold in both games 1 and 2. (ii) Play timid in both games 1 and 2. (iii) Play timid whenever he is ahead in the score. and play bold otherwise. (b) Assume that pw < 1/2, so Boris is the worse player, regardless of the playing style he adopts. Show that with the strategy in (iii) above. and depending on the values of pw and Pd. Boris may have a better than a 50-50 chance to win the match. How do you explain this advantage? Problem 21. Two players take turns removing a ball from a jar that initially contains m white and n black balls. The first player to remove a white ball wins. Develop a 58 Sample Space and Probability Chap. 1 recursive formula that allows the convenient computation of the probability that the starting player wins. Problem 22. Each of k jars contains m white and n black balls. A ball is randomly chosen from jar 1 and transferred to jar 2, then a ball is randomly chosen from jar 2 and transferred to jar 3, etc. Finally, a ball is randomly chosen from jar k. Show that the probability that the last ball is white is the same as the probability that the first ball is white, i.e. , it is m/( m + n) . Problem 23. We have two jars, each initially containing an equal number of balls. We perform four successive ball exchanges. In each exchange, we pick simultaneously and at random a ball from each jar and move it to the other jar. What is the probability that at the end of the four exchanges all the balls will be in the jar where they started? Problem 24. The prisoner's dilemma. The release of two out of three prisoners has been announced. but their identity is kept secret. One of the prisoners considers asking a friendly guard to tell him who is the prisoner other than himself that will be released, but hesitates based on the following rationale: at the prisoner's present state of knowledge, the probability of being released is 2/3, but after he knows the answer, the probability of being released will become 1/2, since there will be two prisoners (including himself) whose fate is unknown and exactly one of the two will be released. What is wrong with this line of reasoning? Problem 25. A two-envelopes puzzle. You are handed two envelopes. and you know that each contains a positive integer dollar amount and that the two amounts are different. The values of these two amounts are modeled as constants that are unknown. Without knowing what the amounts are, you select at random one of the two envelopes, and after looking at the amount inside, you may switch envelopes if you wish. A friend claims that the following strategy will increase above 1/2 your probability of ending up with the envelope with the larger amount: toss a coin repeatedly. let X be equal to 1/2 plus the number of tosses required to obtain heads for the first time, and switch if the amount in the envelope you selected is less than the value of X . Is your friend correct? Problem 26. The paradox of induction. Consider a statement whose truth is unknown. If we see many examples that are compatible with it, we are tempted to view the statement as more probable. Such reasoning is often referred to as induc­ tive inference (in a philosophical, rather than mathematical sense). Consider now the statement that \"all cows are white.\" An equivalent statement is that \"everything that is not white is not a cow.\" We then observe several black crows. Our observations are clearly compatible with the statement. but do they make the hypothesis \"all cows are white\" more likely? To analyze such a situation, we consider a probabilistic model. Let us assume that there are two possible states of the world, which we model as complementary events: A : all cows are white, AC : 50% of all cows are white. Let p be the prior probability P(A) that all cows are white. We make an observation of a cow or a crow, with probability q and 1 - q, respectively, independent of whether Problems 59 event A occurs or not . Assume that 0 < p < 1, 0 < q < 1, and that all crows are black. (a) Given the event B = {a black crow was observed} , what is peA I B)? (b) Given the event C = { a white cow was observed} , what is peA I C)? Problem 27. Alice and Bob have 2n + 1 coins, each coin with probability of heads equal to 1/2. Bob tosses n+ 1 coins, while Alice tosses the remaining n coins. Assuming independent coin tosses , show that the probability that after all coins have been tossed , Bob will have gotten more heads than Alice is 1/2. Problem 28. * Conditional version of the total probability theorem. Let Cl , ••. , Cn be disjoint events that form a partition of the state space. Let also A and B be events such that PCB n Ci ) > 0 for all i. Show that P(A IB) = I:P (Cd B)p(A IBnCI). i=l Solution. We have n p(A nB ) = LP ( An B) nCi ) , i=l and by using the multiplication rule, Combining these two equations, dividing by PCB), and using the formula peA I B) = peA n B)/P(B), we obtain the desired result . Problem 29. * Let A and B be events with peA) > 0 and PCB) > O. We say that an event B suggests an event A if peA I B) > peA), and does not suggest event A if peA I B) < peA) . (a) Show that B suggests A if and only if A suggests B. (b) Assume that P(BC) > O. Show that B suggests A if and only if BC does not suggest A. (c) We know that a treasure is located in one of two places, with probabilities f3 and 1 - f3, respectively, where 0 < f3 < 1. We search the first place and if the treasure is there, we find it with probability p > O. Show that the event of not finding the treasure in the first place suggests that the treasure is in the second place. Solu tion. (a) We have peA I B) = peA n B)/P(B), so B suggests A if and only if peA n B) > P(A)P(B), which is equivalent to A suggesting B, by symmetry. (b) Since PCB) + P(BC) = 1, we have P(B)P(A) + P( BC )P(A) = peA) = P(B)P(A I B) + P(BC)P(A I BC), which implies that P(BC)(P(A) - peA I Be») = P( B) (P(A I B) - peA») . P(A I suggest A). A Using the > P(A) (8 B events A = treasure is B = {we treasure in probabi l ity Probability if P ( A ) > P(B) = (AC)P(B I + (B I A) = t1( 1 - + (1 - ,6) ! so = _( A _ n _ B -,- ) = ___ 1_-___ = _1_-____ > 1 _ {3 = P( B) .8( 1 - + (1 -/3 ) 1- .8p . It event 1 1 not (A). Problem A hu nter has two hu nting dogs . One day, on the trail of some animal , diverges into two paths. He that p. hunter dog a path, if they disagree , to randomly pick a path. the two decide on a path? a no isy A sou rce a message (a str ing of symbols) through a noisy communication channel. Each symbol is o or 1 with probabi lity p 1 - p, is recei ved incorrectly prob- £0 (I ! are indep endent . (a) (b) (c) o 1 - 1. 18: Error probabi lities in a the the in o 1 communication channeL is (d ) 1.1 9: A ,,\",\" ::\"'<\".CIlI A power utility can i with is ... .0 ... '.0 \".,.0 ... as a 0 a can or the movies ) is the sub- tha t starts at 62 Sample Space and Probability Chap. 1 (a) Suppose that any one plant can produce enough electricity to supply the entire city. What is the probability that the city will experience a black-out? (b) Suppose that two power plants are necessary to keep the city from a black-out. Find the probability that the city will experience a black-out. Problem 37. A cellular phone system services a population of n l \"voice users\" (those who occasionally need a voice connection) and n2 \"data users\" (those who occasionally need a data connection). We estimate that at a given time, each user will need to be connected to the system with probability PI (for voice users) or P2 (for data users) , independent of other users. The data rate for a voice user is rl bits/sec and for a data user is r2 bits/sec. The cellular system has a total capacity of c bits/sec. What is the probability that more users want to use the system than the system can accommodate? Problem 38. The problem of points. Telis and Wendy play a round of golf (18 holes) for a $10 stake, and their probabilities of winning on any one hole are P and 1 - p, respectively, independent of their results in other holes. At the end of 10 holes, with the score 4 to 6 in favor of Wendy, Telis receives an urgent call and has to report back to work. They decide to split the stake in proportion to their probabilities of winning had they completed the round, as follows. If PT and pw are the conditional probabilities that Telis and Wendy, respectively, are ahead in the score after 18 holes given the 4-6 score after 10 holes, then Telis should get a fraction PT / (PT + pw ) of the stake, and Wendy should get the remaining pw /(PT + pw ). How much money should Telis get? Note: This is an example of the, so-called, problem of points, which played an important historical role in the development of probability theory. The problem was posed by Chevalier de Mere in the 17th century to Pascal, who introduced the idea that the stake of an interrupted game should be divided in proportion to the players' conditional probabilities of winning given the state of the game at the time of interruption. Pascal worked out some special cases and through a correspondence with Fermat , stimulated much thinking and several probability-related investigations. Problem 39. A particular class has had a history of low attendance. The annoyed professor decides that she will not lecture unless at least k of the n students enrolled in the class are present. Each student will independently show up with probability Pg if the weather is good, and with probability Pb if the weather is bad. Given the probability of bad weather on a given day, obtain an expression for the probability that the professor will teach her class on that day. Problem 40. Consider a coin that comes up heads with probability P and tails with probability 1 - p. Let qn be the probability that after n independent tosses, there have been an even number of heads. Derive a recursion that relates qn to qn -I, and solve this recursion to establish the formula qn = ( 1 + (1 - 2Pt) /2. Problem 41. Consider a game show with an infinite pool of contestants, where at each round i, contestant i obtains a number by spinning a continuously calibrated wheel. The contestant with the smallest number thus far survives. Successive wheel spins are independent and we assume that there are no ties. Let N be the round at which contestant 1 is eliminated. For any positive integer n, find peN = n) . Problems 63 Problem 42. * Gambler's ruin. A gambler makes a sequence of independent bets. In each bet, he wins $1 with probability p, and loses $1 with probability 1- p. Initially, the gambler has $k, and plays until he either accumulates $n or has no money left. What is the probability that the gambler will end up with $n? Solution. Let us denote by A the event that he ends up with $n, and by F the event that he wins the first bet. Denote also by Wk the probability of event A, if he starts with $k. We apply the total probability theorem to obtain Wk = P(A I F)P(F) + P(A I FC)P(FC) = pP(A I F) + qP(A I FC ). 0< k < n, where q = 1 - p. By the independence of past and future bets, having won the first bet is the same as if he were just starting now but with $(k+ l), so that P(A I F) = Wk+l and similarly P(A I FC) = Wk -l . Thus, we have Wk = PWk+l +qwk- l, which can be written as 0< k < n, where r = q/p. We will solve for Wk in terms of p and q using iteration, and the boundary values Wo = 0 and Wn = 1. We have Wk+ l - Wk = rk (wl - wo ), and since Wo = 0, k k-l k k Wk+ l = Wk + r WI = Wk -l + r WI + r WI = WI + rWI + . .. + r WI . The sum in the right-hand side can be calculated separately for the two cases where r = 1 (or p = q) and r =J. 1 (or p =J. q). We have if p =J. q. if p = q. Since Wn = 1, we can solve for WI and therefore for Wk : r -r if p =J. q, 1- rn ' WI = 1 if p = q, - . n so that c-rk • if p =J. q, 1 - rn Wk = k if p = q. - , n Problem 43.* Let A and B be independent events. Use the definition of indepen­ dence to prove the following: (a) The events A and Be are independent. (b) The events AC and BC are independent. Solution. (a) The event A is the union of the disjoint events An BC and An B. Using the additivity axiom and the independence of A and B, we obtain P(A) = P(A n B) + P(A nBC) = P(A)P(B) + P(A nBC). 64 Sample Space and Probability Chap. 1 It follows that P(A n Be) = P(A) (1 - P(B)) = P(A)P(BC) . so A and BC are independent. (b) Apply the result of part (a) twice: first on A and B. then on BC and A. Problem 44. * Let A. B. and C be independent events, with P( C) > O. Prove that A and B are conditionally independent given G. Solution. We have P(A BIG) = P(AnBnG) n P(G) P(A)P(B)P(G) P(G) = P(A)P (B) = P(A I G)P(B I G), so A and B are conditionally independent given G. In the preceding calculation, the first equality uses the definition of conditional probabilities; the second uses the as­ sumed independence; the fourth uses the independence of A from G, and of B from G. Problem 45. * Assume that the events AI , A2 , A3 , A4 are independent and that P(A3 n A4 ) > O. Show that Solution. We have We similarly obtain P(A2 1 A3 n A4 ) = P(A2) and P(A 1 n A2 1 A3 n A4) = P(A 1 n A2 ), and finally, P(AI U A2 1 A3 n A4) = P(A 1 I A3 n A4) + P(A2 1 A3 n A4 ) - P(AI n A2 1 A3 n A4) = P(At) + P(A2) - P(A1 n A2 ) = P(A1 U A2 ). Problem 46.* Laplace's rule of succession. Consider m + 1 boxes with the kth box containing k red balls and m - k white balls, where k ranges from 0 to m. We choose a box at random (all boxes are equally likely) and then choose a ball at random from that box, n successive times (the ball drawn is replaced each time, and a new ball is selected independently). Suppose a red ball was drawn each of the n times. What is the probability that if we draw a ball one more time it will be red? Estimate this probability for large m. Solution. We want to find the conditional probability P(E I Rn ), where E is the event of a red ball drawn at time n + 1, and Rn is the event of a red ball drawn each of the n preceding times. Intuitively, the consistent draw of a red ball indicates that a box with Problems 65 a high percentage of red balls was chosen, so we expect that P(E I Rn) is closer to I than to O. In fact, Laplace used this example to calculate the probability that the sun will rise tomorrow given that it has risen for the preceding 5,000 years. (It is not clear how serious Laplace was about this calculation, but the story is part of the folklore of probability theory. ) We have P(E I R ) = p(EnRn) n P(Rn)' and by using the total probability theorem, we obtain P(Rn) = t p(kth box chosen) (!) n = m � I t (!) n , k=O k=O I m ( k)1l+1 P(E n Rn) = P( R71 + d = m + I L m k=O For large m, we can view P(Rn) as a piecewise constant approximation to an integral: I m ( k ) n I 1m I mn+1 I P( Rn) = m + I L m :::::: (m + I )mn 0 xn dx = (m + I )mn . n + I :::::: n + I . k=O Similarly, so that I P(E n Rn) = P(Rn+ d :::::: n + 2' P (E I R71) :::::: n + I . n+2 Thus, for large m, drawing a red ball one more time is almost certain when n is large. Problem 47. * Binomial coefficient formula and the Pascal triangle. (a) Use the definition of G) as the number of distinct n-toss sequences with k heads, to derive the recursion suggested by the so called Pascal triangle, given in Fig. 1.20. (b) Use the recursion derived in part (a) and induction, to establish the formula (n) n! k - k! (n - k)! ' Solution. (a) Note that n-toss sequences that contain k heads (for a < k < n) can be obtained in two ways: (1) By starting with an (n - I)-toss sequence that contains k heads and adding a tail at the end. There are (nk1) different sequences of this type. (2) By starting with an (n - I)-toss sequence that contains k - 1 heads and adding a head at the end. There are G=�) different sequences of this type. (0 ) 1 ) () () (�) (2 ) ) () () () (� ) () () (�) (�� ) 1. 20: .... ... .... \"' ... 'nf- Each term (�) in the 2 3 3 binomial co��m4C le:m:.s 1 and in the array on the its two in the row above it (except for the boundary terms with k = 0 or k = n, wh ich are equal to 1). if k = 1, ... j n - 1. if k = n. This is formula correspond ing to the Pascal triangle calculation , gi ven in (b) now use (a) � to (�) = k! (n-k )! ' 1 by on n. we the (�) = (i) = 1, so n = 1 1 above formula is seen to hold as long as we use the convention O! = 1. If the formula holds for each index up to n - 1 \\ we have for k = 1, 2 , . . . ,n - 1 j (n) (n - 1) (n - 1) k k- l + k = ---------------�--�------- (k - k n - k n! = - . + -- . ------- n k! ( n-k)! 11, k! (n - k)! k! (n - k)! ' and the induction is complete. 48 .* Consider an infinite sequence of trials. The probability of success at ith trial is some positive number Pi. N be the Problems 67 event that there is no success, and let I be the event that there is an infinite number of successes. (a) Assume that the trials are independent and that 2:::':1 PI = 00. Show that P(N) = 0 and P(I) = 1. (b) Assume that 2:::1 PI < 00. Show that P(I) = O. Solution. (a) The event N is a subset of the event that there were no successes in the first n trials, so that n P(N) :::; II (1 - pd· i=1 Taking logarithms, n n i=1 i=1 Taking the limit as n tends to infinity, we obtain log P(N) = -00. or P(N) = O. Let now Ln be the event that there is a finite number of successes and that the last success occurs at the nth trial. We use the already established result P(N) = 0, and apply it to the sequence of trials after trial n, to obtain P(Ln) = O. The event Ie (finite number of successes) is the union of the disjoint events Ln, n 2: 1. and N, so that = P(IC) = P(N) + L P(Ln) = 0, n=1 and P(I) = 1. (b) Let Si be the event that the ith trial is a success. Fix some number n and for every i > n, let Pi be the event that the first success after time n occurs at time i. Note that Pi C Si. Finally, let An be the event that there is at least one success after time n. Note that I C An , because an infinite number of successes implies that there are successes subsequent to time n. Furthermore, the event An is the union of the disjoint events Pi , i > n. Therefore, P(I) :s P(An) = P (�Q, Fi) - i� ' P(F;) :s i�' P(Si) = ,�, Pi· We take the limit of both sides as n ---+ 00. Because of the assumption 2:::1 Pt < 00, the right-hand side converges to zero. This implies that P(I) = O. SECTION 1.6. Counting Problem 49. De Mere's puzzle. A six-sided die is rolled three times independently. Which is more likely: a sum of 11 or a sum of 12? (This question was posed by the French nobleman de Mere to his friend Pascal in the 17th century.) Problem 50. The birthday problem. Consider n people who are attending a party. We assume that every person has an equal probability of being born on any day 68 Sample Space and Probability Chap. 1 during the year. independent of everyone else, and ignore the additional complication presented by leap years (i.e. , assume that nobody is born on February 29) . What is the probability that each person has a distinct birthday? Problem 51. An urn contains m red and n white balls. (a) We draw two balls randomly and simultaneously. Describe the sample space and calculate the probability that the selected balls are of different color, by using two approaches: a counting approach based on the discrete uniform law, and a sequential approach based on the multiplication rule. (b) We roll a fair 3-sided die whose faces are labeled 1,2,3, and if k comes up. we remove k balls from the urn at random and put them aside. Describe the sample space and calculate the probability that all of the balls drawn are red. using a divide-and-conquer approach and the total probability theorem. Problem 52. We deal from a well-shuffled 52-card deck. Calculate the probability that the 13th card is the first king to be dealt. Problem 53. Ninety students, including Joe and Jane, are to be split into three classes of equal size, and this is to be done at random. What is the probability that Joe and Jane end up in the same class? Problem 54. Twenty distinct cars park in the same parking lot every day. Ten of these cars are US-made. while the other ten are foreign-made. The parking lot has exactly twenty spaces. all in a row. so the cars park side by side. However. the drivers have varying schedules. so the position any car might take on a certain day is random. (a) In how many different ways can the cars line up? (b) What is the probability that on a given day, the cars will park in such a way that they alternate (no two US-made are adjacent and no two foreign-made are adjacent)? Problem 55. Eight rooks are placed in distinct squares of an 8 x 8 chessboard, with all possible placements being equally likely. Find the probability that all the rooks are safe from one another, i.e .. that there is no row or column with more than one rook. Problem 56. An academic department offers 8 lower level courses: {L1 , L2 , .... Ls } and 10 higher level courses: {H 1. H 2 •..•• H 10 }. A valid curriculum consists of 4 lower level courses. and 3 higher level courses. (a) How many different curricula are possible? (b) Suppose that {H1 .... , H5 } have L1 as a prerequisite, and {H6, '\" HlO } have L2 and L3 as prerequisites. i.e .. any curricula which involve, say, one of {H 1, ... , H5 } mllst also include L1 . How many different curricula are there? Problem 57. How many 6-word sentences can be made using each of the 26 letters of the alphabet exactly once? A word is defined as a nonempty (possibly jibberish) sequence of letters. Problems 69 Problem 58. We draw the top 7 cards from a well-shuffled standard 52-card deck. Find the probability that: (a) The 7 cards include exactly 3 aces. (b) The 7 cards include exactly 2 kings. (c) The probability that the 7 cards include exactly 3 aces. or exactly 2 kings, or both. Problem 59. A parking lot contains 100 cars, k of which happen to be lemons. We select m of these cars at random and take them for a test drive. Find the probability that n of the cars tested turn out to be lemons. Problem 60. A well-shuffled 52-card deck is dealt to 4 players. Find the probability that each of the players gets an ace. Problem 61. * Hypergeometric probabilities. An urn contains n balls, out of which m are red. We select k of the balls at random. without replacement (Le., selected balls are not put back into the urn before the next selection). What is the probability that i of the selected balls are red? Solution. The sample space consists of the (�) different ways that we can select k out of the available balls. For the event of interest to occur. we have to select i out of the m red balls, which can be done in (7) ways, and also select k - i out of the n - m balls that are not red, which can be done in (nk�7) ways. Therefore, the desired probability IS for i � 0 satisfying i � m, i � k, and k - i � n - m. For all other i, the probability is zero. Problem 62. * Correcting the number of permutations for indistinguishable objects. When permuting n objects, some of which are indistinguishable, different permutations may lead to indistinguishable object sequences, so the number of distin­ guishable object sequences is less than nL For example, there are six permutations of the letters A, B, and C: ABC. ACB, BAC, BCA, CAB, CBA, but only three distinguishable sequences that can be formed using the letters A, D, and D: ADD, DAD. DDA. (a) Suppose that k out of the n objects are indistinguishable. Show that the number of distinguishable object sequences is n! / kL (b) Suppose that we have r types of indistinguishable objects, and for each i, ki objects of type i. Show that the number of distinguishable object sequences is n! 70 Sample Space and Probability Chap. 1 Solution. (a) Each one of the n! permutations corresponds to k! duplicates which are obtained by permuting the k indistinguishable objects. Thus, the n! permutations can be grouped into n! /k! groups of k! indistinguishable permutations that result in the same object sequence. Therefore, the number of distinguishable object sequences is n!/kL For example, the three letters A, D, and D give the 3! = 6 permutations ADD, ADD, DAD, DDA, DAD, DDA, obtained by replacing B and C by D in the permutations of A, B, and C given earlier. However, these 6 permutations can be divided into the n!/k! = 3!/2! = 3 groups {ADD, ADD}, {DAD, DAD}, {DDA, DDA}, each having k! = 2! = 2 indistinguishable permutations. (b) One solution is to extend the argument in (a) above: for each object type i, there are ki ! indistinguishable permutations of the ki objects. Hence, each permutation belongs to a group of kd k2 ! . .. kr ! indistinguishable permutations, all of which yield the same object sequence. An alternative argument goes as follows. Choosing a distinguishable object se­ quence is the same as starting with n slots and for each i, choosing the ki slots to be occupied by objects of type i. This is the same as partitioning the set {I, ... ,n} into groups of size kl ' . .. , kr , and the number of such partitions is given by the multinomial coefficient. 2 Discre te Random Variables Contents 2. 1. Basic Concepts . . . . . . . 2.2. Probability Mass Functions 2.3. Functions of Random Variables 2.4. Expectation, Mean, and Variance 2.5. Joint PMFs of Multiple Random Variables 2.6. Conditioning . . . . . . 2.7. Independence . . . . . . 2.8. Summary and Discussion Problems ... .... . p. 72 p. 74 p. 80 p.81 p. 92 p. 97 . p. 109 . . p. 115 . p. 119 71 1 nlany probabilist ic outcomes are inst runlent read ings or stock prices . are not . but 2 corre- IS st froIn a given populat ion. we m ay wish to consi der their grade poi nt average . When 'LA'U ...... AA ... '.J>O.. it is useful to ........., '-'� ........ JL is done through the not ion of a variable , the focus of the present an and the possible ( the salnpie space ) 1 a randoIn variable associates a part i c ular nunlber with each out- conle : see Fig. 1. \\iVe to this as the Ju.OU' ...... JI'I:;> ... the t l\\Iathelnatically� a 2.1: Visualizat ion of a random variable . It is a fu nct ion that ��\" o\"'� a numer ical value to each poss ible o u tco me of the experi ment . (b) An of a random variahle. The consists of two rolls of a 4-sided the random va riable is the maximum of the two rolls. If t he outcome of the is (4. 2) . is 4. are sonle of variables : (a) an invol ving a sequence of 5 tosses heads t he sequence is a randon) a t he nunlber of t he Sec. 2. 1 Basic Concepts 73 of heads and tails is not considered a random variable because it does not have an explicit numerical value. (b) In an experiment involving two rolls of a die. the following are examples of random variables: (i) The sum of the two rolls. (ii) The number of sixes in the two rolls. (iii) The second roll raised to the fifth power. (c) In an experiment involving the transmission of a message, the time needed to transmit the message. the number of symbols received in error. and the delay with which the message is received are all random variables. There are several basic concepts associated with random variables. which are summarized below. These concepts will be discussed in detail in the present chapter. Main Concepts Related to Random Variables Starting with a probabilistic model of an experiment : • A random variable is a real-valued function of the outcome of the experiment. • A function of a random variable defines another random variable. • We can associate with each random variable certain ';averages\" of in­ terest, such as the mean and the variance. • A random variable can be conditioned on an event or on another random variable. • There is a notion of independence of a random variable from an event or from another random variable. A random variable is called discrete if its range (the set of values that it can take) is either finite or count ably infinite. For example. the random variables mentioned in (a) and (b) above can take at most a finite number of numerical values, and are therefore discrete. A random variable that can take an uncountably infinite number of values is not discrete. For an example. consider the experiment of choosing a point a from the interval [- 1. 1] . The random variable that associates the numerical value a2 to the outcome a is not discrete. On the other hand. the random variable that associates with a the numerical value { I. if a > O. sgn(a) = O. if a = O� -1. if a < O. 74 Discrete Random Variables Chap. 2 is discrete. In thi� chapter. we focus exclusively on discrete random variables, even though ''''e will typically omit the qualifier '-discrete.\" Concepts Related to Discrete Random Variables Starting with a probabilistic model of an experiment: • A discrete random variable is a real-valued function of the outcome of the experiment that can take a finite or count ably infinite number of values. • A discrete random variable has an associated probability mass func­ tion (PMF) l which gives the probability of each numerical value that the random variable can take. • A function of a discrete random variable defines another discrete random variable, whose PlVIF can be obtained from the PMF of the original random variable. We will discuss each of the above concepts and the associated methodology in the following sections. In addition. we will provide examples of some important and frequently encountered random variables. In Chapter 3, we will discuss general (not necessarily discrete) random variables. Even though this chapter may appear to be covering a lot of new ground, this is not really the case. The general line of development is to simply take the concepts from Chapter 1 (probabilities, conditioning, independence, etc.) and apply them to random variables rather than events, together with some convenient new notation. The only genuinely new concepts relate to means and variances. 2.2 PROBABILITY MASS FUNCTIONS The most important way to characterize a random variable is through the prob­ abilities of the values that it can take. For a discrete random variable X, these are captured by the probability mass function (PMF for short) of X, denoted px . In particular. if x is allY possible value of X. the probability mass of x. denoted px (x) . is the probability of the event {X = x} consisting of all outcomes that give rise to a value of X equal to x: px (r) = P({X x}) . For example. let the experiment consist of two independent tosses of a fair coin, and let X be the number of heads obtained. Then the PMF of X is Sec. 2.2 Probability Mass Functions { 1/4, px ( x) = 1/2, 0, if x = 0 or x = 2, if x = 1, otherwise. 75 In what follows, we will often omit the braces from the event/set notation when no ambiguity can arise. In particular, we will usually write P(X = x) in place of the more correct notation P ({ X = x}) , and we will write P (X E S) for the probability that X takes a value within a set S. We will also adhere to the following convention throughout: we will use upper case characters to denote random variables, and lower case characters to denote real numbers such as the numerical values of a random variable. Note that x where in the summation above, x ranges over all the possible numerical values of X. This follows from the additivity and normalization axioms: as x ranges over all possible values of X, the events {X = x} are disjoint and form a partition of the sample space. By a similar argument, for any set S of possible values of X, we have P(X E S) = L px(x). xES For example, if X is the number of heads obtained in two independent tosses of a fair coin, as above, the probability of at least one head is 2 1 1 3 P(X > 0) = LPx(x) = 2 + 4 = 4· x=l Calculating the PMF of X is conceptually straightforward, and is illus­ trated in Fig. 2.2. Calculation of the PMF of a Random Variable X For each possible value x of X: 1. Collect all the possible outcomes that give rise to the event {X = x}. 2. Add their probabilities to obtain px(x). The Bernoulli Random Variable Consider the toss of a coin, which comes up a head with probability p, and a tail with probability 1 - p. The Bernoulli random variable takes the two values 1 5 16 3 3 4 .r 2.2: Illustration of the method to calculate the PMF of a random variable X. For each the ou tcomes that rise to X = x and add th eir to obtain P x Calcu lat ion of the P!'dF Px of the random variab le X maximum rol l i n two rolls of a fair 4-sided die . There are four values X, 1, 2. 3, 4. To c alcu late p x x I we add the of the outcomes that \"' '''' 'ClUJ' I-''''' ' there are three outcomes that rise to x = 2 ... _ .... _. T . 2) . 1) . Each of these outcomes has 1 so P X as indicated in the - r· IS L- as: if a if a or a if k = 1. if k 2 2.2 a .. n k 2.3: The P�lF of a binomial ran dom variable . If p = 1/2 , the PI\\lF is around n/2. the Pi\\IF is skewed towards 0 if P < 1/2 . and 77 towards n if p > 1/2. (a) state a te lephone at a gi ven ti nle that can be her or busy . (b) A perso n who can be eit her healt hy or sick wi th a certain disease . (c) The preference of a person who can be ei ther for or against a litical .......... 'u. ...... ...... variables, one can con - as the bi nonli al variable, A coin is tossed n tinles . the coin conles up a head with probability p, and a tail of Let X be the of heads in consists of the bi nonlial = k) = (nk) k = 0, 1, .. . � n. (Note that we sinlpli fy notation use X, to denote the values of integer-valued random variables.) The nornlalization property, is as cases of binonlial are Fig. 2.3. we and toss a coin with probabil i ty a head equal to p, where 0 < p < 1. The . .-................. random variable is the p .. . o 12 3 k 2.4: The geo,metnc random variab le. It decreases as a geome'tnc .... .. r\\<rT'&>.<:\"'.rn .. with dHllt: I..t::1 1 - p. number by (1 - p) k - 1 P is tails followed a 00 L (k) = k= l px (k) = (1 - p)k- 00 (1 - = p k= l to come up for 00 k=O k = 1, ••• j 1 I- p)k =P \" l _ I - p) = 1. IS example, it could mean passing a test in a given finding a missing given A Poisson random variable has a PNIF by In a px(k) = Ak k = 0 ,1 ,2, ... , 2 IS the see 2.5. This is a = 1. 2.2 I .. o 2 :3 7 k 2.5: The Pf\\lF e-A).k jk! o f a Poisson rando m variahle for different values of ).. Note th at if ). < 1. then the P!\\IF is with k, while if A > 1. t he PlvI F first increases and then decreases ( th is is shown in the end-of­ chapter problems) . a feel for t he ........ r>.1 ccor.n a binoInial randon1 lp a and associate nlisspelled nlany exanlples , city on a given day. r the nunlber the �Iore precisely. the Poi sson PlvI F A a good approxinlat ion for a binomia1 P1\\IF with n a.nd l.e .. )..k e- A -- � -------- ( 1 - p)\" - J.. . . k = 0. 1. , ... n. = np . n is very P IS sinall. In t case. the nlay res ult in sinlpler .......... ''-.. ''-- ...... p = 0. 01 . Then the For ex amp le. let k = 5 Sllccesses n = 100 trials is usi ng binonlial 100! 95 ' 5! . 0.0 15( 1 - 0.0 1 = 0. 00290. Using Poisson Pl\\:I F with ).. == np == 100 · 0. 01 == 1. t h is probability is approximated by 1 e- l - = 0. 00306 . We provide a fonn al justi fication of the approx i lnation T\"\\r\"'\"\\ T\"1 £� r r, In the end-of-chapter prob1 enls and Chapter 6. we t use it of the Poisson random variables occurred in the the Poisson P�'IF to the number of horse kick accidents in period of several years. by matching Polish cavalry over a 80 Discrete Random Variables Chap. 2 2.3 FUNCTIONS OF RANDOM VARIABLES Given a random variable X, one may generate other random variables by ap­ plying various transformations on X. As an example, let the random variable X be today's temperature in degrees Celsius, and consider the transformation Y = 1.8X + 32. which gives the temperature in degrees Fahrenheit . In this example, Y is a linear function of X, of the form Y = g( X) = aX + b, where a and b are scalars. We may also consider nonlinear functions of the general form Y = g(X ). For example. if we wish to display temperatures on a logarithmic scale, we would want to use the function g( X) = log X. If Y = g(X) is a function of a random variable X, then Y is also a random variable, since it provides a numerical value for each possible outcome. This is because every outcome in the sample space defines a numerical value x for X and hence also the numerical value y = g( x) for Y. If X is discrete with PMF PX. then Y is also discrete, and its PMF py can be calculated using the PMF of X. In particular, to ohtain py(y) for any y, we add the prohahilities of all values of x such that g(x) = y: py(y) = pX(x). {x l g(x)=y} Example 2.1. Let Y = IXI and let us apply the preceding formula for the PMF py to the case where () { 1/9. if x is an integer in the range [-4, 4]. p x x = . O. otherwise: see Fig. 2.6 for an illustration. The possible values of Y are y = O. 1. 2.3.4. To compute py (y) for some given value y from this range. we must add px (x) over all values x such that Ixl = y. In particular. there is only one value of X that corresponds to y = O. namely x = O. Thus. 1 py (O) = px (O) = 9 ' Also. there are two values of X that correspond to each y = 1. 2. 3. 4. so for example, Thus, the PMF of Y is 2 Py ( 1) = p x ( -1) + p x ( 1) = 9' { 2/9. if y = 1. 2, 3, 4, py (y) = 1/9. if y = O. O. otherwise. Y= IXI -4 - .] y Figure 2.6: The P�IFs of X and Y = IXI in Example 2. 1. another related exanlple . let Z = X2 . To obtain the P�1F of we it as the sq uare the or as square of Y = I I . = L {x I (x) or the formula pz( z) = {Y I = z} py (y) . we obtain The pz (z) = 1 if z = o. { 2/9. if z = 1.4 .9 . 16. of a randol n var iable of al l O. ot herw ise. prov ide� u� ,vith �everal ntllubert). X. It is . to pro ba- IHllnber. is by the (in propo rtio n to probabilities) average mot ivat ion . suppose yon a of lllany ............ ...,...,. spin . one nurnbers Tn l. m'2 .. .. . 11 1n cornes up w'ith correspond ing proba- . P2 , . . . . that \\Vhat is the amount to and are a Suppo:se t hat you �pi n t that the outcolne is mj. the total alllo unt received is m 1 k l + arnount spin is If the nUlnber of spins k is bilit ies as frequenc ies. it is �'r.��,:'I\"'\\.�\" if we are will ing to proba- ta ant iripat e 1111 (\"OI1leS up a 82 Discrete Random Variables fraction of times that is roughly equal to Pi: ki \"\" P' k \"\" t, i = 1, ... ,no Thus, the amount of money per spin that you \"expect\" to receive is Motivated by this example, we introduce the following definition. t Expectation Chap. 2 We define the expected value (also called the expectation or the mean) of a random variable X, with PMF P x, by E[X] = L xPx (x). x Example 2.2. Consider two independent coin tosses, each with a 3/4 probability of a head, and let X be the number of heads obtained. This is a binomial random variable with parameters n = 2 and p = 3/4. Its PMF is so the mean is { (1/4)2 , if k = 0, px (k) = 2· (1/4) . (3/4), if k = 1, (3/4)2 , if k = 2, ( 1 ) 2 (1 3 ) ( 3 ) 2 24 3 E[X] = o· 4 + 1 · 2· 4 . 4 + 2 · 4 = 16 = 2' t When dealing with random variables that take a countably infinite number of values, one has to deal with the possibility that the infinite sum Lx xpx (x) is not well-defined. More concretely, we will say that the expectation is well-defined if Lx Ixlpx (x) < 00. In this case, it is known that the infinite sum Lx xpx (x) converges to a finite value that is independent of the order in which the various terms are summed. For an example where the expectation is not well-defined, consider a random variable X that takes the value 2k with probability 2-k, for k = 1, 2, ... . For a more subtle example, consider a random variable X that takes the values 2k and _2k with probability 2-k, for k = 2, 3, ... . The expectation is again undefined, even though the PMF is symmetric around zero and one might be tempted to say that E[X] is zero. Throughout this book, in the absence of an indication to the contrary, we implic­ itly assume that the expected value of the random variables of interest is well-defined. Expecta tion, It useful to view the mean of X as a \"representative\" value of X, which its more by viewing the mean as explained in Fig. 2.7. In particular , if that point must to mean. the PMF, sense around a 2.1: of the mean as a center of a bar with a weight p X placed at each point x with p X > 0, the center of the point at which the sum of the torques from the weights to its left is to the sum of the from the to i ts right : L(X - c)px (x) = O. the center of gravity is equal to the mean E[X] . Besides the mean, there are several its PMF. F'Ir\"II \"\"\" �a'n'll\" as E[xn ] , the .c.'V\"I\"'\\.Ol\"\",Qn terminology, the moment of mean . just the The most important qu antity associ ated a variable X j other than IS IS the expected of the (X - ) 2 can only by var(X) as (X - )2, - E[X] ) 2] . is its mean. is defined ax == Jvar (X ). 84 Discrete Random Variables Chap. 2 The standard deviation is often easier to interpret because it has the same units as X. For example, if X measures length in meters, the units of variance are square meters, while the units of the standard deviation are meters. One way to calculate var(X), is to use the definition of expected value, after calculating the PMF of the random variable (X - E[ Xl) 2 . This latter random variable is a function of X, and its PMF can be obtained in the manner discussed in the preceding section. Example 2.3. Consider the random variable X of Example 2.1, which has the PMF () { 1/9. if x is an integer in the range [-4, 4] , Px x = 0, otherwise. The mean E[X] is equal to O. This can be seen from the symmetry of the PMF of X around 0, and can also be verified from the definition: 1 4 E[X] = L XPX(X) = 9 L x = o. .r x = -.,1 Let Z = (X - E[XJ ) 2 = X2 . As in Example 2. 1, we have { 2/9, if z = 1, 4.9. 16, pz (z) = 1/9. if z = 0, 0, otherwise. The variance of X is then obtained by L 1 2 2 2 2 60 var(X) = E [Z] = zpz(z) = O· - + 1 . - + 4· - + 9· - + 16 · - = - . 9 9 9 9 9 9 z It turns out that there is an easier method to calculate var(X), which uses the PMF of X but does not require the PMF of (X - E[Xl) 2 . This method is based on the following rule. Expected Value Rule for Functions of Random Variables Let X be a random variable with PMF px, and let g(X) be a function of X. Then, the expected value of the random variable g( X) is given by E[g(X)] = Lg(x)px(x). x To verify this rule, we let Y = g(X) and use the formula py(y) = px(x) {x l g(x}=y} Sec. 2. 4 Expectation, l\\:Iean, and Variance derived in the preceding section. We have E[g(X)] = E[Y] = L YPY(Y) y = L Y L px(x) y {x I g(x)= y } = L L ypx (x) y { xl g(x)= y} = L L g(x)px(x) y {x I g(x}=y } = L g(x)px(x). x Using the expected value rule, we can write the variance of X as var(X) = E [(X - E[X])2] = L(x - E[X])2pX(x). x Similarly, the nth moment is given by x and there is no need to calculate the P:l\\fF of X n. Example 2.3 (continued). For the random variable X with PMF we have ( ) {I /9. if x is an integer in the range [-4. 4J . px x = O. otherwise, var(X) = E [ (X - E[xJ) 2] = L (x - E[XJ) 2pX (X) x (since E[XJ = 0) 1 = '9 (16 + 9 + 4 + 1 + 0 + 1 + 4 + 9 + 16) 60 g' which is consistent with the result obtained earlier. 85 86 Discrete Random Variables Chap. 2 As we have already noted, the variance is always nonnegative, but could it be zero? Since every term in the formula Lx (X - E[X])2pX (x) for the variance is nonnegative, the sum is zero if and only if (x - E[X])2px(x) = ° for every x. This condition implies that for any x with px(x) > 0, we must have x = E[X] and the random variable X is not really \"random\" : its value is equal to the mean E[X], with probability 1. Variance The variance var(X) of a random variable X is defined by var(X ) = E [(X - E[X])2] , and can be calculated as x It is always nonnegative. Its square root is denoted by a x and is called the standard deviation. Properties of Mean and Variance \\Ve will now use the expected value rule in order to derive some important properties of the mean and the variance. We start with a random variable X and define a new random variable Y, of the form Y = aX +b, where a and b are given scalars. Let us derive the mean and the variance of the linear function Y. We have E[Y] = L(ax + b)px (x) = a LXPX (x) + b LPx(x) = aE[X] + b. x x x Furthermore, var(Y) = L(ax + b - E[aX + b])2pX(x) x x x = a2 var(X) . Sec. 2. 4 Expectation, Mean, and Variance Mean and Variance of a Linear Function of a Random Variable Let X be a random variable and let Y = aX +b. where a and b are given scalars. Thenl E(Y] = aE(X] + b, var{Y) = a2 var(X). 87 Let us also give a convenient alternative formula for the variance of a random variable X. Variance in Terms of Moments Expression var(X) = E[X2J - (E[X])2. This expression is verified as follows: var(X) = L(x - E[X])2pX (x) x = L (X2 2xE[X] + (E[X])2)px(.T) x x x = E[X2] 2(E[X])2 + (E[X])2 = E[X2] (E[X])2. x We finally illustrate by example a common pitfall: unless g(X) is a linear function, it is not generally true that E [g(X)] is equal to g(E[X]). Example 2.4. Average Speed Versus Average Time. If the weather is good (which happens with probability 0.6) . Alice walks the 2 miles to class at a speed of V = 5 miles per hour, and otherwise rides her motorcycle at a speed of V = 30 miles per hour. What is the mean of the time T to get to class? A correct way to solve the problem is to first derive the PMF of T. ( ) { 0.6. if t = 2/5 hours. PT t = . 0.4. If t = 2/30 hours. and then calculate its mean by 2 2 4 E[T] = 0.6 . 5\" + 0.4 . 30 = 15 hours. 88 Discrete Random Variables However, it is wrong to calculate the mean of the speed V, E[V] = 0.6·5 + 0.4 ·30 = 15 miles per hour, and then claim that the mean of the time T is 2 2 E[V] = 15 hours. To summarize, in this example we have 2 T= V' Chap. 2 Mean and Variance of Some Common Random Variables We will now derive formulas for the mean and the variance of a few important random variables. These formulas will be used repeatedly in a variety of contexts throughout the text . Example 2.5. Mean and Variance of the Bernoulli. Consider the experi­ ment of tossing a coin, which comes up a head with probability p and a tail with probability 1 - p. and the Bernoulli random variable X with PMF px (k) = { P, �f k = 1. 1 - p. If k = O. The mean. second moment. and variance of X are given by the following calcula- tions: E[X] = 1 . p + 0 . (1 - p) = p. E[X2] = 12 . P + 0 . (1 - p) = p, var(X) = E[X2] - (E[X]) 2 = P _ p2 = p(1 _ p) . Example 2.6. Discrete Uniform Random Variable. What is the mean and variance associated with a roll of a fair six-sided die? If we view the result of the roll as a random variable X, its PMF is px (k) = { 1/6, if k = �. 2, 3, 4, 5,6, 0, otherWise. Since the PMF is symmetric around 3.5. we conclude that E[X] = 3.5. Regarding the variance, we have var(X) = E[X2] _ (E[X]) 2 = � (12 + 22 + 32 + 42 + 52 + 62) _ (3.5)2, 2. 4 1 - - + 1 • • • 2.8: PIvlF of the discrete random variable that is uniformly dis- tributed between two a and b. Its mean and variance are E[X] _ a + b - -2- ' (b - a)( b-a+ 2) var( X) = 12 which yields var(X ) = 35/ 12. 89 takes one out of a range of contiguous integer values � with equal probability. i\\lore a random variable a P?v!F of the px (k) = { b - � + 1 . O. if k = a. a + 1. .. , . b. otherwise. a b are two a < b: see The mean is a+b 2 as can be seen inspection , is (a + b) /2 . calculate the variance of X. we first consider the simpler case where a = 1 and b = n. It can on n 1 n 1 = G (n + 1 ) + 1) . k= l )= 11 2 = 6\" (n + 1) ( 2n + 1) - 4' (11, + 1 ) 1 = + 1) + 2- - 3 ) 12 can now 90 Discrete Random Variables Chap. 2 For the case of general integers a and b, we note that a random variable which is uniformly distributed over the interval [a, b] has the same variance as one which is uniformly distributed over [1 , b - a + 1], since the PMF of the second is just a shifted version of the PMF of the first. Therefore, the desired variance is given by the above formula with n = b - a + 1, which yields (X) (b - a+ 1)2 -1 var = -'--------.:.-- 12 (b - a) (b - a+2) 12 Example 2.7. The Mean of the Poisson. The mean of the Poisson PMF (k) - .>. Ak px = e kl' can be calculated is follows: x; \\ k E[X] = Lke-'>'9J k=O x; k = Lke- '>' �! k=l x; Ak - 1 = A Le-'>' (k - 1)! k=l = A � e- .>. Am L m! m=O = A. k = 0, 1, 2, ... , (the k = 0 term is zero) (let m = k - 1) The last equality is obtained by noting that is the normalization property for the Poisson PMF. A similar calculation shows that the variance of a Poisson random variable is also A: see Example 2.20 in Section 2.7. We will derive this fact in a number of different ways in later chapters. Decision Making Using Expected Values Expected values often provide a convenient vehicle for optimizing the choice between several candidate decisions that result in random rewards. If we view the expected reward of a decision as its \"average payoff over a large number of trials,\" it is reasonable to choose a decision with maximum expected reward. The following is an example. 2. 4 as first question attempted is answered incorrectiy, the quiz terminates, i.e. , the person is not allowed to attempt the second If first question is answered received? The answer is not obvious because there is a tradeoff: attempting first the more but 2 as a random variable X 1 and calcu late possible 2,9) : $1 00 $ value E(X] under the two $ $ 2.9: Sequential description of the sample space of the quiz problem for the two cases where we answer question 1 or question 2 first . (a) px (0) = and we have 1 px (100) = ·0.5, is (cf. PX (300) = 0.8 . 0.5 , E[X] = 0.8 · 0.5 · 100 + 0.8 · 0.5 · 300 = $160. (b) Answer question 2 first : Then the PMF of X is (cf. the right side Fig. 2.9) px (0) = px (200) = 0. 5 . px (300) = 0.5 · 0.8, and we E[X] = 0.5 · ·200 + 0.5 · ·300 = $140. 92 Discrete Random Variables Chap. 2 Thus, it is preferable to attempt the easier question 1 first. Let us now generalize the analysis. Denote by PI and P2 the probabilities of correctly answering questions 1 and 2, respectively, and by VI and V2 the corre­ sponding prizes. If question 1 is answered first, we have while if question 2 is answered first, we have It is thus optimal to answer question 1 first if and only if or equivalently, if PI VI > P2V2 1 - PI - 1 - P2 ' Therefore, it is optimal to order the questions in decreasing value of the expression pV/(l - p). which provides a convenient index of quality for a question with prob­ ability of correct answer P and value v. Interestingly, this rule generalizes to the case of more than two questions (see the end-of-chapter problems). 2.5 JOINT PMFS OF MULTIPLE RANDOM VARIABLES Probabilistic models often involve several random variables. For example, in a medical diagnosis context, the results of several tests may be significant, or in a networking context . the workloads of several routers may be of interest. All of these random variables are associated with the same experiment, sample space, and probability law, and their values may relate in interesting ways. This motivates us to consider probabilities of events involving simultaneously several random variables. In this section, we will extend the concepts of PMF and expectation developed so far to multiple random variables. Later on, we will also develop notions of conditioning and independence that closely parallel the ideas discussed in Chapter 1. Consider two discrete random variables X and Y associated with the same experiment . The probabilities of the values that X and Y can take are captured by the joint PMF of X and Y, denoted PX,y. In particular. if (x, y) is a pair of possible values of X and Y, the probability mass of (x. y) is the probability of the event {X = x. Y = y}: PX.y(x. y) = P(X = x. Y = y). Here and elsewhere. we use the abbreviated notation P(X = x, Y = y) instead of the more precise notations P({X = x} n { Y = y}) or P(X = x and Y = y). Sec. 2. 5 Joint PMFs of Multiple Random Variables 93 The joint PMF determines the probability of any event that can be specified in terms of the random variables X and Y. For example if A is the set of all pairs (x, y) that have a certain property, then P((X. Y) E A) = L PX,y(x, y). (x. Y )EA In fact , we can calculate the PMFs of X and Y by using the formulas pX (x) = LPx,Y(x, y), py (y) = LPX,y(x, y). Y x The formula for P x (x) can be verified using the calculation pX (x) = P(X = x) = L P(X =x. Y = y) Y where the second equality follows by noting that the event {X = x} is the union of the disjoint events {X = x. Y = y} as y ranges over all the different values of Y. The formula for py (y) is verified similarly. We sometimes refer to P x and py as the marginal PMFs, to distinguish them from the joint PI\\IF. We can calculate the marginal PMFs from the joint PMF by using the tabular method. Here. the joint PMF of X and Y is arranged in a two­ dimensional table, and the marginal PMF of X or Y at a given value 'is obtained by adding the table entries along a corresponding column or row, respectively. This method is illustrated by the following example and Fig. 2. 10. Example 2.9. Consider two random variables. X and Y, described by the joint PMF shown in Fig. 2. 10. The marginal P�lFs are calculated by adding the table entries along the columns (for the marginal PMF of X) and along the rows (for the marginal PMF of V), as indicated. Functions of Multiple Random Variables When there are multiple random variables of interest , it is possible to generate new random variables by considering functions involving several of these random variables. In particular, a function Z = g(X. Y) of the random variables X and Y defines another random variable. Its PMF can be calculated from the joint PMF Px.y according to pz(z) = PX.y (x, y). {(x.y) I g (x . y) =z} .:1 3 2 1 method for calculating the PMFs from the PMF in 2.9. The joint PMF is TArITA_\"An't.Arl ta ble, where the number in each square y) gives the value of p x, y y) . To calc ulate the margi n al PTvIF PX (x) for a given val ue of x, we add t he nu mbers in the column to x. For Px (2) = Simi larly, to calcu late the P?\\1F py (y) for a value of y, we add the numbers in the row correslPorldulg to y. For py (2 ) = 7/20. 2 Fu rthermore . the exp ected value rule for functions naturally '\"'..,· .. \"\" .... · ...... ... and takes the form [g(X, x y very to In the special case \"iNhere 9 is we y)pX,y (x, y) . case a and of E[aX bY + c] = aE [X] + bE[Y] c. a form aX +bY +c, Example (continued). joint PMF is given in Fig. 2. the random X and Y whose and a new random variable Z defi ned by z = X +2Y. Z can pz (z) = PX,y (x, y), {( X,y) I x+2y=z} Sec. 2.5 Joint PMFs of Multiple Random Variables and we have, using the PMF given in Fig. 2. 10, 1 1 224 pz (3) = 20 ' pz ( 4) = 20 ' pz (5) = 20 ' pz (6) = 20 ' pz (7) = 20 ' 33 211 pz (8) = 20 ' pz (9) = 20 ' pz ( lO) = 20 ' pz ( l 1) = 20 ' pz (12) = 20 ' The expected value of Z can be obtained from its PMF: E[Z] = L zpz (z) 1 1 224 = 3 . 20 + 4 . 20 + 5 . 20 + 6 . 20 + 7 · 20 3 3 2 1 1 + 8 . - + 9 . - + 10 . - + 11 . - + 12 . - 20 20 20 20 20 = 7.55. Alternatively, we can obtain E[Z] using the formula E[Z] = E[X] + 2E[Y] . From the marginal PMFs, given in Fig. 2. 10, we have so 3 6 8 3 51 E[X] = 1· - + 2· - + 3· - + 4· - = - 20 20 20 20 20 ' 3 7 7 3 50 E[Y] = 1· - + 2· - + 3· - + 4· - = - 20 20 20 20 20 ' E[Z] = 51 2 . 50 = 7.55. 20 + 20 More than Two Random Variables 95 The joint PMF of three random variables X, Y l and Z is defined in analogy with the above as PX,Y.z(x, y, z) = P(X = x, Y = y, Z = z) , for all possible triplets of numerical values (x, y, z) . Corresponding marginal PMFs are analogously obtained by equations such as and PX,y (x, y) = L PX,y,z(x, y, z) , z pX(x) = LL PX,y,z(x,y, z) . y z 96 Discrete Random Variables Chap. 2 The expected value rule for functions is given by E[g(X, Y. Z)] = L L L 9(x, y, z)pX,Y,z(x, y, z), x y z and if 9 is linear and has the form aX + bY + cZ + d, then E[aX + bY + cZ + d] = aE[X] + bErYl + cE[Z] + d. Furthermore, there are obvious generalizations of the above to more than three random variables. For example, for any random variables Xl , X2, ... ,Xn and any scalars a I, a2 .... , an, we have Example 2. 10. Mean of the Binomial. Your probability class has 300 students and each student has probability 1/3 of getting an A, independent of any other student . What is the mean of X. the number of students that get an A? Let Xl = { 1. if the i�h student gets an A, O. otherwise. Thus XI . X2 . . .. . Xn are Bernoulli random variables with common mean p = 1/3. Their sum X=X1+ X2+\" , +Xn is the number of students that get an A. Since X is the number of \"successes\" in n independent trials, it is a binomial random variable with parameters n and p. Using the linearity of X as a function of the Xi , we have 300 300 E [X] = L E[Xi] = L � = 300 · � = 100. 1=1 i=1 If we repeat this calculation for a general number of students n and probability of A equal to p, we obtain n n i= 1 1= 1 Example 2.11. The Hat Problem. Suppose that n people throw their hats in a box and then each picks one hat at random. (Each hat can be picked by only one person, and each assignment of hats to persons is equally likely.) What is the expected value of X, the number of people that get back their own hat? For the ith person. we introduce a random variable Xi that takes the value 1 if the person selects his/her own hat. and takes the value 0 otherwise. Since P(Xi = 1) = l/n and P(Xi = 0) = 1 - l/n, the mean of Xi is 1 ( 1 ) 1 E[Xi] =1 ·- + 0· 1-- = -. n n n Sec. 2.6 Conditioning We now have so that 1 E[X] = E[X d + E[X2] + .. . + E[Xn] = n . - = l. n Summary of Facts About Joint PMFs Let X and Y be random variables associated with the same experiment. • The joint PMF p x. y of X and Y is defined by PX,y(x, y) = P(X = x, Y = y). • The marginal PMFs of X and Y can be obtained from the joint PMF, using the formulas px (x) = LPx,Y(x, y), py(y) = LPx,Y(x, y). y x • A function g(X, Y) of X and Y defines another random variable, and E[g(X, Y)] = L L g(x, y)px,Y(x, y). x y If 9 is linear, of the form aX + bY + c, we have E[aX + bY + c] = aE[X] + bErYl + c. • The above have natural extensions to the case where more than two random variables are involved. 2.6 CONDITIONING 97 Similar to our discussion in Chapter 1. conditional probabilities can be used to capture the information conveyed by various events about the different possible values of a random variable. We are thus motivated to introduce conditional PMFs, given the occurrence of a certain event or given the value of another ran­ dom variable. In this section, we develop this idea and we discuss the properties of conditional PMFs. In reality though, there is not much that is new, only an elaboration of concepts that are familiar from Chapter 1. together with some new notation. 98 Discrete Random Variables Chap. 2 Conditioning a Random Variable on an Event The conditional PMF of a random variable X, conditioned on a particular event A with P(A) > 0, is defined by p({X =x}nA) PXIA(X) = P(X = x I A) = P(A) . Note that the events {X = x} n A are disjoint for different values of x, their union is A, and, therefore, P(A) = L P({X = x}nA) . x Combining the above two formulas, we see that so PXIA is a legitimate PMF. x The conditional PMF is calculated similar to its unconditional counterpart : to obtain PXIA(X), we add the probabilities of the outcomes that give rise to X = x and belong to the conditioning event A, and then normalize by dividing with P(A). Example 2.12. Let X be the roll of a fair six-sided die and let A be the event that the roll is an even number. Then, by applying the preceding formula, we obtain PX I A(k) = P(X = k I roll is even) P(X = k and X is even) P(roll is even) = { 1/3, if k = 2, 4, 6, 0, otherwise. Example 2.13. A student will take a certain test repeatedly, up to a maximum of n times, each time with a probability P of passing, independent of the number of previous attempts. What is the PMF of the number of attempts, given that the student passes the test? Let A be the event that the student passes the test (with at most n attempts) . We introduce the random variable X, which is the number of attempts that would be needed if an unlimited number of attempts were allowed. Then, X is a geometric random variable with parameter p, and A = {X ::s n }. We have n P(A) = L (1 - p)m -lp, 1n =1 p .... o 1 2. 11: Visualization and calculation of the conditional P!vl F P X IA In Example 2. 13. We start with the P�IF of X! we set to zero the P:t+.IF values for all k that do not to the event A. and we normalize the values with P(A). and as in Fig. 2. 11. 12 conditional prvlF. a more if k = 1. ... . n. otherwise . of 2. 12: V isuali zation and calcu lation of the conditional P fvl F p X I A ( x) . For each X, we add the of the outcomes in the intersection {X = n and normalize with P(A). JI.'-'JlJl.JI.�lJl.j:::O,. one x we know some partial knowledge about the value of on same OV'I\"'\\.O't\"1 n,,\\ OT\"1\" y [with (y) > 01 , this This kno\\v ledge is capt ured IY I A to events \\ve IY a 2.13: Visualization of the conditional Pl\\IF PX I Y (x I y) . For each y, we view the Pi\\IF the slice Y y and renormal ize so that PX jY = 1 2 Sec. 2.6 Conditioning 101 The conditional PI\\IF is often convenient for the calculation of the joint PIVIF, using a sequential approach and the formula PX,Y(x, y) = PY(Y)PxlY(x I y), or its counterpart PX.Y (x, y) = PX(x)PYIX (y I x). This method is entirely similar to the use of the multiplication rule from Chap­ ter 1. The following example provides an illustration. Example 2. 14. Professor May B. Right often has her facts wrong, and answers each of her students' questions incorrectly with probability 1/4, independent of other questions. In each lecture, May is asked 0, 1, or 2 questions with equal probability 1/3. Let X and Y be the number of questions May is asked and the number of questions she answers wrong in a given lecture, respectively. To construct the joint PMF px. Y (x, y), we need to calculate the probability P(X = x, Y = y) for all combinations of values of x and y. This can be done by using a sequential description of the experiment and the multiplication rule, as shown in Fig. 2. 14. For example. for the case where one question is asked and is answered wrong, we have 1 1 1 px. y( 1, I) = px (x)PY lx(y lx) = 3 ' 4 = 12 ' The joint PMF can be represented by a two-dimensional table, as shown in Fig. 2. 14. It can be used to calculate the probability of any event of interest. For instance, we have P(at least one wrong answer) = px. y ( 1 , 1) + px.y (2, 1) + px. y(2, 2) 4 6 1 = 48 + 48 + 48 ' The conditional PMF can also be used to calculate the marginal PMFs. In particular. we have by using the definitions, y y This formula provides a divide-and-conquer method for calculating marginal PMFs. It is in essence identical to the total probability theorem given in Chap­ ter 1, but cast in different notation. The following example provides an illustra­ tion. Example 2.15. Consider a transmitter that is sending messages over a computer network. Let us define the following two random variables: X : the travel time of a given message, Y: the length of the given message. We know the PMF of the travel time of a message that has a given length, and we know the PMF of the message length. We want to find the (unconditional) PMF of the travel time of a message. 2. 14: ass ume y UI(M, IUI l of the joint PMF PX ,y (x. y) in py (y ) = { 1 /6, if Y = 102 � if y = 2 2. 14. y congestion in the network at the time of transmission. In particular I the travel time Y seconds with probability 1 1 0 -3y seconds with probability 1/3� and obtain ( 0-2 ) 5 1 px 1 = 6 . 2' 1 we {if x = 1, px\\ y (x l 104 ) = 1/3, if x= lO, 1/6, if x = 100. we use total probability formula 5 1 1 1 px ( l ) = - . - + - . - 6 6 6 2 ' 1 1 px ( 10) = 6 . 3' 1 1 px ( lOO) = 6 . 6' Sec. 2.6 Conditionillg 103 We finally note that one can define conditional PMFs involving more than two random variables, such as PX.Ylz(x, Y I z) or PXIY.z(x I y, z) . The concepts and methods described above generalize easily. Summary of Facts About Conditional PMFs Let X and Y be random variables associated with the same experiment. • Conditional PMFs are similar to ordinary PMFs, but pertain to a universe where the conditioning event is known to have occurred. • The conditional PMF of X given an event A with P(A) > 0, is defined by PXIA(X) = P(X = x I A) and satisfies • If AI , ... ,An are disjoint events that form a partition of the sample space, with P(Ad > 0 for all i, then n px(x) = LP(AdpXIAi(X), i=1 (This is a special case of the total probability theorem.) Furthermore, for any event B, with P(Ai n B) > 0 for all i, we have n PXIB(X) = L P(Ai I B)PxIAinB(X). i=1 • The conditional PMF of X given Y = y is related to the joint PMF by PX,Y(X, y) = PY(Y)PxlY(x I y). • The conditional PMF of X given Y can be used to calculate the marginal PMF of X through the formula pX(X) = LPY(Y)pxlY(x I y). y • There are natural extensions of the above involving more than two random variables. 104 Discrete Random Variables Chap. 2 Conditional Expectation A condit ional P�IF can be thought of as an ordinary P�IF over a new universe determined by the conditioning event. In the same spirit. a condit ional expec­ tation is the same as an ordinary expect atioll, except that it refers to the new universe. and all probabilities and PlvIFs are replaced by their conditional coun­ terparts. (Conditional variances can also be treated similarly.) We list the main df'finit iolls and relevant facts below . Summary of Facts About Conditional Expectations Let X and Y be random variables associated with the same experiment . • The conditional expect ation of X given an event A with P(A) > 0, is defined by x For a function g(X) , we have x • The conditional expectation of X given a value y of Y is defined by E[X I Y = y] = LXPxJY(x I y) . x • If AI , ... , An be disjoint events that form a partition of the sample space, with P(Ad > 0 for all i, then n E[X] = L P(Ai )E[X I Ai] . i=I Furthermore, for any event B with P(Ai n B) > 0 for all i, we have n E[X I B] = L P{Ai I B)EfX I Ai n B] . i=l • We have EfX] = L Py (y)E[X I Y = y] . y The last three equalities above apply in different situations. but are essen­ tially equivalent . and will be referred to collectively as the total expectation Sec. 2. 6 Conditioning 105 theorem. They all follow from the total probability theorem. and express the fact that \"the unconditional average can be obtained by averaging the condi­ tional averages.\" They can be used to calculate the unconditional expectation E[X] from the conditional P1lF or expectation, using a divide-and-conquer ap­ proach. To verify the first of the three equalities. we write n pX (x) = L P(Ai)PxIAt (x I Ai). i=l we multiply both sides by x. and we sum over x: E[X] = LX Px (x) x n x i=l n i= 1 :t· n = LP(AdE[X I Ad. i=l The remaining two equalities are verified similarly. Example 2. 16. Messages transmitted by a computer in Boston through a data network are destined for New York with probability 0.5, for Chicago with probability 0.3, and for San Francisco with probability 0.2. The transit time X of a message is random. Its mean is 0.05 seconds if it is destined for New York, 0. 1 seconds if it is destined for Chicago, and 0.3 seconds if it is destined for San Francisco. Then. E[X] is easily calculated using the total expectation theorem as E[X] = 0.5 . 0.05 + 0.3 . 0. 1 + 0.2 · 0.3 = 0. 115 seconds. Example 2. 17. Mean and Variance of the Geometric. You write a software program over and over, and each time there is probability p that it works correctly. independent of previous attempts. What is the mean and variance of X, the number of tries until the program works correctly? We recognize X as a geometric random variable with PMF k = 1, 2, .... The mean and variance of X are given by E[X] = L k(l - p)k-lp, var(X) = L(k - E[X])2(1 _ p)k- lp, k=l k=l 106 Discrete Random Variables Chap. 2 but evaluating these infinite sums is somewhat tedious. As an alternative, we will apply the total expectation theorem, with Al = {X = I} = {first try is a success}, A2 = {X > I} = {first try is a failure}, and end up with a much simpler calcula­ tion. If the first try is successful, we have X = 1, and E[X I X = 1] = 1. If the first try fails (X > 1). we have wasted one try, and we are back where we started. So, the expected number of remaining tries is E[XJ, and E[X I X> 1] = 1 + E[X]. Thus, E[X] = P(X = l)E[X IX = 1] + P(X > l)E[X IX > 1] = p + (1 - p) (l + E[X]) , from which we obtain E[X] = .!.. P With similar reasoning, we also have E[X2 IX = 1] 1, so that from which we obtain E[X2] = 1 + 2(1 - p)E[X] , p and, using the formula E[X] = lip derived above, We conclude that 2 ( )2 2 1 1 1 - p var(X ) = E[X ] - E[X] = - - - - - = -. p2 P p2 p2 Example 2. 18. The Two-Envelopes Paradox. This is a much discussed puzzle that involves a subtle mathematical point regarding conditional expectations. You are handed two envelopes. and you are told that one of them contains m times as much money as the other, where m is an integer with m > 1. You open one of the envelopes and look at the amount inside. You may now keep this amount, or you may switch envelopes and keep the amount in the other envelope. What is the best strategy? Sec. 2.6 Conditioning 107 Here is a line of reasoning that argues in favor of switching. Let A be the envelope you open and B be the envelope that you may switch to. Let also x and y be the amounts in A and B, respectively. Then, as the argument goes, either y = x/m or y = mx, with equal probability 1/2, so given x, the expected value of y is ! . � + ! . mx = ! (� + m) x = 1 + m 2 x > x, 2 m 22 m 2m since 1 + m2 > 2m for m > 1. Therefore, you should always switch to envelope B! But then, since you should switch regardless of the amount found in A, you might as well open B to begin with; but once you do, you should switch again, etc. There are two assumptions, both flawed to some extent, that underlie this paradoxical line of reasoning. (a) You have no a priori knowledge about the amounts in the envelopes, so given x, the only thing you know about y is that it is either l/m or m times x, and there is no reason to assume that one is more likely than the other. (b) Given two random variables X and Y, representing monetary amounts, if E[Y I X = x] > x, for all possible values x of X, then the strategy that always switches to Y yields a higher expected monetary gain. Let us scrutinize these assumptions. Assumption (a) is flawed because it relies on an incompletely specified prob­ abilistic model. Indeed, in any correct model, all events, including the possible values of X and Y, must have well-defined probabilities. With such probabilistic knowledge about X and Y, the value of X may reveal a great deal of information about Y. For example, assume the following probabilistic model: someone chooses an integer dollar amount Z from a known range �, z] according to some distribu­ tion, places this amount in a randomly chosen envelope, and places m times this amount in the other envelope. You then choose to open one of the two envelopes (with equal probability) , and look at the enclosed amount X. If X turns out to be larger than the upper range limit z, you know that X is the larger of the two amounts, and hence you should not switch. On the other hand, for some other values of X, such as the lower range limit �, you should switch envelopes. Thus, in this model, the choice to switch or not should depend on the value of X. Roughly speaking, if you have an idea about the range and likelihood of the values of X, you can judge whether the amount X found in A is relatively small or relatively large, and accordingly switch or not switch envelopes. Mathematically, in a correct probabilistic model, we must have a joint PMF for the random variables X and Y, the amounts in envelopes A and B, respectively. This joint PMF is specified by introducing a PMF pz for the random variable Z, the minimum of the amounts in the two envelopes. Then, for all z, and 1 px,y (mz, z) = PX,y (z, mz) = 2Pz(z), PX,y (x, y) = 0, 108 Discrete Random Variables Chap. 2 for every (x, y) that is not of the form (mz, z) or (z, mz). With this specification of px.y (x, y) , and given that X = x, one can use the rule switch if and only if E[Y I X = x] > x. According to this decision rule, one may or may not switch envelopes, depending on the value of X, as indicated earlier. Is it true that, with the above described probabilistic model and decision rule, you should be switching for some values x but not for others? Ordinarily yes, as illustrated from the earlier example where Z takes values in a bounded range. However, here is a devilish example where because of a subtle mathematical quirk, you will always switch! A fair coin is tossed until it comes up heads. Let N be the number of tosses. Then, mN dollars are placed in one envelope and mN-1 dollars are placed in the other. Let X be the amount in the envelope you open (envelope A) , and let Y be the amount in the other envelope (envelope B) . Now, if A contains $1, clearly B contains $m, so you should switch envelopes. If. on the other hand, A contains mn dollars, where n > 0, then B contains either mn-l or mn+l dollars. Since N has a geometric PMF, we have P(Y = mn+II X = mn) P(Y = mn-1 lX = mn) P(Y = mn+l , X = mn) P(Y = mn-l , X = mn) P(N = n + 1 ) P(N = n) Thus and [ . I n] 2 n-l 1 n+l 2 + m2 n E amount III B X = m = 3 . m + 3 . m = 3m . m . 1 - 2 We have (2 + m2)/3m > 1 if and only if m2 - 3m + 2 > ° or (m - l)(m - 2) > 0. Thus if m > 2, then E[amount in B I X = mn] > mn , and to maximize the expected monetary gain you should always switch to B! What is happening in this example is that you switch for all values of x because E[Y I X = x] > x, for all x. A naive application of the total expectation theorem might seem to indicate that E[Y] > E[X] . However, this cannot be true, since X and Y have identical PMFs. Instead, we have E[Y] = E[X] = 00 , which is not necessarily inconsistent with the relation E[Y I X = x] > x for all x. The conclusion is that the decision rule that switches if and only if E[Y I X = x] > x does not improve the expected monetary gain in the case where E[Y] E[X] = 00 , and the apparent paradox is resolved. Sec. 2. 7 Independence 109 2.7 INDEPENDENCE We now discuss concepts of independence related to random variables. These are analogous to the concepts of independence between events (cf. Chapter 1). They are developed by simply introducing suitable events involving the possible values of various random variables, and by considering the independence of these events. Independence of a Random Variable from an Event The independence of a random variable from an event is similar to the indepen­ dence of two events. The idea is that knowing the occurrence of the conditioning event provides no new information on the value of the random variable. More formally, we say that the random variable X is independent of the event A if P(X = x and A) = P(X = x)P(A) = px(x)P(A), for all x. which is the same as requiring that the two events {X x} and A be indepen- dent , for any choice x. From the definition of the conditional PMF, we have P(X = x and A) = PXIA(X)P(A). so that as long as P(A) > 0, independence is the same as the condition for all x. Example 2. 19. Consider two independent tosses of a fair coin. Let X be the number of heads and let A be the event that the number of heads is even. The (unconditional) PMF of X is { 1/4. px (x) = 1/2, 1/4, if x = O. if x = 1, if x = 2. and P(A) = 1/2. The conditional PMF is obtained from the definition PX IA (X) = p(X = x and A) /P(A): { 1/2, PX IA(X) = 0, 1/2, if x = 0, if x = 1, if x = 2. Clearly, X and A are not independent, since the PMFs px and PX IA are different. For an example of a random variable that is independent of A, consider the random variable that takes the value 0 if the first toss is a head. and the value 1 if the first toss is a tail. This is intuitively clear and can also be verified by using the definition of independence. 110 Discrete Random Variables Chap. 2 Independence of Random Variables The notion of independence of two random variables is similar to the indepen­ dence of a random variable from an event. We say that two random variables X and Y are independent if PX,Y (x, y) = Px (x) PY (Y), for all x, y. This is the same as requiring that the two events {X = x} and {Y = y} be in­ dependent for every x and y. Finally, the formula pX,Y(x, y) = PXIY(x I y)py(y) shows that independence is equivalent to the condition PXIY(x I y) = px (x). for all y with py(y) > 0 and all x. Intuitively, independence means that the value of Y provides no information on the value of X. There is a similar notion of conditional independence of two random vari­ ables, given an event A with P(A) > o. The conditioning event A defines a new universe and all probabilities (or PMFs) have to be replaced by their conditional counterparts. For example, X and Y are said to be conditionally indepen­ dent, given a positive probability event A, if P(X = x, Y = y I A) = P(X = x I A)P(Y = y I A) , for all x and y, or, in this chapter's notation, for all x and y. Once more, this is equivalent to for all x and y such that PYIA(y) > O. As in the case of events (Section 1.5), conditional independence may not imply unconditional independence and vice versa. This is illustrated by the example in Fig. 2.15. If X and Y are independent random variables, then E[XY] = E[X] E[Y] , as shown by the following calculation: E[XY] = LL xyPX,Y(x, y) x y = L LXYPx (x)PY(y) x y x = E[X] E[Y] . y (by independence) 2. 7 lJ 3 2 2.15: conditional may not imply uncondit ional independence. For the PIvIF show n, the random variables X and Y are not independent . For example . we have = 1) = px (1 ). On the other hand , conditional on the event A = {X :s; 2. Y � 3} (the shaded set in the figure) 1 the random variables X and Y can be seen to independent . In particular, we have = { 1/3, �f x = I, If x = 2, for both val ues y = 3 and y = 4. 111 A very ... AA..l ...... � .... .. that if and are independent� then E [g(X)h(Y)] = E [g(X)] E [h (Y)]. h. In fact l this follows once we if are intuitively clear same is true for g( X) verification is left as an + Y us unchanged when the ...., � .. ' .... '\\JA.AA variable is shifted wi th the zero-mean X = X - E [Xj var(X + Y) = + = E[X2 +2X + + + = E [X 2] E[Y2 ) = var(X) + var (Y) + var (Y ) . it to Y = Y - E[Y] . 112 Discrete Random Variables Chap. 2 \\Ve have used above the property E[X Y] = O. which is justified as follows. The random variables X = X - E[X] and Y = Y - E[Y] are independent (because they are functions of the independent random variables X and Y). and since they also have zero-mean. we obtain E[X Y] = E[X] E[Y] = o. In conclusion. the variance of the sum of two independent random variables is equal to the sum of their variances. For an interesting comparison, note that the mean of the sum of two random variables is always equal to the sum of their means. even if they are not independent. Summary of Facts About Independent Random Variables Let A be an event, with P(A) > 0, and let X and Y be random variables associated with the same experiment. • X is independent of the event A if PXIA(X) = px(x), for all x, that is, if for all x, the events {X = x} and A are independent. • X and Y are independent if for all pairs (x, y), the events {X = x} and {Y = y} are independent, or equivalently PX,Y(x, y) = px(x)py(y), for all x, y. • If X and Y are independent random variables, then E[XY] = E[X] E[Y] . Furthermore, for any functions 9 and h, the random variables g(X) and h(Y) are independent, and we have E [g(X)h(Y)] = E [g(X)] E [h(Y)] . • If X and Y are independent, then var(X + Y) = var(X) + var(Y) . Independence of Several Random Variables The preceding discussion extends naturally to the case of more than two random variables. For example. three random variables X. Y. and Z are said to be Sec. 2. 7 Independence 113 independent if px.Y.z (x. y. z) = px(x)py(y)pz(z). for all x. y. z. If X, Y. and Z are independent random variables. then any three random variables of the form f(X). g(Y). and h(Z), are also independent. Similarly. any two random variables of the form g(X, Y) and h(Z) are independent. On the other hand. two random variables of the form g(X, Y) and h(Y, Z) are usually not independent because they are both affected by Y. Properties such as the above are intuitively clear if we interpret independence in terms of noninter­ acting (sub )experiments. They can be formally verified but this is sometimes tedious. Fortunately, there is general agreement between intuition and what is mathematically correct. This is basically a testament that our definitions of independence adequately reflect the intended interpretation. Variance of the Sum of Independent Random Variables Sums of independent random variables are especially important in a variety of contexts. For example. they arise in statistical applications where we \"average\" a number of independent measurements, with the aim of minimizing the effects of measurement errors. They also arise when dealing with the cumulative effect of several independent sources of randomness. We provide some illustrations in the examples that follow and we will also return to this theme in later chapters. In the examples below, we will make use of the following key property. If Xl , X 2 •... , X n are independent random variables, then var(Xl + X2 + ... + Xn ) = var(Xt ) + var(X2 ) + ... + var(Xn ). This can be verified by repeated use of the formula var(X + Y) = var(X) +var(Y) for two independent random variables X and Y. Example 2.20. Variance of the Binomial and the Poisson. We consider n independent coin tosses, with each toss having probability p of coming up a head. For each i, we let Xl be the Bernoulli random variable which is equal to 1 if the ith toss comes up a head, and is 0 otherwise. Then, X = X l + X2 + . .. + Xn is a binomial random variable. Its mean is E[X] = np. as derived in Example 2. 10. By the independence of the coin tosses. the random variables Xl , .... X n are independent , and n var(X) = L var(Xt ) = np(l - p). i= l As we discussed in Section 2.2. a Poisson random variable Y with parameter A can be viewed as the \"limit\" of the binomial as n - oc. p - O. while np = A. Thus. taking the limit of the mean and the variance of the binomial. we informally obtain the mean and variance of the Poisson: E[Y] = var( Y) = A. We have indeed 114 Discrete Random Variables Chap. 2 verified the formula E [Y] = A in Example 2.7. To verify the formula var(Y) = A, we write from which m=O = A(E[Y] + 1) = A(A + 1), The formulas for the mean and variance of a weighted sum of random variables form the basis for many statistical procedures that estimate the mean of a random variable by averaging many independent samples. A typical case is illustrated in the following example. Example 2.21. Mean and Variance of the Sample Mean. We wish to estimate the approval rating of a president, to be called B. To this end, we ask n persons drawn at random from the voter population, and we let Xi be a random variable that encodes the response of the ith person: X _ { I, if the ith person approves B's performance, 1 - 0, if the ith person disapproves B's performance. We model XI , X2 , ... , Xn as independent Bernoulli random variables with common mean p and variance p(1 - p). Naturally, we view p as the true approval rating of B. We \"average\" the responses and compute the sample mean STl. ' defined as X1 +X2 +\" ,+Xn Sn = . n Thus, the random variable Sn is the approval rating of B within our n-person sample. We have, using the linearity of Sn as a function of the Xi, n n E [Sn] = L �E [Xd = � LP = p, i=l i=l and making use of the independence of Xl , ... , X n, Ln 1 p( 1 - p) var(Sn ) = 2 var(Xd = . n n i=l Sec. 2. 8 Summary and Discussion 115 The sample mean Sn can be viewed as a \"good\" estimate of the approval rating. This is because it has the correct expected value, which is the approval rating p, and its accuracy, as reflected by its variance, improves as the sample size n increases. Note that even if the random variables Xi are not Bernoulli, the same calcu­ lation yields var(Sn ) = var(X) , n as long as the Xi are independent, with common mean E[X] and variance var(X). Thus, again, the sample mean becomes a good estimate (in terms of variance) of the true mean E[X] , as the sample size n increases. We will revisit the properties of the sample mean and discuss them in much greater detail in Chapter 5, in connection with the laws of large numbers. Example 2.22. Estimating Probabilities by Simulation. In many practical situations, the analytical calculation of the probability of some event of interest is very difficult. However, if we have a physical or computer model that can generate outcomes of a given experiment in accordance with their true probabilities, we can use simulation to calculate with high accuracy the probability of any given event A. In particular, we independently generate with our model n outcomes, we record the number m of outcomes that belong to the event A of interest, and we approximate P(A) by min. For example, to calculate the probability p = P(Heads) of a coin, we toss the coin n times, and we approximate p with the ratio (number of heads recorded) In. To see how accurate this process is, consider n independent Bernoulli random variables Xl \" ' \" Xn , each with PMF { P(A), pXi (k) = 1 _ P(A), if k = 1, if k = O. In a simulation context, Xi corresponds to the ith outcome, and takes the value 1 if the ith outcome belongs to the event A. The value of the random variable X = Xl + X2 + ... + Xn n is the estimate of P(A) provided by the simulation. According to Example 2.21, X has mean P(A) and variance P(A) (1 - P(A)) In, so that for large n, it provides an accurate estimate of P(A) . 2.8 SUMMARY AND DISCUSSION Random variables provide the natural tools for dealing with probabilistic models in which the outcome determines certain numerical values of interest. In this chapter, we focused on discrete random variables, and developed a conceptual framework and some relevant tools. In particular, we introduced concepts such as the PMF, the mean, and the variance, which describe in various degrees of detail the probabilistic character 116 Discrete Random Variables Chap. 2 of a discrete random variable. \\Ve showed how to use the PMF of a random variable X to calculate the mean and the variance of a related random variable Y = g(X) without calculating the PI\\IF of Y. In the special case where 9 is a linear function. Y = aX + b. the means and the variances of X and Y are related by E[Y] = aE[X] + b: var(Y) = a2var(X). \\Ve also discussed several special random variables, and derived their PI\\IF. mean, and variance. as summarized in the table that follows. Summary of Results for Special Random Variables Discrete Uniform over [a, b] : if k = a, a + 1, ... , b, otherwise, (X) (b -a)(b-a+2) var = 12 . Bernoulli with Parameter p: (Describes the success or failure in a single trial. ) px(k) = { p, �f k 1, 1 - p. If k - 0, E[X] = p, var(X) = p( l - p) . Binomial with Parameters p and n: (Describes the number of successes in n independent Bernoulli trials.) px(k) = (�) pk ( l - p)n-k, k = 0, 1 , ... , n, E[X] = np, var(X) = np(l - p) . Geometric with Parameter p: (Describes the number of trials until the first success, in a sequence of independent Bernoulli trials.) px(k) = (1 - p) k- lp, E[X] = �. p k = 1, 2, .. . , 1- p var(X) = -2- ' P Sec. 2. 8 Summary and Discussion 117 Poisson with Parameter 'x: (Approximates the binomial PMF when n is large, P is small, and ,x = np.) k = 0, 1, ... , E[X] = ,x, var(X) =,x . We also considered multiple random variables, and introduced joint PMFs, conditional PMFs, and associated expected values. Conditional PMFs are often the starting point in probabilistic Illodels and can be used to calculate other quantities of interest, such as marginal or joint P1IFs and expectations, through a sequential or a divide-and-conquer approach. In particular. given the condi­ tional Pl\\1F PXIY(x I y): (a) The joint PMF can be calculated by px.y(x. y) = py (y)pXIY ( .T I y). This can be extended to the case of three or more random variables. as in px.y.z(x. y. z) = pz(z)PYlz(Y I z)PxlY.z(x I y. z). and is analogous to the sequential tree-based calculation method using the multiplication rule. discussed in Chapter 1 . (b) The marginal PMF can be calculated by px(x) = LPY(Y)pxlY(x I y). y which generalizes the divide-and-conquer calculation method we discussed in Chapter 1 . (c) The divide-and-conquer calculation method in (b) above can be extended to compute expected values using the total expectation theorem: E[X] = LPy(y)E[X I Y = y]. y We introduced the notion of independence of random variables, in analogy with the notion of independence of events. Among other topics. we focused on random variables X obtained by adding several independent random variables XI , .... Xn: X = Xl + ... + Xn. 118 Discrete Random Variables Chap. 2 We argued that the mean and the variance of the sum are equal to the sum of the means and the sum of the variances, respectively: E[X] = E[XI] + . . . + E[XnJ, var(X) = var(XI ) + .. . + var(Xn ). The formula for the mean does not require independence of the Xi , but the formula for the variance does. The concepts and methods of this chapter extend appropriately to general random variables (see the next chapter), and are fundamental for our subject. Problems 119 PROB LEMS SECTION 2.2. Probability Mass Functions Problem 1. The MIT soccer team has 2 games scheduled for one weekend. It has a 0.4 probability of not losing the first game. and a 0.7 probability of not losing the second game, independent of the first. If it does not lose a particular game, the team is equally likely to win or tie. independent of what happens in the other game. The MIT team will receive 2 points for a win, 1 for a tie. and 0 for a loss. Find the PMF of the number of points that the team earns over the weekend. Problem 2. You go to a party with 500 guests. What is the probability that exactly one other guest has the same birthday as you? Calculate this exactly and also approximately by using the Poisson PMF. (For simplicity. exclude birthdays on February 29.) Problem 3. Fischer and Spassky play a chess match in which the first player to win a game wins the match. After 10 successive draws. the match is declared drawn. Each game is won by Fischer with probability 0.4. is won by Spassky with probability 0.3. and is a draw with probability 0.3. independent of previous games. (a) What is the probability that Fischer wins the match? (b) What is the PMF of the duration of the match? Problem 4. An internet service provider uses 50 modems to serve the needs of 1000 customers. It is estimated that at a given time. each customer will need a connection with probability 0.01, independent of the other customers. (a) What is the PMF of the number of modems in use at the given time? (b) Repeat part (a) by approximating the PMF of the number of customers that need a connection with a Poisson PMF. (c) \\Vhat is the probability that there are more customers needing a connection than there are modems? Provide an exact. as well as an approximate formula based on the Poisson approximation of part (b) . Problem 5. A packet communication system consists of a buffer that stores packets from some source, and a communication line that retrieves packets from the buffer and transmits them to a receiver. The system operates in time-slot pairs. In the first slot, the system stores a number of packets that are generated by the source according to a Poisson PMF with parameter 'x; however, the maximum number of packets that can be stored is a given integer b, and packets arriving to a full buffer are discarded. In the second slot, the system transmits either all the stored packets or c packets (whichever is less) . Here, c is a given integer with 0 < c < b. 120 Discrete Random Variables Chap. 2 (a) Assuming that at the beginning of the first slot the buffer is empty, find the PMF of the number of packets stored at the end of the first slot and at the end of the second slot. (b) What is the probability that some packets get discarded during the first slot? Problem 6. The Celtics and the Lakers are set to play a playoff series of n basketball games, where n is odd. The Celtics have a probability p of winning any one game, independent of other games. (a) Find the values of p for which n = 5 is better for the Celtics than n = 3. (b) Generalize part (aL i.e., for any k > 0, find the values for p for which n = 2k + 1 is better for the Celtics than n = 2k - 1. Problem 7. You just rented a large house and the realtor gave you 5 keys, one for each of the 5 doors of the house. Unfortunately, all keys look identical. so to open the front door, you try them at random. (a) Find the PMF of the number of trials you will need to open the door, under the following alternative assumptions: (1) after an unsuccessful trial. you mark the corresponding key. so that you never try it again. and (2) at each trial you are equally likely to choose any key. (b) Repeat part (a) for the case where the realtor gave you an extra duplicate key for each of the 5 doors. Problem 8. Recursive computation of the binomial PMF. Let X be a binomial random variable with parameters n and p. Show that its PMF can be computed by starting with px (O) = (1 - p)n. and then using the recursive formula p n - k px (k +l) = I - p ' k+ l ' px (k) , k = 0, 1. .. . , n - 1. Problem 9. Form of the binomial PMF. Consider a binomial random variable X with parameters n and p. Let k* be the largest integer that is less than or equal to (n + l)p. Show that the PMF px (k) is monotonically nondecreasing with k in the range from 0 to k* . and is monotonically decreasing with k for k � k* . Problem 10. Form of the Poisson PMF. Let X be a Poisson random variable with parameter A. Show that the PMF px (k) increases monotonically with k up to the point where k reaches the largest integer not exceeding A, and after that point decreases monotonically with k. Problem 11. * The matchbox problem - inspired by Banach's smoking habits. A smoker mathematician carries one matchbox in his right pocket and one in his left pocket. Each time he wants to light a cigarette, he selects a matchbox from either pocket with probability p = 1/2, independent of earlier selections. The two matchboxes have initially n matches each. What is the PMF of the number of remain­ ing matches at the moment when the mathematician reaches for a match and discovers that the corresponding matchbox is empty? How can we generalize to the case where the probabilities of a left and a right pocket selection are p and 1 - p, respectively? Problems 121 Solution. Let X be the number of matches that remain when a matchbox is found empty. For k = 0, 1, .. .. n, let Lk (or Rk) be the event that an empty box is first discovered in the left (respectively. right) pocket while the number of matches in the right (respectively, left) pocket is k at that time. The PMF of X is k = 0, 1, ... ,no Viewing a left and a right pocket selection as a \"success\" and a \"failure,\" respectively, P (Lk) is the probability that there are n successes in the first 2n - k trials, and trial 2n - k + 1 is a success. or k = 0, 1, ... ,no By symmetry. P(Lk) = P(Rk)' so px(k) = P(Lk) + P(Rk) = (2nn - k) (21 ) 2n-k k = 0. 1, .. .. n. In the more general case, where the probabilities of a left and a right pocket selection are p and 1 - p, using a similar reasoning. we obtain k = 0. 1, . . .. n. and k = 0, 1, .. . ,no which yields px(k) = P(Lk) + P(Rk) = (2n:: k) (pn+l (1 _ pt-k + pn-k(1 _ Pt+1). k = O. I , . .. . n. Problem 12.* Justification of the Poisson approximation property. Con­ sider the PMF of a binomial random variable with parameters n and p. Show that asymptotically, as n ---+ 00, p ---+ O. while np is fixed at a given value >., this PMF approaches the P1-IF of a Poisson random variable with parameter >.. Solution. Using the equation >. = np, write the binomial PMF as I px(k) = (n _ nk)! k!pk(1 - pt-k = n(n -l) ... (n -k +l) . >.k . (1 _�) n-k nk k! n 122 Discrete Random Variables Fix k and let n --> 00. We have, for j = 1, . .. . k, n-k + j 1 --> . n Thus, for each fixed k, as n --> 00 we obtain ( A) n _A 1-;; --> e . SECTION 2.3. Functions of Random Variables Chap. 2 Problem 13. A family has 5 natural children and has adopted 2 girls. Each natural child has equal probability of being a girl or a boy, independent of the other children. Find the PMF of the number of girls out of the 7 children. Problem 14. Let X be a random variable that takes values from ° to 9 with equal probability 1/10. (a) Find the PMF of the random variable Y = X mod(3) . (b) Find the PMF of the random variable Y = 5 mod(X + 1 ). Problem 15. Let K be a random variable that takes, with equal probability 1/(2n+ l), the integer values in the interval [-n, nj . Find the PMF of the random variable Y = In X. where X = alKI• and a is a positive number. SECTION 2.4. Expectation, Mean, and Variance Problem 16. Let X be a random variable with PMF ( ) { X2 la, px x = 0, (a) Find a and E[Xj . if x = -3, -2, -1 , 0, 1, 2, 3, otherwise. (b) What is the PMF of the random variable Z = (X - E[xJ) 2 ? (c) Using the result from part (b) , find the variance of X. (d) Find the variance of X using the formula var{X) = L:x (x - E[XJ) 2px(X). Problem 17. A city's temperature is modeled as a random variable with mean and standard deviation both equal to 10 degrees Celsius. A day is described as \"normal\" if the temperature during that day ranges within one standard deviation from the mean. What would be the temperature range for a normal day if temperature were expressed in degrees Fahrenheit? Problem 18. Let a and b be positive integers with a ::; b, and let X be a random variable that takes as values, with equal probability, the powers of 2 in the interval [2a, 2bj . Find the expected value and the variance of X. Problems 123 Problem 19. A prize is randomly placed in one of ten boxes, numbered from 1 to 10. You search for the prize by asking yes-no questions. Find the expected number of questions until you are sure about the location of the prize, under each of the following strategies. (a) An enumeration strategy: you ask questions of the form \"is it in box k?\" . (b) A bisection strategy: you eliminate as close to half of the remaining boxes as possible by asking questions of the form \"is it in a box numbered less than or equal to k?\" . Solution. We will find the expected gain for each strategy, by computing the expected number of questions until we find the prize. (a) With this strategy, the probability 1/10 of finding the location of the prize with i questions, where i = 1, . .. , 10, is 1/10. Therefore, the expected number of questions is 10 1� L i = 1� . 55 = 5.5. i=l (b) It can be checked that for 4 of the 10 possible box numbers, exactly 4 questions will be needed, whereas for 6 of the 10 numbers, 3 questions will be needed. Therefore, with this strategy, the expected number of questions is 4 6 - . 4 + - . 3 = 3.4. 10 10 Problem 20. As an advertising campaign, a chocolate factory places golden tickets in some of its candy bars, with the promise that a golden ticket is worth a trip through the chocolate factory, and all the chocolate you can eat for life. If the probability of finding a golden ticket is p, find the mean and the variance of the number of candy bars you need to eat to find a ticket. Problem 21. St. Petersburg paradox. You toss independently a fair coin and you count the number of tosses until the first tail appears. If this number is n, you receive 2n dollars. What is the expected amount that you will receive? How much would you be willing to pay to play this game? Problem 22. Two coins are simultaneously tossed until one of them comes up a head and the other a tail. The first coin comes up a head with probability p and the second with probability q. All tosses are assumed independent. (a) Find the PMF, the expected value, and the variance of the number of tosses. (b) What is the probability that the last toss of the first coin is a head? Problem 23. (a) A fair coin is tossed repeatedly and independently until two consecutive heads or two consecutive tails appear. Find the PMF, the expected value, and the variance of the number of tosses. 124 Discrete Random Variables Chap. 2 (b) Assume now that the coin is tossed until we obtain a tail that is immediately preceded by a head. Find the PMF and the expected value of the number of tosses. SECTION 2.5. Joint PMFs of Multiple Random Variables Problem 24. A stock market trader buys 100 shares of stock A and 200 shares of stock B. Let X and Y be the price changes of A and B. respectively. over a certain time period. and assume that the joint PMF of X and Y is uniform over the set of integers x and y satisfying -2 :::; x :::; 4, -1 :::; y -x :::; 1. (a) Find the marginal PMFs and the means of X and Y. (b) Find the mean of the trader's profit. Problem 25. A class of n students takes a test consisting of m questions. Suppose that student i submitted answers to the first ml questions. (a) The grader randomly picks one answer, call it (I, J) , where I is the student ID number (taking values 1, ... , n) and J is the question number (taking values 1. ... ,m) . Assume that all answers are equally likely to be picked. Calculate the joint and the marginal PMFs of I and J. (b) Assume that an answer to question j. if submitted by student i, is correct with probability Plj. Each answer gets a points if it is correct and gets b points otherwise. Calculate the expected value of the score of student i. Problem 26. PMF of the minimum of several random variables. On a given day. your golf score takes values from the range 101 to 110. with probability 0. 1, independent of other days. Determined to improve your score, you decide to play on three different days and declare as your score the minimum X of the scores X I , X 2, and X3 on the different days. (a) Calculate the PMF of X. (b) By how much has your expected score improved as a result of playing on three days? Problem 27. * The multinomial distribution. A die with r faces, numbered 1, .... r. is rolled a fixed number of times n. The probability that the ith face comes up on any one roll is denoted pz , and the results of different rolls are assumed independent. Let Xz be the number of times that the ith face comes up. (a) Find the joint PMF pxl ..... xr ( k1, . •• , kr) . (b) Find the expected value and variance of Xi . (c) Find E[XlXJJ for i ¥- j. Solution. (a) The probability of a sequence of rolls where, for i = 1, . . . ,r , face i comes up ki times is p�l ... p�r . Every such sequence determines a partition of the set of n rolls into r subsets with the ith subset having cardinality ki (this is the set of rolls Problems 125 for which the ith face came up). The number of such partitions is the multinomial coefficient (cf. Section 1.6) ( n ) n! kl ' .. . , kr kl ! . . . kr! • Thus, if kl + ... + kr = n, and otherwise, Pxl ..... xr(kl , .. . , kr) = O. (b) The random variable Xl is binomial with parameters n and Pt. Therefore, E[Xi] = npi, and var(Xd = npi( l - pd. (c) Suppose that i =f::. j, and let Yi•k (or Yj,k ) be the Bernoulli random variable that takes the value 1 if face i (respectively, j) comes up on the kth roll. and the value 0 otherwise. Note that Yi,kYj,k = 0, and that for l =f::. k. Yt.k and Yj.1 are independent, so that E[Yi.k Yj,l] = PiPj . Therefore, E[XlXj] = E [(Yi.l + . . . + Yt.n)(Y).1 + ... + Yj.n )] = n(n l)E[Yi,1 Yj,2] = n(n - l)PiPj . Problem 28. * The quiz problem. Consider a quiz contest where a person is given a list of n questions and can answer these questions in any order he or she chooses. Question i will be answered correctly with probability Pi. and the person will then receive a reward Vi . At the first incorrect answer, the quiz terminates and the person is allowed to keep his or her previous rewards. The problem is to choose the ordering of questions so as to maximize the expected value of the total reward obtained. Show that it is optimal to answer questions in a nonincreasing order of Pivi/(l - pd. Solution. We will use a so-called interchange argument, which is often useful in sequencing problems. Let i and j be the kth and (k + 1 )st questions in an optimally ordered list Consider the list obtained from L by interchanging the order of questions i and j. We compute the expected values of the rewards of L and L', and note that since L is optimally ordered, we have E[reward of L] � E[reward of L']. Define the weight of question i to be ( .) _ PiVi w Z - --. 1 - Pi 126 Discrete Random Variables Chap. 2 We will show that any permutation of the questions in a nonincreasing order of weights maximizes the expected reward. If L = (i 1 , . .. , in) is a permutation of the questions, define L (k) to be the permu­ tation obtained from L by interchanging questions ik and ik+ 1 . Let us first compute the difference between the expected reward of L and that of L(k) . We have and E [reward of L(k)] = pi l ViI + Pi l Pi2Vi2 + .. . + Pi l ... P1k- l Vik_ 1 + Pi } ... Pik-l Pik+l Vik+l + pil ... Plk- l Pik+ l Plk V1k + Pil . .. Pik+2 Vik+2 + .. . + Pi l . . . Pin Vin · Therefore, E [reward of L(k)] - E[reward of L] = Pi l . .. Pik _l (Pik+ l Vik+l + Pik+l Pik Vik - pik V1k - pikPik+l Vik+l ) = Pi l ... Pik- l {I - pik )( l - Pik+l ) (W{ik+l ) - W{ik)) . Now, let us go back to our problem. Consider any permutation L of the questions. If w{ik ) < W{ik+ d for some k, it follows from the above equation that the permutation L (k) has an expected reward larger than that of L. So, an optimal permutation of the questions must be in a nonincreasing order of weights. Let us finally show that any two such permutations have equal expected rewards. Assume that L is such a permutation and say that W{ik) = W{ik+ d for some k. We know that interchanging ik and ik+ l preserves the expected reward. So, the expected reward of any permutation L' in a non-increasing order of weights is equal to that of L, because L' can be obtained from L by repeatedly interchanging adjacent questions having equal weights. Problem 29.* The inclusion-exclusion formula. Let A I , A2 , . .. , An be events. Let 81 = {i 11 � i � n} , 82 = {{il ,i2) 11 � il < i2 � n} , and more generally, let 8m be the set of all m-tuples (i 1 , .. . , im ) of indices that satisfy 1 � i 1 < i2 < . . . < im � n. Show that Hint: Let Xi be a binary random variable which is equal to 1 when Ai occurs, and equal to 0 otherwise. Relate the event of interest to the random variable (I - XI ) {I - X2 ) ··· (I - Xn ) . Solution. Let us express the event B = U�= l Ak in terms of the random variables Xl , . . . , Xn . The event Be occurs when all of the random variables Xl , . . . , Xn are zero, which happens when the random variable Y = {1-XI) {I-X2) ··· (1-Xn) is equal to 1 . Problems 127 Note that Y can only take values in the set {a, I}, so that P(BC) = P(Y = 1) = E[Y] . Therefore, P(B) = 1 - E [( 1- XI )(1 - X2 )··· ( 1 - Xn)] = E[XI + .. . + Xn] - E [ L XiI Xt2] + ... + (-lr- 1 E[X1 . .. Xn]. (II ,i2)ES2 We note that E[Xd = P(Ad, E[Xil Xi2Xi3] = P(Ail n At2 n Ai3 ), E[Xil Xt2] = P(Ail n Ai2 ), E [X1 X2 ··· Xn] = p(nk=lAk), etc., from which the desired formula follows. Problem 30.* Alvin's database of friends contains n entries, but due to a software glitch, the addresses correspond to the names in a totally random fashion. Alvin writes a holiday card to each of his friends and sends it to the (software-corrupted) address. What is the probability that at least one of his friends will get the correct card? Hint: Use the inclusion-exclusion formula. Solution. Let Ak be the event that the kth card is sent to the correct address. We have for any k, j, i, etc., and P(Ak) = .!. = (n - I ) ! , n n! 1 1 (n - 2)' P(Ak n Aj ) = P(Ak)P(AJ I Ak) = - . -- = , ' . n n - 1 n. 1 1 1 (n - 3) ! P(Ak nA) nAi) = - . --. -- = I' n n - 1 n - 2 n. Applying the inclusion-exclusion formula, P (Uk=I Ak) = L P(Ai) - L P(Ail n Ai2 ) iESI (i1 ,i2)es2 + we obtain the desired probability P(Uk=I Ak) = (n) (n - I)! _ (n) (n - 2)! + (n) (n - 3)! _ ... + (-lr-l � 1 n! 2 n! 3 n! n! = 1 -� +� -\"'+ (-lr-l� 2! 3! n! ' When n is large, this probability can be approximated by 1 - e-l. 128 Discrete Random Variables Chap. 2 SECTION 2.6. Conditioning Problem 31. Consider four independent rolls of a 6-sided die. Let X be the number of Is and let Y be the number of 2s obtained. What is the joint PMF of X and Y? Problem 32. D. Bernoulli's problem of joint lives. Consider 2m persons forming m couples who live together at a given time. Suppose that at some later time, the probability of each person being alive is p, independent of other persons. At that later time. let A be the number of persons that are alive and let S be the number of couples in which both partners are alive. For any survivor number a, find E[S I A = a] . Problem 33. * A coin that has probability of heads equal to p is tossed successively and independently until a head comes twice in a row or a tail comes twice in a row. Find the expected value of the number of tosses. Solution. One possibility here is to calculate the PMF of X. the number of tosses until the game is over, and use it to compute E[X] . However, with an unfair coin, this turns out to be cumbersome. so we argue by using the total expectation theorem and a suitable partition of the sample space. Let Hk (or Tk) be the event that a head (or a tail, respectively) comes at the kth toss. and let p (respectively, q) be the probability of Hk (respectively, Tk )' Since HI and Tl form a partition of the sample space, and P(HI ) = p and P(TI ) = q, we have E[X] = pE[X I HI ] + qE[X l Td· Using again the total expectation theorem, we have E[X IHd = pE[X IHl nH2] +qE[X IHI nT2] = 2p +q (1+E[XITd) , where we have used the fact (since the game ends after two successive heads), and E[X I HI n T2] = 1 + E[X I Td (since if the game is not over. only the last toss matters in determining the number of additional tosses up to termination). Similarly, we obtain E[X I Td = 2q + p(l + E[X I Htl) · Combining the above two relations. collecting terms, and using the fact p + q = 1, we obtain after some calculation and similarly E[X I Ttl = 2 + p2 , 1- pq E[X IHd = 2+q2 1 - pq Problems Thus, E[X] = p . 2 + q2 + q. 2 + p2 , 1- pq 1- pq and finally, using the fact p + q = 1, E[X] = 2+ pq . 1- pq 129 In the case of a fair coin (p = q = 1/2), we obtain E[X] = 3. It can also be verified that 2 ::; E[X] ::; 3 for all values of p. Problem 34.* A spider and a fly move along a straight line. At each second, the fly moves a unit step to the right or to the left with equal probability p, and stays where it is with probability 1 - 2p. The spider always takes a unit step in the direction of the fly. The spider and the fly start D units apart, where D is a random variable taking positive integer values with a given PMF. If the spider lands on top of the fly, it's the end. What is the expected value of the time it takes for this to happen? Solution. Let T be the time at which the spider lands on top of the fly. We define Ad: the event that initially the spider and the fly are d units apart. Bd: the event that after one second the spider and the fly are d units apart. Our approach will be to first apply the (conditional version of the) total expectation theorem to compute E[T I Ad, then use the result to compute E[T I A2J. and similarly compute sequentially E[T I Ad] for all relevant values of d. We will then apply the (unconditional version of the) total expectation theorem to compute E[T] . We have if d > 1. This is because if the spider and the fly are at a distance d > 1 apart, then one second later their distance will be d (if the fly moves away from the spider) or d - 1 (if the fly does not move) or d - 2 (if the fly moves towards the spider). We also have, for the case where the spider and the fly start one unit apart, and Using the total expectation theorem. we obtain E[T I Ad] = P(Bd I Ad)E[T I Ad n Bd] + P(Bd- I I Ad)E[T I Ad n Bd- d + P(Bd-2 1 Ad)E[T I Ad n Bd-2], if d > 1, E[T I Ad = P(B1 I AdE[T I Al n Bd + P(Bo I At }E[T I Al n Bo] , if d = 1. It can be seen based on the problem data that P(B1 I Ad = 2p, P(Bo I Ad = 1 - 2p, 130 Discrete Random Variables E[T I Al n Bd = 1 + E[T I Ad, E[TIAI nBo] = 1, so by applying the formula for the case d = 1, we obtain or E[T I Ad = 2p(1 + E[T I Ad) + (1 - 2p), 1 E[T I Ad = 1 _ 2p By applying the formula with d = 2, we obtain We have E[T I A2 n Bo] = 1, E[T I A2 n Bd = 1 + E[T I Ad, E[T I A2 n B2] = 1 + E[T I A2], so by substituting these relations in the expression for E[T I A2], we obtain E[T I A2] = p(1 + E[T I A2J) + (1 - 2p) (1 + E[T I Ad) + p =p(I+E[TIA2J) +(1-2p) (1+ 1 � 2P) +p. This equation yields after some calculation 2 E[TI A2] = -. I - p Generalizing. we obtain for d> 2, Chap. 2 Thus, E[T I Ad] can be generated recursively for any initial distance d, using as initial conditions the values of E[T I Ad and E[T I A2] obtained earlier. Finally, the expected value of T can be obtained using the given PMF for the initial distance D and the total expectation theorem: E[T] = L PD(d)E[T I Ad]. d Problem 35.* Verify the expected value rule E [g(X, Y)] = LL g(x, y)pX,y (x, y), x y using the expected value rule for a function of a single random variable. Then, use the rule for the special case of a linear function, to verify the formula E[aX + bY] = aE[X] + bErYl, Problems 131 where a and b are given scalars. Solution. We use the total expectation theorem to reduce the problem to the case of a single random variable. In particular, we have E[g(X, Y)] = LPy(Y)E[g(X, Y) I Y = Y] y = LPy(y)E[g(X, y) I Y = Y] y y x = L L g(x, y)px.y(x, y), x y as desired. Note that the third equality above used the expected value rule for the function g(X, y) of a single random variable X. For the linear special case, the expected value rule gives E[aX + bY] = L L (ax + by )px. y (x, y) x y = a LX Lpx.y(x, y) + b LY Lpx.y(x,y) x y y x = a LXPx(x) + b L YPY(Y) x y = aE[X] + bErYl. Problem 36. * The multiplication rule for conditional PMFs. Let X, Y, and Z be random variables. (a) Show that PX.y.z(x, y, z) = px(x)PYlx(y I x)PzIX.y(z I x, y). (b) How can we interpret this formula as a special case of the multiplication rule given in Section 1.3? (c) Generalize to the case of more than three random variables. Solution. (a) We have PX.y.Z(x, y, z) = P(X = x, Y = y, Z = z) = P(X = x)P(Y = y, Z = z I X = x) = P(X = x)P(Y = y I X = x)P(Z = z I X = x, Y = y) = px(x)PYlx(y I x)PZIX.y(z I x, y). (b) The formula can be written as P(X = x, Y = y, Z = z) = P(X = x)P(Y = y I X = x)P(Z = z I X = x, Y = y), 132 Discrete Random Variables which is a special case of the multiplication rule. (c) The generalization is PXI .... ,Xn (Xl, . . . , Xn) Chap. 2 = PXI (xI)px2IxI (x2 1 xI) . .. PXnIXI ..... Xn_1 (Xn I Xl , · .. , Xn-I ). Problem 37. * Splitting a Poisson random variable. A transmitter sends out either a 1 with probability p, or a 0 with probability 1 - p. independent of earlier transmissions. If the number of transmissions within a given time interval has a Poisson P�lF with parameter A, show that the number of Is transmitted in that same time interval has a Poisson PMF with parameter pA. Solution. Let X and Y be the numbers of Is and Os transmitted, respectively. Let Z = X + Y be the total number of symbols transmitted. We have Thus, P(X = n, Y = m) = P(X = n, Y = m I Z = n + m)P(Z = n + m) = (n + m)pn(1 _ p)111 . e-'>' An+111 n (n + m)! e-'>'P(Ap)n e-.>.(l -p) (A(l _ p))111 n! m! oc P(X = n) = L P(X = n, Y = m) -'>'P( ' )n x (A(1 )) 111 = e :p e-.>.(l -p) '\"' - p n . � m! 111=0 -'>'P( ' )n _ e AP -.>.(l-p) '>'(l -p) - ,e e n. e-'>'P(Ap)n n! so that X is Poisson with parameter Ap. SECTION 2.7. Independence Problem 38. Alice passes through four traffic lights on her way to work, and each light is equally likely to be green or red. independent of the others. (a) What is the PMF, the mean, and the variance of the number of red lights that Alice encounters? (b) Suppose that each red light delays Alice by exactly two minutes. What is the variance of Alice's commuting time? Problem 39. Each morning, Hungry Harry eats some eggs. On any given morning, the number of eggs he eats is equally likely to be 1. 2, 3, 4, 5, or 6, independent of Problems 133 what he has done in the past. Let X be the number of eggs that Harry eats in 10 days. Find the mean and variance of X. Problem 40. A particular professor is known for his arbitrary grading policies. Each paper receives a grade from the set {A, A-, B+. B, B-, C+}, with equal probability, independent of other papers. How many papers do you expect to hand in before you receive each possible grade at least once? Problem 41. You drive to work 5 days a week for a full year (50 weeks) , and with probability p = 0.02 you get a traffic ticket on any given day, independent of other days. Let X be the total number of tickets you get in the year. (a) What is the probability that the number of tickets you get is exactly equal to the expected value of X? (b) Calculate approximately the probability in (a) using a Poisson approximation. (c) Any one of the tickets is $10 or $20 or $50 with respective probabilities 0.5, 0.3, and 0.2, and independent of other tickets. Find the mean and the variance of the amount of money you pay in traffic tickets during the year. (d) Suppose you don't know the probability p of getting a ticket. but you got 5 tickets during the year, and you estimate p by the sample mean p = 2�0 = 0.02. What is the range of possible values of p assuming that the difference between p and the sample mean p is within 5 times the standard deviation of the sample mean? Problem 42. Computational problem. Here is a probabilistic method for com­ puting the area of a given subset S of the unit square. The method uses a sequence of independent random selections of points in the unit square [0, 1] x [0, 1], according to a uniform probability law. If the ith point belongs to the subset S the value of a random variable Xi is set to 1, and otherwise it is set to O. Let X I, X2, ... be the sequence of random variables thus defined, and for any n, let Xl + X2 + . . . + Xn Sn = ---------------- n (a) Show that E[SnJ is equal to the area of the subset S. and that var(Sn ) diminishes to 0 as n increases. (b) Show that to calculate Sn . it is sufficient to know Sn-l and Xn , so the past values of Xk, k = 1, .. . ,n - 1, do not need to be remembered. Give a formula. (c) Write a computer program to generate Sn for n = 1, 2, ... ,10000, using the computer's random number generator, for the case where the subset S is the circle inscribed within the unit square. How can you use your program to measure experimentally the value of 1r? (d) Use a similar computer program to calculate approximately the area of the set of all (x. y) that lie within the unit square and satisfy 0 � cos 1rX + sin 1ry � 1. 134 Discrete Random Variables Chap. 2 Problem 43. * Suppose that X and Y are independent, identically distributed, geo­ metric random variables with parameter p. Show that P{X = i 1 X + Y = n) = _ 1 _, n -1 i = 1, . .. , n - 1. Solution. Consider repeatedly and independently tossing a coin with probability of heads p. We can interpret P{X = i 1 X + Y = n) as the probability that we obtained a head for the first time on the ith toss given that we obtained a head for the second time on the nth toss. We can then argue, intuitively, that given that the second head occurred on the nth toss, the first head is equally likely to have come up at any toss between 1 and n - 1. To establish this precisely, note that we have P{X - '1 X Y _ ) _ P{X = i, X + Y = n) _ P{X = i)P{Y = n - i) - 1. + -n - - . P{X + Y = n) P{X + Y = n) Also and It follows that P{X = i) = p(1 _ p)i-l, P{Y = n - i) = p{l _ p)n-i-l, for i 2: 1, for n - i 2: 1. P{X = i)P{Y = n - i) = p p , { 2{1 _ )n-2 0, if i = 1, . . . , n - 1, otherwise. Therefore, for any i and j in the range [1, n - 1] , we have P{X = i 1 X + Y = n) = P{X = j 1 X + Y = n) . Hence P{X=i IX+Y =n) = � 1 ' n - i=l , ... ,n -1 . Problem 44. * Let X and Y be two random variables with given joint PMF, and let 9 and h be two functions of X and Y, respectively. Show that if X and Y are independent, then the same is true for the random variables g{X) and h{Y). Solution. Let U = g{X) and V = h{Y). Then, we have PU,v{u, v) = L PX,y{x, y) { (x ,y) I g(x)=u , h(y)=v} - L PX (x)py{y) {(x,y) I g(x)=u, h(y)=v } - L px{x) L py{y) {x I g(x)=u} {x I h(y)=v} = Pu {u)pv (v), so U and V are independent. Problems 135 Problem 45. * Variability extremes. Let Xl , .. . , X n be independent random vari­ ables and let X = Xl + . .. + Xn be their sum. (a) Suppose that each Xl is Bernoulli with parameter pi , and that PI , ... ,pn are chosen so that the mean of X is a given /l > O. Show that the variance of X is maximized if the Pi are chosen to be all equal to /lIn. (b) Suppose that each Xi is geometric with parameter pi , and that PI , . . . ,pn are chosen so that the mean of X is a given /l > O. Show that the variance of X is minimized if the Pi are chosen to be all equal to nl/l. [Note the strikingly different character of the results of parts (a) and (b).] Solution. (a) We have n n n Thus maximizing the variance is equivalent to minimizing L� l p� . It can be seen (using the constraint L�l Pi = /l) that TI n n ;= 1 i= l 1=1 so E�=l p; is minimized when Pl = /lIn for all i. (b) We have and n n /l = L E[XiJ = L ;i ' 1= 1 1= 1 n n � � l - p · var(X) = L- var(X1 ) = L- P; 1 . t=1 1=1 Introducing the change of variables Yl = Ilpi = E[XiJ . we see that the constraint becomes n i= l and that we must minimize n n i=l i=l subject to that constraint . This is the same problem as the one of part (a) , so the method of proof given there applies. Problem 46. * Entropy and uncertainty. Consider a random variable X that can take n values. Xl .... ,Xn , with corresponding probabilities PI , . . . ,pn ' The entropy of X is defined to be n H(X) = - L pdog Pl' i=l 136 Discrete Random Variables Chap. 2 (All logarithms in this problem are with respect to base two.) The entropy H (X) provides a measure of the uncertainty about the value of X. To get a sense of this, note that H(X) ;::: 0 and that H(X) is very close to 0 when X is \"nearly deterministic,\" i.e., takes one of its possible values with probability very close to 1 (since we have plog p � 0 if either p � 0 or p � 1). The notion of entropy is fundamental in information theory, which originated with C. Shannon's famous work and is described in many specialized textbooks. For example. it can be shown that H(X) is a lower bound to the average number of yes-no questions (such as \"is X = Xl?\" or \"is X < X5?\" ) that must be asked in order to deter­ mine the value of X. Furthermore, if k is the average number of questions required to determine the value of a string of independent identically distributed random variables XI , X 2 , ... . X n. then. with a suitable strategy. kin can be made as close to H (X) as desired, when n is large. (a) Show that if ql ..... qn are nonnegative numbers such that 2:: 1 qi = 1, then H(X) � - LPdog qi ' i= 1 with equality if and only if Pi = qi for all i. As a special case, show that H(X) � log n, with equality if and only if Pt = lin for all i. Hint: Use the inequality In Q � Q - 1, for Q > 0. which holds with equality if and only if Q = 1; here In Q stands for the natural logarithm. (b) Let X and Y be random variables taking a finite number of values, and having joint PMF px.y(x, y). Define '\"' '\"' ( px.y (x. y) ) J(X, Y) = L.., L.., px.Y(x, y) log px(x)py(y) . x y Show that J(X, Y) ;::: 0, and that J(X. Y) = 0 if and only if X and Y are independent. (c) Show that where J(X. Y) = H(X) + H(Y) - H(X, Y), H(X. Y) = - L L px.y (x . y) logpx.y(x. y), x y H(X) = - LPX (x) log px (x) . H(Y) = - LPY(Y) logpy(y). x (d) Show that where J(X. Y) = H(X) - H(X I Y), y x y [Note that H(X I Y) may be viewed as the conditional entropy of X given Y, that is. the entropy of the conditional distribution of X. given that Y = y, averaged Problems 137 over all possible values y. Thus. the quantity /(X, Y) = H(X) - H(X I Y) is the reduction in the entropy (uncertainty) on X, when Y becomes known. It can be therefore interpreted as the information about X that is conveyed by Y. and is called the mutual information of X and Y.] Solution. (a) We will use the inequality In a ::; a - 1. (To see why this inequality is true. write In a = flo (3- 1 d{3 < flO d{3 = a - 1 for a > 1. and write In a = - f� (3-l d{3 < - f� dB = a - 1 for 0 < a < 1.) We have with equality if and only if Pt = qt for all i. Since In p = log p in 2. we obtain the desired relation H(X) ::; - E:l Pi log q,. The inequality H(X) ::; logn is obtained by setting qi = lin for all i. (b) The numbers px (x)py (y) satisfy Ex Ey px (x)PY (Y) = 1. so by part (a), we have L L px.y (x. y) log(px.y (x, y)) � L L px.y (x. y) log(px (x)py (y)) , x y with equality if and only if x y px.y (x, y) = Px (x)py (y), for all x and y, which is equivalent to X and Y being independent. (c) We have /(X, Y) = L L PX,y (x, y) logpx.y (x. y) - L L px.y (x, y) log(px (x)py (y)) , and x y x y L L px.y (x. y) 10gpx,Y (x. y) = -H(X, Y) . x y - L L px.y (x, y) log(px (x)py(y)) = - L L px.y (x, y) logpx (x) x y x y - L L px.y (x. y) logpy (y) x y = - L Px (x) logpx (x) - L py (y) logpy (y) x y = H(X) + H(Y) . Combining the above three relations, we obtain /(X, Y) = H(X) + H(Y) - H(X. Y). 138 Discrete Random Variables (d) From the calculation in part (c), we have [(X, Y) = LL PX,y(x, y)logpX,Y (x, y) - LPx (x)logpx (x) x y - L LPX,Y (x, y) logpy (y) x y \"\" \"\" (PX,y(X, y») = H(X) + L..,; L..,; PX,y(x, y) log py(y) x y = H(X) + L LPY (y)PX,Y (x I y) logPxlY (x I y) x y = H(X) - H(X I Y) . Chap. 2 3 General Random Variable s Contents 3.1. Continuous Random Variables and PDFs 3.2. Cumulative Distribution Functions . . . 3.3. Normal Random Variables ...... . 3.4. Joint PDFs of Multiple Random Variables 3.5. Conditioning ..... . 3.6. The Continuous Bayes' Rule 3.7. Summary and Discussion Problems ........ . · p. 140 · p. 148 · p. 153 · p. 158 · p. 164 · p. 178 · p. 182 · p. 184 139 140 General Random Variables Chap. 3 Random variables with a continuous range of possible values are quite common; the velocity of a vehicle traveling along the highway could be one example. If the velocity is measured by a digital speedometer, we may view the speedometer's reading as a discrete random variable. But if we wish to model the exact velocity, a continuous random variable is called for. Models involving continuous random variables can be useful for several reasons. Besides being finer-grained and pos­ sibly more accurate, they allow the use of powerful tools from calculus and often admit an insightful analysis that would not be possible under a discrete model. All of the concepts and methods introduced in Chapter 2, such as expec­ tation, PMFs, and conditioning, have continuous counterparts. Developing and interpreting these counterparts is the subject of this chapter. 3.1 CONTINUOUS RANDOM VARIABLES AND PDFS A random variable X is called continuous if there is a nonnegative function f x, called the probability density function of X, or PDF for short, such that P(X E B) = 1 fx(x) dx, for every subset B of the real line. t In particular, the probability that the value of X falls within an interval is P(a X < b) = f.b fx(x) dx, and can be interpreted as the area under the graph of the PDF (see Fig. 3. 1). For any single value a, we have P (X = a) = fa a fx{x) dx = O. For this reason, including or excluding the endpoints of an interval has no effect on its probability: P(a � X � b) = P(a < X < b) = P(a < X < b) = P(a < X � b) . Note that to qualify as a PDF, a function fx must be nonnegative, I.e. , fx(x) ;:::: 0 for every x, and must also have the normalization property I: fx{x)dx = P(-oc < X < oc) = 1. t The integral fB Ix (x) dx is to be interpreted in the usual calculus/Riemann sense and we implicitly assume that it is well-defined. For highly unusual functions and sets, this integral can be harder or even impossible - to define, but such issues belong to a more advanced treatment of the subject. In any case, it is comforting to know that mathematical subtleties of this type do not arise if Ix is a piecewise continuous function with a finite or countable number of points of discontinuity, and B is the union of a finite or countable number of intervals. 3. 1 ( X that X takes a value in an is the shaded area in x 6] (t) · 8, 3.2: of the \"pr'o o,aOlHt\\ m ass per around x. If 6 is very that X takes x + 0] is which is 6. if 0 :::; X :::; 1, must .\", PDF fx Cr ) 1 b- a a for some constant c. property 1 = 100 -00 so c = 1. b .1' constant can (x) General Random Variables 3.3: The PDF a uni­ form random variable . = c, 3 tvlore generally, we can consider a random variable X that takes values in an interval [a, b] ) again assume that two subintervals of the same length to as or Ix (x) = { � a j 0, if a � x � b, (cf. Fig. constant value of the normal ization property. Indeed , we have within b] is determined from the 1= Ix dx = Ib 1 b- a a. PDF. Alvin's driving between 20 case. is sunny 1/3. the driving time, as a random variable X? We interpret the statement \"all ti mes are equally likely\" in the sunny cases , to mean is constant [15, 20] and [20, 25] . Furthermore, since these two intervals contain PDF zero \"'''L�r'UUIJ C2 are some constants. of a sunny 2 120 :3 = P(sunny day) = 15 if 15 ::; x < 20, if 20 ::; x ::; 25, (x) 120 = Cl 15 constants 3. 1 so rI • • , I' 3.4: A piecewise constant PDF involving three intervals. 1 125 3 = P ( rainy day) = 20 (x) 125 = C2 20 1 2 15 ' C2 = -. COl1Sl(]er a ....... £l.f>'O'IU .C' 'O constant form = { ��! if a, � x <ai+ l l i= I, 2, ... ,n -I , a 1 ) a2 : ' - . ) an are some with at < ai+ 1 for all i, and Cl, C2, ... ) Cn are constants by as in must be such that the normalization 1n.rr.nLll 'l\"Y n-l 1ai+1 n-l 1 = (x) dx = Ci dx = ci (ai+ l - ad. i= l ai i=l !X (X) = { 1 O. if 0 < x ::; 1, determined a becomes infinitely large as x approaches zero� this is still a valid 1: fx (x) = [ 144 General Random Variables Summary of PDF Properties Let X be a continuous random variable with PDF f x . • fx(x) � 0 for all x. · I: fx(x) dx = l. • If 8 is very small, then P ([x, x + 8]) � f x (x) . 8. • For any subset B of the real line, P(X E B) = fa fx(x) dx. Expectation Chap. 3 The expected value or expectation or mean of a continuous random variable X is defined by t E[X] = I: xfx(x) dx. This is similar to the discrete case except that the PMF is replaced by the PDF, and summation is replaced by integration. As in Chapter 2. E[X] can be inter­ preted as the \"center of gravity\" of the PDF and, also. as the anticipated average value of X in a large number of independent repetitions of the experiment. Its mathematical properties are similar to the discrete case - after all, an integral is just a limiting form of a sum. If X is a continuous random variable with given PDF. any real-valued function Y = g(X) of X is also a random variable. Note that Y can be a continuous random variable: for example, consider the trivial case where Y = g(X) = X. But Y can also tUrn out to be discrete. For example. suppose that t One has to deal with the possibility that the integral f�oc> xix (x) dx is infi­ nite or undefined. More concretely. we will say that the expectation is well-defined if f�x Ixlix (x) dx < ce. In that case, it is known that the integral f�Xi xix (x) dx takes a finite and unambiguous value. For an example where the expectation is not well-defined. consider a random variable X with PDF ix (x) = c/(l + x2), where c is a constant chosen to enforce the normalization condition. The expression Ixlix (x) can be approximated by c/lxl when Ixl is large. Using the fact fiX (Ilx) dx = x. one can show that r::=x Ixlix (x) dx = :)c. Thus. E[X] is left undefined. despite the symmetry of the PDF around zero. Throughout this book. in the absence of an indication to the contrary, we implic­ itly assume that the expected value of any random variable of interest is well-defined. Sec. 3. 1 Continuous Random Variables and PDFs 145 g(x) = 1 for x > O. and g(x) = O. otherwise. Then Y = g(X) is a discrete random variable taking values in the finite set {O. I}. In either case. the mean of g(X) satisfies the expected value rule E[g(X)] = I: g(x)fx(x) dx, in complete analogy with the discrete case; see the end-of-chapter problems. The nth moment of a continuous random variable X is defined as E[xn] . the expected value of the random variable Xn. The variance. denoted by var(X ) . is defined as the expected value of the random variable (X - E[X]) 2 . We now summarize this discussion and list a number of additional facts that are practically identical to their discrete counterparts. Expectation of a Continuous Random Variable and its Properties Let X be a continuous random variable with PDF fx. • The expectation of X is defined by E[X] = I: xfx(x) dx. • The expected value rule for a function g(X) has the form E[g(X)] = I: g(x)fx(x) dx. • The variance of X is defined by var(X) = E[(X - E[X]) 2] = i: (x - E[X]) 2 fx(x) dx. • We have 0::; var(X) = E[X2]- (E[X]) 2 . • If Y = aX + b, where a and b are given scalars, then E[Y] = aE[X] + b, var(Y) = a2var(X) . Example 3.4. Mean and Variance of the Uniform Random Variable. Consider a uniform PDF over an interval [a. b]. as in Example 3. 1. \\Ve have jx {b E[X] = _ = xfx {x) dx = 1a X · b � a dx 146 = _1 _. !X21 b b - a 2 a 1 b2 - a2 --. --- b-a 2 a + b - 2- ' General Random Variables as one expects based on the symmetry of the PDF around (a + b)/2. Chap. 3 To obtain the variance, we first calculate the second moment. We have E[X2] = _x _ dx = __ x2 dx lb 2 1 lb b-a b-a a a Thus, the variance is obtained as (a + b)2 _ (b - a)2 after some calculation. Exponential Random Variable 4 - 12 An exponential random variable has a PDF of the form { Ae- AX if x > ° fx(x) = 0, ' otherwi�e, where A is a positive parameter characterizing the PDF (see Fig. 3.5). This is a legitimate PDF because 100 fx(x) dx = roo Ae-AX dx = _e_.xxI OO = 1. -00 io 0 Note that the probability that X exceeds a certain value decreases exponentially. Indeed, for any a > 0, we have An exponential random variable can, for example, be a good model for the amount of time until an incident of interest takes place, such as a message 3. 1 J ... large A o o 3.5: The PDF of an eXJ:;lon��ntlal random variabl e. a for the time being we will analytically. the can be 1 E[X] = � ' 1 var(X ) = ,.\\2 ' can be verified by straightforward E[X] = == 0 - 1 - �. o ..... ....... .. 1& ....., ..... as we now by the second I S E[X2] = [10 = ( Ax )I: + 100 2 = 0 - ,.\\ 2 147 148 General Random Variables Finally, using the formula var(X) = E[X2] - (E[X]) 2 . we obtain 2 1 1 var(X) = ,,\\2 - ,,\\2 = ,,\\2 ' Chap. 3 Example 3.5. The time until a small meteorite first lands anywhere in the Sahara desert is modeled as an exponential random variable with a mean of 10 days. The time is currently midnight. What is the probability that a meteorite first lands some time between 6 a.m. and 6 p.m. of the first day? Let X be the time elapsed until the event of interest, measured in days. Then, X is exponential, with mean 1/>. = 10, which yields >. = 1/10. The desired probability is P(1/4 � X � 3/4) = P(X � 1/4) - P(X > 3/4) = e-I/40 - e-3/40 = 0.0476. where we have used the formula P(X � a) = P(X > a) = e-..\\a. 3.2 CUMULATIVE DISTRIBUTION FUNCTIONS We have been dealing with discrete and continuous random variables in a some­ what different manner. using PMFs and PDFs, respectively. It would be desir­ able to describe all kinds of random variables with a single mathematical concept. This is accomplished with the cumulative distribution function, or CDF for short. The CDF of a random variable X is denoted by F x and provides the probability P(X ::; x). In particular, for every x we have if X is discrete, Fx(x) = P(X ::; x) = if X is continuous. Loosely speaking, the CDF Fx(x) \"accumulates\" probability \"up to\" the value x. Any random variable associated with a given probability model has a CDF, regardless of whether it is discrete or continuous. This is because {X ::; x} is always an event and therefore has a well-defined probability. In what follows, any unambiguous specification of the pro babili ties of all events of the form {X ::; .r}, be it through a PMF, PDF, or CDF. will be referred to as the probability law of the random variable X. Figures 3.6 and 3.7 illustrate the CDFs of various discrete and continuous random variables. From these figures, as well as from the definition, some general properties of the CDF can be observed. o ... .. r\" . .... · ... the formulA. and has a staircase mass. Note t h at at the of the two COl:re5pcmd 1 b- a 2 :r < o 2 3 <:1 1 ............ ....... .. ---- variables. The CDF 15 re l ated to the at the .... \" .... -.� 3 . 7: CDFs of some continuous random variables. The CDF is related to the PDF the tl\"\\T'lrn ul� < Thus. the PDF x can be obtai ned from the CDF For a co n t i nuou s random the CDF has no dt . Le .. it is continuous. 149 150 General Random Variables Chap. 3 Properties of a CDF The CDF Fx of a random variable X is defined by Fx(x) = P(X ::; x), for all x, and has the following properties. • F x is monotonically nondecreasing: if x ::; y, then Fx(x) < Fx(y). • Fx(x) tends to 0 as x - -00, and to 1 as x - 00 . • If X is discrete, then Fx(x) is a piecewise constant function of x. • If X is continuous, then Fx(x) is a continuous function of x. • If X is discrete and takes integer values, the PMF and the CDF can be obtained from each other by summing or differencing: k Fx(k) = L px(i), i= - oo px(k) = P(X ::; k) - P(X ::; k - 1) = Fx(k) - Fx(k - 1) , for all integers k. • If X is continuous, the PDF and the CDF can be obtained from each other by integration or differentiation: Fx(x) = [ X oo /x(t) dt, dFx /x(x) = dx (x). (The second equality is valid for those x at which the PDF is contin­ uous.) Sometimes, in order to calculate the PMF or PDF of a discrete or contin­ uous random variable. respectively. it is more convenient to first calculate the CDF. The systematic use of this approach for functions of continuous random variables will be discussed in Section 4. 1. The following is a discrete example. Example 3.6. The Maximum of Several Random Variables. You are al­ lowed to take a certain test three times. and your final score will be the maximum Sec. 3. 2 Cumulative Distribution Functions 151 of the test scores. Thus, where XI ,X2.X3 are the three test scores and X is the final score. Assume that your score in each test takes one of the values from 1 to 10 with equal probability 1/10, independently of the scores in other tests. What is the PMF px of the final score? We calculate the PMF indirectly. We first compute the CDF Fx and then obtain the PMF as px (k) = Fx (k) - Fx (k - 1), k = 1, ... , 10. We have Fx (k) = P(X � k) = P(XI � k, X2 � k, X3 � k) = P(XI � k) P(X2 � k) P(X3 � k) = (1�) 3 where the third equality follows from the independence of the events { Xl � k}, {X2 � k}, {X3 � k}. Thus, the PMF is given by (k) 3 (k - 1)3 px (k) = 10 - --w- k = 1. .... 10. The preceding line of argument can be generalized to any number of random variables Xl ..... Xn . In particular, if the events {Xl � x} .... , {Xn � X} are independent for every x, then the CDF of X = max{XI , .... Xn } is Fx (x) = FX I (x) .. . FXn (x). From this formula, we can obtain px (x) by differencing (if X is discrete) , or fx (x) by differentiation (if X is continuous). The Geometric and Exponential CDFs Because the CDF is defined for any type of random variable, it provides a conve­ nient means for exploring the relations between continuous and discrete random variables. A particularly interesting case in point is the relation between geo­ metric and exponential random variables. Let X be a geometric random variable with parameter Pi that is, X is the number of trials until the first success in a sequence of independent Bernoulli trials, where the probability of success at each trial is p. Thus, for k = 1, 2, .. \" we have P(X = k) = p(l - p)k- l and the CDF is given by � l-( l- p)n Fgeo (n) = L..,.. p( 1 - p)k-l = p 1 _ (1 _ p) = 1 - (1 - p)n , k=l for n = 1, 2, ... . 15 2 3 < x> 1 1 o 3. 8: and the eXIJO[ten'tlal We (n), n = 1. 2, ... , where 6 is chosen so that e-'\\o = I- p. As 6 ra.ndom variable can be two 1- so are n 1, to or ......... . \"' .............. if it 1 - --- dx = 1 3.9: A normal PDF and with IJ. = 1 and 1 . We observe that the PDF is around its mean 11-, a nd has a characteristic bell As x further from 11. the term e- decreases very In this the PDF is very dose to zero outside the interval 1,3] Inean can e- dy so Inean can we 153 a 154 General Random Variables Chap. 3 The last equality above is obtained by using the fact -- e-y2 /2 dy = 1, 1 100 J27T -00 which is just the normalization property of the normal PDF for the case where Il = 0 and (j = 1. A normal random variable has several special properties. The following one is particularly important and will be justified in Section 4. 1. Normality is Preserved by Linear Transformations If X is a normal random variable with mean Il and variance (j2, and if a =f. 0, b are scalars, then the random variable Y = aX +b is also normal, with mean and variance E[Y] = all + b, var(Y) = a2(j2 . The Standard Normal Random Variable A normal random variable Y with zero mean and unit variance is said to be a standard normal. Its CDF is denoted by cI>: 1 1Y 2 cI>(y) = P(Y ::; y) = P(Y < y) =!lC e-t /2 dt. V 27r -00 It is recorded in a table (given in the next page), and is a very useful tool for calculating various probabilities involving normal random variables; see also Fig. 3. 10. Note that the table only provides the values of cI>(y) for y � 0, because the omitted values can be found using the symmetry of the PDF. For example, if Y is a standard normal random variable, we have cI>( -0.5) = P(Y ::; -0.5) = P(Y � 0.5) = 1 - P(Y < 0.5) = 1 - cI>(0.5) = 1 - .6915 = 0.3085. More generally, we have cI>( -y) = 1 - <I>(y) , for all y. Sec. 3.3 Normal Random Variables 155 .00 .01 .02 .03 .04 .05 .06 .07 .08 .09 0.0 .5000 .5040 .5080 .5120 .5160 .5199 .5239 .5279 .5319 .5359 0. 1 .5398 .5438 .5478 .5517 .5557 .5596 .5636 .5675 .5714 .5753 0.2 .5793 .5832 .5871 .5910 .5948 .5987 .6026 .6064 .6 103 .614 1 0.3 .6179 .6217 .6255 .6293 .633 1 .6368 .6406 .6443 .6480 .6517 0.4 .6554 .6591 .6628 .6664 .6700 .6736 .6772 .6808 .6844 .6879 0.5 .6915 .6950 .6985 .7019 .7054 .7088 .7123 .7157 .7190 .7224 0.6 .7257 .7291 .7324 .7357 .7389 .7422 .7454 .7486 .7517 .7549 0.7 .7580 .7611 .7642 .7673 .7704 .7734 .7764 .7794 .7823 .7852 0.8 .7881 .7910 .7939 .7967 .7995 .8023 .8051 .8078 .8106 .8133 0.9 .8159 .8186 .82 12 .8238 .8264 .8289 .8315 .8340 .8365 .8389 1.0 .8413 .8438 .846 1 .8485 .8508 .8531 .8554 .8577 .8599 .8621 1.1 .8643 .8665 .8686 .8708 .8729 .8749 .8770 .8790 .8810 .8830 1.2 .8849 .8869 .8888 .8907 .8925 .8944 .8962 .8980 .8997 .9015 1.3 .9032 .9049 .9066 .9082 .9099 .91 15 .9131 .9147 .9162 .9177 1.4 .9192 .9207 .9222 .9236 .9251 .9265 .9279 .9292 .9306 .9319 1.5 .9332 .9345 .9357 .9370 .9382 .9394 .9406 .94 18 .9429 .9441 1.6 .9452 .9463 .9474 .9484 .9495 .9505 .9515 .9525 .9535 .9545 1.7 .9554 .9564 .9573 .9582 .9591 .9599 .9608 .9616 .9625 .9633 1.8 .9641 .9649 .9656 .9664 .9671 .9678 .9686 .9693 .9699 .9706 1.9 .9713 .9719 .9726 .9732 .9738 .9744 .9750 .9756 .9761 .9767 2.0 .9772 .9778 .9783 .9788 .9793 .9798 .9803 .9808 .9812 .9817 2.1 .9821 .9826 .9830 .9834 .9838 .9842 .9846 .9850 .9854 .9857 2.2 .986 1 .9864 .9868 .9871 .9875 .9878 .9881 .9884 .9887 .9890 2.3 .9893 .9896 .9898 .9901 .9904 .9906 .9909 .9911 .9913 .9916 2.4 .9918 .9920 .9922 .9925 .9927 .9929 .9931 .9932 .9934 .9936 2.5 .9938 .9940 .9941 .9943 .9945 .9946 .9948 .9949 .9951 .9952 2.6 .9953 .9955 .9956 .9957 .9959 .9960 .9961 .9962 .9963 .9964 2.7 .9965 .9966 .9967 .9968 .9969 .9970 .9971 .9972 .9973 .9974 2.8 .9974 .9975 .9976 .9977 .9977 .9978 .9979 .9979 .9980 .9981 2.9 .998 1 .9982 .9982 .9983 .9984 .9984 .9985 .9985 .9986 .9986 3.0 .9987 .9987 .9987 .9988 .9988 .9989 .9989 .9989 .9990 .9990 3.1 .9990 .9991 .9991 .9991 .9992 .9992 .9992 .9992 .9993 .9993 3.2 .9993 .9993 .9994 .9994 .9994 .9994 .9994 .9995 .9995 .9995 3.3 .9995 .9995 .9995 .9996 .9996 .9996 .9996 .9996 .9996 .9997 3.4 .9997 .9997 .9997 .9997 .9997 .9997 .9997 .9997 .9997 .9998 The standard normal table. The entries in this table provide the numerical values of �(y) = P(Y :::; y), where Y is a standard normal random variable, for y between 0 and 3.49. For example, to find �( 1.71), we look at the row corresponding to 1.7 and the column corresponding to 0.01 . so that �(1 .71) = .9564. When y is negative. the value of �(y) can be found using the formula �(y) = 1 - �( -y) . General Randolll Variables by y = _X_-_Il , Y is a it is normal . -1-1 - --=----=--- = 0, var(Y) = --- = 1. a Thus, Y is a standard normal random variable. This the probability of any event defi ned in of X: we of and then use the st andard nonnal t able. IvIean = 0 = 1 Figure 3. 10: The PDF (y) = 1 Chap. 3 y of the standard normal random variable. The correslDorld noted by <1>, is recorded in a table. which is de- Example 3.7. Usi ng the Normal Table. The annual snowfall at a particular location is modeled as a normal random with a mean of j.L = 60 a (J = is that snowfall will be at least 80 inches? X snow accumulation, viewed as a normal random variable, and y = X - J1 = _ X _ - _ 6 _ 0 , (J be the corresponding standard normal random variable. We have P (X > 80) = P (X - 60 > 80 - 60) = - 20 - 20 (y > 80 - 60) = - 20 where 4> is the CDF of the standard normal. We read the value 4>(1 ) from the table: 4l( 1) = 0.84 13, Sec. 3.3 Normal Random Variables 157 so that P(X � 80) = 1 - cIl(l) = 0. 1587. Generalizing the approach in the preceding example, we have the following procedure. CDF Calculation for a Normal Random Variable For a normal random variable X with mean Jl and variance 0'2, we use a two-step procedure. (a) \"Standardize\" X, i.e., subtract Jl and divide by a to obtain a standard normal random variable Y. (b) Read the CDF value from the standard normal table: P(X S x) = P ( X ; /l < x : /l) = P (y < x u /l) = 1> (x : /l) . Normal random variables are often used in signal processing and communi­ cations engineering to model noise and unpredictable distortions of signals. The following is a typical example. Example 3.8. Signal Detection. A binary message is transmitted as a signal s, which is either -l or + 1. The communication channel corrupts the transmission with additive normal noise with mean J-L = 0 and variance a2 • The receiver concludes that the signal -1 (or + 1) was transmitted if the value received is < 0 (or � 0, respectively); see Fig. 3. 11 . What is the probability of error? An error occurs whenever -1 is transmitted and the noise N is at least 1 so that s + N = -1 + N � 0, or whenever + 1 is transmitted and the noise N is smaller than -1 so that s + N = 1 + N < O. In the former case, the probability of error is P(N � 1) = 1 _ P(N < 1) = 1 _ P ( N ; J-L < 1 : J-L) = l_ cIl ( l : J-L) = l-cIl (�) . In the latter case, the probability of error is the same, by symmetry. The value of cIl(l/a) can be obtained from the normal table. For a = 1, we have cIl(l/a) = cIl(1) = 0.8413, and the probability of error is 0.1587. Normal random variables play an important role in a broad range of proba­ bilistic models. The main reason is that. generally speaking, they model well the additive effect of many independent factors in a variety of engineering, physical. and statistical contexts. Mathematically, the key fact is that the sum of a large shaded is transmitted . -1 if N<O 3.8. The area of the of er ror in the two cases where -1 and + 1 3 number independent identically distributed (not necessarily normal) ran­ dom variables has an approximately normal cnp, of the cnp of the theorem� which will be discussed of a PDF to the case multiple random variables. parallel the discrete case . that two cont inuous random are can be we uce j oint , interpretation as PDF Jx.Y if fx.Y is a nonnegative function that satisfies ((X� Y) E (x, y) dx saIne of a joint of two-dimensional that the integrat ion is carried ove r the set B. In the \"\"\", ,,, U..IAA above Ineans case where B is a of == { (x: y) I a � x � b, c :::; y ::; d} , we d b P(a :-::: X :-::: b, c :-::: Y :-::: d) = 11 fx.Y Y) Sec. 3.4 Joint PDFs of Multiple Random Variables 159 Furthermore, by letting B be the entire two-dimensional plane, we obtain the normalization property 1:1: fx.y(x,y) dxdy = 1. To interpret the joint PDF, we let 0 be a small positive number and consider the probability of a small rectangle. We have lc+6 1a+6 P(a < X < a+o, c ::; Y < c+o) c a fX'y(x,y)dxdy � fx.Y(a,c)·o2, so we can view fx,Y(a, c) as the \"probability per unit area\" in the vicinity of (a. c). The joint PD F contains all relevant probabilistic information on the random variables X, Y, and their dependencies. It allows us to calculate the probability of any event that can be defined in terms of these two random variables. As a special case, it can be used to calculate the probability of an event involving only one of them. For example, let A be a subset of the real line and consider the event {X E A}. We have P(X E A) = p(X E A and Y E ( - 00 , (0)) = i I: fx,Y(x, y) dydx. Comparing with the formula P(X E A) = i fx(x) dx. we see that the marginal PDF fx of X is given by fx{x) = i: fx.y(x, y) dy. Similarly, fy(y) = 1: fx,y{x, y) dx. Example 3.9. Two-Dimensional Uniform PDF. Romeo and Juliet have a date at a given time, and each will arrive at the meeting place with a delay between o and 1 hour (recall the example given in Section 1.2). Let X and Y denote the delays of Romeo and Juliet, respectively. Assuming that no pairs (x. y) in the unit square are more likely than others, a natural model involves a joint PDF of the form { c. if 0 S x S 1 and 0 S y S I, /x.y (x, y) = 0, otherwise, 3 where c is a constant. th is to y) = I , we must have c == 1. is an a us some S of two-dimensional plane. The corresponding uniform joint PDF on S is deft ned to be { area lof S! O. any set A C ((X. Y) E A) = J Jfx,y y) (:r· Y) EA Y) if Y) E otherwise. in A is area of A = ---- Example are told that the jOint PDF of the random variables X and Y is a constant c on the set S 3. and is zero We wish to Y. fx .y (x, y) = c = 1/4, for y) E marginal PDF f X (x) for SOIne particular Xl we (with respect to y) the joint PDF over the vertical. ]ine correspond ing to that x. is We can 2 1 3.12: The joint PDF in Example 3.10 and the resulting margi nal PDFs. 161 Example 3.1 1. Buffon 's the This is a famous example, wh ich marks the is . Suppose that we a needle of length l on the What is the probability that the needle will intersect one of the lines? 3.13 : BuH'on 's need le. The C'fll ... .... 'nln .. between the of the need le and the of intersection of the axis of the needle with the closest paral le] line is sin 9. The needle will intersect the closest par- allel line if and only if t his is less than l/2. 1 < d so that cannot two the vertical dist.ance from the midpoint of the needle to e (X. with a uniform joint d/2. 0 � () � 11\"/2} , so that can only if so (x, O) = { 4/(7rd}. if x E [0, d/2] otherwise. seen from 3. of the .. ..... ..... UI ..... will x < � sin - 2 is (jE one of the li nes if and (X ::; (l/2) sin e) = Ix .s B) dB t This problem was posed and solved in 1 A num ber of of the problem have been by the French naturalist Buffon. y\"-\"', \"'''l''o ..... ... . '-''-'' . induding the case where as a basis for experimental evaluations of 11\" ( among others, it named 11\" experimentally in War). simulation programs for computin g 11\" usi n g Buffon 's ideas. 162 General Random Variables 4 1Tf/21(1/2)Sin9 ; --d dx dO 7r 0 0 4 1Tf/2 l = 7rd 0 2 sin OdO 2l ITf 12 = --( - cos O) 7rd 0 21 7rd ' Chap. 3 The probability of intersection can be empirically estimated, by repeating the ex­ periment a large number of times. Since it is equal to 2l/7rd, this provides us with a method for the experimental evaluation of 7r. Joint CDFs If X and Y are two random variables associated with the same experiment, we define their joint CDF by Fx,Y(x, y) = P(X � X, Y < y). As in the case of a single random variable, the advantage of working with the CDF is that it applies equally well to discrete and continuous random variables. In particular, if X and Y are described by a joint PDF j X,Y, then Conversely, the PDF can be recovered from the CDF by differentiating: 82FX,Y jx,Y(x,y) = 8x8y (x, y). Example 3.12. Let X and Y be described by a uniform PDF on the unit square. The joint CDF is given by Fx.y(x, y) ; P(X � x, Y � y) xy, We then verify that for 0 :5 x, y � 1. ;)2 Fx,y tf (xy) axay (x, y) = axay (x, y) = 1 = /x.y (x, y) , for all (x, y) in the unit square. Sec. 3.4 Joint PDFs of Multiple Random Variables 163 Expectation If X and Y are jointly continuous random variables and 9 is some function, then Z = g(X, Y) is also a random variable. We will see in Section 4. 1 methods for computing the PDF of Z, if it has one. For now, let us note that the expected value rule is still applicable and E[g(X, Y)] = I: I: g(x, y)fx,y(x, y) dxdy. As an important special case, for any scalars a, b, and c, we have E[aX + bY + c] = aE[X] + bErYl + c. More than Two Random Variables The joint PDF of three random variables x, Y, and Z is defined in analogy with the case of two random variables. For example, we have P((X, Y, Z) E B) = j j jfx,y,z(x,y, z) dxdydz, (x,y ,z )EB for any set B. We also have relations such as and fx,Y(x, y) = I: fx,Y,z(x, y, z) dz, fx(x) = I: I: fx,Y.z(x, y, z) dydz. The expected value rule takes the form E[g(X, Y, Z)] = I: I: I: g(x, y, z)fx.Y,z(x, y, z) dxdydz, and if 9 is linear, of the form aX + bY + cZ, then E[aX + bY + cZ] = aE[X] + bErYl + cE[Z] . Furthermore, there are obvious generalizations of the above to the case of more than three random variables. For example, for any random variables Xl, X2, . . . , X n and any scalars aI, a2 ... . , an , we have 164 General Random Variables Chap. 3 Summary of Facts about Joint PDFs Let X and Y be jointly continuous random variables with joint PDF /x,y. • The joint PDF is used to calculate probabilities: p((X, Y) E B) = J J /x,y(x, y) dxdy. (x,y)EB • The marginal PDFs of X and Y can be obtained from the joint PDF, using the formulas /x(x) = I: /x.y(x, y) dy, /y(y) = i: /x.y(x, y) dx. • The joint CDF is defined by Fx,Y(x, y) = P(X ::; x, Y ::; y), and determines the joint PDF through the formula 82FX Y /x,y(x, y) = 8x8� (x, y), for every (x, y) at which the joint PDF is continuous. • A function g(X, Y) of X and Y defines a new random variable, and E [g(X, Y)] = I: 1: g(x, Y)/X,y(x, y) dx dy. If 9 is linear, of the form aX + bY + c, we have E[aX + bY + c] = aE[X] + bErYl + c. • The above have natural extensions to the case where more than two random variables are involved. 3.5 CONDITIONING Similar to the case of discrete random variables. we can condition a random variable on an event or on another random variable, and define the concepts of conditional PDF and conditional expectation. The various definitions and formulas parallel the ones for the discrete case, and their interpretation is similar, except for some subtleties that arise when we condition on an event of the form {Y = y}, which has zero probability. Sec. 3.5 Conditioning 165 Conditioning a Random Variable on an Event The conditional PDF of a continuous random variable X, given an event A with P(A) > 0, is defined as a nonnegative function fXIA that satisfies P(X E B I A) = is fXIA(X) dx, for any subset B of the real line. In particular, by letting B be the entire real line, we obtain the normalization property so that fXIA is a legitimate PDF. In the important special case where we condition on an event of the form {X E A}, with P(X E A) > 0, the definition of conditional probabilities yields P(X B I X A) = P(X E B, X E A) E E P(X E A) r fx(x) dx JAnB P(X E A) By comparing with the earlier formula, we conclude that { fx (x) fXI{XEA}(X) = P(X E A) . 0, if x E A, otherwise. As in the discrete case, the conditional PDF is zero outside the conditioning set. Within the conditioning set , the conditional PDF has exactly the same shape as the unconditional one, except that it is scaled by the constant factor l/P(X E A), so that fXI{XEA} integrates to 1; see Fig. 3. 14. Thus, the conditional PDF is similar to an ordinary PDF, except that it refers to a new universe in which the event {X E A} is known to have occurred. Example 3.13. The Exponential Random Variable is Memoryless. The time T until a new light bulb burns out is an exponential random variable with parameter A. Ariadne turns the light on, leaves the room, and when she returns, t time units later. finds that the light bulb is still on. which corresponds to the event A = {T > t}. Let X be the additional time until the light bulb burns out. What is the conditional CDF of X. given the event A? We have, for x � O. P(X > x I A) = P(T > t + x IT> t) = P(T > �7; :�� T> t) P(T > t + x) P(T > t) - .>. x =e 166 3.1 4 : The unconditional P DF Ix and the conditional PD F Ix where A is the interval [a, b] . Note that within cond itioning event I {X E A} retains the same shape as Ix ! except that it is scaled along the vertical axis. 3 where we have used the expression for the CDF of an exponential random variable of X is .... \"' .... , ..... .... ....,. ...,. .. of the t ime t that elapsed between the lighting of the bulb and Ariadne's arrival . is known as the memorylessness property of the exponential . General ly, if we remaining time up to completion operation started. by an ..... .I ... � ... ...., AA ...... &A'�U .... When variables are Suppose , for a similar notion are jointly .. c.A, ...., .. ......... . with joint probability event of the form := { (X! y) == { (x) = two provide one 0, f x I y. If we condition on a E A}, we have can method for obtaining the PDF of a random variable X {X E A}, is is not of terms of multiple random variables. finally which conditional of the total probability , ••• 1 form a Sec. 3.5 Conditioning 167 the sample space, then n !x (x) = L P(Ai)!XIAi (x) . i=l To justify this statement, we use the total probability theorem from Chapter 1, and obtain 11 P(X � x) = L P(AdP(X � x I Ai) . i= l This formula can be rewritten as jx n j.e -oc !X (t) dt = � P(Ad -oc !XIA, (t) dt. We then take the derivative of both sides, with respect to x, and obtain the desired result. Conditional PDF Given an Event • The conditional PDF !XIA of a continuous random variable X, given an event A with P(A) > 0, satisfies P(X E B I A) = Is !XIA (X) dx. • If A is a subset of the real line with P(X E A) > 0, then { !x (x) 'f E A !XI{XEA} (x) = P(X E A) ' 1 X , 0, otherwise. • Let AI, A2 , . .. ,An be disjoint events that form a partition of the sam­ ple space, and assume that P(Ai) > 0 for all i, Then, n !X{x) = L P(Ai)!xIA; (X) i=l (a version of the total probability theorem), The following example illustrates a divide-and-conquer approach that uses the total probability theorem to calculate a PDF. General Variables 3 Example 14. The metro trai n arrives at the station near your home every at 6:00 a. m . 3. 15: The PDFs . jYjA ' jYI Bl and your X l is a 5 5 y lJ in ........ ...... ,[;1. .. ,1-\" ,;;;; 3. 14 . over the int erval from 7: 10 to 7:30; see Fig. 3. 15(a) . Let events fy a A = {7: 10 � X � 7: = {yon board the 7: train }\\ = { 7: 15 < ::; 7:30} = {you board the 7:30 event your is 7: to 7: 1 5 . In th is case : time Y is also uniform and takes between o and 5 minutes; see Fig. 3. 15(b). Similarly, conditioned on B� Y is uniform and o see 3. 15(c) . is using the total probabi lity and is shown in (y) = 3. 15(d) . We 1 1 3 1 1 ( y) = 4 . 5\" + \"4 . 15 = 10 ! 1 3 1 1 (y) = 4 · 0 + 4: . 15 = -) for 0 � y � for 5 < y :::; 15 . continuous with (y) > O. the '-''U' lLlL''-lLA lL'U\"lLA c:.&A I Y on 169 with joint y that = y , is defined by This definition is analogous to y y)/py ( y) for case. thinking about the it is to y as a fixed number and consider IY (x I y) as a function of the single variable x. Viewed as a I XIY ( x I y) the sanle as joint Ix. Y (x, Y) , be- cause the denominator (y) not depend on �r: see 1 so for Iy (y) = fx .y (:r. y) Ix I y) =1 . .IJ 4 3 1 1 1 3 3.1 6: Visualization of the conditional PDF PDF which is uniform on the set S. For the slice Y = y and normal ize it so 3. 2 ::r r 3 .r y I y) . Let X and Y fixed y, we consider the it to L a dart at a of T 3. 17). assume always hits the target� target all points of impact (x . y) are equally likely. so that the joint PDF of the random x .L..I ...... ...... .... '. '\" 3. 15. Example 1 = is not \" n . t ....... · ....... 1 Y I y) == -----'- = --:=----'-'----- a if IYI � T. IY IS area of t if + < 3 Sec. 3.5 Conditioning 171 To interpret the conditional PDF, let us fix some small positive numbers (h and 82, and condition on the event B = {y ::; Y ::; y + 82}. We have P(x < X < x 8 I < Y < 8 ) = P(x ::; X ::; x + 81 and y ::; Y ::; y + 82) - - + 1 Y - - Y + 2 P( < Y < + 8 ) y _ _ Y 2 fx,Y(x, y)8182 � fy(y)82 = fxlY(x I y)81 • In words, fxlY(x I y)81 provides us with the probability that X belongs to a small interval [x, x + 8J], given that Y belongs to a small interval [y, y + 82], Since fxlY(x I y)81 does not depend on 82, we can think of the limiting case where 82 decreases to zero and write P(x < X < x + 81 I Y = y) � fxlY(x I y)81, (81 small), and, more generally, P (X E A I Y = y) = i f x IY (x I y) dx. Conditional probabilities, given the zero probability event {Y = y}, were left undefined in Chapter 1. But the above formula provides a natural way of defining such conditional probabilities in the present context. In addition, it allows us to view the conditional PDF fxlY(x I y) (as a function of x) as a description of the probability law of X, given that the event {Y = y} has occurred. As in the discrete case, the conditional PDF fxlY' together with the marginal PDF fy are sometimes used to calculate the joint PDF. Furthermore, this approach can also be used for modeling: instead of directly specifying fx,Y, it is often natural to provide a probability law for Y, in terms of a PDF fy, and then provide a conditional PDF fxlY(x I y) for X, given any possible value y of Y. Example 3. 16. The speed of a typical vehicle that drives past a police radar is modeled as an exponentially distributed random variable X with mean 50 miles per hour. The police radar's measurement Y of the vehicle's speed has an error which is modeled as a normal random variable with zero mean and standard deviation equal to one tenth of the vehicle's speed. What is the joint PDF of X and Y? We have fx(x) = (1/50)e-x/5o, for x � O. Also, conditioned on X = x, the measurement Y has a normal PDF with mean x and variance x2/ 100. Therefore, f (I x) = 1 e-Cy-x)2 /C2x2 /100) . YIX y J2\"7r (x/ lO) Thus, for all x � 0 and all y, f ( ) - f ()I ( I) - 1 -x/50 10 -50Cy-x)2 /x2 X,Y x, y - x x YIX Y x - - O e fiL. e . 5 v 271\" X 172 General Random Variables Chap. 3 Conditional PDF Given a Random Variable Let X and Y be jointly continuous random variables with joint PDF fx,Y' • The joint, marginal, and conditional PDFs are related to each other by the formulas fx,Y(x, y) = fy(y)fxlY(x I y), fx(x) = [: fy(y)fxlY(x I y) dy. The conditional PDF fxlY(x I y) is defined only for those y for which fy(y) > 0 . • We have P(X E A I Y = y) = LfxlY(X I y) dx. For the case of more than two random variables, there are natural exten­ sions to the above. For example, we can define conditional PDFs by formulas such as fx,Y.z(x, y, z) fX,Ylz(x.y I z) = fz(z) . fx,Y.z(x, y. z) fxlY,z(x I y, z) = f ( ) . Y,Z y, z There is also an analog of the multiplication rule, if fz(z) > 0, if fy,z(y, z) > O. fx.y.z(x. y. z) = fxlY,z(x I y. z)fYlz(Y I z)fz(z), and of other formulas developed in this section. Conditional Expectation For a continuous random variable X, we define its conditional expectation E[X I A] given an event A, similar to the unconditional case, except that we now need to use the conditional PDF fXIA' The conditional expectation E[X I Y = y] is defined similarly, in terms of the conditional PDF fxlY' Various familiar properties of expectations carry over to the present context and are summarized below. We note that all formulas are analogous to corresponding formulas for the case of discrete random variables. except that sums are replaced by integrals, and PMFs are replaced by PDFs. Sec. 3. 5 Conditioning 173 Summary of Facts About Conditional Expectations Let X snd Y be jointly continuous random variables, and let A be an event with P(A) > O. • Definitions: The conditional expectation of X given the event A is defined by E[X I A] = I: XJX IA(X) dx. The conditional expectation of X given that Y = y is defined by E[X I Y = y] = I: xJx IY (x I y) dx. • The expected value rule: For a function g(X), we have E[g(X) I A] = I: g(X)JXIA(X)dx, and E[g(X) I Y = Y] = I: g(x)JxlY (X I y) dx. • Total expectation theorem: Let AI, A2, ... ,An be disjoint events that form a partition of the sample space, and assume that P(Ad > 0 for all i. Then, n E[X] = L P(AdE[X I Ai]. i=l Similarly, E[X] = I: E[X I Y = y]Jy(y) dy. • There are natural analogs for the case of functions of several random variables. For example, E[g(X, Y) I Y = y] = J g(x, y)JxlY (X I y) dx, and E[g(X, Y)] = ! E[g(X, Y) I Y = ylJy(y) dy. The expected value rule is established in the same manner as for the case of unconditional expectations. To justify the first version of the total expectation 114 General Random Variables theorem, we start with the total probability theorem n fx(x) = L P(Ai)fxIAi (x), i=l multiply both sides by x, and then integrate from -00 to 00. Chap. 3 To justify the second version of the total expectation theorem, we observe that I: E[X I Y = y]fy(y) dy = I: [I: xfxlY(x I y) dX] fy(y) dy = I: I: xfxlY(x I y)fy(y) dxdy = I: I: xfx,Y(x,y) dxdy = L: x [L: fx,Y(X,Y) dY] dx = I: xfx(x) dx = E[X]. The total expectation theorem can often facilitate the calculation of the mean, variance, and other moments of a random variable, using a divide-and­ conquer approach. Example 3.11. Mean and Variance of a Piecewise Constant PDF. Suppose that the random variable X has the piecewise constant PDF { 1/3, if 0 � x � 1 , Ix {x) = 2/3, if 1 <x�2, 0, otherwise, (see Fig. 3. 18) . Consider the events Al = {X lies in the first interval [0, In , A2 = {X lies in the second interval { I , 2] } . We have from the given PDF, 11 1 P{AI) = 0 Ix (x) dx = 3' 12 2 P{A2 ) = 1 Ix (x) dx = 3· FUrthermore, the conditional mean and second moment of X, conditioned on Al and A2 , are easily calculated since the corresponding conditional PDFs IXIAI and now use = 1 l A d = 2' ] :; �, J + + .r 2 y PDF for ...... \" ... '''LIlj.J'''''' mean a C'C> .. ,\"' ..... .., moment is 1 1 2 3 7 _ . _ +_.- =:: - 3 2 3 2 6' 1 1 2 7 =- .-+-. _ =- 3 3 3 3 9 . 11 , we see >0 x y) = = __ l_ exp { are ... r' AC\" O two axes are nO:rlZ,Oll'tal o constant . 3 >0 all z. Le ., sets contours are described 3.19: Contou rs of the PDF of two m(]lepen�:Jerlt variables X and Y with meanS J.ix . p\". and variances Sec. 3.5 Conditioning 177 If X and Y are independent, then any two events of the form {X E A} and {Y E B} are independent. Indeed, P(X E A and Y E B) = [ 1 fx.Y(x, y) dydx iXEA yEB = 1 1 fx(x)fy(y) dydx xEA yEB = 1 fx(x) dx 1 fy(y) dy xEA yE B = P(X E A) P(Y E B). In particular, independence implies that Fx,Y(x. y) = P(X ::; x, Y ::; y) = P(X ::; x) P(Y ::; y) = Fx(x)Fy(y). The converse of these statements is also true: see the end-of-chapter problems. The property Fx.y(x. y) = Fx(x)Fy(y). for all x. y. can be used to provide a general definition of independence between two random variables. e.g., if X is discrete and Y is continuous. An argument similar to the discrete case shows that if X and Y are inde­ pendent, then E[g(X)h(Y)] = E[g(X)] E[h(Y)] . for any two functions 9 and h. Finally. the variance of the sum of independent random variables is equal to the sum of their variances. Independence of Continuous Random Variables Let X and Y be jointly continuous random variables. • X and Y are independent if !x,Y(x, y) = !x(x)fy(y), for all x, y . • If X and Y are independent, then E[XY] = E[X] E[Y] . 178 3 for g the AUOV ....... U g(X) and h(Y) are independent , and we have [g(X)h(Y)] = [g(X)] [h(Y)] . • Yare + Y) = var(X) + var( Y). 3.6 THE In many situations� we represent an unobserved phenomenon by a random able X with PDF f x and we make a noisy measurement Y, which is modeled in a conditional !y!x . Once value Y is ....................... , .... .. information does it prov ide on the unknown value of This setting is similar 1. 4, where we rule it to see The only we are now dealing with cont inuous random x Schemat ic desc r i ptio n of the inference pro blem. We have an nC\"' .'\"Arl random variable X with k nown and we obt ain a measurement Y accord ing to a con di tional PDF !Y I X ' Given an observed value y of Y 1 the inference problem is to evaluate the con d i t ion al PDF fX I Y (x I y) . tured by the From the formulas f X Iy \"-''''''' ................ on pression is !X IY information is prov ided {Y = y} is ! XIY I y) . It to evaluate this = Ix. y = Iy jY, it follows that I x) IY I y) = ----- !X IY I y) dx = 1, an I y) = !x (x) !Y lx (Y I . icc f X (t) !Y IX (y It ) dt ex- Sec. 3.6 The Continuous Bayes ' Rule 179 Example 3. 19. A light bulb produced by the General Illumination Company is known to have an exponentially distributed lifetime Y. However, the company has been experiencing quality control problems. On any given day, the parameter ). of the PDF of Y is actually a random variable, uniformly distributed in the interval [1 . 3/2] . We test a light bulb and record its lifetime. What can we say about the underlying parameter ).? We model the parameter ). in terms of a uniform random variable A with PDF 3 for 1 < ). < - . - -2 The available information about A is captured by the conditional PDF !AIY (). I y), which using the continuous Bayes' rule, is given by f (). I ) = !A ().)!YIA(y l).) = 2).e- >'Y AIY y 100 3/2 ' -00 !A (t)!YIA(y I t) dt !. 2te - ty dt Inference about a Discrete Random Variable 3 for 1 < ). < - . - -2 In some cases, the unobserved phenomenon is inherently discrete. For some examples, consider a binary signal which is observed in the presence of normally distributed noise, or a medical diagnosis that is made on the basis of continuous measurements such as temperature and blood counts. In such cases, a somewhat different version of Bayes' rule applies. We first consider the case where the unobserved phenomenon is described in terms of an event A whose occurrence is unknown. Let P(A) be the probability of event A. Let Y be a continuous random variable, and assume that the conditional PDFs fYIA(Y) and fYIAc(y) are known. We are interested in the conditional probability P(A I Y = y) of the event A, given the value y of Y. Instead of working with the conditioning event {Y = y}, which has zero probability, let us instead condition on the event {y � Y � y + o}, where 0 is a small positive number, and then take the limit as 0 tends to zero. We have, using Bayes' rule, and assuming that fy(y) > 0, P(A I Y = y) � P(A I y < Y � y + 0) P(A)P(y � Y � y + 0 I A) - P(y ::; Y � y + 0) P(A)fYIA (y)o � fy(y)o P(A)fYIA (y) fy(y) The denominator can be evaluated using the following version of the total prob­ ability theorem: 180 so that General Random Variables P(A I Y = Y) = P(A)fYIA(Y) . P(A)fYIA (y) + P(Ac)fYIAC (y) Chap. 3 In a variant of this formula, we consider an event A of the form {N = n}, where N is a discrete random variable that represents the different discrete possibilities for the unobserved phenomenon of interest. Let PN be the PMF of N. Let also Y be a continuous random variable which, for any given value n of N, is described by a conditional PDF fYIN(Y I n). The above formula becomes P(N = n I Y = y) = PN(n)::�;/y I n). The denominator can be evaluated using the following version of the total prob­ ability theorem: so that P(N = n I Y = y) = PN(n)fYIN(Y I n) . LPN(i)fYIN(Y I i) t Example 3.20. Signal Detection. A binary signal S is transmitted, and we are given that P(S = 1) = p and P(S = -1 ) = I - p. The received signal is Y = N + S. where N is normal noise, with zero mean and unit variance, independent of S. What is the probability that S = 1, as a function of the observed value y of Y? Conditioned on S = s, the random variable Y has a normal distribution with mean s and unit variance. Applying the formulas given above, we obtain P _(y_ 1)2/2 --e P(S = 11 Y = y) = ps( l)fYIS(Y 11 ) = ___ v\"21r..:.....2_1l\"_----=-___ _ fy (y) p _(y_l )2/2 1 - P _(y+l )2/2 ' which simplifies to --e + --e v\"21r v\"21r peY P (S = 1 I Y = y) = --c-----------:-­ peY + (1 - p)e- Y ' Note that the probability P(S = 11 Y = y) goes to zero as y decreases to -00, goes to 1 as y increases to 00, and is monotonically increasing in between, which is consistent with intuition. Sec. 3.6 The Continuous Bayes ' Rule 181 Inference Based on Discrete Observations We finally note that our earlier formula expressing P(A I Y = y) in terms of fYIA (y) can be turned around to yield Based on the normalization property J�oc fYIA(Y) dy = 1. an equivalent expres- sion is f ( ) - fy(y)P(AIY =y) YIA Y -jOC . - oc fy(t) P(A I Y = t) dt This formula can be used to make an inference about a random variable Y when an event A is observed. There is a similar formula for the case where the event A is of the form {N = n}, where N is an observed discrete random variable that depends on Y in a manner described by a conditional PMF PNly(n I y). Bayes' Rule for Continuous Random Variables Let Y be a continuous random variable. • If X is a continuous random variable, we have and fy(y)fxlY(x I y) fx(x)fYlx(Y I x), J ( I ) - fx(x)fYlx(Yl x) _ fx(x)fYlx(Y lx) XIY x y - - 00 . fy(y) 100 fx(t)fYlx(Y I t) dt • If N is a discrete random variable, we have fy(y) P(N = n I Y = y) = pN(n)fYIN(Y I n), resulting in the formulas 182 General Random Variables Chap. 3 and f ( I ) - fy (y)P(N = n l Y = y) _ fy (y) P(N = n l Y = y) Y I N Y n - - 00 . PN (n) 100 fy (t) P(N = n I Y = t) dt • There are similar formulas for P (A I Y = y) and fYIA(Y). 3.7 SUMMARY AND DISCUSSION Continuous random variables are characterized by PDFs, which are used to cal­ culate event probabilities. This is similar to the use of PMFs for the discrete case, except that now we need to integrate instead of summing. Joint PDFs are similar to joint Pl\\lFs and are used to determine the probability of events that are de­ fined in terms of multiple random variables. Furthermore, conditional PDFs are similar to conditional PMFs and are used to calculate conditional probabilities, given the value of the conditioning random variable. An important application is in problems of inference, using various forms of Bayes' rule that were developed in this chapter. There are several special continuous random variables which frequently arise in probabilistic models. We introduced some of them, and derived their mean and variance. A summary is provided in the table that follows. Summary of Results for Special Random Variables Continuous Uniform Over [a, b] : if a � x <b, fX(X) = { b � a ' 0, otherwise, E[X] = a + b , 2 Exponential with Parameter 'x: fx(x) = { ,Xe-Ax , 0, if x > 0, otherwise, (b - a)2 var(X) = . 12 Fx(x) = { 1- e-AX , 0, 1 var(X) = ,X2 . if x � 0, otherwise, Sec. 3. 7 Summary and Discussion Normal with Parameters 11 and a 2 > 0: 1 2 2 fx(x) = e -(X -IL) /20' , V\"ii a E[X] = 11, var(X) = a 2. 183 We have also introduced CDFs, which can be used to characterize general random variables that are neither discrete nor continuous. CDFs are related to PMFs and PDFs, but are more general. For a discrete random variable, we can obtain the PMF by differencing the CDF; for a continuous random variable, we can obtain the PDF by differentiating the CDF. 184 General Random Variables Chap. 3 PROBLEMS SECTION 3. 1. Continuous Random Variables and PDFs Problem 1. Let X be uniformly distributed in the unit interval [0, 1] . Consider the random variable Y = g(X), where g(x) = {21., if x ::; 1/3, if x > 1/3. Find the expected value of Y by first deriving its PMF. Verify the result using the expected value rule. Problem 2. Laplace random variable. Let X have the PDF f () .A ->' I xl x x = '2e , where .A is a positive scalar. Verify that f x satisfies the normalization condition, and evaluate the mean and variance of X. Problem 3. * Show that the expected value of a discrete or continuous random vari­ able X satisfies E[X] = J.x P(X > x) dx J.x P(X < -x) dx. Solution. Suppose that X is continuous. We then have where for the second equality we have reversed the order of integration by writing the set {(x. y) 10 ::; x < oc. x::; y < oc} as {(x. y) 10 ::; x::; y, 0 ::; y < oo}. Similarly. we can show that J.= P(X < -x) dx -1°= yfx(y) dy. Problems Combining the two relations above, we obtain the desired result. If X is discrete, we have P(X > x) = IX> LPX(Y) o y>x = L (IV P x (y) dx ) y>O 0 = LPX(Y) ( III dX) y>O 0 and the rest of the argument is similar to the continuous case. Problem 4. * Establish the validity of the expected value rule E [g(X)] = I: g(x)fx (x) dx, where X is a continuous random variable with PDF fx . 185 Solution. Let us express the function 9 as the difference of two nonnegative functions, where g+(x) = max{g(x) , O}, and g- (x) = max{ -g(x), O}. In particular. for any t 2::: 0, we have g(x) > t if and only if g+ (x) > t. We will use the result E [g(X)] = f.X> p (g(X) > t) dt - f.X> p (g(X) < -t) dt from the preceding problem. The first term in the right-hand side is equal to 100 f fx (X) dX dt = joo f fx (X) dt dx = j= g+(x)fx (x) dx. o i{x I g(x» t} -00 i{t l0:$t <g(x)} -X> By a symmetrical argument, the second term in the right-hand side is given by f.= p (g(X) < -t) dt = I: g- (x)fx (x) dx. Combining the above equalities, we obtain E [g(X)] = I: g+ (x)fx (x) dx - I: g- (x)fx (x) dx = I: g(x)fx (x) dx. 186 General Random Variables Chap. 3 SECTION 3.2. Cumulative Distribution Functions Problem 5. Consider a triangle and a point chosen within the triangle according to the uniform probability law. Let X be the distance from the point to the base of the triangle. Given the height of the triangle, find the CDF and the PDF of X. Problem 6. Calamity Jane goes to the bank to make a withdrawal, and is equally likely to find 0 or 1 customers ahead of her. The service time of the customer ahead, if present, is exponentially distributed with parameter >.. What is the CDF of Jane's waiting time? Problem 7. Alvin throws darts at a circular target of radius r and is equally likely to hit any point in the target. Let X be the distance of Alvin's hit from the center. (a) Find the PDF, the mean. and the variance of X. (b) The target has an inner circle of radius t. If X � t, Alvin gets a score of S = 1/ X. Otherwise his score is S = O. Find the CDF of S. Is S a continuous random variable? Problem 8. Consider two continuous random variables Y and Z, and a random variable X that is equal to Y with probability p and to Z with probability 1 - p. (a) Show that the PDF of X is given by fx (x) = pfy (x) + (1 - p)fz (x). (b) Calculate the CDF of the two-sided exponential random variable that has PDF given by _ { p>.eAX , fx (x) - ( 1 _ p)>.e-AX • where >. > 0 and 0 < p < 1. if x < 0, if x 2: 0, Problem 9. * Mixed random variables. Probabilistic models sometimes involve random variables that can be viewed as a mixture of a discrete random variable Y and a continuous random variable Z. By this we mean that the value of X is obtained according to the probability law of Y with a given probability p. and according to the probability law of Z with the complementary probability 1 - p. Then, X is called a mixed random variable and its CDF is given. using the total probability theorem, by Fx (x) = P(X � x) = pP(Y � x) + (1 - p)P(Z � x) = pFy (x) + (1 - p)Fz(x). Its expected value is defined in a way that conforms to the total expectation theorem: E[X] = pE[Y] + ( 1 - p)E[Z] . The taxi stand and the bus stop near AI's home are in the same location. Al goes there at a given time and if a taxi is waiting (this happens with probability 2/3) he Problems 187 boards it. Otherwise he waits for a taxi or a bus to come, whichever comes first. The next taxi will arrive in a time that is uniformly distributed between 0 and 10 minutes, while the next bus will arrive in exactly 5 minutes. Find the CDF and the expected value of AI's waiting time. Solution. Let A be the event that Al will find a taxi waiting or will be picked up by the bus after 5 minutes. Note that the probability of boarding the next bus, given that Al has to wait, is Pea taxi will take more than 5 minutes to arrive) = �. AI's waiting time, call it X, is a mixed random variable. With probability 2 1 1 5 peA) = - + - . - = -3 3 2 6' it is equal to its discrete component Y (corresponding to either finding a taxi waiting, or boarding the bus), which has PMF py (y) { 3P�A) ' if Y = 0, 6P�A) ' if Y = 5, { 12 = �5 ) 15 ' if y = 0, if y = 5. [This equation follows from the calculation (0) = P(Y = 0 I A) = P(Y = 0, A) 2 py peA) - 3P(A) ' The calculation for py (5) is similar.] With the complementary probability 1 - peA), the waiting time is equal to its continuous component Z (corresponding to boarding a taxi after having to wait for some time less than 5 minutes), which has PDF fz(z) = { 1/5, if 0 :::; � :::; 5, 0, otherwIse. The CDF is given by Fx (x) = P(A)Fy(x) + (1 - P(A))Fz(x), from which { 0, if x < 0, 5 12 1 x Fx (x) = _._ + _.- if O :::; x<5, 6 15 6 5 ' 1, if 5 :::; x. The expected value of the waiting time is 5 3 1 5 15 E[X] = P(A)E[Y] + (1 - P(A)) E[Z] = - . - . 5 + - . - = -. 6 15 6 2 12 188 General Random Variables Chap. 3 Problem 10. * Simulating a continuous random variable. A computer has a subroutine that can generate values of a random variable U that is uniformly distributed in the interval [0, 1] . Such a subroutine can be used to generate values of a continuous random variable with given CDF F(x) as follows. If U takes a value u, we let the value of X be a number x that satisfies F(x) = u. For simplicity, we assume that the given CDF is strictly increasing over the range S of values of interest. where S = {x I 0 < F( x) < I}. This condition guarantees that for any u E (0. 1). there is a unique x that satisfies F(x) = u. (a) Show that the CDF of the random variable X thus generated is indeed equal to the given CDF. (b) Describe how this procedure can be used to simulate an exponential random variable with parameter 'x. (c) How can this procedure be generalized to simulate a discrete integer-valued ran­ dom variable? Solution. (a) By definition, the random variables X and U satisfy the relation F(X) = U. Since F is strictly increasing, we have for every x, X � x if and only if F(X) � F(x). Therefore, P(X � x) = P (F(X) � F(x)) = p(U � F(x)) = F(x) , where the last equality follows because U is uniform. Thus, X has the desired CDF. (b) The exponential CDF has the form F(x) = 1 - e->'x for x � O. Thus, to generate values of X. we should generate values u E (0. 1) of a uniformly distributed random variable U. and set X to the value for which 1 - e->'x = u, or x = - In(1 - u)/,x. (c) Let again F be the desired CDF. To any u E (0. 1), there corresponds a unique integer Xu such that F(xu - 1) < u � F(xu). This correspondence defines a random variable X as a function of the random variable U. We then have. for every integer k. P(X = k) = P (F(k - 1) < U � F(k)) = F(k) - F(k - 1). Therefore, the CDF of X is equal to F, as desired. SECTION 3.3. Normal Random Variables Problem 11. Let X and Y be normal random variables with means 0 and 1, respec­ tively, and variances 1 and 4, respectively. (a) Find P(X � 1.5) and P(X � -1). (b) Find the PDF of (Y - 1)/2. (c) Find P(-1 :$ Y :$ 1). Problem 12. Let X be a normal random variable with zero mean and standard deviation u. Use the normal tables to compute the probabilities of the events {X � ku} and {I XI � ku} for k = 1 , 2, 3. Problems 189 Problem 13. A city's temperature is modeled as a normal random variable with mean and standard deviation both equal to 10 degrees Celsius. What is the probability that the temperature at a randomly chosen time will be less than or equal to 59 degrees Fahrenheit? Problem 14. * Show that the normal PDF satisfies the normalization property. Hint: 2 The integral J�x e-x /2 dx is equal to the square root of 1= 1 00 2 2 -x /2 - y /2 d d e e x y, -x -00 and the latter integral can be evaluated by transforming to polar coordinates. Solution. We note that = - e -r /2rdrdO 1 1271\" 1= 2 21T\" 0 0 = 1, where for the third equality, we use a transformation into polar coordinates, and for the fifth equality, we use the change of variables u = r2 /2 . Thus, we have 1= _1 _ -x2/2 d - 1 e x - , - 00 ..j'i; because the integral is positive. Using the change of variables u = (x - J-l)/u, it follows that fx (x) dx = e-(x-/L) /217 dx = __ e-u /2du = 1. Ix IX 1 2 2 lOG 1 2 -:x; -= v'2ii u _ = ..j'i; SECTION 3.4. Joint PDFs of Multiple Random Variables Problem 15. A point is chosen at random (according to a uniform PDF) within a semicircle of the form {(x, y) I x2 + y2 :::; r2, y � O}, for some given r > O. (a) Find the joint PDF of the coordinates X and Y of the chosen point. 190 General Random Variables Chap. 3 (b) Find the marginal PDF of Y and use it to find E[Y] . (c) Check your answer in (b) by computing E[Y] directly without using the marginal PDF of Y. Problem 16. Consider the following variant of Buffon's needle problem (Example 3. 11 ) ' which was investigated by Laplace. A needle of length I is dropped on a plane surface that is partitioned in rectangles by horizontal lines that are a apart and vertical lines that are b apart. Suppose that the needle's length I satisfies 1 < a and 1 < b. What is the expected number of rectangle sides crossed by the needle? What is the probability that the needle will cross at least one side of some rectangle? Problem 17. * Estimating an expected value by simulation using samples of another random variable. Let Y1 •••• , Yn be independent random variables drawn from a common and known PDF fy. Let S be the set of all possible values of Yi, S = {y I fy(y) > O}. Let X be a random variable with known PDF fx, such that fx(y) = 0, for all y ¢ S. Consider the random variable Show that E[Z] = E[X] . Solution. We have [ fx(Yi)] r fx(y) r E Yi fY(Yi) = Js Yfy(y) fy(y) dy= Js yfx(y) dy= E[X] . Thus, E[Z] = .!. � E [Yi fx(Yi)] = .!. � E[X] = E[X] . n L- fY (Yi) n L- t=1 i=1 SECTION 3.5. Conditioning Problem 18. Let X be a random variable with PDF fx (x) = { X/4, 0, and let A be the event {X � 2}. if 1 < x ::; 3, otherwise, (a) Find E[X] , P(A), fXIA(X), and E[X I A] . (b) Let Y = X2 . Find E[Y] and var(Y) . Problem 19. The random variable X has the PDF fx(x) = {cx-2, if 1 ::; �::; 2, 0, otherwIse. Problems 191 (a) Determine the value of c. (b) Let A be the event {X > 1.5}. Calculate P(A) and the conditional PDF of X given that A has occurred. (c) Let Y = X2 . Calculate the conditional expectation and the conditional variance of Y given A. Problem 20. An absent-minded professor schedules two student appointments for the same time. The appointment durations are independent and exponentially distributed with mean thirty minutes. The first student arrives on time, but the second student arrives five minutes late. What is the expected value of the time between the arrival of the first student and the departure of the second student? Problem 21. We start with a stick of length e. We break it at a point which is chosen according to a uniform distribution and keep the piece, of length Y, that contains the left end of the stick. We then repeat the same process on the piece that we were left with, and let X be the length of the remaining piece after breaking for the second time. (a) Find the joint PDF of Y and X. (b) Find the marginal PDF of X. (c) Use the PDF of X to evaluate E[X]. (d) Evaluate E[X] , by exploiting the relation X = y. (X/Y). Problem 22. We have a stick of unit length, and we consider breaking it in three pieces using one of the following three methods. (i) We choose randomly and independently two points on the stick using a uniform PDF, and we break the stick at these two points. (ii) We break the stick at a random point chosen by using a uniform PDF, and then we break the piece that contains the right end of the stick. at a random point chosen by using a uniform PDF. (iii) We break the stick at a random point chosen by using a uniform PDF, and then we break the larger of the two pieces at a random point chosen by using a uniform PDF. For each of the methods (i) , (ii), and (iii) , what is the probability that the three pieces we are left with can form a triangle? Problem 23. Let the random variables X and Y have a joint PDF which is uniform over the triangle with vertices at (0, 0) , (0, 1), and (1. 0). (a) Find the joint PDF of X and Y. (b) Find the marginal PDF of Y. (c) Find the conditional PDF of X given Y. (d) Find E[X I Y = yj, and use the total expectation theorem to find E[X] in terms of E[Y] . (e) Use the symmetry of the problem to find the value of E[X]. 192 General Random Variables Chap. 3 Problem 24. Let X and Y be two random variables that are uniformly distributed over the triangle formed by the points (0, 0), (1. 0) , and (0, 2) (this is an asymmetric version of the PDF in the previous problem). Calculate E[X] and E[Y] by following the same steps as in the previous problem. Problem 25. The coordinates X and Y of a point are independent zero mean normal random variables with common variance (72. Given that the point is at a distance of at least c from the origin. find the conditional joint PDF of X and Y. Problem 26. * Let XI , .... Xn be independent random variables. Show that Solution. We have ,=1 ' var X, var( TIn X ) n ( ( ) ) TI�=1 E[X;] = g E[Xll + 1 - 1. var(IT X,) = E [IT X;] - IT (E[XiJ) 2 ,=1 i=1 i=1 11 n = II E [X;] - II (E[X,J) 2 i= 1 ,=1 n n = II (var(X, ) + (E[X,J) 2) - II (E[XiJ) 2. 1=1 i=1 The desired result follows by dividing both sides by ,=1 Problem 21. * Conditioning multiple random variables on events. Let X and Y be continuous random variables with joint PDF fx.y , let A be a subset of the two-dimensional plane, and let C = {(X, Y) E A}. Assume that P(C) > 0, and define { fx.Y (x, y) fx.Ylc (x, y) = P(C) , 0, (a) Show that fX.Ylc is a legitimate joint PDF. if (x, y) E A, otherwise. (b) Consider a partition of the two-dimensional plane into disjoint subsets Ai , i = 1, ... ,n , let Ci = {(X. Y) E Ad, and assume that P(Ci ) > 0 for all i. Derive the following version of the total probability theorem n fx,y (x, y) = L P(C )fX.Y ICi (x, y) . i=1 Problems Problem 28. * Consider the following two-sided exponential PDF { p)..e-AX , f X (x) = (1 _ p) .. e AX , if x � 0, if x < 0, 193 where ).. and p are scalars with )\" > ° and p E [0, 1]. Find the mean and the variance of X in two ways: (a) By straightforward calculation of the associated expected values. (b) By using a divide-and-conquer strategy, and the mean and variance of the (one­ sided) exponential random variable. Solution. (a) and E[X] = f: xfx (x) dx = 1° x(1 - p) .. eAX dx + 100 xp)..e-AX dx -00 ° = _ _ I_-_p + � ).. ).. 2p - 1 - ).. E[X2] = f: x2 fx (x) dx = 1° x2 (1 - p) .. eAX dx + 100 x2p)..e-AX dx -00 0 2( 1 - p) 2p = )..2 + )..2 2 )..2' 2 (2P - 1 ) 2 var(X) = )..2 - ).. (b) Let A be the event {X � O}, and note that P(A) = p. Conditioned on A, the random variable X has a (one-sided) exponential distribution with parameter )... Also, conditioned on AC• the random variable -X has the same one-sided exponential dis­ tribution. Thus, and It follows that 1 E[X IA] = >:' E[X] = P(A)E[X I A] + P(AC)E[X lAC] p 1 - p - - -- ).. ).. 2p - l ).. 194 and General Random Variables E[X2] = P(A)E[X2 1 AI + P(AC)E[X2 1 AC] 2p 2( 1- p) = .;\\2 + .;\\2 2 - .;\\2 ' 2 (2P - 1) 2 var(X) = .;\\2 - .;\\ • Chap. 3 Problem 29.* Let X, Y. and Z be three random variables with joint PDF /x.y.z . Show the multiplication rule: /x.Y.z(x, Y, z ) = /x lY,z (x I y, z )/Yl z (Y I z )/z (z) . Solution. We have, using the definition of conditional density, and / ( I ) - /x,Y,z(x, y, z) x I y,Z x Y, z - / ( ) , Y.Z Y,Z /Y,z(y, z ) = /Y IZ (Y I z )/z (z ) . Combining these two relations, we obtain the multiplication rule. Problem 30.* The Beta PDF. The beta PDF with parameters Q > 0 and {3 > 0 has the form { 1 xo-1 ( 1 _ X)i3- 1 /x (x) = B(o:, ,8) , 0, if 0:5 x :5 1, otherwise. The normalizing constant is and is known as the Beta function. (a) Show that for any m > 0, the mth moment of X is given by E[X7n] = B(o: + m, (3) . B(o:, ,8) (b) Assume that 0: and (3 are integer. Show that so that B(o:, (3) = (0: - 1)' ((3 I)! . (0: +(3- 1)! m 0:(0: + 1)·· . (0: + m - 1) E[X 1 = . ( 0: + (3)(0: + (3 + 1) ... (0: + (3 + m - 1) Problems (Recall here the convention that O! = 1.) Solution. (a) We have E[Xm] = 1 11 m 0- 1 ( 1 _ )13- 1 d = B(o + m, )3) B(o, )3) 0 x x x X B(o. )3) · 195 (b) In the special case where 0 = 1 or )3 = 1, we can carry out the straightforward integration in the definition of B(o, )3), and verify the result. We will now deal with the general case. Let Y, Yl , ... , Yo+13 be independent random variables, uniformly dis­ tributed over the interval [0, 1] , and let A be the event Then, 1 P(A) = (0 +)3+ 1)!' because all ways of ordering these 0 + )3 + 1 random variables are equally likely. Consider the following two events: B = { max{ Y1 , ... , Yo } � Y } , We have, using the total probability theorem, p(B nC) = /.1 p(BnCI Y = y)Jy (y) dy = /.1 p ( max{ Y1 , ... , Yo } � y � min{Yo+1 , ... , Yo+13 }) dy = /.1 p( max{ E . ... , Yo } :-; y) ply :-; min{ Yo+J , . .. 'yo+, }) dy = /.' yO ( 1 _ y)\" dy. We also have 1 p(A I BnC) = 0! 1'!' because given the events B and C, all o! possible orderings of Y1 , ••• ,Yo are equally likely, and all f'! possible orderings of Yo+! , ... , Yo +13 are equally likely. By writing the equation P(A) = P(B n C) P(A I Bn C) in terms of the preceding relations, we finally obtain (\" + � + I ) ' = \",1 m /.' yO (1 - y)\" dy, 196 or General Random Variables 0< f3 0:. . 11 ' {3' o Y ( 1 - y) dy = (0: + (3 + I)! . This equation can be written as o:! B! B(o: + 1. {3+ 1) = ( (3 )\" 0:+ +1 . for all integer 0: > 0, (3 > O. Chap. 3 Problem 31. * Estimating an expected value by simulation. Let Ix (x) be a PDF such that for some nonnegative scalars a, b, and c, we have Ix (x) = 0 for all x outside the interval [a, b]. and xix (x) � c for all x. Let Yr, i = 1, ... , n, be independent random variables with values generated as follows: a point (Vi, Wt) is chosen at random (according to a uniform PDF) within the rectangle whose corners are (a, 0) , (b, 0) . (a, c) , and (b, c) , and if W1 � Vilx (Vi ) . the value of Yi is set to 1, and otherwise it is set to O. Consider the random variable Show that and Z = Y1 + . . . + Yn . n E[Z] = E[X] c(b - a) 1 var(Z) :::; 4n ' In particular, we have var(Z) --+ 0 as n --+ 00. Solution. We have P(Yi = 1) = P (Wt � Vi Ix (Vi)) - lb 1V1X(V) 1 - a 0 c( b - a) dw dv l' vtx (v) dv _ .:::...!!:.a ___ _ c(b - a) E[X] - c(b - a) ' The random variable Z has mean P(Yi = 1) and variance P(Yr = 1) (1 - P(Yi = 1)) var(Z) = . n Since 0 :::; ( 1 - 2p)2 = 1 - 4p( 1 - p), we have p(1 - p) � 1/4 for any p in [0, 1] ' so it follows that var(Z) :::; 1/(4n) . Problem 32. * Let X and Y be continuous random variables with joint PDF Ix,Y . Suppose that for any subsets A and B of the real line, the events {X E A} and {Y E B} are independent. Show that the random variables X and Y are independent. Problems 197 Solution. For any two real numbers x and y, using the independence of the events {X � x} and {Y � y}, we have Fx.y (x, y) = P(X � x, Y � y) = P(X � x) P(Y � y) = Fx (x)Fy(y). Taking derivatives of both sides, we obtain 82 Fx. y 8Fx 8Fy fx.y (x, y) = 8x8y (x, y) = 8x (x) 8y (y) = fx (x)fy (y) , which establishes that X and Y are independent. Problem 33. * The sum of a random number of random variables. You visit a random number N of stores and in the ith store, you spend a random amount of money Xi. Let T = Xl + X2 + ... + XN be the total amount of money that you spend. We assume that N is a positive integer random variable with a given PMF, and that the Xl are random variables with the same mean E[X] and variance var(X). Furthermore, we assume that N and all the Xi are independent. Show that E[T] = E[X] E[N], Solution. We have for all i, and var(T) = var(X) E[N] + (E[X]) 2 var(N). E[T I N = i] = iE[X], since conditional on N = i, you will visit exactly i stores, and you will spend an expected amount of money E[X] in each. We now apply the total expectation theorem. We have 00 E[T] = L P(N = i) E[T I N = i] i=l oc = L P(N = i)iE[X] i=l = E[X] L iP(N = i) 1=1 =E[X] E[N]. 198 General Random Variables Chap. 3 Similarly, using also the independence of the Xi, which implies that E[XiXj] = (E[XJ)2 if i =I- j, the second moment of T is calculated as 00 E[T2] = L P(N = i) E[T2 1 N = i] ,=1 00 i=1 00 = L P(N = i) (iE[X2] + i (i - 1) (E[XJ)2) t=1 00 00 = E[X2] L iP(N = i) + (E[XJ) 2 L i(i - l)P(N = i) i=1 t=1 = E[X2] E[N] + (E[XJ) 2 (E[N2] - E[NJ) = var(X) E[N] + (E[XJ)2E[N2]. The variance is then obtained by so finally var(T) = E[T2] _ (E[TJ) 2 = var(X) E[N] + (E[XJ)2E[N2] - (E[XJ) 2 (E[Nl) 2 = var(X) E[N] + (E[XJ)\\E[N2] - (E[NJ)2), var(T) = var(X) E[N] + (E[Xl) 2 var(N). Note: The formulas for E[T] and var(T) will also be obtained in Chapter 4, using a more abstract approach. SECTION 3.6. The Continuous Bayes' Rule Problem 34. A defective coin minting machine produces coins whose probability of heads is a random variable P with PDF jp (p) = { peP , p E [O, �], 0, otherwise. A coin produced by this machine is selected and tossed repeatedly, with successive tosses assumed independent. (a) Find the probability that a coin toss results in heads. (b) Given that a coin toss resulted in heads, find the conditional PDF of P. (c) Given that the first coin toss resulted in heads, find the conditional probability of heads on the next toss. Problem 35. * Let X and Y be independent continuous random variables with PDFs j x and jy, respectively, and let Z = X + Y. Problems 199 (a) Show that fZlx (z I x) = fy (z - x) . Hint: Write an expression for the conditional CDF of Z given X, and differentiate. (b) Assume that X and Y are exponentially distributed with parameter A. Find the conditional PDF of X, given that Z = z. (c) Assume that X and Y are normal random variables with mean zero and variances (7; and (7� , respectively. Find the conditional PDF of X, given that Z = z. Solution. (a) We have P(Z :::; z I X = x) = P(X + Y :::; z I X = x) = P(x + Y :::; z I X = x) = P(x + Y :::; z) = P(Y :::; z - x) , where the third equality follows from the independence of X and Y. By differentiating both sides with respect to z, the result follows. (b) We have, for 0 :::; x :::; z, f ( I) - fZlx (z I x)fx(x) XI Z x z - fz (z) fy (z - x) f x (x) fz (z) Ae ->'(z-x) Ae->'x A2e - >'z fz (z) - fz (z) . Since this is the same for all x, it follows that the conditional distribution of X is uniform on the interval [0, z] , with PDF fX l z (x I z) = liz. (c) We have f (I ) - fy (z - x)fx (x) XIZ x z - fz (z) We focus on the terms in the exponent. By completing the square, we find that the negative of the exponent is of the form (z - X)2 x2 (7; + (7� ( Z(7; ) 2 Z2 ( (7; ) \"\":\"\"-----,,...:- + - - x - + - I - ---;<'\"---=----;<'\" 2(7� 2(7; - 2(7;(7� (7; + (7� 2(7� (7; + (7� . Thus, the conditional PDF of X is of the form 2 + 2 2 2 ) { (7 x (7 y ( Z(7 x ) } f x I z (x I z = c( z) . exp - 2 2 2 X - 2 2 ' (7x(7y (7x + (7y where c(z) does not depend on x and plays the role of a normalizing constant. We recognize this as a normal distribution with mean and variance (72 E[X I Z = z] = 2 x 2 Z, (7x + (7y (7;(7� var(X I Z = z) = 2 2' (7x + (7y 4 Further Topics on Random Variables Contents 4.1. Derived Distributions . . . . . . . . . . . . . p. 202 4.2. Covariance and Correlation ......... . p. 217 4.3. Conditional Expectation and Variance Revisited . p. 222 4.4. Transforms ... ............. . p. 229 4.5. Sum of a Random Number of Independent Random Variables p. 240 4.6. Summary and Discussion . p. 244 Problems . . . . . . . . . . . . . . . . . . . . . . . . p. 246 201 202 Further Topics on Random Variables Chap. 4 In this chapter. we develop a number of more advanced topics. We introduce methods that are useful in: (a) deriving the distribution of a function of one or multiple random variables; (b) dealing with the sum of independent random variables. including the case where the number of random variables is itself random; (c) quantifying the degree of dependence between two random variables. With these goals in mind. we introduce a number of tools. including transforms and convolutions. and we refine our understanding of the concept of conditional expectation. The material in this chapter is not needed for Chapters 5-7. with the ex­ ception of the solutions of a few problems. and may be viewed as optional in a first reading of the book. On the other hand, the concepts and methods dis­ cussed here constitute essential background for a more advanced treatment of probability and stochastic processes. and provide powerful tools in several disci­ plines that rely on probabilistic models. Furthermore, the concepts introduced in Sections 4.2 and 4.3 will be required in our study of inference and statistics, in Chapters 8 and 9. 4.1 DERIVED DISTRIBUTIONS In this section, we consider functions Y = g(X) of a continuous random variable X. We discuss techniques whereby, given the PDF of X, we calculate the PDF of Y (also called a derived distribution). The principal method for doing so is the following two-step approach. Calculation of the PDF of a Function Y = g(X) of a Continuous Random Variable X 1. Calculate the CDF Fy of Y using the formula Fy(y) = P(g(X) < y) = [ fx(x) dx. J{x I g(x)Sy} 2. Differentiate to obtain the PDF of Y: dFy fy(y) = dy (y). Example 4.1. Let X be uniform on [0. 11. and let Y = v'X. We note that for every y E [0, 11. we have Fy (y) = P(Y ::; y) = P(v'X ::; y) = P(X ::; y2) = y2. Sec. 4. 1 Derived Distributions We then differentiate and obtain dF d( 2) fy(y) = ---2::. (y) = -y- = 2y, dy dy 203 O � y �l. Outside the range [0, IJ, the CDF Fy(y) is constant, with Fy(y) = 0 for y � 0, and Fy (y) = 1 for y 2 1. By differentiating, we see that fy (y) = 0 for y outside [0, 1] . Example 4.2. John Slow is driving from Boston to the New York area, a distance of 180 miles at a constant speed, whose value is uniformly distributed between 30 and 60 miles per hour. What is the PDF of the duration of the trip? Let X be the speed and let Y = g(X) be the trip duration: g(X) = 180 . X To find the CDF of Y, we must calculate P(Y � y) = P ( 11 0 � y) = P ( 1: 0 � X) . We use the given uniform PDF of X, which is fx(x) = { 1/30, if 30 :s; x :s; 60, 0, otherwise, and the corresponding CDF, which is Thus, { 0, Fx(x) = (x - 30)/30, 1, ( 180 ) Fy(y) = P 11 � X = 1- Fx ( 1: 0) if x � 30, if 30 � x � 60, if 60 � x. 0, if Y � 180/60, 180 _ 30 1 - Y 30 if 180/60 � Y � 180/30, 1, { 0, = 2 - (6/y), 1, if 180/30 :s; y, if Y :s; 3, if 3 � y � 6, if 6 � y, on 4. we { O . if y < if 3 < y < O. if 6 < 1 x ... ......... .. :..,. . ....... _-_ .... 3 6 y 4.1: The calculation of the PDF of Y :::::: arrows ind icate the Row of the calculation . 3 6 y in L.JA CI.1UUn;; 4.20. The 4 4. 1 now see Fig . -2 on for a Y is a li near fu nct ion 9 4.2: The PDF of aX + b in terms of the PDF X. In this figure, a = 2 we obtain the PDF of aX . The range of Y is wider tha.n a factor of a. the PDF must this factor. But in order to the total area under the PDF to 1, we need to scale dow n the PDF by the same factor a. The random variable aX + b is t he same as aX except that its values are sh ifted by b. Accordingly, we take t he PDF of aX and shift it (horizontally) by b. The end result of these operations is the PDF o f Y = aX + b and is given mat hemat ical ly (Y : b) . If a were would b e the same of X would first need to be reflected around the vert ical axis ( ) yield ing a horizontal and vertical (by a factor of lal l/ial. respec- the PDF of -lalX = aX . a horizontal sh ift of b would the PDF of + b. a a be a with y= b, a bare a O. Then, 1 (y) = � 206 Further Topics on Random Variables Chap. 4 To verify this formula, we first calculate the CDF of Y and then differenti­ ate. We only show the steps for the case where a > OJ the case a < 0 is similar. We have Fy(y) = P(Y � y) = P(aX + b � y) �p(x:s Y:b) = Fx (y a b) . We now differentiate this equality and use the chain rule, to obtain dFy 1 (y - b) fy(y) = dy (y) = �fx -a- . Example 4.4. A Linear Function of an Exponential Random Variable. Suppose that X is an exponential random variable with PDF fx (x) = { >'e-AX , if x � �, 0, otherwIse, where >. is a positive parameter. Let Y = aX + b. Then, { �e-A(Y-b)/a, if (y - b)/a � 0, fy(y) = lal 0, otherwise. Note that if b = ° and a > 0, then Y is an exponential random variable with parameter >./a. In general, however, Y need not be exponential. For example, if a < ° and b = 0, then the range of Y is the negative real axis. Example 4.5. A Linear Function of a Normal Random Variable is Nor­ mal. Suppose that X is a normal random variable with mean J-L and variance a2 , and let Y = aX + b, where a and b are scalars, with a =1= 0. We have Therefore, fx(x) = � e-(x-Il)2/2q2 . 211\" a 1 ( Y - b) fy(y) = � fx -a- 1 1 {(y -b ) 2/ 2} = - exp - -- - J-L 2a lal J21i= a a 1 { (y - b-aJ-L)2 } = .j2; lala exp - 2a2a2 . We recognize this as a normal PDF with mean aJ-L + b and variance a2a2. In particular, Y is a normal random variable. Sec. 4. 1 Derived Distributions 207 The Monotonic Case The calculation and the formula for the linear case can be generalized to the case where 9 is a monotonic function. Let X be a continuous random variable and suppose that its range is contained in a certain interval I, in the sense that fx (x) = 0 for x � I. We consider the random variable Y = g(X), and assume that 9 is strictly monotonic over the interval I. so that either (a) g(x) < g(x') for all x. x' E I satisfying x < x' (monotonically increasing case) . or (b) g(x) > g(x') for all x, x' E I satisfying x < x' (monotonically decreasing case). Furthermore. we assume that the function 9 is differentiable. Its derivative will necessarily be nonnegative in the increasing case and non positive in the decreasing case. An important fact is that a strictly monotonic function can be \"inverted\" in the sense that there is some function h, called the inverse of g. such that for all x E I, we have y = g(x) if and only if x = h(y) . For example, the inverse of the function g(x) = 180/x considered in Example 4.2 is h(y) = 180/y, because we have y = 180/x if and only if x = 180/y. Other such examples of pairs of inverse functions include g(x) =ax+b. where a and b are scalars with a i- 0, and g(x) = eax , where a is a nonzero scalar. h(y) = Y - b . a h(y) = In y. a For strictly monotonic functions g, the following is a convenient analytical formula for the PDF of the function Y = g(X). PDF Formula for a Strictly Monotonic Function of a Continuous Random Variable Suppose that 9 is strictly monotonic and that for some function h and all x in the range of X we have y = g(x) if and only if x = h(y). Further on 4 .. ..,OJ ..., .............. that h is the in the region where fy(y) > 0 is given by (y) = (h(y)) -(y) . a verification of the above formula, assume first that 9 monotonical1y Then . we have Fy(y) = P(g(X ) � y) = P(X � h(y)) = Fx(h(y))� where the second equality can be justified the monotonical ly increasing property of 9 (see Fig. 4. 3) . By different iating this relation , using also the chain rule , we obtain (y) = - (y) = dh (h(y)) -(y). Because 9 is monoton ically increasing. h is monotonically increasi ng: so Idh dy (y) = dy (y) for a monotonically ...... u.o.:>£.u.s;;;.. function case instead the relation Fy (y) = (g(X) $ y) = p(X � h(y)) = 1 - use the chain rule. 9 = IS .::J &.I. &.I. , '(.1,.1. (h(y)) . 4.3: Calculating the probabi lity p (g(X) � y) . When 9 is ............ 'n .... t' /-.. .... (left . the event {g(X) � y } is the same as the event {X � h(y)}. When 9 is (right the event � y } is the same as the event {X � h(y)}. we Sec. 4.1 Derived Distribu tions 209 Example 4.2 (continued). To check the PDF formula, let us apply it to the problem of Example 4.2. In the region of interest, x E [30, 60] , we have h(y) = 180/y, and 1 fx (h(y)) = 30 ' dh ( ) = 180 d y 2 • Y Y Thus, in the region of interest y E [3,6], the PDF formula yields dh 1 180 6 fy(y) = fx (h(y)) dy (y) = 30 . -:yr- = y2' consistent with the expression obtained earlier. Example 4.6. Let Y = g(X) = X2, where X is a continuous uniform random variable on the interval (0, 1] . Within this interval, 9 is strictly monotonic, and its inverse is h(y) = ..;Y. Thus, for any y E (0. 1] , we have fx (v'Y) = 1. and fy(y) = { 2� . 0, dh (y) _ 1 dy 2JY ' if y E (0. 1.]. otherwise. We finally note that if we interpret PDFs in terms of probabilities of small intervals, the content of our formulas becomes pretty intuitive; see Fig. 4.4. Functions of Two Random Variables The two-step procedure that first calculates the CDF and then differentiates to obtain the PDF also applies to functions of more than one random variable. Example 4.7. Two archers shoot at a target. The distance of each shot from the center of the target is uniformly distributed from 0 to 1, independent of the other shot. What is the PDF of the distance of the losing shot from the center? Let X and Y be the distances from the center of the first and second shots. respectively. Let also Z be the distance of the losing shot: Z = max{X, Y}. We know that X and Y are uniformly distributed over [0. 1] , so that for all z E [0. 1]. we have P(X :::; z) = P(Y :::; z) = z. on .Ii ...... ..... \"' ...... 4.4: Illustration of the PDF a mcmotOlllclllll). m(:re,a,sl n,e: func­ g . Consider an interval where is a small number. m(lPI)lng 9. the of this interval is another interval y + is the of g � we have or in terms of the inverse We now note that the event y + }. dh - � - (y), � X � x + } is the same as the event � ::;V::; y + = �X::;x + We move to obtain to the left- hand side and use our earlier formula the ratio = if we move .. ,,-' uu.,U'Li side and use we obtain x we zE = = = < < Under Since 4 4. 1 1 o 1 o 1 4.5: The calculation of the CDF of Z = Y / X in 4.8. The value P(Y / X � is to shaded subarea of unit square. The figure on left deals with the case where 0 ::; z ::; 1 and the on the refers to the case where z > 1. Differentiating, we obtain fz = {2Z' 0, if O ::;z �l ! Y/X? 211 We wi ll find the PDF of Z by first finding its CDF and then differentiating. cases 0 � z � 1 z > 1. in we = (X ::;; z ) = 1 - 1 / (22) I if z > I, { 2/2, if 0 � 2 � 1, 0, otherwise. By differentiating, we obtain if O �z ::;l , if z > 1, (z) by considering separately the cases z � 0 and z < 0 y o Further Topics on Variables - y ... z 2: x x 4.6: The calculation of the of Z = X - Y in To obtain the value - Y > z) we must integrate the joint PDF y over the shaded area in the above figures, which correspond to z � 0 side) and z < 0 (right side) . z � O� we (see (4) = - Y ::; z) = 1 - P(X - Y > = 1 - 1\"\" dy = 1- e- '\" 1x 1 1 -AZ = - 2\" e . For the case z < O, we can use a calculation , but we can also 4 symmetry. Indeed , the symmetry of the situation implies that the random = - Y = same (z) = P( Z ::;: z) = P( -Z � - z) = P(Z � -z ) = 1 - z < 0, we -z > ° Fz (z) = 1 - (-z) = 1 - (1 - �e-A(-Z)) = �eAZ. Combi ning the two cases z � ° and z < 0, we obtai n (z) = {I - �e-AZ. if z ;::: 0, 1 AZ f 2\"e , i z < 0, ( - z) . Sec. 4.1 or Derived Distributions We now calculate the PDF of Z by differentiating its CDF. We have { � -AZ ·f > 0 2 e ,1 Z _ , fz {z) = \\ A AZ ·f 0 '2e , 1 Z < , f () >. - A l z l z Z = '2e . 213 This is known as a two-sided exponential PDF, also called the Laplace PDF. Sums of Independent Random Variables - Convolution We now consider an important example of a function Z of two random variables, namely, the case where Z = X + Y. for independent X and Y. For some initial insight, we start by deriving a PMF formula for the case where X and Y are discrete. Let Z = X + Y, where X and Y are independent integer-valued random variables with PMFs PX and py, respectively. Then, for any integer z, PZ(z) = P(X + Y = z) L P(X = x, Y = y) {(x.y) I x +y=z } = L P(X = x, Y = z - x) x = LPX(x)PY(z - x). x The resulting PMF PZ is called the convolution of the PMFs of X and Y. See Fig. 4.7 for an illustration. Suppose now that X and Y are independent continuous random variables with PDFs fx and fy, respectively. We wish to find the PDF of Z = X + Y. Towards this goal, we will first find the joint PDF of X and Z, and then integrate to find the PDF of Z. We first note that P(Z � z I X = x) = P(X + Y � z I X = x) = P(x + Y � z I X = x) = P(x + Y � z) = P(Y � z - x), where the third equality follows from the independence of X and Y. By differ­ entiating both sides with respect to z, we see that fZlx(z I x) = fy(z -x). Using the multiplication rule, we have fx,z(x, z) = fx(x)fzlx(z I x) = fx(x)fy(z - x), Further Topics on Randonl Variables Chap. 4 (0,3) . ( 1 • (2.1 ) ( :3 .0) ,1 ' 4.7: The pz (3) that X + Y = 3 is the sum of the of all such that x + y = 3, wh ich are the in the figure. The probability of a generic such point is of the form {x, 3 - = px {x)py (3 - we finally obtain (z) = 1: (x, z) (x)fy (z - x) is entirely analogous to the one for the �4 \"\"\"''\"''''''' '''''' by an the PrvIFs are except that by PDFs. and Y are independent and uniformly Z == + Y is ( z ) = 1: o S z - x S 1. two max{ O, Z - I} ::; x :s; min{l, z}. Thus , (z) = { 0, 1, z} - z- l}, O::;z::; ::; x ::; 1 and IS nonzero which has the triangular shape shown in Fig. 4.9. We next an the convolution formula. 4. 1 +y 4.8: Illustrat ion of the convolution formula for the case of cont i nuous random with For smal l 6, the of the is �x +y z+ = dx � dx . Thus . The desired formula follows CalI1CE:li lll)2; t. from bot h sides. 1 o meJlepen4:lerlt l1 '1'H'I'£,\\'I\"I,\" random 1 2 z z --a-z ex p { - ...:.------=-� } _______ 1- exp { can answer turns out to + are 4. 1 rando m 4.8: Illustration of the convolution formula for the case of continuous with For small 6� the of the indicated in the is :S X + Y :S .z + � ( Z )d . z+ (y) dy dx dx. The desi red formula follows 6 from both sides. 1 o 4.9: The PDF of the surn of two mClepenlOerlt uniform 1 2 z z + Y. __ I=-- exp { _ (x - J.lx )2 }_l_ exp { _ ____ --=-�_ } ax 2a; can answer turns out to --;========== exp { 215 are 216 Further Topics on Random Variables Chap. 4 which we recognize as a normal PDF with mean /-Lx + /-Ly and variance a; + a� . We therefore reach the conclusion that the sum of two independent normal random variables is normal. Given that scalar multiples of normal random variables are also normal (cf. Example 4.5), it follows that aX + bY is also normal, for any nonzero a and b. An alternative derivation of this important fact will be provided in Section 4.4, using transforms. Example 4. 12. The Difference of Two Independent Random Variables. The convolution formula can also be used to find the PDF of X - Y, when X and Y are independent, by viewing X - Y as the sum of X and -Y. We observe that the PDF of -Y is given by f-Y (Y) = fy (-y) , and obtain fx -y {z) = I: fx {x)f-y{z - x) dx = I: fx {x)fy {x - z) dx. As an illustration, consider the case where X and Y are independent expo­ nential random variables with parameter A, as in Example 4.9. Fix some z � 0 and note that fy {x - z) is nonzero only when x 2:: z. Thus, fx -y(z) = I: fx {x)fy {x - z) dx = fcc Ae- '>'x Ae- '>' (x-Z) dx = A2 e'>'Z foe e-2'>'x dx _ \\ 2 .>.z 1 - 2.>.z - /\\ e 2A e A - .>.z = -e 2 in agreement with the result obtained in Example 4.9. The answer for the case z < 0 is obtained with a similar calculation or, alternatively. by noting that fx -y{z) = fy-x{z) = f-(x-y) {z) = fx -y{-z), where the first equality holds by symmetry, since X and Y are identically dis­ tributed. When applying the convolution formula, often the most delicate step was to determine the correct limits for the integration. This is often tedious and error prone, but can be bypassed using a graphical method described next. Graphical Calculation of Convolutions We use a dummy variable t as the argument of the different functions involved in this discussion; see also Fig. 4. 10. Consider two PDFs fx(t) and fy(t). For a fixed value of z, the graphical evaluation of the convolution fz(z) = I: fx(t)fy(z - t) dt (h) (c) 217 ( z) amount z we are we UlJL CLl ll any z. b t c d t - d -c t o b 4.10: Illustration of the convolu tion calculation. For the value of z under eonsiderat ion. f z (z) is to the of the fu net ion shown in t he last 218 on ... eA ... , ......... '-' of two random is defined by Y) = [( X- E[X] )( Y - )] . When cov(X. Y) == O. \\ve ing. a or .. ��,��A - E [Y] obtained in a single experi ment -'tend\" to 11 ). Thus the an of relationship hornrc.:.:., .. y y negatively correlated Here. X and Y are over the shown in the case (a) the covariance cov (X. Y ) is positive, while in case (b) it is .. r.\"\" ..... ... \" ... . An formula the is cov(X, Y) = E [X YJ - E[X] E[YL as can be verified by a simple calculation . We a few ,..,. .... r� ...... ...... .,..t\" ances that are derived the definition: for any and Z, and scalars a b, we have cov(X. ) == cov( + b) == a . cov(X. ) . V) : cov(X. Z) . 4 Y) . provides and are independent , we E[XY] = E[X] E[Y] , which following example. Y) = O. Thus, if Y are independent , the converse is not true, as the Example 4. The pair of random variables (X. Y) takes the values (1 ,0), (0, 1) . (- 1, 0). and (0. -1 ). 1/4 4. 1 4.2 Correlation Yare 0, = E[Y] = O. for all pairs (x, y) ! either x or y is equal to 0, which implies that XY == 0 and E[XY] == O. Therefore, Y) == Yare are not example, a nonzero value of X fixes the value of Y to zero. This example can generalized . assume and satisfy E[X I Y == yj == E[XJ , for all y . Then, assuming X and Y are discrete, the total expectation theorem implies that so E[XY] == YPy (y)E[X I Y == y] == E[X] ypy(y) = E[X] E[YL y Y are uncorrelated , The argument for continuous case is similar. The ...,..n. ............ .n ........ ... ... ....... x 4. 12: Joint PMF of X and Y for Example 4.13. Each of the four Here ............ ,v ..... � ...... \"' .... , ......... p(X, Y) of two random '-& ..... .. ... ........... '-& as cov(X, Y) Jvar(X )var(Y) \"' ............... \"\" ... , ...... version of Y in problems) . -1 to 1 (see to p > 0 (or p < O) � of X - E[X] the same (or opposite, The size of Ipi measure of extent to this is true. In a that if and Y have positive it can be shown that p = 1 (or p = -1) only if there exists a positive (or c such - E[Y] = c(X - E[X] ) 220 Further Topics on Random Variables Chap. 4 (see the end-of-chapter problems) . The following example illustrates in part this property. Example 4. 14. Consider n independent tosses of a coin with probability of a head equal to p. Let X and Y be the numbers of heads and of tails, respectively, and let us look at the correlation coefficient of X and Y. Here, we have X + Y = n, and also E[X] + E[Y] = n. Thus, X - E[X] = -(Y - E[Y]) . We will calculate the correlation coefficient of X and Y, and verify that it is indeed equal to -1. We have cov(X, Y) = E[(X E[X]) (Y E[Y])] = -E [(X - E[X]) 2] = -var(X). Hence, the correlation coefficient is p(X, Y) = cov(X, Y) _ ---;::=-=v=ar:::::(X==:::::) = y'var(X)var(Y) vvar(X)var(X) Variance of the Sum of Random Variables -1. The covariance can be used to obtain a formula for the variance of the sum of several (not necessarily independent) random variables. In particular, if Xl, X2 , ... , Xn are random variables with finite variance, we have and, more generally, n = I: var(Xi )+ I: COV(Xi,Xj ). i=l {(i,j) I i,cj } This can be seen from the following calculation, where for brevity, we denote Xi = Xi - E[Xi]: Sec. 4.2 Covariance and Correlation n n = LL E[XiXj] i=l j=l n = L E [X/] + L E[XiXj] i=l {(i,j) I i;ej} n = L var(Xd + L COV(Xi,Xj). i=l {(i,j) I i;ej} The following example illustrates the use of this formula. 221 Example 4.15. Consider the hat problem discussed in Section 2.5, where n people throw their hats in a box and then pick a hat at random. Let us find the variance of X, the number of people who pick their own hat. We have X = Xl + ... + Xn , where Xt is the random variable that takes the value 1 if the ith person selects his/her own hat, and takes the value 0 otherwise. Noting that Xi is Bernoulli with parameter p = P(Xi = 1) = l/n, we obtain For i =/:. j, we have Therefore, E[XiJ =�, var(Xd = � (1 -�). 1 1 = P(Xi = 1 and Xj = 1) - - . - n n 1 = P(Xi = I)P(Xj = 1 1 Xi = 1) - - n2 1 1 1 n = L var(Xt) + L cov(Xi, Xj) i=l {(i,j) I ii=j} = n . � (1 - �) + n(n - 1) . 1 n n n2 (n - 1) = 1. 222 Further Topics on Random Variables Chap. 4 Covariance and Correlation • The covariance of X and Y is given by cov(X, Y) = E [(X - E [X]) (Y - ElY])] = E[XY] - E[X] E[Y] . • If cov(X, Y) = 0, we say that X and Y are uncorrelated. • If X and Y are independent, they are uncorrelated. The converse is not always true. • We have var{X + Y) = var{X) + var{Y) + 2cov{X, Y). • The correlation coefficient p{X, Y) of two random variables X and Y with positive variances is defined by and satisfies p(X, Y) = cov(X, Y) . Jvar(X)var(Y) , - 1 � p( X, Y) � 1. 4.3 CONDITIONAL EXPECTATION AND VARIANCE REVISITED In this section, we revisit the conditional expectation of a random variable X given another random variable Y, and view it as a random variable determined by Y. We derive a reformulation of the total expectation theorem. called the law of iterated expectations. \\Ve also obtain a new formula, the law of total variance, that relates conditional and unconditional variances. We introduce a random variable, denoted by E[X I YJ , that takes the value E[X I Y = y] when Y takes the value y. Since E[X I Y = y] is a function of y, E[X I Y] is a function of Y. and its distribution is determined by the distribution of Y. The properties of E[X I Y] will be important in this section but also later, particularly in the context of estimation and statistical inference, in Chapters 8 and 9. Example 4.16. We are given a biased coin and we are told that because of manufacturing defects, the probability of heads. denoted by Y, is itself random, with a known distribution over the interval [0. 1]. We toss the coin a fixed number n of times, and we let X be the number of heads obtained. Then. for any y E [0, 1], we have E[X I Y = y] = ny. so E[X I Y] is the random variable nY. Sec. 4.3 Conditional Expectation and Variance Revisited 223 Since E[X I Yl is a random variable, it has an expectation E [E[X I YJ] of its own, which can be calculated using the expected value rule: L E[X I Y = Ylpy (y) , Y discrete, E[E[X I YlJ y I: E[X I Y = yl Jy (y) dy, Y continuous. Both expressions in the right-hand side are familiar from Chapters 2 and 3, re­ spectively. By the corresponding versions of the total expectation theorem. they are equal to E[Xl . This brings us to the following conclusion. which is actually valid for every type of random variable Y (discrete. continuous. or mixed) , as long as X has a well-defined and finite expectation E[Xl . Law of Iterated Expectations: E[E[X I Y:IJ = E[Xl · The following examples illustrate how the law of iterated expectations fa­ cilitates the calculation of expected values when the problem data include con­ ditional probabilities. Example 4.16 (continued). Suppose that Y. the probability of heads for our coin is uniformly distributed over the interval [0. 1] . Since E [X I Y] = nY and E[Y] = 1/2. by the law of iterated expectations, we have E[X] = E[E[X I Y]] = E[nY] = nE[Y] = � . Example 4.17. We start with a stick of length f. 'Ve break it at a point which is chosen randomly and uniformly over its length. and keep the piece that contains the left end of the stick. We then repeat the same process on the piece that we were left with. What is the expected length of the piece that we are left with after breaking twice? Let Y be t he length of the piece after we break for the first time. Let X be the length after we break for the second time. We have E[X I Y] = Y/2. since the breakpoint is chosen uniformly over a piece of length Y. For a similar reason. we also have E[Y] = f/2. Thus. E[X] = E [E[X I Y:IJ = E [�] = E�l = �. Example 4.18. Averaging Quiz Scores by Section. A class has n students and the quiz score of student i is Xi . The average quiz score is n m = � L Xi ' t=1 224 Further Topics on Random Variables Chap. 4 The students are divided into k disjoint subsets AI, .... Ak , and are accordingly assigned to different sections. We use ns to denote the number of students in section s. The average score in section s is The average score over the whole class can be computed by taking the average score ms of each section, and then forming a weighted average; the weight given to section s is proportional to the number of st udents in that section, and is ns/n. We verify that this gives the correct result: =m . How is this related to conditional expectations? Consider an experiment in which a student is selected at random, each student having probability l/n of being selected. Consider the following two random variables: x = quiz score of a student. Y = section of a student, (Y E {I, .. . , k}). We then have E[X] = m. Conditioning on Y = s is the same as assuming that the selected st udent is in section s. Conditional on that event , every student in that section has the same probability l/ns of being chosen. Therefore. E[X I Y = s] A randomly selected student belongs to section s with probability ns /n, i.e., P(Y = s) = na /n. Hence, k k m = E[X] = E [E[X I YJ] = LE[X I Y = s]P(Y = s) = L r;: rna . s=1 a=1 Thus, averaging by section can be viewed as a special case of the law of iterated expectat ions. Sec. 4.3 Conditional Expectation and Variance Revisited 225 Example 4.19. Forecast Revisions. Let Y be the sales of a company in the first semester of the coming year, and let X be the sales over the entire year. The company has constructed a statistical model of sales, and so the joint distribution of X and Y is assumed to be known. In the beginning of the year, the expected value E[X] serves as a forecast of the actual sales X. In the middle of the year. the first semester sales have been realized and the value of the random variable Y is now known. This places us in a new \"universe,\" where everything is conditioned on the realized value of Y. Based on the knowledge of Y, the company constructs a revised forecast of yearly sales, which is E[X I Yj. We view E[X I Yj - E[X] as the forecast revision, in light of the mid-year information. The law of iterated expectations implies that E[E[X I Yj- E[XJ] = E[E[X I YJ] - E[X] = E[X] - E[X] = O. This indicates that while the actual revision will usually be nonzero, in the beginning of the year we expect the revision to be zero. on the average. This is quite intuitive. Indeed. if the expected revision were positive. the original forecast should have been higher in the first place. We finally note an important property: for any function g, we have E [Xg(Y) I Y] = g(Y) E[X I Y] . This is because given the value of Y, g(Y) is a constant and can be pulled outside the expectation; see also Problem 25. The Conditional Expectation as an Estimator If we view Y as an observation that provides information about X, it is natural to view the conditional expectation, denoted x = E[X I Y] . as an estimator of X given Y. The estimation error is a random variable satisfying _ A X = X-X, E[X I Y] = E[X - X I Y] = E[X I Y] - E[X I Y] = X - X = o. Thus, the random variable E[X I Y] is identically zero: E[X I Y = y] 0 for all values of y. By using the law of iterated expectations, we also have E[X] = E [E[X I Yl] = o. This property is reassuring, as it indicates that the estimation error does not have a systematic upward or downward bias. 226 Further Topics on Random Variables Chap. 4 \\Ve will now show that X has another interesting property : it is uncor­ related with the estimation error X. Indeed. using the law of iterated expectations, we have where the last two equalities follow from the fact that X is completely determined by Y. so that E[X X I Y] = XE[X I Y] = O. I t follows that cov(X. X) = E[XX]- E[X] E[X] = 0 - E[X] · 0 = 0, and X and X are uncorrelated. An important consequence of the fact cov(�, xt = 0 is that by considering the variance of both sides in the equation X = XX, we obtain var (X) = var(X) + var(X). This relation can be written in the form of a useful law. as we now discuss. The Conditional Variance We introduce the random variable This is the function of Y whose value is the conditional variance of X when Y takes the value y: var( X I Y = y) = E [X2 1 Y = y] . Using the fact E[X] = 0 and the law of iterated expectations, we can write the variance of the estimation error as and rewrite the equation var(X) = var(X) + var(X) as follows. Law of Total Variance: var(X) = E [var(X I Y)] + var(E[X I YD · The law of total variance is helpful in calculating variances of random variables by using conditioning. as illustrated by the following examples. Sec. 4.3 Conditional Expectation and Variance Revisited 227 Example 4.16 (continued). We consider n independent tosses of a biased coin whose probability of heads, Y, is uniformly distributed over the interval [0, 1]. With X being the number of heads obtained, we have E[X I Y] = nY and var(X I Y) = nY(1 - Y). Thus, E [var(X I Y)] =E [nY( I - Y)] = n (E[Y] - E[y2J) Furthermore, ( 2) ( 1 1 1 ) n = n E[Y] - var(Y) - (E[Y]) = n - - - - - = - . 2 12 4 6 n2 var (E[X I YJ) = var(nY) = 12 · Therefore, by the law of total variance, we have n n2 var(X) = E [var(X I Y)] + var(E[X I YJ) = 6\" + 12 · Example 4.17 (continued). Consider again the problem where we break twice a stick of length £ at randomly chosen points. Here Y is the length of the piece left after the first break and X is the length after the second break. We calculated the mean of X as f.j4. We will now use the law of total variance to calculate var(X). Since X is uniformly distributed between a and Y, we have y2 var(X I Y) = 1\"2. Thus, since Y is uniformly distributed between a and £, we have 1 1t 1 2 1 1 31 i £2 E [var(X IY)] = - -y dy = _. -y =- . 12 0 £ 12 3£ 0 36 We also have E[X I Y] = Y/2, so 1 1 £2 £2 var(E[X I yO = var(Y/2) = 4var(Y) = 4 . 12 = 48 · Using now the law of total variance, we obtain £2 £2 7£2 var(X) = E [var(X I Y)] + var(E[X I yO = 36 + 48 = 144 · Example 4.20. Averaging Quiz Scores by Section - Variance. The setting is the same as in Example 4.18 and we consider again the random variables X = quiz score of a student, Y = section of a student, (Y E {I, .. . , k}) . on ns 5, n students. in the formula var (X) = [var (X I Y)] + var (E[X I Y]) . 4 Here, var (X I Y = s) is the of the quiz scores within s. Thus, k [var(X I = s)var(X I k n s var(X I = s ). n so that E [var(X I Y )] is the weighted of the sect ion variances , where each is in proportion to size. I Y = s1 is is a measure total states that the tot al quiz score variance can broken into two (a) The (b) var (E[X I YJ) We can be used to U<I.I�\"\"\"\"'V . by considering cases . A similar method applies to variance calculations. I Y] mean of E(X I Y] is Y = {I, 2, if x < 1, if x � 1. wit h 1 (1 5 ) 2 l( 5) 2 9 var I YJ) =\"2 \"2 - 4\" +\"2 2 - 4\" = 16 ' 1/4 - 1 3 :t 4.13: The PDF in .L.JA'aul .... 'OC 4. 21. Sec. 4.4 'Transforms 229 Conditioned on Y = 1 or Y = 2. X is uniformly distributed on an interval of length 1 or 2, respectively. Therefore, and 1 var( X I Y = 1) = -, 12 4 var(X I Y = 2) = 12 ' 1 1 1 4 5 E [var(X I Y)] = - . - + - . - = - . 2 12 2 12 24 Putting everything together. we obtain 5 9 37 var(X) = E [var(X I Y)] + var (E[X I YJ) = 24 + 16 = 48 ' We summarize the main points in this section. Properties of the Conditional Expectation and Variance • E[X I Y = yj is a number whose value depends on y. • E[X I Yj is a function of the random variable Y, hence a random vari­ able. Its value is E[X I Y = yj whenever the value of Y is y. • E[E[X I Y]] = E[X] (law of iterated expectations). • E[X I Y = y] may be viewed as an estimate of X given Y = y. The corresponding error E[X I Yj - X is a zero mean random variable that is uncorrelated with E[X I Yj . • var(X I Y) is a random variable whose value is var(X I Y = y) whenever the value of Y is y. • var(X) = E[var(X I Y)] + var (E[X I Y]) (law of total variance). 4.4 TRANSFORMS In this section, we introduce the transform associated with a random variable. The transform provides us with an alternative representation of a probability law. It is not particularly intuitive, but it is often convenient for certain types of mathematical manipulations. The transform associated with a random variable X (also referred to as the associated moment generating function) is a function Jvlx (s) of a scalar parameter s, defined by J..lx (s) = E[esXj. 230 Further Topics on Random Variables Chap. 4 The simpler notation M(s) can also be used whenever the underlying random variable X is clear from the context. In more detail, when X is a discrete random variable, the corresponding transform is given by x while in the continuous case it is given by t M(s) = I: e8X fx(x) dx. Let us now provide some examples of transforms. Example 4.22. Let { 1/2, px(x)= 1/6, 1/3, if x = 2, if x = 3, if x = 5. The corresponding transform is M( ) - E[ 8Xj _ 1 28 + 1 38 + 1 58 S - S - -e - e - e . 263 Example 4.23. The Transform Associated with a Poisson Random Vari­ able. Let X be a Poisson random variable with parameter A: x = 0, 1 ,2, ... The corresponding transform is 00 x _A M(s) = '\"' e8X A e L- x! x=o t The reader who is familiar with Laplace transforms may recognize that the transform associated with a continuous random variable is essentially the same as the Laplace transform of its PDF, the only difference being that Laplace transforms usually involve e-sx rather than eSx • For the discrete case, a variable z is sometimes used in place of eS and the resulting transform x is known as the z-transform. However, we will not be using z-transforms in this book. Sec. 4.4 Transforms We let a = eS >. and obtain x x lI1( ) - - A L a _ -A a _ a - A _ A ( eS - I) 1� S - e - - e e - e - e . X! x=o 231 Example 4.24. The Transform Associated with an Exponential Random Variable. Let X be an exponential random variable with parameter >.: X 2:: o. Then, - A.r dx (if s < >') >. >. - s' The above calculation and the formula for .M(s) is correct only if the integrand e ( S - A )X decays as :r increases. which is the case if and only if s < >.: otherwise, the integral is infinite. It is important to realize that the transform is not a number but rather a function of a parameter s. Thus. we are dealing with a transformation that starts with a function. e.g., a PDF, and results in a new function. Strictly speaking, 1\\1(8) is only defined for those values of 8 for which E[esX] is finite. as noted in the preceding example. Example 4.25. The Transform Associated with a Linear Function of a Random Variable. Let Mx {s) be the transform associated with a random variable X. Consider a new random variable Y = aX + b. We then have For example, if X is exponential with parameter >' = 1. so that Alx (s) = 1/(1 - s), and if Y = 2X + 3. then Aly(s) 3s 1 e 1 - 2s ' Example 4.26. The Transform Associated with a Normal Random Vari­ able. Let X be a normal random variable with mean 11 and variance (72. To calcu­ late the corresponding transform, we first consider the special case of the standard 232 Further Topics on Random Variables Chap. 4 normal random variable Y, where /1 = 0 and 0'2 = 1, and then use the formula derived in the preceding example. The PDF of the standard normal is f ( ) - 1 _y2 /2 Y Y - vz;r e , and the associated transform is MY(s)= j= _1_e-y2 /2 eSY dY - 00 vz;r 1 j= -(y2 /2)+SYd = -- e y v'2-rr - 00 s2 /2 1 joo _(y2 /2)+sy_(.�2 /2) d =e -- e y vz;r - ()C = e.s2 /2 _1_ joo e - (y - s)2/2dy vz;r - ()C where the last equality follows by using the normalization property of a normal PDF with mean s and unit variance. A general normal random variable with mean /1 and variance 0'2 is obtained from the standard normal via the linear transformation x = O'Y + /1. 2 The transform associated with the standard normal is A1y (s) = eS /2 , as verified above. By applying the formula of Example 4.25, we obtain 8\" (\".2 82 /2)+\"8 Mx (s) = e .... AJy (sO') = e .... . From Transforms to Moments The reason behind the alternative name '\"moment generating function\" is that the moments of a random variable are easily computed once a formula for the associated transform is available. To see this, let us consider a continuous random variable X, and let us take the derivative of both sides of the definition M(s) = i: eSX fx (x) dx, with respect to s. We obtain d d JOO - M(s) = - eSX fx (x) dx ds ds -00 JOO d = -esxfx(x) dx -00 ds = i: xeSX fx (x) dx. Sec. 4.4 TI-ansEorms 233 This equality holds for all values of s.t By considering the special case where s = 0, we obtain :. M(')I ,�o = i: X/X (x) dx = E[X] . More generally, if we differentiate n times the function 1\\1/(s) with respect to s, a similar calculation yields ::n M(s) ,�o = i: xn /x(x) dx = E[xn]. Example 4.27. We saw earlier (Example 4.22) that the PMF { 1/2, if x = 2. px{x) = 1/6, if x = 3, 1/3, if x = 5. is associated with the transform Thus, Also, �J{ ) 1 2s 1 3s 1 5s 11 S = - e + -e + -e . 26 3 1 28 1 38 1 58 1 = - . 2e + - . 3e + - . 5e 2 6 3 8=0 1 1 1 = 2 . 2 + 6 . 3+ 3 . 5 19 6 d2 I E[X2] = ds2 M{s) 8=0 = - . 4e + - . ge + - . 25e 1 2.. 1 3s 1 5s 1 2 6 3 8=0 1 1 1 = 2 . 4 + 6 . 9 + 3 . 25 71 - 6 t This derivation involves an interchange of differentiation and integration. The interchange turns out to be justified for all of the applications to be considered in this book. Furthermore, the derivation remains valid for general random variables, including discrete ones. In fact, it could be carried out more abstractly, in the form leading to the same conclusion. 234 Further Topics on Random Variables For an exponential random variable with PDF x ;::: O. we found earlier (Example 4.24) that Thus. ). /v[(8) = -\\ -. A-8 d ). d.<; A[(8) = (,\\ _ 8)2 ' d2 2). d82 A1(8) = (,\\ _ 8)3' By setting 8 = O. we obtain 1 E[X] = ); . 2 2 E[X ] = ).2 ' which agrees with the formulas derived in Chapter 3. Chap. 4 \\Ve close by noting two more useful and generic properties of transforms. For any random variable X. we have AIx (O) = E[eOX ] = E[l] = L and if X takes only nonnegative integer values, then lim AIx (s) = P (X = 0) s--::x; (see the end-of-chapter problems). Inversion of Transforms A very important property of the transform AIx (s) is that it can be inverted, i.e .. it can be used to determine the probability law of the random variable X. Some appropriate mathematical conditions are required, which are satisfied in all of our examples that make use of the inversion property. The following is a more precise statement. Its proof is beyond our scope. Inversion Property The transform Mx (s) associated with a random variable X uniquely deter­ mines the CDF of X, assuming that A1x (s) is finite for all s in some interval [ -a, a] , where a is a positive number. There exist explicit formulas that allow us to recover the Pl\\IF or PDF of a random variable starting from the associated transform, but they are quite diffi­ cult to use. In practice, transforms are usually inverted by \"pattern matching,\" Sec. 4.4 Transforms 235 based on tables of known distribution-transform pairs. We will see a number of such examples shortly. Example 4.28. We are told that the transform associated with a random variable X is M( ) 1 -s 1 1 4s 1 5s S = -e + - + - e + - e . 4 2 8 8 Since M (s) is a sum of terms of the form eSx , we can compare with the general formula x and infer that X is a discrete random variable. The different values that X can take can be read from the corresponding exponents, and are -1, 0, 4, and 5. The probability of each value x is given by the coefficient multiplying the corresponding eSx term. In our case, 1 P(X = -1) = - , 4 1 P(X = 0) = -, 2 1 P(X = 4) = 8' 1 P(X = 5) = - . 8 Generalizing from the last example, the distribution of a finite-valued dis­ crete random variable can be always found by inspection of the corresponding transform. The same procedure also works for discrete random variables with an infinite range, as in the example that follows. Example 4.29. The Transform Associated with a Geometric Random Variable. We are told that the transform associated with a random variable X is of the form peS M(s) = 1 (1 ) ' - -p eS where p is a constant in the range 0 < p :::; 1. We wish to find the distribution of X. We recall the formula for the geometric series: 1 2 -- =I + a+a + .. . , I-a which is valid whenever lal < 1. We use this formula with a = (1 - p)eS , and for s sufficiently close to zero so that (1 - p )eS < 1. We obtain As in the previous example, we infer that this is a discrete random variable that takes positive integer values. The probability P(X = k) is found by reading the coefficient of the term eks . In particular, P(X = 1) = p, P(X = 2) = p( 1 - p), and P(X = k) = p( 1 _ p)k-l, k = 1, 2, ... We recognize this as the geometric distribution with parameter p. 236 Note that Further Topics on Random Variables d 1'.1 pes (1 - p)pe2s d8 (8) = 1 - (1 - p)es + (1 - (1 - p)eS)2 Chap. 4 For 8 = 0, the right-hand side is equal to l/p, which agrees with the formula for E[X] derived in Chapter 2. Example 4.30. The Transform Associated with a Mixture of Two Dis­ tributions. The neighborhood bank has three tellers, two of them fast, one slow. The time to assist a customer is exponentially distributed with parameter >' = 6 at the fast tellers, and >. = 4 at the slow teller. Jane enters the bank and chooses a teller at random, each one with probability 1/3. Find the PDF of the time it takes to assist Jane and the associated transform. We have Then, x � o. M(8) = /.00 eSx (�6e-6X + �4e-4X) dx 2 100 sX6 -6x dx + 1 100 sX4 -4x d = - e e - e e x 3 0 3 0 2 6 1 4 :3 . 6 - 8 + :3 . 4 _ s (for s < 4). More generally, let X} , . . . ,Xn be continuous random variables with PDFs f Xl ' ... , f Xn · The value y of a random variable Y is generated as follows: an index i is chosen with a corresponding probability pi , and y is taken to be equal to the value of Xi . Then, fy(y) = Pl fxl (y) + ... + PnfXn (y), and My(s) = PIMx1 (s) + . . . + PnMxn (s). The steps in this problem can be reversed. For example, we may be given that the transform associated with a random variable Y is of the form We can then rewrite it as 1 1 3 1 _ . _- + _._- . 2 2-s 4 l- s 1 2 3 1 _ . _- + _ . _- , 4 2-s 4 l-s and recognize that Y is the mixture of two exponential random variables with parameters 2 and 1, which are selected with probabilities 1/4 and 3/4, respectively. Sec. 4.4 Transforms 237 Sums of Independent Random Variables Transform methods are particularly convenient when dealing with a sum of ran­ dom variables. The reason is that addition of independent random variables corresponds to multiplication of transforms, as we will proceed to show. This provides an often convenient alternative to the convolution formula. Let X and Y be independent random variables, and let Z = X + Y. The transform associated with Z is, by definition, Mz (s) = E[esZ] = E[es(x+y)] = E[esX esY] . Since X and Y are independent, esx and eSY are independent random variables, for any fixed value of s. Hence, the expectation of their product is the product of the expectations, and Mz (s) = E[esX]E[esY] = Mx(s)My(s). By the same argument, if Xl , ... , Xn is a collection of independent random variables, and then Example 4.31. The Transform Associated with the Binomial. Let Xl ' . . . ' Xn be independent Bernoulli random variables with a common parameter p. Then, for all i. The random variable Z = Xl + . .. + Xn is binomial with parameters n and p. The corresponding transform is given by Example 4.32. The Sum of Independent Poisson Random Variables is Poisson. Let X and Y be independent Poisson random variables with means .x and Jl, respectively, and let Z = X + Y. Then, M ( ) _ ACes _I) X S - e , and Thus, the transform associated with Z is the same as the transform associated with a Poisson random variable with mean .x + Jl. By the uniqueness property of transforms, Z is Poisson with mean .x + Jl. 238 Further Topics on Random Variables Chap. 4 Example 4.33. The Sum of Independent Normal Random Variables is Normal. Let X and Y be independent normal random variables with means J.lx , J.lY ' and variances a; , a� , respectively, and let Z = X + Y. Then, { a2 S2 } �lx(s) = exp T + J.lx S , { a2s2 } My(s) = exp + + J.ly S , and We observe that the transform associated with Z is the same as the transform associated with a normal random variable with mean J.lx + J.ly and variance a; + a� . By the uniqueness property of transforms, Z is normal with these parameters, thus providing an alternative to the derivation described in Section 4. 1, based on the convolution formula. Summary of Transforms and their Properties • The transform associated with a random variable X is given by X discrete, x Mx (s) = E[e8X] = I: eSX fx (x) dx, X continuous. • The distribution of a random variable is completely determined by the corresponding transform. • Moment generating properties: Mx (O) = 1, d ds Mx (s) = E[X] , 8=0 • If Y = aX + b, then My (s) = esbMx (as). • If X and Y are independent, then Mx+y (s) = Mx {s)My{s) . We have obtained formulas for the transforms associated with a few com­ mon random variables. We can derive such formulas with a moderate amount of algebra for many other distributions (see the end-of-chapter problems for the case of the uniform distribution) . We summarize the most useful ones in the tables that follow. Sec. 4.4 Transforms Transforms for Common Discrete Random Variables Bernoulli(p) (k = 0, 1) px (k) = { p, �f k _ L 1 - p, If k - 0, Binomial(n, p) (k = O. 1, ... ) n) px (k) = (�)pk{l - p)n-k, .AI X (s) = 1 - p + peS . pe'� Geometric{p) (k = 1, 2, ... ) px {k) = p{ l - p)k-I, Afx (s) 1 - (I p) e s' Poisson{A) (k = O. 1, ... ) e->\"Ak px (k) = k! ' Uniform{a, b) (k = a, a + 1, ... , b) 1 P x (k) = b _ a + 1 ' AI x (B) esa (es(b-a+ l ) -1) (b - a + 1){ eS - 1) . Transforms for Common Continuous Random Variables U niform( a, b) (a :::; x :::; b) 1 fx(x) = -b -, -a Exponential(A) (x 2:: 0) fx(x) = Ae->\"x, Normal(JL, (72) ( - 00 < x < (0) 1 2 2 fx(x) = e-(x-/-L) /20' : � (7 eSb esa AIx {s) = s(b - a) A Afx (B) = � , (B < A) . 239 240 Further Topics on Random Variables Chap. 4 Transforms Associated with Joint Distributions If two random variables X and Y are described by some joint distribution (e.g., a joint PDF), then each one is associated with a transform A1x (s) or Nly (s). These are the transforms of the marginal distributions and do not convey information on the dependence between the two random variables. Such information is contained in a multivariate transform, which we now define. Consider n random variables Xl , ... , X n related to the same experiment. Let Sl ..... Sn be scalar free parameters. The associated multivariate trans­ form is a function of these n parameters and is defined by The inversion property of transforms discussed earlier extends to the multivari- ate case. In particular. if Yl ..... Yn is another set of random variables and if 1\\Ixl ..... Xn (Sl , . . . . Sn ) = AIyl .. ... yn (Sl , .... Sn ) for all (Sl .. . . . Sn) belonging to some n-dimensional cube with positive volume. then the joint distribution of X I, ... . X n is the same as the joint distribution of YI , ... , Yn. 4.5 SUM OF A RANDOM NUMBER OF INDEPENDENT RANDOM VARIABLES In our discussion so far of sums of random variables, we have always assumed that the number of variables in the sum is known and fixed. In this section. we will consider the case where the number of random variables being added is itself random. In particular. we consider the sum where N is a random variable that takes nonnegative integer values, and Xl , X2 •... are identically distributed random variables. (If N = 0, we let Y = 0.) We as­ sume that N. Xl . X2 , ... are independent , meaning that any finite subcollection of these random variables are independent . Let us denote by E[X] and var(X) the common mean and variance, re­ spectively. of the Xi . We wish to derive formulas for the mean, variance, and the transform of Y. The method that we follow is to first condition on the event {N = n}, which brings us to the more familiar case of a fixed number of random variables. Fix a nonnegative integer n. The random variable Xl + ... + Xn is inde­ pendent of N and, therefore, independent of {N = n}. Hence, E[Y I N = n] = E[XI + .. . + XN IN = n] = E[X I + ... + Xn IN = n] = E[X I + ... + Xn] =nE[X] . Sec. 4.5 Sum of a Random Number of Independent Random Variables 241 This is true for every nonnegative integer n, so E[Y I N] = NE[X] . Using the law of iterated expectations, we obtain E[Y] = E [E[Y I N]] = E (NE[Xl] = E[N] E[X] . Similarly, var(Y I N = n) = var(X1 + .. . + XN I N = n) = var(X1 + .. . + Xn ) = nvar(X) . Since this is true for every nonnegative integer n, the random variable var(Y I N) is equal to Nvar(X) . We now use the law of total variance to obtain var(Y) = E [var(Y I N)] + var(E[Y I N]) = E [Nvar(X)] + var (NE[X]) = E[N]var(X) + (E[X]) 2var(N) . The calculation of the transform proceeds along similar lines. The trans­ form associated with Y, conditional on N = n, is E[esY I N = n] . However, condi­ tioned on N = n, Y is the sum of the independent random variables Xl , . . . , Xn , and E[esY I N = n] = E [eSX1 • • • esxN I N = n] = E [eSX1 .. . esXn] = E[eSX1 ] ... E[esXn] = (Alx(s)) n . where Afx (s) is the transform associated with Xi , for each i. Using the law of iterated expectations, the (unconditional) transform associated with Y is 00 My (s) = E[esY] = E [E[esY I NJ] = E [ (Alx(s)) N ] L (Alx(s)) npN (n) . Using the observation we have oc AIy (s) = L en log AIX (s)PN(n) . n=O n=O 242 Further Topics on Random Variables Chap. 4 Comparing with the formula :x: AIN(S) = E[esN] = L esnpN (n) . n=O we see that Aly(s) = AIN ( log AIx (s)) . i.e. , Afy (s) is obtained from the formula for AfN(S). with s replaced by log Afx (s) or, equivalently, with eS replaced by AIx (s). Let us summarize the properties derived so far. Properties of the Sum of a Random Number of Independent Ran­ dom Variables Let Xl , X2, ... be identically distributed random variables with mean E[X] and variance var(X). Let N be a random variable that takes nonnegative in­ teger values. We assume that all of these random variables are independent, and we consider the sum Y = X1+ ···+XN· Then: • E[Y] = E[N] E[X] . 2 • var(Y) = E[N] var(X) + (E[X] ) var(N). • We have lvly (s) = l\\,fN( log Mx(s)) . Equivalently, the transform lvly (s) is found by starting with the trans­ form MN(S) and replacing each occurrence of e8 with lvIx (s). Example 4.34. A remote village has three gas stations. Each gas station is open on any given day with probability 1/2. independent of the others. The amount of gas available in each gas station is unknown and is uniformly distributed between 0 and 1000 gallons. We wish to characterize the probability law of the total amount of gas available at the gas stations that are open. The number N of open gas stations is a binomial random variable with p = 1/2 and the corresponding transform is The transform !Ylx{ s) associated with the amount of gas available in an open gas station is elOOOs _ 1 l\\/x{ s) = 0 0 . lO s Sec. 4.5 Sum of a Random Number of Independent Random Variables 243 The transform associated with the total amount Y available is the same as MN (S) , except that each occurrence of eS is replaced with Mx (s) , i.e., 1 ( ( elOOOS _ 1)) 3 My (s) = 8 1 + 1000s Example 4.35. Sum of a Geometric Number of Independent Exponen­ tial Random Variables. Jane visits a number of bookstores, looking for Great Expectations. Any given bookstore carries the book with probability p, indepen­ dent of the others. In a typical bookstore visited, Jane spends a random amount of time, exponentially distributed with parameter A, until she either finds the book or she determines that the bookstore does not carry it. We assume that Jane will keep visiting bookstores until she buys the book and that the time spent in each is independent of everything else. We wish to find the mean, variance, and PDF of the total time spent in bookstores. The total number N of bookstores visited is geometrically distributed with pa­ rameter p. Hence, the total time Y spent in bookstores is the sum of a geometrically distributed number N of independent exponential random variables Xl , X2, .•. . We have E[Y] = E[N] E[X] = � . ±. Using the formulas for the variance of geometric and exponential random variables, we also obtain ( ) 2 1 1 1 I- p 1 var(Y) = E[N] var(X) + E[X] var(N) = p . A2 + A2 . � = A2p2 · In order to find the transform My (s), let us recall that A Mx (s) = -, - , /\\ -s Then, My (s) is found by starting with MN (S) and replacing each occurrence of eS with Mx (s). This yields PA A-S My (s) = pMx (s) 1 - (1 - p)Mx(s) - ------:--A ' which simplifies to 1-( 1- p) ­ A-S My (s) = fA p - s We recognize this as the transform associated with an exponentially distributed random variable with parameter PA, and therefore, fy (y) = pAe -P>'Y , y � o. 244 Further Topics on Random Variables Chap. 4 This result can be surprising because the sum of a fixed number n of indepen­ dent exponential random variables is not exponentially distributed. For example, if n = 2, the transform associated with the sum is (>'/(>' - s)) 2 , which does not correspond to an exponential distribution. Example 4.36. Sum of a Geometric Number of Independent Geometric Random Variables. This example is a discrete counterpart of the preceding one. We let N be geometrically distributed with parameter p. We also let each random variable Xi be geometrically distributed with parameter q. We assume that all of these random variables are independent. Let Y = Xl + ... + XN . We have qeS M x ( s) = -1 -----:( -=- 1 - _ - q-:-) e -s To determine My (s) , we start with the formula for MN (S) and replace each occur­ rence of eS with M x (s) . This yields and, after some algebra, pMx (s) lY!y (s) = 1 _ (1 - p)Mx(s) ' pqeS My ( s) = ----;;-\"\"------:--1 - (1 - pq)es We conclude that Y is geometrically distributed, with parameter pq. 4.6 SUMMARY AND DISCUSSION In this chapter, we have studied a number of advanced topics. We discuss here some of the highlights. In Section 4.1, we addressed the problem of calculating the PDF of a func­ tion g(X) of a continuous random variable X. The concept of a CDF is very useful here. In particular, the PDF of g(X) is typically obtained by calculat­ ing and differentiating the corresponding CDF. In some cases, such as when the function 9 is strictly monotonic, the calculation is facilitated through the use of special formulas. We also considered some examples involving a function g(X, Y) of two continuous random variables. In particular, we derived the convolution formula for the probability law of the sum of two independent random variables. In Section 4.2, we introduced covariance and correlation, both of which are important qualitative indicators of the relationship between two random variables. The covariance and its scaled version, the correlation coefficient , are involved in determining the variance of the sum of dependent random variables. They also play an important role in the linear least mean squares estimation methodology of Section 8.4. Sec. 4.6 Summary and Discussion 245 In Section 4.3, we reconsidered the subject of conditioning, with the aim of developing tools for computing expected values and variances. We took a closer look at the conditional expectation and indicated that it can be viewed as a random variable, with an expectation and variance of its own. We derived some related properties, including the law of iterated expectations, and the law of total variance. In Section 4.4, we introduced the transform associated with a random vari­ able, and saw how such a transform can be computed. Conversely, we indicated that given a transform, the distribution of an associated random variable is uniquely determined. It can be found, for example, using tables of commonly occurring transforms. We have found transforms useful for a variety of purposes, such as the following. (a) Knowledge of the transform associated with a random variable provides a shortcut for calculating the moments of the random variable. (b) The transform associated with the sum of two independent random vari­ ables is equal to the product of the transforms associated with each one of them. This property was used to show that the sum of two independent normal (respectively, Poisson) random variables is normal (respectively, Poisson). (c) Transforms can be used to characterize the distribution of the sum of a random number of random variables (Section 4.5), something which is often impossible by other means. Finally, in Section 4.5, we derived formulas for the mean, the variance, and the transform of the sum of a random number of random variables, by combining the methodology of Sections 4.3 and 4.4. 246 Further Topics on Random Variables Chap. 4 PROBLEMS SECTION 4.1. Derived Distributions Problem 1. If X is a random variable that is uniformly distributed between -1 and 1. find the PDF of JfXi and the PDF of In IXI. Problem 2. Find the PDF of eX in terms of the PDF of X. Specialize the answer to the case where X is uniformly distributed between 0 and 1. Problem 3. Find the PDFs of IX1 1/3 and IX11/4 in terms of the PDF of X. Problem 4. The metro train arrives at the station near your home every quarter hour starting at 6:00 a.m. You walk into the station every morning between 7: 10 and 7:30 a.m., with the time in this interval being a random variable with given PDF (d. Example 3. 14, in Chapter 3). Let X be the elapsed time, in minutes, between 7:10 and the time of your arrival. Let Y be the time that you have to wait until you board a train. Calculate the CDF of Y in terms of the CDF of X and differentiate to obtain a formula for the PDF of Y. Problem 5. Let X and Y be independent random variables, uniformly distributed in the interval [0, 1]. Find the CDF and the PDF of IX - YI. Problem 6. Let X and Y be the Cartesian coordinates of a randomly chosen point (according to a uniform PDF) in the triangle with vertices at (0, 1), (0, -1), and (1, 0). Find the CDF and the PDF of IX YI. Problem 7. Two points are chosen randomly and independently from the interval [0. 1] according to a uniform distribution. Show that the expected distance between the two points is 1/3. Problem 8. Find the PDF of Z = X + Y, when X and Y are independent exponential random variables with common parameter A. Problem 9. Consider the same problem as in Example 4.9, but assume that the random variables X and Y are independent and exponentially distributed with different parameters A and J.L, respectively. Find the PDF of X - Y. Problem 10. Let X and Y be independent random variables with PMFs () { 1/3, if x = 1, 2,3, px x = 0, otherwise, { 1/2, if y = 0, ( ) 1/3, if Y = 1, py y = 1/6, if y - 2, 0, otherwise. Find the PMF of Z = X + Y, using the convolution formula. Problems 247 Problem 11. Use the convolution formula to establish that the sum of two indepen­ dent Poisson random variables with parameters A and J.L. respectively, is Poisson with parameter A + J.L. Problem 12. The random variables X, Y. and Z are independent and uniformly distributed between zero and one. Find the PDF of X + Y + Z. Problem 13. Consider a PDF that is positive only within an interval [a, b] and is symmetric around the mean (a + b)/2. Let X and Y be independent random variables that both have this PDF. Suppose that you have calculated the PDF of X + Y. How can you easily obtain the PDF of X - Y? Problem 14. Competing exponentials. The lifetimes of two light bulbs are modeled as independent and exponential random variables X and Y, with parameters A and J.L, respectively. The time at which a light bulb first burns out is Z = min{X. Y}. Show that Z is an exponential random variable with parameter A + J.L. Problem 15. * Cauchy random variable. (a) Let X be a random variable that is uniformly distributed between -1/2 and 1/2. Show that the PDF of Y = tan( 71' X) is 1 fy (y) = 71'( 1 + y2 ) , - ex:: < y < ex::. (Y is called a Cauchy random variable .) (b) Let Y be a Cauchy random variable. Find the PDF of the random variable X, which is equal to the angle between -71'/2 and 71'/2 whose tangent is Y. Solution. (a) We first note that Y is a continuous, strictly monotonically increasing function of X. which takes values between -ex:: and ex:: . as X ranges over the interval [- 1/2, 1/2] . Therefore, we have for all scalars y. Fy (y) = P(Y ::; y) = P (tan(7rX) ::; y) = p (7rX::; tan- l y) = :; tan- l y + �, where the last equality follows using the CDF of X. which is uniformly distributed in the interval [- 1/2, 1/2] . Therefore, by differentiation, using the formula d/dy(tan- l y) = 1/(1 + y2 ). we have for all y. 1 fy(y) = 71'(1 + y2 ) ' (b) We first compute the CDF of X and then differentiate to obtain its PDF. We have for -71'/2 ::; x ::; 71'/2. P(X :s x) = P(tan -1 Y ::; x) = P(Y ::; tan x) 248 Further Topics on Random Variables 1 jtanx 1 = - dy rr -00 1 + y2 1 -1 I tan x = - tan y rr -oc Chap. 4 For x < -rr /2, we have P(X ::; x) = 0, and for rr /2 < x, we have P(X ::; x) = 1. Taking the derivative of the CDF P(X ::; x) , we find that X is uniformly distributed on the interval [-rr /2, rr /2] . Note: An interesting property of the Cauchy random variable is that it satisfies as can be easily verified. As a result. the Cauchy random variable does not have a well­ defined expected value, despite the symmetry of its PDF around 0; see the footnote in Section 3. 1 on the definition of the expected value of a continuous random variable. Problem 16. * The polar coordinates of two independent normal random variables. Let X and Y be independent standard normal random variables. The pair (X, Y) can be described in polar coordinates in terms of random variables R ;::: 0 and 8 E [0,2rr] , so that X = Rcos e, Y = Rsin 8. (a) Show that 8 is uniformly distributed in [0,2rr] , that R has the PDF r ;::: 0, and that R and 8 are independent. (The random variable R is said to have a Rayleigh distribution.) (b) Show that R2 has an exponential distribution with parameter 1/2. Note: Using the results in this problem, we see that samples of a normal random vari­ able can be generated using samples of independent uniform and exponential random variables. Solution. (a) The joint PDF of X and Y is We first find the joint CDF of R and 8. Fix some r > 0 and some B E [0. 2rr] . and let A be the set of points (x, y) whose polar coordinates (r, O) satisfy 0 ::; r ::; r and o ::; 0 ::; B; note that the set A is a sector of a circle of radius r. with angle B. We have FR.e(r,B) = P(R ::; 1', e ::; B) = p((X, Y) E A) Problems 249 where the last equality is obtained by transforming to polar coordinates. We then differentiate, to find that _ a2 FR.e _ r _r2 /2 !R.e(r.8) - ara8 (r. 8) - 27f e . r 2: 0, 8 E [0,27f] . Thus, Furthermore, 1 2� 2 !R (r) = 0 !R.e (r, 8) d() = re-r /2 , r 2: 0. I (8 I ) = !R,e(r, 8) = � J el R r fR(r) 27f ' 8 E [0, 27f]. Since the conditional PDF !el R of e is unaffected by the value of the conditioning variable R. it follows that it is also equal to the unconditional PDF !e . In particular, !R,e (r. ()) = !R (r)!e(8) , so that R and e are independent. (b) Let t 2: 0. We have Jx 2 lX P (R2 2: t) = P (R 2: Vi) = re-r /2 dr = e- u du = e -t/2 • vt t/2 where we have used the change of variables u = r2 /2. By differentiating, we obtain ! (t) - ! - t/2 R2 - 2 e , t 2: 0. SECTION 4.2. Covariance and Correlation Problem 17. Suppose that X and Y are random variables with the same variance. Show that X - Y and X + Y are uncorrelated. Problem 18. Consider four random variables. \\IF. X. Y, Z. with E[W] = E[X] = E[Y] = E[Z] = 0, var( W) = var(X) = var(Y) = var(Z) = 1. and assume that W. X, Y. Z are pairwise uncorrelated. Find the correlation coefficients p(R. S) and p(R. T) . where R = W +X, S = X + Y. and T = Y + Z. Problem 19. Suppose that a random variable X satisfies and let Y = a + bX + cX2. Find the correlation coefficient p(X. Y). 250 Further Topics on Random Variables Chap. 4 Problem 20. * Schwarz inequality. Show that for any random variables X and Y. we have Solution. We may assume that E[y2] i= 0; otherwise, we have Y = 0 with probability 1. and hence E[XY] O. so the inequality holds. We have 0 < E [(X - E[XY] y) 2] - E[Y2] = E [X2 - 2 E[XY] XY + (E[XYJ) 2 y2] E[Y2] (E[Y2J) 2 E[X2] _ 2 E[XY] E[XY] + (E[XY]) 2 E[y2] E[Y2] (E[Y2J) 2 2 (E[XYJ) 2 = E[X ] - E[Y2] 1 i.e., (E[xYl) 2 � E[X2] E[y2]. Problem 21.* Correlation coefficient. Consider the correlation coefficient p(X. Y) = cov(X. Y) vvar(X) var(Y) of two random variables X and Y that have positive variances. Show that: (a) Ip(X, Y)I � 1. Hint: Use the Schwarz inequality from the preceding problem. (b) If Y - E[Y] is a positive (or negative) multiple of X - E[X], then p(X, Y) = 1 [or p(X. Y) = -1, respectively] . (c) If p(X, Y) 1 [or p(X, Y) = -1]. then, with probability 1. Y -E[Y] is a positive (or negative. respectively) multiple of X - E[X]. Solution. (a) Let X = X - E[X] and Y = Y - E[Y]. Using the Schwarz inequality, we get and hence Ip(X, Y)I � 1. (b) If Y = aX, then (E[Xy]) 2 ( (X y)) 2 = < 1 p , E[X2] E[Y2] - , p(X. Y) = E[X aX] = .5:.. . JE[X2] E[(aX)2] lal Problems (c) If (p(X, y») 2 = 1, the calculation in the solution of Problem 20 yields E X - E[�Y] y = E[X2] _ _ [( - - ) 2] (E[Xy]) 2 E[y2] E[Y2] = E[X21(1 - (p(X, y») 2) = 0. Thus, with probability 1, the random variable - E[XY] -X- _ Y E[y2] is equal to zero. It follows that, with probability I, - E[XY] -X= _ Y= E[Y2] 251 i.e., the sign of the constant ratio of X and Y is determined by the sign of p(X, Y). SECTION 4.3. Conditional Expectation and Variance Revisited Problem 22. Consider a gambler who at each gamble either wins or loses his bet with probabilities p and 1 - p, independent of earlier gambles. When p > 1/2, a popular gambling system , known as the Kelly strategy, is to always bet the fraction 2p - 1 of the current fortune. Compute the expected fortune after n gambles, starting with x units and employing the Kelly strategy. Problem 23. Pat and Nat are dating, and all of their dates are scheduled to start at 9 p.m. Nat always arrives promptly at 9 p.m. Pat is highly disorganized and arrives at a time that is uniformly distributed between 8 p.m. and 10 p.m. Let X be the time in hours between 8 p.m. and the time when Pat arrives. If Pat arrives before 9 p.m., their date will last exactly 3 hours. If Pat arrives after 9 p.m., their date will last for a time that is uniformly distributed between 0 and 3 - X hours. The date starts at the time they meet. Nat gets irritated when Pat is late and will end the relationship after the second date on which Pat is late by more than 45 minutes. All dates are independent of any other dates. (a) What is the expected number of hours Nat waits for Pat to arrive? (b) What is the expected duration of any particular date? (c) What is the expected number of dates they will have before breaking up? Problem 24. A retired professor comes to the office at a time which is uniformly distributed between 9 a.m. and 1 p.m., performs a single task, and leaves when the task is completed. The duration of the task is exponentially distributed with parameter ,X(y) = 1/(5 - y), where y is the length of the time interval between 9 a.m. and the time of his arrival. 252 Further Topics on Random Variables Chap. 4 (a) What is the expected amount of time that the professor devotes to the task? (b) What is the expected time at which the task is completed? (c) The professor has a Ph.D. student who on a given day comes to see him at a time that is uniformly distributed between 9 a.m. and 5 p.m. If the student does not find the professor, he leaves and does not return. If he finds the professor, he spends an amount of time that is uniformly distributed between 0 and 1 hour. The professor will spend the same total amount of time on his task regardless of whether he is interrupted by the student. What is the expected amount of time that the professor will spend with the student and what is the expected time at which he will leave his office? Problem 25. * Show that for a discrete or continuous random variable X, and any function g(Y) of another random variable Y, we have E[Xg(Y) I YJ = g(Y) E[X I YJ . Solution. Assume that X is continuous. From a version of the expected value rule for conditional expectations given in Chapter 3, we have E[Xg(Y) I Y = yJ = 1: xg(y)jx IY (X I y) dx = g(y) I: xjxlY (X I y) dx = g(y) E[X I Y = yJ . This shows that the realized values E[Xg(Y) I Y = yJ and g(y)E[X I Y = yJ of the random variables E[Xg(Y) I YJ and g(Y)E[X I YJ are always equal. Hence these two random variables are equal. The proof is similar if X is discrete. Problem 26. * Let X and Y be independent random variables. Use the law of total variance to show that var(XY) = (E[XJ) 2var(Y) + (E[YJ) 2var(X) + var(X)var(Y). Solution. Let Z = XY. The law of total variance yields var(Z) = var(E[Z I XJ) + E [var(Z I X)] . We have E[Z I XJ = E[XY I XJ = XE[Y] , so that var(E[Z I Xl) = var(XE[YJ) = (E[Yl) 2var(X). Furthermore, var(Z I X) = var(XY I X) = X2var(Y I X) = X2var(Y), so that E [var(Z I X)] = E[X2]var(Y) = (E[Xl) 2var(Y) + var(X)var(Y). Problems 253 Combining the preceding relations, we obtain var(XY) = (E[XJ) 2var(Y) + (E[YJ) 2var(X) + var(X)var(Y). Problem 27. * We toss n times a biased coin whose probability of heads, denoted by q, is the value of a random variable Q with given mean J.L and positive variance (j2 . Let X1 be a Bernoulli random variable that models the outcome of the ith toss (i.e., Xi = 1 if the ith toss is a head). We assume that Xl , . . . , Xn are conditionally independent, given Q = q. Let X be the number of heads obtained in the n tosses. (a) Use the law of iterated expectations to find E[X1J and E[XJ . (b) Find COV(Xi, Xj ). Are Xl , ... ,Xn independent? (c) Use the law of total variance to find var(X). Verify your answer using the co­ variance result of part (b) . Solution. (a) We have, from the law of iterated expectations and the fact E[Xi I QJ = Q, Since X = Xl + ... + Xn , it follows that E[X] = E[XI ] + ... + E[XnJ = nJ.L. (b) We have, for i =1= j, using the conditional independence assumption, and Thus, Since COV(Xi ' Xj ) > 0, Xl , ... , Xn are not independent. Also, for i = j, using the observation that xl = X1 , var(Xi ) = E[Xl] - (E[XiJ) 2 = E[XiJ - (E[XiJ) 2 2 =J.L- J.L . 254 Further Topics on Random Variables Chap. 4 (c) Using the law of total variance, and the conditional independence of Xl , ... , Xn , we have var(X) = E [var(X I Q)] + var(E[X I QJ) = E [var(Xl + ... + Xn I Q)] + var(E[X1 + ... + Xn I QJ) = E [nQ(1 - Q)] + var(nQ) = nE[Q - Q2] + n2var(Q) = n(J-L - J-L2 - 0'2 ) + n20'2 = n(J-L - J-L2 ) + n(n - 1)0'2 . To verify the result using the covariance formulas of part (b), we write var(X) = var(X1 + ... + Xn ) n = L var(Xd + L COV(Xi, Xj ) i=l {(i,j) I i#j } = nvar(X1 ) + n(n - I)COV(Xl , X2 ) = n(J-L - J-L2 ) + n( n - 1 )0'2 . Problem 28. * The Bivariate Normal PDF. The (zero mean) bivariate normal PDF is of the form fx,Y(x, y) = ce-q(x,y) , where the exponent term q(x, y) is a quadratic function of x and y, q(x, y) = O'x and O'y are positive constants, p is a constant that satisfies -1 < p < 1, and c is a normalizing constant. (a) By completing the square, rewrite q(x, y) in the form (ax - {3y)2 + ,y2 , for some constants a, (3, and ,. (b) Show that X and Y are zero mean normal random variables with variance 0'; and O'� , respectively. ( c) Find the normalizing constant c. (d) Show that the conditional PDF of X given that Y = y is normal, and identify its conditional mean and variance. (e) Show that the correlation coefficient of X and Y is equal to p. (f) Show that X and Y are independent if and only if they are uncorrelated. (g) Show that the estimation error E[X I Y] - X is normal with mean zero and variance (1 - / )0'; , and is independent from Y. Problems Solution. (a) We can rewrite q(x, y) in the form q(x, y) = ql (x, y) + q2 (y) , where 1 ( x Y )2 qdx, y) = 2( 1 - p2) ax - p ay . and (b) We have Using the change of variables we obtain Thus, fy (y) = cax Jl - p2 y'2;:e-y2/2(7� . 255 We recognize this as a normal PDF with mean zero and variance a�. The result for the random variable X follows by symmetry. (c) The normalizing constant for the PDF of Y must be equal to 1/ ( v'27f a y). It follows that which implies that (d) Since and f ( ) 1 e-q1 (x,y)e-Q2(y) x,y x ,y = , 27raxay y'1 - p2 we obtain f ( I ) - fx,Y (x , y) _ 1 { (x - paxy/ay)2 } x I y x Y - - exp - . fy (y) v'27fax Jl - p2 2ai (l - p2) 256 Further Topics on Random Variables Chap. 4 For any fixed y, we recognize this as a normal PDF with mean (pax/ay)y, and variance a; (1 - p2 ) . In particular, E[X I Y = y] = (pax/ay)Y. and E[X I Y] = (pax/ay)Y. (e) Using the expected value rule and the law of iterated expectations, we have E[XY] = E [E[XY I YJ] = E [YE[X I Y:i] = E [Y(pax/l1y)Y] = paX E[y2] ay = paxay . Thus, the correlation coefficient p(X . Y) is equal to p(X, Y) = cov(X. Y) = E[XYj = p. axay axay (f) If X and Y are uncorrelated, then p = 0, and the joint PDF satisfies fx.y (x, y) = fx (x)fy (y) , so that X and Y are independent. Conversely, if X and Y are independent, then they are automatically uncorrelated. (g) From part (d). we know that conditioned on Y = y, X is normal with mean E[X I Y = yj and variance (1 - /)a;. Therefore, conditioned on Y = y, the estimation error X = E[X I Y = yj - X is normal with mean zero and variance (1 - p2)a;, i.e .. Since the conditional PDF of X does not depend on the value y of y, it follows that X is independent of Y, and the above conditional PDF is also the unconditional PDF of X. SECTION 4.4. Transforms Problem 29. Let X be a random variable that takes the values 1. 2, and 3, with the following probabilities: 1 P(X = 1) = 2 ' 1 P(X = 2) = 4' 1 P(X = 3) = -. 4 Find the transform associated with X and use it to obtain the first three moments, E[Xj. E[X2], E[X3j. Problem 30. Calculate E[X3] and E[X4] for a standard normal random variable X. Problem 31. Find the third, fourth, and fifth moments of an exponential random variable with parameter 'x. Problems 257 Problem 32. A nonnegative integer-valued random variable X has one of the follow­ ing two expressions as its transform: 1. !vf(8) = e2(eeS - l_ l ) . s 2. M(8) = e2(ee - 1) . (a) Explain why one of the two cannot possibly be the transform. (b) Use the true transform to find P(X = 0). Problem 33. Find the PDF of the continuous random variable X associated with the transform 1 2 2 3 M(s) = - . -- + -. -- . 3 2-8 3 3-8 Problem 34. A soccer team has three designated players who take turns striking penalty shots. The ith player has probability of success PI , independent of the successes of the other players. Let X be the number of successful penalty shots after each player has had one turn. Use convolution to calculate the PMF of X. Confirm your answer by first calculating the transform associated with X and then obtaining the PMF from the transform. Problem 35. Let X be a random variable that takes nonnegative integer values, and is associated with a transform of the form 3 + 4e2s + 2e3s A1x (s) =c , , 3 - eS where c is some scalar. Find E[X] , px (1), and E[X I X 1= 0] . Problem 36. Let X. Y, and Z be independent random variables, where X is Bernoulli with parameter 1/3, Y is exponential with parameter 2, and Z is Poisson with param­ eter 3. (a) Consider the new random variable U = XY + (1 - X)Z. Find the transform associated with U. (b) Find the transform associated with 2Z + 3. (c) Find the transform associated with Y + Z. Problem 37. A pizza parlor serves n different types of pizza, and is visited by a number K of customers in a given period of time, where K is a nonnegative integer random variable with a known associated transform MK (S) = E[esK]. Each customer orders a single pizza. with all types of pizza being equally likely, independent of the number of other customers and the types of pizza they order. Give a formula, in terms of l\\1K (')' for the expected number of different types of pizzas ordered. Problem 38. * Let X be a discrete random variable taking nonnegative integer values. Let M (s) be the transform associated with X. (a) Show that P(X = 0) = lim M(s) . s--oo 258 Further Topics on Random Variables Chap. 4 (b) Use part (a) to verify that if X is a binomial random variable with parameters n and p, we have P(X = 0) = (1 - pt . Furthermore, if X is a Poisson random variable with parameter .A. we have P( X = 0) = e - A . (c) Suppose that X is instead known to take only integer values that are greater than or equal to a given integer k. How can we calculate P( X = k) using the transform associated with X? Solution. ( a) We have oc Al(s) = L P(X = k)eks. k=O As s ---+ -oc, all the terms eks with k > 0 tend to 0, so we obtain lims_-::>e A1(s) = P(X = 0) . (b) In the case of the binomial, we have from the transform tables so that lims_ -oc Al(s) = (1 - p)n . In the case of the Poisson, we have so that lims_-oc Al(s) = e- A • (c) The random variable Y = X - k takes only nonnegative integer values and the associated transform is A1y (s) = e-SkAl(s) (cf. Example 4.25) . Since P(Y = 0) = P(X = k) , we have from part (a) , P(X = k) = lim e- sk Al(s). s� - oo Problem 39. * Transforms associated with uniform random variables. (a) Find the transform associated with an integer-valued random variable X that is uniformly distributed in the range {a, a + 1, .. . , b}. (b) Find the transform associated with a continuous random variable X that is uni­ formly distributed in the range [a, bl . Solution. (a) The PMF of X is if k = a, a + 1. ... , b, otherwise. The transform is A1(s) = L eskp (X = k) k =-oc Problems (b) We have b L 1 sk - e b-a + l k=a sa b-a _ e � esk b-a + l L..,. k=O esa es(b-a+l) - 1 b-a + l sx Jb eSx eSb - esa M(s) = E[e 1 = a b _ a dx = s(b - a) . 259 Problem 40. * Suppose that the transform associated with a discrete random variable X has the form A(eS) M(s) = B(es) ' where A(t) and B(t) are polynomials of the generic variable t. Assume that A(t) and B(t) have no common roots and that the degree of A(t) is smaller than the degree of B(t). Assume also that B(t) has distinct, real, and nonzero roots that have absolute value greater than 1. Then it can be seen that M(s) can be written in the form where I/T l , ... , I/Tm are the roots of B(t) and the ai are constants that are equal to limes _.!. (1 - TieS)M(s), i = 1, ... , m. ri (a) Show that the PMF of X has the form P(X = k) = { f aiTf' t=l 0, if k = 0, 1, ... , otherwise. Note: For large k, the PMF of X can be approximated by a-;TI' where I is the index corresponding to the largest ITil (assuming I is unique) . (b) Extend the result of part (a) to the case where M(s) = ebs A(eS)/ B(eS) and b is an integer. Solution. (a) We have for all s such that ITi les < 1 Therefore, 260 Further Topics on Random Variables and by inverting this transform, we see that m P(X = k) I: air: t=l Chap. 4 for k ;::: 0, and P(X = k) = 0 for k < O. Note that if the coefficients a, are nonnegative, this PMF is a mixture of geometric PMFs. (b) In this case, AI ( s) corresponds to the translation by b of a random variable whose transform is A(e8)/ B(e8 ) (cf. Example 4.25), so we have P(X = k) = {�; a,rj'-b) , if k = b, b + 1 \" \" , 0, otherwise. SECTION 4.4. Sum of a Random Number of Independent Random Variables Problem 41. At a certain time, the number of people that enter an elevator is a Poisson random variable with parameter A. The weight of each person is independent of every other person's weight, and is uniformly distributed between 100 and 200 lbs. Let Xi be the fraction of 100 by which the ith person exceeds 100 lbs, e.g. , if the 7th person weighs 175 lbs. , then X7 0.75. Let Y be the sum of the Xi . (a) Find the transform associated with Y. (b) Use the transform to compute the expected value of Y. (c) Verify your answer to part (b) by using the law of iterated expectations. Problem 42. Construct an example to show that the sum of a random number of independent normal random variables is not normal (even though a fixed sum is) . Problem 43. A motorist goes through 4 lights, each of which is found to be red with probability 1/2 . The waiting times at each light are modeled as independent normal random variables with mean 1 minute and standard deviation 1/2 minute. Let X be the total waiting time at the red lights. (a) Use the total probability theorem to find the PDF and the transform associated with X, and the probability that X exceeds 4 minutes. Is X normal? (b) Find the transform associated with X by viewing X as a sum of a random number of random variables. Problem 44. Consider the calculation of the mean and variance of a sum Y=X1 +\" , +XN, where N is itself a sum of integer-valued random variables, i.e., Problems 261 Here N, M, KI , K2 , ... , Xl , X2 , ... are independent random variables, N, M, KI , K2 , ... are integer-valued and nonnegative, K I, K2 , ••• are identically distributed with common mean and variance denoted E[K] and var(K), and Xl , X2 , '\" are identically distributed with common mean and variance denoted E[X] and var(X ). (a) Derive formulas for E[N] and var(N) in terms of E[lHJ , var(Af), E[K], var(K). (b) Derive formulas for E[Y] and var(Y) in terms of E[.MJ , var(M), E[K] , var(K), E[X] . var(X). (c) A crate contains !vI cartons, where M is geometrically distributed with parame­ ter p. The ith carton contains Ki widgets, where Ki is Poisson-distributed with parameter JL. The weight of each widget is exponentially distributed with pa­ rameter >.. All these random variables are independent . Find the expected value and variance of the total weight of a crate. Problem 45. * Use transforms to show that the sum of a Poisson-d istributed number of independent. identically distributed Bernoulli random variables is Poisson . Solution . Let N be a Poisson-distributed random variable with parameter >.. Let Xi , i = 1, .. . , N, be independent Bernoulli random variables with parameter P, and let be the corresponding sum. The transform associated with L is found by starting with the transform associated with N, which is and replacing each occurrence of eS by the transform associated with Xi , which is We obtain Mx (s) = I -p+pes . M ( ) _ >.(l -p+pes -l ) _ >'p(es 1) LS - e - e . This is the transform associated with a Poisson random variable with parameter >.p. 5 Limit Theorems Contents 5. L Markov and Chebyshev Inequalities 5.2. The Weak Law of Large Numbers 5.3. Convergence in Probability . . . . 5.4. The Central Limit Theorem . . . 5.5. The Strong Law of Large Numbers 5.6. Summary and Discussion Problems ........... . · p. 265 · p. 269 · p. 271 · p. 273 · p. 280 · p. 282 · p. 284 263 264 Limit Theorems Chap. 5 In this chapter, we discuss some fundamental issues related to the asymptotic behavior of sequences of random variables. Our principal context involves a sequence X I, X 2, ... of independent identically distributed random variables with mean p and variance 0'2. Let be the sum of the first n of them. Limit theorems are mostly concerned with the properties of Sn and related random variables as n becomes very large. Because of independence, we have var(Sn) = var(Xd + ... + var(Xn) = nO'2 . Thus, the distribution of Sn spreads out as n increases, and cannot have a meaningful limit. The situation is different if we consider the sample mean Xl + ... +Xn Sn A1n = ------------ n n A quick calculation yields E[Afnl = p, 0'2 var(Nfn ) = --. n In particular, the variance of Mn decreases to zero as n increases, and the bulk of the distribution of Mn must be very close to the mean p. This phenomenon is the subject of certain laws of large numbers, which generally assert that the sample mean A1n (a random variable) converges to the true mean p (a num­ ber) , in a precise sense. These laws provide a mathematical basis for the loose interpretation of an expectation E [Xl = p as the average of a large number of independent samples drawn from the distribution of x. We will also consider a quantity which is intermediate between Sn and Mn . We first subtract np from Sn , to obtain the zero-mean random variable Sn - np and then divide by O'Vn, to form the random variable It can be seen that Z _ Sn - np n - O'Vn . E[Znl = 0, var(Zn) = 1. Since the mean and the variance of Zn remain unchanged as n increases, its distribution neither spreads, nor shrinks to a point . The central limit theorem is concerned with the asymptotic shape of the distribution of Zn and asserts that it becomes the standard normal distribution. Sec. 5. 1 Markov and Chebyshev Inequalities 265 Limit theorems are useful for several reasons: (a) Conceptually. they provide an interpretation of expectations (as well as probabilities) in terms of a long sequence of identical independent experi­ ments. (b) They allow for an approximate analysis of the properties of random vari­ ables such as Sn. This is to be contrasted with an exact analysis which would require a formula for the P11F or PDF of Sn . a complicated and tedious task when n is large. (c) They play a major role in inference and statistics, in the presence of large data sets. 5.1 MARKOV AND CHEBYSHEV INEQUALITIES In this section. we derive some important inequalities. These inequalities use the mean and possibly the variance of a random variable to draw conclusions on the probabilities of certain events. They are primarily useful in situations where exact values or bounds for the mean and variance of a random variable X are easily computable. but the distribution of X is either unavailable or hard to calculate. We first present the Markov inequality. Loosely speaking. it asserts that if a nonnegative random variable has a small mean. then the probability that it takes a large value must also be small. Markov Inequality If a random variable X can only take nonnegative values, then P(X � a) � E[X] , a for all a > O. To justify the Markov inequality, let us fix a positive number a and consider the random variable Ya defined by It is seen that the relation always holds and therefore. Ya = {O, a, if X < a, if X � a. E[Ya] � E[X] . n 5.1: Illustrat ion of the deri vation of the I\\,·I arkov inequal ity. Part (a) of t he figure shows the PDF of a non negat ive random variable X. Part (b) shows the PI\\IF of a related random variable Yo . wh ich is constructed as follows. All of the mass in the PDF of X that lies hctween 0 and a is to 0, anrl al l of th e mass t h at lies above a is to a. mass is shifted to t,he left. the expectation can only decrease and) therefore. E[X] � E[YuJ = = a) = aP (X ;;:: a). On t he other hand � E[Ya] = aP (Ya = a ) = aP(X � from we see 1 for an illustration . 5.1. X uniformly in E[X] = 2. Then . the i\\larkov inequal ity asserts that P(X > 2) < � = 1. - - 2 (X > 3) < � = - - 3 By comparing with the exact probabi lities � 2) = 0.5. P(X 2:: 3) = 0.25. we see [0 . 4] and note > 4) < � = - - 4 � 4) = 0, can 5 Sec. 5. 1 Markov and Chebyshev Inequalities 267 We continue with the Chebyshev inequality. Loosely speaking, it asserts that if a random variable has small variance, then the probability that it takes a value far from its mean is also small. Note that the Chebyshev inequality does not require the random variable to be nonnegative. Chebyshev Inequality If X is a random variable with mean JL and variance 0'2, then for all c> 0. To justify the Chebyshev inequality, we consider the nonnegative random variable (X - 11)2 and apply the lVlarkov inequality with a = c2• We obtain We complete the derivation by observing that the event (X 11)2 > c2 is identical to the event IX - 111 2:: c, so that POX - 111 2:: c) = P ((X 11) 2 For a similar derivation that bypasses the Markov inequality, assume for simplicity that X is a continuous random variable, introduce the function (X) = { O, if lx -l1l < c, g c2, if Ix - 111 2:: c, note that (x - 11)2 > g(x) for all x, and write cr2 = I: (x - 11)2 fx (x) dx > I: g(x) fx {x) dx = c2 P(I X - 111 c) , which is the Chebyshev inequality. An alternative form of the Chebyshev inequality is obtained by letting c = kcr, where k is positive, which yields 0'2 1 P ( IX -I1I 2:: kO') < k20'2 = k2' Thus, the probability that a random variable takes a value more than k standard deviations away from its mean is at most 1/k2 . 268 Limi t Theorems Chap. 5 The Chebyshev inequality tends to be more powerful than the Markov inequality (the bounds that it provides are more accurate) , because it also uses information on the variance of X. Still, the mean and the variance of a random variable are only a rough summary of its properties, and we cannot expect the bounds to be close approximations of the exact probabilities. Example 5.2. As in Example 5.1, let X be uniformly distributed in [0, 4]. Let us use the Chebyshev inequality to bound the probability that IX - 21 2: 1. We have (72 = 16/12 = 4/3, and p ( IX -21 2: 1)::; �, which is uninformative. For another example, let X be exponentially distributed with parameter >' = 1, so that E[X] = var(X) = 1. For c > 1, using the Chebyshev inequality, we obtain (\" 1 P(X 2: c) = P(X -12: c- 1) ::; P IX - .L12: c- 1)::; (c - 1)2 \" This is again conservative compared to the exact answer P(X 2: c) = e-c. Example 5.3. Upper Bounds in the Chebyshev Inequality. When X is known to take values in a range [a, b], we claim that (72 ::; (b - a)2/4. Thus, if (72 is unknown, we may use the bound (b - a)2/4 in place of (72 in the Chebyshev inequality. and obtain p ( IX - J.LI 2: c) ::; (b �C:)2 , for all c> o. To verify our claim, note that for any constant \" we have E [(X _ ,)2] = E[X2] _ 2E[Xb + ,2 , and the above quadratic is minimized when , = E[X] . It follows that (72 = E [(X - E[xJ) 2] ::; E [(X _,)2], By letting , = (a + b)/2, we obtain for all ,. (72 ::; E [ (X _ a ; b) 2] = E [(X _ a)(X _ b)] + (b � a)2 ::; (b � a)2 , where the equality above is verified by straightforward calculation, and the last inequality follows from the fact (x - a)(x - b) ::; 0 for all x in the range [a, b]. The bound (72 ::; (b - a)2/4 may be quite conservative, but in the absence of further information about X, it cannot be improved. It is satisfied with equality when X is the random variable that takes the two extreme values a and b with equal probability 1/2. Sec. 5.2 The Weak Law of Large Numbers 5.2 THE WEAK LAW OF LARGE NUMBERS 269 The weak law of large numbers asserts that the sample mean of a large number of independent identically distributed random variables is very close to the true mean, with high probability. As in the introduction to this chapter, we consider a sequence Xl , X2 , ... of independent identically distributed random variables with mean J..L and variance (72, and define the sample mean by We have Xl + . .. + Xn 'A1n = -----­ n E['AfnJ = E[Xd + .. . + E[Xn] = nJ..L = J..L, n n and, using independence, (lIf' ) _ var(XI + ... + Xn ) var lVJ n - 2 n var(Xt ) + ... + var(Xn) n2 We apply the Chebyshev inequality and obtain for any E > 0. We observe that for any fixed € > 0, the right-hand side of this inequality goes to zero as n increases. As a consequence, we obtain the weak law of large numbers, which is stated below. It turns out that this law remains true even if the Xi have infinite variance, but a much more elaborate argument is needed, which we omit. The only assumption needed is that E[XiJ is well-defined. The Weak Law of Large Numbers Let Xl , X2, . . . be independent identically distributed random variables with mean J..L. For every E > 0, we have as n - 00. The weak law of large numbers states that for large n, the bulk of the distribution of Mn is concentrated near J..L. That is, if we consider a positive length interval [J..L - f., J..L + f.] around J..L, then there is high probability that 'Afn will fall in that interval; as n - 00, this probability converges to 1. Of course, if € is very small, we may have to wait longer (i.e. , need a larger value of n) before we can assert that Mn is highly likely to fall in that interval. 270 Limit Theorems Chap. 5 Example 5.4. Probabilities and Frequencies. Consider an event A defined in the context of some probabilistic experiment. Let p = P(A) be the probability of this event. We consider n independent repetitions of the experiment, and let Mn be the fraction of time that event A occurs; in this context, Mn is often called the empirical frequency of A. Note that Xl +···+Xn Mn = , n where Xi is 1 whenever A occurs, and 0 otherwise; in particular, E[XiJ = p. The weak law applies and shows that when n is large, the empirical frequency is most likely to be within € of p. Loosely speaking, this allows us to conclude that em­ pirical frequencies are faithful estimates of p. Alternatively, this is a step towards interpreting the probability p as the frequency of occurrence of A. Example 5.5. Polling. Let p be the fraction of voters who support a particular candidate for office. We interview n \"randomly selected\" voters and record Mn, the fraction of them that support the candidate. We view Mn as our estimate of p and would like to investigate its properties. We interpret \"randomly selected\" to mean that the n voters are chosen inde­ pendently and uniformly from the given population. Thus, the reply of each person interviewed can be viewed as an independent Bernoulli random variable X. with success probability p and variance (72 = p(l - p). The Chebyshev inequality yields p(IMn _ pi � €) ::; p( 1 -; p) . n€ The true value of the parameter p is assumed to be unknown. On the other hand, it may be verified that p(1 - p) ::; 1/4 (cf. Example 5.3) , which yields 1 p(IMn - pi � €) ::; -4 2 · n€ For example, if € = 0. 1 and n = 100, we obtain 1 P(IMlOo - pi � 0.1) ::; 4 . 100 . (0. 1 )2 = 0.25. In words, with a sample size of n = 100, the probability that our estimate is incorrect by more than 0.1 is no larger than 0.25. Suppose now that we impose some tight specifications on our poll. We would like to have high confidence (probability at least 95%) that our estimate will be very accurate (within .01 of p). How many voters should be sampled? The only guarantee that we have at this point is the inequality 1 P (IMn - pi � 0.01) ::; 4n(0.01 )2 · We will be sure to satisfy the above specifications if we choose n large enough so that 1 4n(0.01)2 ::; 1 - 0.95 = 0.05, which yields n � 50, 000. This choice of n satisfies our specifications, but turns out to be fairly conservative, because it is based on the rather loose Chebyshev inequality. A refinement will be considered in Section 5.4. Sec. 5.3 Convergence in Probability 271 5.3 CONVERGENCE IN PROBABILITY We can interpret the weak law of large numbers as stating that \" A1n converges to J-l. \" However. since .. HI , AI2 . . .. is a sequence of random variables. not a sequence of numbers. the meaning of convergence has to be made precise. A particular definition is provided below. To facilitate the comparison with the ordinary notion of convergence. we also include the definition of the latter. Convergence of a Deterministic Sequence Let a I, a2 , . .. be a sequence of real numbers, and let a be another real number. We say that the sequence an converges to a, or limn-+oo an = a, if for every (; > 0 there exists some no such that for all n > no . Intuitively. if limn-+x an = a. then for any given accuracy level (;. an must be within € of a. when n is large enough. Convergence in Probability Let Y1 , Y2 , ... be a sequence of random variables (not necessarily indepen­ dent), and let a be a real number. We say that the sequence Yn converges to a in probability, if for every (; > 0, we have lim p (IYn - al � €) = O. n-+oo Given this definition. the weak law of large numbers simply states that the sample mean converges in probability to the true mean J-l. More generally, the Chebyshev inequality implies that if all Yrl have the same mean J-l. and var(Yn) converges to 0, then Yn converges to J-l in probability. If the random variables YI. Y2 •... have a P1IF or a PDF and converge in probability to a. then according to the above definition. \"almost all\" of the PMF or PDF of Yn is concentrated within (; of a for large values of n. It is also instructive to rephrase the above definition as follows: for every (; > O. and for every 8 > O. there exists some no such that p ( IYn - al > €) < 8. for all n � no . If we refer to f as the accuracy level. and 8 as the confidence level. the defini tion takes the following intuitive form: for any given level of accuracy and confidence. 272 Limi t Theorems Chap. 5 Yn will be equal to a, within these levels of accuracy and confidence, provided that n is large enough. Example 5.6. Consider a sequence of independent random variables Xn that are uniformly distributed in the interval [0. 1 J, and let Yn = min{X1 , . .. . Xn}. The sequence of values of Yn cannot increase as n increases, and it will occasionally decrease (whenever a value of Xn that is smaller than the preceding values is ob­ tained). Thus, we intuitively expect that Yn converges to zero. Indeed, for I: > O. we have using the independence of the X n, In particular. P ( I Yn - 0 1 � 1:) = P (X 1 � 1: , ...• X n � 1:) = P(Xl � 1:) ' .. P(Xn � 1:) = (l _l:)n . lim p (IYn - 01 � 1:) = lim (1 - I:)n = O. n-x n-c:x; Since this is true for every I: > O. we conclude that Yn converges to zero, in proba­ bility. Example 5.7. Let Y be an exponentially distributed random variable with pa­ rameter A = 1. For any positive integer n, let Yn = Yin. (Note that these random variables are dependent.) We wish to investigate whether the sequence Yn converges to zero. For I: > O. we have In particular, lim p(IYn - 01 � 1:) = lim e-m = O. n-x n-� Since this is the case for every E > O. Yn converges to zero, in probability. One might be tempted to believe that if a sequence Yn converges to a number a, then E[YnJ must also converge to a. The following example shows that this need not be the case, and illustrates some of the limitations of the notion of convergence in probability. Example 5.S. Consider a sequence of discrete random variables Yn with the following distribution: P(Yn = y) = 1 1 - -. for y = 0, n 1 n c _ 2 lor y - n , 0, elsewhere: 5.4 see an I1.-X ( I f> we 1 1 � e) = - = 0, 11.-- :lO n and YI1. converges to zero in probability. On the other hand, E[ Yn] == n2 In == n. to asn 5.2: The PrvIF of the random variable true mean M. of sun) == n lvln in Example 5.8. increases to infini ty, and the distribution of Sn cannot said to anything meaningful. An intermediate is obtained by considering the the Sn - nf..l of from its mean nM, it by a factor proportional to 1/ .;n. vVhat is special about this particular scaling is that it at a constant limit asserts scaled random a normal distribution. More distributed a variables with mean J1 z _ Sn - nJ1 n - aJ7i calculation yields - nM --------:=---- = 0, 274 Limit Theorems Chap. 5 and (Z ) _ var(XI + ... + Xn ) _ var(Xt } + ... + var(Xn) _ na2 _ var n - - ---- l . a2n a2n na2 The Central Limit Theorem Let Xl , X2 , . . . be a sequence of independent identically distributed random variables with common mean J..L and variance a2 , and define Xl + .. . +Xn -nJ..L Zn = ----�--- ay'n Then, the CDF of Zn converges to the standard normal CDF in the sense that lim P(Zn < z) = q,(z), n--+oo for every z. The central limit theorem is surprisingly general. Besides independence. and the implicit assumption that the mean and variance are finite, it places no other requirement on the distribution of the Xi , which could be discrete. continuous, or mixed; see the end-of-chapter problems for an outline of its proof. This theorem is of tremendous importance for several reasons, both concep­ tual and practical. On the conceptual side, it indicates that the sum of a large number of independent random variables is approximately normal. As such, it applies to many situations in which a random effect is the sum of a large number of small but independent random factors. Noise in many natural or engineered systems has this property. In a wide array of contexts, it has been found empir­ ically that the statistics of noise are well-described by normal distributions, and the central limit theorem provides a convincing explanation for this phenomenon. On the practical side, the central limit theorem eliminates the need for detailed probabilistic models, and for tedious manipulations of P:rvIFs and PDFs. Rather, it allows the calculation of certain probabilities by simply referring to the normal CDF table. Furthermore. these calculations only require the knowledge of means and variances. Approximations Based on the Central Limit Theorem The central limit theorem allows us to calculate probabilities related to Zn as if Zn were normal. Since normality is preserved under linear transformations, Sec. 5.4 The Central Limit Theorem 275 this is equivalent to treating Sn as a normal random variable with mean nJ.l and variance ncr2 . Normal Approximation Based on the Central Limit Theorem Let Sn = Xl + ... + Xn, where the Xi are independent identically dis­ tributed random variables with mean J.L and variance a2 • If n is large, the probability P(Sn < c) can be approximated by treating Sn as if it were normal, according to the following procedure. 1. Calculate the mean nJ.L and the variance na2 of Sn. 2. Calculate the normalized value z = (c - nJ.L)/afo. 3. Use the approximation P(Sn $ c) ::::: 4>(z) , where 4>(z) is available from standard normal CDF tables. Example 5.9. We load on a plane 100 packages whose weights are independent random variables that are uniformly distributed between 5 and 50 pounds. What is the probability that the total weight will exceed 3000 pounds? It is not easy to cal­ culate the CDF of the total weight and the desired probability, but an approximate answer can be quickly obtained using the central limit theorem. We want to calculate P(S100 > 3000), where S100 is the sum of the weights of 100 packages. The mean and the variance of the weight of a single package are 5 + 50 J.L = 2 = 27.5, cr2 = (50 - 5)2 = 168.75, 12 based on the formulas for the mean and variance of the uniform PDF. We calculate the normalized value Z = 3000 - 100 · 27.5 = 250 = 1 .92 .j168.75 . 100 129.9 ' and use the standard normal tables to obtain the approximation P(S100 $ 3000) � 4>( 1.92) = 0.9726. Thus, the desired probability is P(S100 > 3000) = 1 - P(S100 $ 3000) � 1 - 0.9726 = 0.0274. Example 5. 10. A machine processes parts, one at a time. The processing times of different parts are independent random variables, uniformly distributed in [1 ,5]. 276 Limit Theorems Chap. 5 We wish to approximate the probability that the number of parts processed within 320 time units, denoted by N320 , is at least 100. There is no obvious way of expressing the random variable N320 as a sum of independent random variables, but we can proceed differently. Let Xi be the processing time of the ith part, and let S100 = Xl + . . ·+XlOo be the total processing time of the first 100 parts. The event {N 320 � 100} is the same as the event {S100 ::; 320}, and we can now use a normal approximation to the distribution of S100 . Note that J-L = E[X1J = 3 and u2 = var(Xd = 16/12 = 4/3. We calculate the normalized value z = 320 - nJ-L _ 320 - 300 = 1. 73, u.Jii )100 . 4/3 and use the approximation P(SI00 ::; 320) � �(1.73) = 0.9582. If the variance of the Xi is unknown, but an upper bound is available, the normal approximation can be used to obtain bounds on the probabilities of interest. Example 5.11. Polling. Let us revisit the polling problem in Example 5.5. We poll n voters and record the fraction Mn of those polled who are in favor of a particular candidate. If p is the fraction of the entire voter population that supports this candidate, then XI + ·· ·+Xn Mn = ------n where the Xi are independent Bernoulli random variables with parameter p. In particular, Mn has mean p and variance pel - p)/n. By the normal approximation. Xl + . . . + Xn is approximately normal, and therefore Mn is also approximately normal. We are interested in the probability P( IN!n - pi � €) that the polling error is larger than some desired accuracy €. Because of the symmetry of the normal PDF around the mean, we have P (11\\1 n - pi � €) � 2P (!v! n - P � €). The variance p( 1 -p) / n of Mn - p depends on p and is therefore unknown. We note that the probability of a large deviation from the mean increases with the variance. Thus, we can obtain an upper bound on PCMn - p � €) by assuming that Mn - p has the largest possible variance, namely, 1/(4n) which corresponds to p = 1/2. To calculate this upper bound, we evaluate the standardized value z = 1/(2.Jii)' and use the normal approximation Sec. 5.4 The Central Limit Theorem 277 For instance, consider the case where n = 100 and € = 0. 1. Assuming the worst-case variance, and treating Mn as if it were normal, we obtain P(IMlOo - pi 2:: 0. 1) � 2P(J\\;ln - p 2:: 0. 1) ::; 2 - 2 <I? (2 . 0. 1 · J100) = 2 - 2<1?(2) = 2 - 2· 0.977 = 0.046. This is much smaller (and more accurate) than the estimate of 0.25 that was ob­ tained in Example 5.5 using the Chebyshev inequality. We now consider a reverse problem. How large a sample size n is needed if we wish our estimate Mn to be within 0.01 of p with probability at least 0.95? Assuming again the worst possible variance, we are led to the condition 2 - 2<1? (2 . 0.01 . v'n) ::; 0.05, or <I? (2 . 0.01 . v'n) 2:: 0.975. From the normal tables, we see that <I?(1.96) = 0.975, which leads to or 2 . 0.01 . v'n 2:: 1.96, n > (1 .96)2 = 9604. - 4· (0.01)2 This is significantly better than the sample size of 50,000 that we found using Chebyshev's inequality. The normal approximation is increasingly accurate as n tends to infinity, but in practice we are generally faced with specific and finite values of n. It would be useful to know how large n should be before the approximation can be trusted, but there are no simple and general guidelines. Much depends on whether the distribution of the Xi is close to normal and, in particular, whether it is symmetric. For example, if the Xi are uniform, then 58 is already very close to normal. But if the Xi are, say, exponential. a significantly larger n will be needed before the distribution of 5n is close to a normal one. Furthermore, the normal approximation to P(5n < c) tends to be more faithful when c is in the vicinity of the mean of 5n. De Moivre-Laplace Approximation to the Binomial A binomial random variable 5n with parameters n and p can be viewed as the sum of n independent Bernoulli random variables Xl , .. .. Xn, with common parameter p: Recall that (j = y'var(Xd = y'p{l - p), k k I 5.3: The central limit treats a binomial random variable as if it were normal with mean np and vari ance 1 - p) . This a bi nomial with the normal (a) A ....... .... .. . .......... of a binomial probabi lity P(k � � 1) is obtai ned the area under the normal from k to II which is the shaded area in the With this if we have k = 1. the will be by zero. (b) A possible remedy is to use the normal probability k - � k + � to = k) . By \"\" ...,. '-,0 ..-. ,.., P(k � :s; l) can be from k - � to l + � 1 wh ich area. We will now use the approximation suggested by the cent ral limit an for the of the event � � l}, 1 are dardized k - Sn - np l - np -r�==== < < -r�==== Jnp(l - p) /np(l - p) Jnp( l - p) 5 (Sn - np) / Jnp( l - p) dard normal distribution , and we obtain a stan- < � l) = --;::::==== < --;::::==== < --;::::==== ( k - np l- np ) ( l - np ) � - of this forn) is equivalent treating Sn as a mean np np(l - p) . 5.3 provides an illustrat ion and ind icates that a Inure accurate approximation rnay be possible if we k 1 k - 1 l + 1 2 2' is below. Sec. 5.4 The Central Limit Theorem 279 De Moivre-Laplace Approximation to the Binomial If Sn is a binomial random variable with parameters n and p, n is large, and k, 1 are nonnegative integers, then P(k < Sn < l) � <P ( 1 + � - np ) _ <P ( k - � - np ) . - - Jnp( l - p) Jnp(l - p) When p is close to 1/2, in which case the PMF of the Xi is symmetric, the above formula yields a very good approximation for n as low as 40 or 50. When p is near 1 or near O. the quality of the approximation drops. and a larger value of n is needed to maintain the same accuracy. Example 5.12. Let Sn be a binomial random variable with parameters n = 36 and p = 0.5. An exact calculation yields 36 36 2 1 ( ) P(Sn � 21) = � k (0.5) = 0.8785. The central limit theorem approximation. without the above discussed refinement. yields P(Sn � 21) � q, ( 21 - np ) = q, ( 21 - 18 ) = q,(I) = 0.8413. Jnp(1 - p) 3 Using the proposed refinement, we have P(Sn � 21) � q, ( 21.5 - np ) = q, ( 21.5 - 18 ) = q,(1. 17) = 0.879, Jnp(1 - p) 3 which is much closer to the exact value. The de Moivre-Laplace formula also allows us to approximate the probability of a single value. For example. P(Sn = 19) � q, ( 19.53 - 18 ) _ q, ( 18.53- 18 ) = 0.6915 - 05675 = 0.124. This is very close to the exact value which is (��) (0.5)36 = 0.1251. 280 Limit Theorems 5.5 THE STRONG LAW OF LARGE NUMBERS Chap. 5 The strong law of large numbers is similar to the weak law in that it also deals with the convergence of the sample mean to the true mean. It is different, however, because it refers to another type of convergence. The following is a general statement of the strong law of large numbers. A proof of the strong law, under the mildly restrictive assumption that the Xi have finite fourth moments is developed in the end-of-chapter problems. The Strong Law of Large Numbers Let Xl , X2 , ... be a sequence of independent identically distributed random variables with mean Jl. Then, the sequence of sample means Mn = (Xl + . .. + Xn )/n converges to Jl, with probability 1, in the sense that P ( lim Xl + . . . + Xn = Jl) = 1. n-+oo n In order to interpret the strong law of large numbers. we need to go back to our original description of probabilistic models in terms of sample spaces. The contemplated experiment is infinitely long and generates a sequence of values, one value for each one of the random variables in the sequence Xl . X2 .. . .. Thus, it is best to think of the sample space as a set of infinite sequences (X I,X2 ••.. ) of real numbers: any such sequence is a possible outcome of the experiment. Let us now consider the set A consisting of those sequences (x I , X2 , .•• ) whose long-term average is Jl. i.e .. . Xl + ... + Xn hm = Jl. n--x n The strong law of large numbers states that all of the probability is concentrated on this particular subset of the sample space. Equivalently, the collection of outcomes that do not belong to A (infinite sequences whose long-term average is not Jl) has probability zero. The difference between the weak and the strong law is subtle and deserves close scrutiny. The weak law states that the probability P(I1\\In - JlI 2: €) of a significant deviation of A1n from Jl goes to zero as n - oc. Still, for any finite n, this probability can be positive and it is conceivable that once in a while, even if infrequently, Aln deviates significantly from Jl. The weak law provides no conclusive information on the number of such deviations. but the strong law does. According to the strong law. and with probability 1. 1\\;fn converges to Jl. This implies that for any given € > 0, the probability that the difference lAIn - JlI will exceed € an infinite number of times is equal to zero. Sec. 5.5 The Strong Law of Large Numbers 281 Example 5.13. Probabilities and Frequencies. As in Example 5.4, consider an event A defined in terms of some probabilistic experiment. We consider a sequence of independent repetitions of the same experiment. and let Af n be the fraction of the first n repetitions in which A occurs. The strong law of large numbers asserts that AIn converges to P(A) , with probability 1. In contrast, the weak law of large numbers asserts that Mn converges to P(A) in probability (cf. Example 5.4). We have often talked intuitively about the probability of an event A as the frequency with which it occurs in an infinitely long sequence of independent trials. The strong law backs this intuition and establishes that the long-term frequency of occurrence of A is indeed equal to P(A) , with essential certainty (the probability of this happening is 1). Convergence with Probability 1 The convergence concept behind the strong law is different than the notion em­ ployed in the weak law. We provide here a definition and some discussion of this new convergence concept. Convergence with Probability 1 Let Y1 , Y2 , • •• be a sequence of random variables (not necessarily indepen­ dent). Let c be a real number. We say that Yn converges to c with prob­ ability 1 (or almost surely) if P ( lim Yn = c) = l. n-->oo Similar to our earlier discussion. a proper interpretation of this type of convergence involves a sample space consisting of infinite sequences: all of the probability is concentrated on those sequences that converge to c. This does not mean that other sequences are impossible, only that they are extremely unlikely, in the sense that their total probability is zero. Example 5.14. Let Xl . X2 ••.. be a sequence of independent random variables that are uniformly distributed in [0, 1] ' and let Yn = min{Xl , ... . Xn }. We wish to show that Yn converges to O. with probability 1. In any execution of the experiment, the sequence Yn is nonincreasing. i.e., Yn+l � Yn for all n. Since this sequence is bounded below by zero. it must have a limit. which we denote by Y. Let us fix some € > O. \\Ve have Y 2:: € if and only if Xl 2:: € for all i, which implies that 282 Limit Theorems Chap. 5 Since this is true for all n, we must have P (Y 2: E) ::; lim (1 - E t = O. n-+oc This shows that P(Y 2: E) = 0, for any positive E. We conclude that P(Y > 0) = 0, which implies that P(Y = 0) = 1. Since Y is the limit of Yn , we see that Yn converges to zero with probability 1. Convergence with probability 1 implies convergence in probability (see the end-of-chapter problems), but the converse is not necessarily true. Our last example illustrates the difference between convergence in probability and con­ vergence with probability 1. Example 5. 15. Consider a discrete-time arrival process. The set of times is partitioned into consecutive intervals of the form Ik = {2k ,2k + 1, ... ,2k+ 1 - I}. Note that the length of h is 2k , which increases with k. During each interval h, there is exactly one arrival, and all times within an interval are equally likely. The arrival times within different intervals are assumed to be independent. Let us define Yn = 1 if there is an arrival at time n, and Yn = 0 if there is no arrival. We have P(Yn =I 0) = 1j2k , if n Elk . Note that as n increases, it belongs to intervals I k with increasingly large indices k. Consequently, lim P(Y,l =I 0) = lim 2 1 k = 0, n--+ oc k--+ 00 and we conclude that Yn converges to 0 in probability. However, when we carry out the experiment, the total number of arrivals is infinite (one arrival during each interval h). Therefore, Yn is unity for infinitely many values of n, the event {limn-+oc Yn = O} has zero probability, and we do not have convergence with prob­ ability 1. Intuitively. the following is happening. At any given time, there is only a smalL and diminishing with n. probability of a substantial deviation from 0, which implies convergence in probability. On the other hand. given enough time, a sub­ stantial deviation from 0 is certain to occur and for this reason, we do not have convergence with probability 1. 5.6 SUMMARY AND DISCUSSION In this chapter, we explored some fundamental aspects of probability theory that have major conceptual and practical implications. On the conceptual side, they put on a firm ground the interpretation of probability as relative frequency in a large number of independent trials. On the practical side, they allow the ap­ proximate calculation of probabilities in models that involve sums of independent random variables and that would be too hard to compute with other means. We will see a wealth of applications in the chapter on statistical inference. Sec. 5.6 Summary and Discussion 283 We discussed three major laws that take the form of limit theorems. (a) The first one, the weak law of large numbers, indicates that the sample mean is very likely to be close to the true mean, as the sam pIe size in­ creases. It is based on the Chebyshev inequality, which is of independent interest and is representative of a large collection of useful inequalities that permeate probability theory. (b) The second one, the central limit theorem, is one of the most remarkable results of probability theory, and asserts that the sum of a large number of independent random variables is approximately normal. The central limit theorem finds many applications: it is one of the principal tools of statistical analysis and also justifies the use of normal random variables in modeling a wide array of situations. (c) The third one, the strong law of large numbers, makes a more emphatic connection of probabilities and relative frequencies, and is often an impor­ tant tool in theoretical studies. While developing the various limit theorems, we introduced a number of convergence concepts (convergence in probability and convergence with proba­ bility 1), which provide a precise language for discussing convergence in proba­ bilistic models. The limit theorems and the convergence concepts discussed in this chapter underlie several more advanced topics in the study of probabilistic models and stochastic processes. 284 Limit Theorems Chap. 5 PR OBLEMS SECTION 5.1. Some Useful Inequalities Problem 1. A statistician wants to estimate the mean height h (in meters) of a population, based on n independent samples Xl , .. . , X n , chosen uniformly from the entire population. He uses the sample mean Mn = (Xl + .. . + Xn)/n as the estimate of h, and a rough guess of 1.0 meters for the standard deviation of the samples Xt • (a) How large should n be so that the standard deviation of Mn is at most 1 cen­ timeter? (b) How large should n be so that Chebyshev's inequality guarantees that the esti­ mate is within 5 centimeters from h, with probability at least 0.99? (c) The statistician realizes that all persons in the population have heights between 1.4 and 2.0 meters, and revises the standard deviation figure that he uses based on the bound of Example 5.3. How should the values of n obtained in parts (a) and (b) be revised? Problem 2. * The Chernoff bound. The Chernoff bound is a powerful tool that relies on the transform associated with a random variable, and provides bounds on the probabilities of certain tail events. (a) Show that the inequality P(X � a) ::; e-sa M(s) holds for every a and every s � 0, where M(s) = E[eSX] is the transform associ­ ated with the random variable X, assumed to be finite in a small open interval containing s = O. (b) Show that the inequality P(X ::; a) ::; e- sa M(s) holds for every a and every s ::; O. (c) Show that the inequality holds for every a, where ¢(a) = max (sa - In 1\\.1(s)). s2: 0 (d) Show that if a > E[X] , then ¢(a) > O. Problems 285 (e) Apply the result of part (c) to obtain a bound for P(X � a) , for the case where X is a standard normal random variable and a > 0. (f) Let Xl ,X2 , . .. be independent random variables with the same distribution as X. Show that for any a > E[X], we have so that the probability that the sample mean exceeds the mean by a certain amount decreases exponentially with n. Solution. (a) Given some a and s � 0, consider the random variable Ya defined by It is seen that the relation always holds and therefore, On the other hand, from which we obtain if X < a, if X � a. (b) The argument is similar to the one for part (a) . We define Ya by Since s � 0, the relation always holds and therefore, On the other hand, from which we obtain Ya = { esa , 0, if X � a, if X> a. P(X � a) � e-sa M(s). 286 Limit Theorems (c) Since the inequality from part (a) is valid for every s � 0, we obtain (d) For s = 0, we have P(X � a) � min (e-saj\\,f(s)) s�o . - (sa -In M(s)) = mIn e s�o _ - maxs >O (sa -In M(s)) - e - _ -q)(a) -e . sa - In M(s) =O-lnl = 0, Chap. 5 where we have used the generic property M(O) = 1 of transforms. Furthermore, d l I d I - (sa - ln M(s)) = a - -_. -M(s) = a -1· E[X] > o. ds s=O M(s) ds s=O Since the function sa -In M (s) is zero and has a positive derivative at s = 0, it must be positive when s is positive and small. It follows that the maximum ¢(a) of the function sa - In M (s) over all s � 0 is also positive. (e) For a standard normal random variable X, we have M(s) = e s2 /2 • Therefore, sa - In M(s) = sa - s2/2. To maximize this expression over all s � 0, we form the derivative, which is a - s, and set it to zero, resulting in s = a. Thus, ¢(a) = a2/2, which leads to the bound Note: In the case where a � E[XJ , the maximizing value of s turns out to be s = 0, resulting in ¢( a) = 0 and in the uninteresting bound P(X � a) � 1. (f) Let Y = Xl + ... + Xn . Using the result of part (c), we have where and P (* i?' � a) = P(Y � na) :o e->y(nn) , ¢y (na) = max (nsa - In My (s) ) , s�O is the transform associated with Y. We have In My (s) = nln M(s) , from which we obtain ¢y (na) = n . max (sa - In M (s)) = n¢( a) , s�O Problems 281 and p (;; t Xi ::: a) :; ,-n.(a) Note that when a > E[XJ, part (d) asserts that ¢(a) > 0, so the probability of interest decreases exponentially with n. Problem 3.* Jensen inequality. A twice differentiable real-valued function J or a single variable is called convex if its second derivative (d2 J I dx2)( x) is nonnegative for all x in its domain of definition. (a) Show that the functions J(x) = eOx, J(x) = -In x, and J(x) = X4 are all convex. (b) Show that if J is twice differentiable and convex, then the first order Taylor approximation of J is an underestimate of the function. that is, dJ J(a) + (x - a) dx (a) � J(x). for every a and x. (c) Show that if J has the property in part (b), and if X is a random variable, then Solution. (a) We have d2 ax 2 ax 0 dx2 e = a e > , J (E[XI) � E [J(X)] . d2 1 d 2 ( - In x) = 2\" > 0, x x d2 4 2 dx2 X = 4 . 3 . x � o. (b) Since the second derivative of J is nonnegative, its first derivative must be nonde­ creasing. Using the fundamental theorem of calculus, we obtain J(x) = J(a) + J.x : (t) dt � J(a) + J.x : (a) dt = J(a) + (x - a) �� (a). (c) Since the inequality from part (b) is assumed valid for every possible value x of the random variable X, we obtain J(a) + (X - a) �� (a) � J(X). We now choose a = E[X] and take expectations, to obtain J(E[XI) + (E[X]- E[XI) �� (E[Xl) � E [J(X)] , or J(E[Xl) � E [J(X)] . 288 Limit Theorems Chap. 5 SECTION 5.2. The Weak Law of Large Numbers Problem 4. In order to estimate f. the true fraction of smokers in a large population, Alvin selects n people at random. His estimator Aln is obtained by dividing Sn. the number of smokers in his sample, by n, i.e., Mn = Sn ln. Alvin chooses the sample size n to be the smallest possible number for which the Chebyshev inequality yields a guarantee that where € and 6 are some prespecified tolerances. Determine how the value of n recom­ mended by the Chebyshev inequality changes in the following cases. (a) The value of f is reduced to half its original value. (b) The probability 6 is reduced to half its original value. SECTION 5.3. Convergence in Probability Problem 5. Let Xl . X2, ••• be independent random variables that are uniformly distributed over 1-1. 1]. Show that the seqllence Y1 , Y2 •••• converges in probability to some limit, and identify the limit, for each of the following cases; (a) Yn = Xn ln. (b) Yn = (Xn)n . (c) Yn = Xl ' X 2 •.• X n. (d) Yn = max{Xl \" \" ,Xn}. Problem 6. * Consider two sequences of random variables Xl. X 2 , .. . and Y1 , Y2 , ... , which converge in probability to some constants. Let e be another constant. Show that cXn. Xn +Yn. max{O, Xn}. IXnl. and XnYn all converge in probability to corresponding limits. Solution. Let x and y be the limits of Xn and Yn , respectively. Fix some € > 0 and a constant e. If e = 0, then cXn equals zero for all n, and convergence trivially holds. If e =f:. 0, we observe that p(lcXn - exl 2: f) = p( IXn - xl 2: f/lel) , which converges to zero. thus establishing convergence in probability of cXn. We will now show that P(IX\" + y\" - x - yl 2: f) converges to zero, for any € > O. To bound this probability. we note that for IXn + Yn - X - yl to be as large as f, we need either IXn - xl or lY.l - xl (or both) to be at least €/2. Therefore, in terms of events. we have This implies that and lim p(IXn+ Y,,- x-yl 2:€) � lim p(IXn- xl 2: €/2) + lim p(IYn- yl � €/2) = 0, n-+� n-+oo n-+oc Problems 289 where the last equality follows since Xn and Yn converge, in probability, to x and y, respectively. By a similar argument, it is seen that the event { I max{O, Xn } - max{O, x}1 2: E} is contained in the event { IXn - xl 2: E} . Since limn-Xl p (IXn - xl ;:::: E) = 0, this implies that lim P (lmax{O. Xn }- max{O,x}I 2:E) =0. n-oo Hence max{O, Xn } converges to max{O, x} in probability. We have IXnl = max{O, Xn }+max{O, -Xn}. Since max{O, Xn} and max{O, -Xn } converge, as shown earlier, it follows that their sum, IX n I, converges to max {O, x} + max{O. -x} = Ixl in probability. Finally, we have P (IXnYn - xyl 2: E) = P (I (Xn - X)(Yn - y) + xYn + yX\" - 2xyl ;:::: E) ::; P (I (Xn - X)(YrI - y)1 2: E/2) + p (lxYn + yXn - 2xyl 2: E/2) . Since xYn and yXn both converge to xy in probability. the last probability in the above expression converges to 0. It will thus suffice to show that To bound this probability. we note that for I(Xn - X)(Yn - y) 1 to be as large as E/2, we need either IXn - xl or IYn - xl (or both) to be at least v;J2. The rest of the proof is similar to the earlier proof that Xn + Yn converges in probability. Problem 7. * A sequence Xn of random variables is said to converge to a number c in the mean square, if lim E [(Xn - c)2] = 0. n-oo (a) Show that convergence in the mean square implies convergence in probability. (b) Give an example that shows that convergence in probability does not imply con­ vergence in the mean square. Solution. (a) Suppose that Xn converges to c in the mean square. Using the Markov inequality, we have Taking the limit as n - x. we obtain lim p(IXn - cl 2: E) = 0. n-X which establishes convergence in probability. (b) In Example 5.8, we have convergence in probability to ° but E[Y;] = n3 , which diverges to infinity. 290 Limit Theorems Chap. 5 SECTION 5.4. The Central Limit Theorem Problem 8. Before starting to play the roulette in a casino, you want to look for biases that you can exploit. You therefore watch 100 rounds that result in a number between 1 and 36. and count the number of rounds for which the result is odd. If the count exceeds 55, you decide that the roulette is not fair. Assuming that the roulette is fair, find an approximation for the probability that you will make the wrong decision. Problem 9. During each day. the probability that your computer's operating system crashes at least once is 5%, independent of every other day. You are interested in the probability of at least 45 crash-free days out of the next 50 days. (a) Find the probability of interest by using the normal approximation to the bino­ mial. (b) Repeat part (a), this time nsing the Poisson approximation to the binomial. Problem 10. A factory produces Xn gadgets on day n. where the Xn are independent and identically distributed random variables, with mean 5 and variance 9. (a) Find an approximation to the probability that the total number of gadgets pro­ duced in 100 days is less than 440. (b) Find (approximately) the largest value of n such that P(XI + .. . + Xn 2: 200 + 5n) ::; 0.05. (c) Let N be the first day on which the total number of gadgets produced exceeds 1000. Calculate an approximation to the probability that N 2: 220. Problem 11. Let X I. YI , X 2 . Y2 • • •• be independent random variables, uniformly distributed in the unit interval [0. l] , and let (Xl + ... + X16) - (YI + ... + Y16) W= 16 . Find a numerical approximation to the quantity p(I\"\" - E[ltV1 1 < 0.001). Problem 12. * Proof of the central limit theorem. Let X I, X 2, .. . be a sequence of independent identically distributed zero-mean random variables with common vari­ ance (j2, and associated transform Alx (s) . We assume that Mx (s) is finite when -d < s < d, where d is some positive number. Let (a) Show that the transform associated with Zn satisfies Afz,, (s) = (Afx ((jfo)) n Problems 291 (b) Suppose that the transform Mx (s) has a second order Taylor series expansion around s = 0, of the form where o( S2) is a function that satisfies lims-+o o( S2) / S2 = O. Find a, b, and c in terms of a2• (c) Combine the results of parts (a) and (b) to show that the transform lvlzn (s) converges to the transform associated with a standard normal random variable, that is, lim MZn (s) = es2/2, for all s. n-+oo Note: The central limit theorem follows from the result of part (c), together with the fact (whose proof lies beyond the scope of this text) that if the transforms MZn (s) converge to the transform Mz (s) of a random variable Z whose CDF is continuous, then the CDFs FZn converge to the CDF of Z. In our case, this implies that the CDF of Zn converges to the CDF of a standard normal. Solution. (a) We have, using the independence of the Xi , MZn (s) = E [eSzn ] =E [exp{ ��t,x'}l n i=l (b) Using the moment generating properties of the transform, we have a = Mx (O) = 1, and b = d d Mx (s) 1 = E[X] = 0, s s=o (c) We combine the results of parts (a) and (b). We have ( ( s ) ) n ( bs cs2 ( S2 )) n MZn (s) = Mx afo = a + afo + a2n + 0 a2n ' and using the formulas for a, b, and c from part (b), it follows that 292 We now take the limit as n - 00, and use the identity to obtain lim (1 + �) n = eC, n ..... oo n Limit Theorems SECTION 5.5. The Strong Law of Large Numbers Chap. 5 Problem 13. * Consider two sequences of random variables Xl , X 2, . .. and YI , Y2 , .•• • Suppose that X n converges to a and Yn converges to b, with probability 1. Show that Xn + Yn converges to a+b, with probability 1. Also, assuming that the random variables Yn cannot be equal to zero, show that Xn /Yn converges to alb, with probability 1. Solution. Let A (respectively, B) be the event that the sequence of values of the random variables Xn (respectively, Yn ) does not converge to a (respectively, b). Let C be the event that the sequence of values of X n + Yn does not converge to a + b and notice that C C AU B. Since Xn and Yn converge to a and b, respectively, with probability 1. we have P(A) = 0 and P(B) = O. Hence, P(C) :s; P(A U B) :s; P(A) + P(B) = O. Therefore. P(CC) = 1, or equivalently, Xn + Yn converges to a + b with probability 1. For the convergence of Xn /Yn, the argument is similar. Problem 14. * Let Xl . X2 , . .. be a sequence of independent identically distributed random variables. Let YI , Y2 , • •• be another sequence of independent identically dis­ tributed random variables. We assume that the Xl and � have finite mean, and that YI + ... + Yn cannot be equal to zero. Does the sequence Xl + . . . + Xn Zn = -::-:----......,.-­ YI + ... + Yn converge with probability 1, and if so, what is the limit? Solution. We have Zn = (Xl + . .. + Xn )/n . (YI + ... + Yn )/n By the strong law of large numbers, the numerator and denominator converge with probability 1 to E[X] and E[Y] . respectively. It follows that Zn converges to E[XJjE[Y] , with probability 1 (cf. the preceding problem). Problem 15. * Suppose that a sequence YI , Y2 , ••• of random variables converges to a real number c, with probability 1. Show that the sequence also converges to c in probability. Solution. Let C be the event that the sequence of values of the random variables Yn converges to c. By assumption, we have P( C) = 1. Fix some € > 0, and let Ak be the event that IYn - cl < € for every n � k. If the sequence of values of the random variables Yn converges to c, then there must exist some k such that for every n � k, Problems 293 this sequence of values is within less than E from c. Therefore, every element of C belongs to Ak for some k, or 00 C c U Ak. k=1 Note also that the sequence of events Ak is monotonically increasing, in the sense that Ak C Ak+ l for all k. Finally, note that the event Ak is a subset of the event {I Yk - cl < E}. Therefore, lim p ( I Yk - cl < E) � lim P(Ak) = P(U�= I Ak ) � P(C) = 1, k-oo k-oc where the first equality uses the continuity property of probabilities (Problem 13 in Chapter 1). It follows that lim p ( IYk - cl � E) = 0, k-oc which establishes convergence in probability. Problem 16. '\" Consider a sequence Yn of nonnegative random variables and suppose that Show that Yn converges to 0, with probability 1. Note: This result provides a commonly used method for establishing convergence with probability 1. To evaluate the expectation of 2::'= 1 Yn , one typically uses the formula E [t. Yn] = � E[Yn). The fact that the expectation and the infinite summation can be interchanged, for the case of nonnegative random variables, is known as the monotone convergence theorem. a fundamental result of probability theory, whose proof lies beyond the scope of this text. Solution. We note that the infinite sum 2::'=1 Yn must be finite, with probability 1. Indeed. if it had a positive probability of being infinite, then its expectation would also be infinite. But if the sum of the values of the random variables Yn is finite, the sequence of these values must converge to zero. Since the probability of this event is equal to 1, it follows that the sequence Yn converges to zero, with probability 1. Problem 17. '\" Consider a sequence of Bernoulli random variables X n , and let pn = P(Xn = 1) be the probability of success in the nth trial. Assuming that 2::'= 1 pn < 00, show that the number of successes is finite, with probability 1. [Compare with Problem 48(b) in Chapter 1.] Solution. Using the monotone convergence theorem (see above note), we have 294 Limit Theorems Chap. 5 This implies that 00 L Xn < 00 , n=l with probability 1. We then note that the event {2:::'1 Xn < oo} is the same as the event that there is a finite number of successes. Problem 18. * The strong law of large numbers. Let Xl , X 2, . . . be a sequence of independent identically distributed random variables and assume that E[XtJ < 00. Prove the strong law of large numbers. Solution. We note that the assumption E[XtJ < 00 implies that the expected value of the Xi is finite. Indeed, using the inequality Ixl � 1 + X4, we have E[IXi l] � 1 + E[XtJ < 00. Let us assume first that E[XiJ = o. We will show that We have [LX (Xl + .. . + Xn)4] E 4 < 00. n n=l [ (Xl + ... +Xn)4] 1 ���� E n4 = n4 L- L- L- L- E[Xil Xi2X'3Xi4J· '1 =1 '2=1 13=1 '4=1 Let us consider the various terms in this sum. If one of the indices is different from all of the other indices, the corresponding term is equal to zero. For example, if il is different from i2, i3, or i4, the assumption E[XiJ = 0 yields E[Xil Xi2 Xi3Xi4J = E[Xil JE[Xi2 Xi3Xi4J = o. Therefore, the nonzero terms in the above sum are either of the form E[xtl (there are n such terms) , or of the form E[Xl XJl, with i =f j. Let us count how many terms there are of this form. Such terms are obtained in three different ways: by setting il = i2 =f i3 = i4, or by setting il = i3 =f i2 = i4, or by setting il = i4 =f i2 = i3. For each one of these three ways, we have n choices for the first pair of indices, and n - 1 choices for the second pair. We conclude that there are 3n(n - 1) terms of this type. Thus, E [(Xl + . .. + Xn)4] = nE[Xtl + 3n(n - I)E[X� X�l. Using the inequality xy � (x2 + y2)/2, we obtain E[Xf xiJ � E[XtJ, and E[(XI + . . . + Xn)4] � (n + 3n(n - 1))E[Xtl � 3n2E[XtJ. It follows that E [f; (X, + .�� + Xn)4] = f; �4 E [(XI + . . . +xn)4] � f; :2 ElxtJ < 00 . where the last step uses the well known property 2:�=1 n -2 < 00. This implies that (Xl + . . . +Xn)4/n4 converges to zero with probability 1 (cf. Problem 16), and therefore, (Xl + . . . + Xn)/n also converges to zero with probability 1, which is the strong law of large numbers. For the more general case where the mean of the random variables Xi is nonzero, the preceding argument establishes that (Xl + .. . +Xn - nE[Xl.l)/n converges to zero, which is the same as (Xl + ... + Xn)/n converging to E[Xl], with probability 1. 6 The Bernoulli and Poisson Process es 6. 1. The Bernoulli ProcelSs . 6.2. The Poisson Process 6.3. Summary and Discussion Problems ....... . Contents · p. 297 · p. 309 · p. 324 · p. 326 295 296 The Bernoulli and Poisson Processes Chap. 6 A stochastic process is a mathematical model of a probabilistic experiment that evolves in time and generates a sequence of numerical values. For example. a stochastic process can be used to model: (a) the sequence of daily prices of a stock; (b) the sequence of scores in a foot ball game: (c) the sequence of failure times of a machine: (d) the sequence of hourly traffic loads at a node of a communication network; (e) the sequence of radar mea.'iurements of the position of an airplane. Each numerical value in the sequen('e is modeled by a random variable, so a stochastic process is simply a (finite or infinite) sequence of random variables and does not represent a major conceptual departure from our basic framework. We are still dealing with a single basic experiment that involves outcomes gov­ erned by a probability law. and random variables that inherit their probabilistic properties from that law. t However. stochastic processes involve some change in emphasis over our earlier models. In particular: (a) \"Ve tend to focus on the dependencies in the sequence of values generated by the process. For example. how do future prices of a stock depend on past values? (b) We are often interested in long-term averages involving the entire se­ quence of generated values. For example. what is the fraction of time that a machine is idle? (c) 'Ve sometimes wish to characterize the likelihood or frequency of certain boundary events. For example, what is the probability that within a given hour all circuits of some telephone system become simultaneously busy: or what is the frequency with which some buffer in a computer net­ work overflows with data? There is a wide variety of stochastic processes. but in this book we will only discuss two major ('ategories. (i) Arrival- Type Processes : Here. we are interested in occurrences that have the character of an \"'arrivaL\"' such as message receptions at a receiver, job completions in a manufacturing celL customer purchases at a store, etc. We will focus on models in which the interarrival times (the times between successive arrivals) are independent random variables. In Section 6.1, we consider the case where arrivals occur in discrete time and the interarrival t Let us empha..<;ize that al l of the random variables arising in a stochastic process refer to a single and common experiment, and are therefore defined on a common sample space. The corresponding probability law can be specified explicitly or implicitly (in terms of its properties) , provided that it determines unambiguously the joint CDF of any subset of the random variables involved. Sec. 6. 1 The Bernoulli Process 297 times are geometrically distributed - this is the Bernoulli process . In Sec­ tion 6.2, we consider the case where arrivals occur in continuous time and the interarrival times are exponentially distributed - this is the Poisson process . (ii) Markov Processes : Here, we are looking at experiments that evolve in time and in which the future evolution exhibits a probabilistic dependence on the past. As an example, the future daily prices of a stock are typically dependent on past prices. However. in a Markov process� we assume a very special type of dependence: the next value depends on past values only through the current value. There is a rich methodology that applies to such processes, and is the subject of Chapter 7. 6.1 THE BERNOULLI PROCESS The Bernoulli process can be visualized as a sequence of independent coin tosses, where the probability of heads in each toss is a fixed number p in the range o < p < 1. In general, the Bernoulli process consists of a sequence of Bernoulli trials. Each trial produces a 1 (a success) with probability p, and a 0 (a failure) with probability 1 - p, independent of what happens in other trials. Of course, coin tossing is just a paradigm for a broad range of contexts involving a sequence of independent binary outcomes. For example, a Bernoulli process is often used to model systems involving arrivals of customers or jobs at service centers. Here, time is discretized into periods� and a \"success\" at the kth trial is associated with the arrival of at least one customer at the service center during the kth period. We will often use the term \"arrival\" in place of \"success\" when this is justified by the context. In a more formal description, we define the Bernoulli process as a sequence Xl � X2 , . . . of independent Bernoulli random variables Xi with for each i.t P(Xi = 1) = P(success at the ith trial) = p, P(Xi = 0) = P(failure at the ith trial) = 1 - p, Given an arrival process, one is often interested in random variables such as the number of arrivals within a certain time period. or the time until the first arrival. For the case of a Bernoulli process, some answers are already available from earlier chapters. Here is a summary of the main facts. t Generalizing from the case of a finite number of random variables, the inde­ pendence of an infinite sequence of random variables Xi is defined by the requirement that the random variables Xl ..... Xll be independent for any finite n. Intuitively, knowing the values of any finite subset of the random variables does not provide any new probabilistic information on the remaining random variables, and the conditional distribution of the latter is the same as the unconditional one. 298 T1Je Bernoulli and Poisson Processes Chap. 6 Some Random Variables Associated with the Bernoulli Process and their Properties • The binomial with parameters p and n. This is the number S of successes in n independent trials. Its PMF, mean, and variance are k 0, 1, .. . ,n, E[S] = np, var(S) = np(l - p). • The geometric with parameter p. This is the number T of trials up to (and including) the first success. Its PMF, mean, and variance are PT(t) = (1 - p)t- lp, t = 1, 2, ... , E[T] = �, p I- p var(T) = -2- ' P Independence and Memorylessness The independence assumption underlying the Bernoulli process has important implications. including a memorylessness property (whatever has happened in past trials provides no information on the outcomes of future trials). An appre­ ciation and intuitive understanding of such properties is very useful, and allows the quick solution of many problems that would be difficult with a more formal approach. In this subsection. we aim at developing the necessary intuition. Let us start by considering random variables that are defined in terms of what happened in a certain set of trials. For example. the random variable Z = (Xl + X3)X6X7 is defined in terms of the first, third. sixth, and seventh trial. If we have two random variables of this type and if the two sets of trials that define them have no common element. then these random variables are independent. This is a generalization of a fact first seen in Chapter 2: if two random variables U and V are independent, then any two functions of them, g(U) and h(V). are also independent. Example 6.1. (a) Let U be the number of successes in trials 1 to 5. Let V be the number of successes in trials 6 to 10. Then. U and V are independent. This is because U = Xl + . . . + X5 • V = Xu + ... + XIO. and the two collections {Xl \" ... X5 }. { X 6. .. . X 1O } have no common elements. (b) Let U (respectively. V) be the first odd (respectively, even) time i in which we have a success. Then. U is determined by the odd-time sequence Xl . X3 , ... , Sec. 6. 1 The Bernoulli Process 299 whereas V is determined by the even-time sequence X2 • X4 , .... Since these two sequences have no common elements, U and V are independent. Suppose now that a Bernoulli process has been running for n time steps, and that we have observed the values of Xl , X2 , ... ,Xn. We notice that the sequence of future trials Xn+l , Xn+2, ... are independent Bernoulli trials and therefore form a Bernoulli process. In addition, these future trials are indepen­ dent from the past ones. We conclude that starting from any given point in time, the future is also modeled by a Bernoulli process, which is independent of the past. We refer to this loosely as the fresh-start property of the Bernoulli process. Let us now recall that the time T until the first success is a geometric random variable. Suppose that we have been watching the process for n time steps and no success has been recorded. What can we say about the number T- n of remaining trials until the first success? Since the future of the process (after time n) is independent of the past and constitutes a fresh-starting Bernoulli process, the number of future trials until the first success is described by the same geometric PMF. Mathematically, we have P(T - n = tiT> n) = (1 - p)t- Ip = P(T = t), t = 1, 2, ... . We refer to this as the memorylessness property. It can also be derived al­ gebraically, using the definition of conditional probabilities, but the argument given here is certainly more intuitive. Independence Properties of the Bernoulli Process • For any given time n, the sequence of random variables X n+ 1, X n+2, . . . (the future of the process) is also a Bernoulli process, and is indepen­ dent from Xl ,.'\" Xn (the past of the process). • Let n be a given time and let T be the time of the first success after time n. Then, T - n has a geometric distribution with parameter p, and is independent of the random variables X I , ... ,Xn. Example 6.2. A computer executes two types of tasks, priority and non priority, and operates in discrete time units (slots). A priority task arrives with probability p at the beginning of each slot, independent of other slots, and requires one full slot to complete. A nonpriority task is always available and is executed at a given slot if no priority task is available. In this context, it may be important to know the probabilistic properties of the time intervals available for non priority tasks. With this in mind, let us call a slot busy if within this slot, the computer executes a priority task, and otherwise let us call it idle . We call a string of idle (or busy) slots, flanked by busy (or idle, respectively) slots. an idle period (or busy 300 (a) = ( b ) B = (c ) I ;; B I ... ... ill ... T liliiii ... Z B .. .. Z mean, first busy ..... o'rlr.rII up to 6. 1: Ill ustrat ion of random and and idle in 6.2. In the top T = 4, B = 3, I = 2, and Z 3. In the bottom T I, 1= 5) B = 4, and Z = 4. = --- 6 see 1- p, we index Sec. 6. 1 The Bernoulli Process of the first busy slot, so that PI(k) = (1 - p)k- lp, k = 1, 2, .. . , I - p var(I) = -2-. P 301 We finally note that the argument given here also works for the second, third, etc., busy (or idle) period. Thus, the PMFs calculated above apply to the ith busy and idle period, for any i. If we start watching a Bernoulli process at a certain time n, what we see is indistinguishable from a Bernoulli process that has just started. It turns out that the same is true if we start watching the process at some random time N, as long as N is determined only by the past history of the process and does not convey any information on the future. Indeed, such a property was used in Example 6.2, when we stated that the process starts fresh at time L + 1. For another example, consider a roulette wheel with each occurrence of red viewed as a success. The sequence generated starting at some fixed spin (say, the 25th spin) is probabilistically indistinguishable from the sequence generated starting immediately after red occurs in five consecutive spins. In either case, the process starts fresh (although one can certainly find gamblers with alternative theories) . The next example makes a similar argument, but more formally. Example 6.3. Fresh-Start at a Random Time. Let N be the first time that we have a success immediately following a previous success. (That is, N is the first i for which Xi-l = Xi = 1.) What is the probability P(XN+l = XN+2 = 0) that there are no successes in the two trials that follow? Intuitively, once the condition XN-l = XN = 1 is satisfied, and from then on, the future of the process consists of independent Bernoulli trials. Therefore, the probability of an event that refers to the future of the process is the same as in a fresh-starting Bernoulli process, so that P(XN+l = XN+2 = 0) = (1 _ p)2. To provide a rigorous justification of the above argument, we note that the time N is a random variable, and by conditioning on the possible values of N, we have n=l 00 = L P(N = n)P(Xn+1 = Xn+2 = 0 I N = n). n=l Because of the way that N was defined, the event {N = n} occurs if and only if the values of Xl , ... , X n satisfy a certain condition. But these random variables are independent of Xn+1 and Xn+2. Therefore, P(Xn+l = Xn+2 = 0 IN = n) = P(Xn+l = Xn+2 = 0) = (1 _ p)2, which leads to 00 P(XN+l = XN+2 = 0) = L P(N = n)(1 - p)2 = (1 _ p)2. n=l 6 An IS of the kth success (or is the kth interarrival we denote by Yk . A related random variable by Tk . It is by 1 , k = number (k - 1 )st success until for an illustration, and also note that + + . . . + 6.2: Illustration of interarrival where a 1 represents an arrivaL In = 2, T4 = 1. Y1 = 3 , = 8, We have already seen with p. a success T1 , a new Bernoulli process, to the original: the T2 until next success has the same geometric PfvlF. Furthermore, past trials (up to and including T1 ) are (from 1 is determined exclusively by what happens see that T2 is of Tl . Continuing \"-' .... , ........ ..., ... random distribution . .... are This important observation to an describing the Bernoulli which is Alternative ....... \"'-' . .:::0 ..., ,, 1. with a sequence com mon the more way of a success at + T3 , etc. Sec. 6. 1 The Bernoulli Process 303 Example 6.4. It has been observed that after a rainy day. the number of days until it rains again is geometrically distributed with parameter p. independent of the past . Find the probability that it rains on both the 5th and the 8th day of the month. If we attempt to approach this problem by manipulating the geometric PMFs in the problem statement. the solution is quite tedious. However, if we view rainy days as \"arrivals,\" we notice that the description of the weather conforms to the al­ ternative description of the Bernoulli process given above. Therefore, any given day is rainy with probability p. independent of other days. In particular. the probability that days 5 and 8 are rainy is equal to p2 . The kth Arrival Time The time Yk of the kth success (or arrival) is equal to the sum Yk = Tl + T2 + . . . + Tk of k independent identically distributed geometric random variables. This allows us to derive formulas for the mean. variance. and Pl\\IF of Yk . which are given in the table that follows. Properties of the kth Arrival Time • The kth arrival time is equal to the sum of the first k interarrival times and the latter are independent geometric random variables with com­ mon parameter p. • The mean and variance of Yk are given by k( l p) var(Yk) = var(TI ) + ... + var(Tk) = 2 . P • The PMF of Yk is given by (t -1) PYk (t) = k - 1 pk (l - p)t-k , t = k,k+1, ... , and is known as the Pascal PMF of order k. To verify the formula for the PMF of Yk , we first note that Yk cannot be smaller than k. For t 2: k. we observe that the event {Yk = t} (the kth success 304 The Bernoulli and Poisson Processes Chap. 6 comes at time t) will occur if and only if both of the following two events A and B occur: (a) event A: trial t is a success: (b) event B: exactly k - 1 successes occur in the first t - 1 trials. The probabilities of these two events are and P(A) = p, ( t - 1) P(B) = pk-l (l - p)t-k . k- 1 respectively. In addition. these two events are independent (whether trial t is a success or not is independent of what happened in the first t - 1 trials) . Therefore, ( t - 1) PYk (t) = P(Yk = t) = P(A n B) = P(A)P(B) = k _ 1 pk (l - p)t - k . as claimed. Example 6.5. In each minute of basketball play� Alicia commits a single foul with probability p and no foul with probability 1 - p. The number of fouls in different minutes are assumed to be independent. Alicia will foul out of the game once she commits her sixth foul. and will play 30 minutes if she does not foul out. What is the PMF of Alicia�s playing time? We model fouls as a Bernoulli process with parameter p. Alicia's playing time Z is equal to Y6 • the time until the sixth foul, except if Y6 is larger than 30, in which case. her playing time is 30; that is, Z = min{Y6 , 3D}. The random variable Y6 has a Pascal PMF of order 6, which is given by (t - 1) 6 t -6 PY6 (t) = 5 P (1 - p) . t = 6, 7, .. . To determine the PMF pz (z) of Z, we first consider the case where z is between 6 and 29. For z in this range, we have z = 6, 7, ... ,29. The probability that Z = 30 is then determined from 29 pz (30) = 1 - LPZ(z). z=6 6. 1 with a Bernoulli process in wh ich there is a probability p of an time� consider it as follows . is an arrival. we choose to it ( with probabil ity q) . or to it ( with probability 1- q) : see Fig . 6.3. Assume that the decisions to keep or discard are independent we on of are we see that it is a Bernoulli process: in each time slot . there is a probability pq of a a reverse (with parameters p as follows . All the same reason . pro cess . with a probability to p( 1 - q) . 6.3: Split ti ng of a Bernoulli process . . we st �rt h t·wo q. respecti vely) and IS in the lllcrged if therc is an at one two prob abilit ,\\' p + q - pq [o ne mi nus prob abil ity (1 - p) (I - q) of no arrival in either process] . Since different time slots in slot� are the nlerged process is Bernoulli. with success proba bili ty p + q - at each tinle 6.4. ........... '-''''.. of successes n with parameters n. and p. In work center In a,,\" see a streanl of to a be faced wit h arrivals :stream . IS a ...... 111, U'llll u,,& nlean is np. In thi s subsect ion . \\ve 6 ... \", \"\"\"\"\" \",, of maeo(maent Bernoul li processes . • k 1, mean are [Z] =A, Sec. 6. 1 The Bernoulli Process 307 • For any fixed nonnegative integer k, the binomial probability n' ps (k) = (n _ �)! k! . pk(1 - p)n-k converges to pz (k), when we take the limit as n -+ 00 and p = )./n, while keeping ). constant. • In general, the Poisson PMF is a good approximation to the binomial as long as ). = np, n is very large, and p is very small. To verify the validity of the Poisson approximation, we let p )./n and note that n! ps(k) = (n _ k)! k! . pk(1 - p)n-k n(n-l ) . .. (n -k+ l ). ).k . (1 - ).)n-k k! nk n n (n 1) ... (n-k+l) . ).k . (1- �)n-k n n n k! n Let us focus on a fixed k and let n -+ 00. Each one of the ratios (n - 1)/n, (n - 2)/n, .. . , (n - k + 1)/n converges to 1. Furthermore,t ( ).)-k 1 - ;, -+ 1, We conclude that for each fixed k, and as n -+ 00, we have ).k ps (k) -+ e-A- k! . Example 6.6. As a rule of thumb, the Poisson/binomial approximation - >. >.k n! k ( e k! � (n _ k)! k! . P 1 )n-k P , k = 0, 1, ... ,n, is valid to several decimal places if n � 100, P :$ 0.01, and >' = np. To check this, consider the following. Gary Kasparov, a world chess champion, plays against 100 amateurs in a large simultaneous exhibition. It has been estimated from past experience that Kasparov t We are using here, the well known formula limx ..... oo(l - � )x = e - 1 • Letting x = n/>', we have limn ..... oo(l - �)n/>. = 1 , and limn ..... oc(l - � ) n = e - >' . 308 The Bernoulli and Poisson Processes Chap. 6 wins in such exhibitions 99% of his games on the average (in precise probabilistic terms, we assume that he wins each game with probability 0.99, independent of other games) . What are the probabilities that he will win 100 games, 98 games, 95 games, and 90 games? We model the number of games X that Kasparov does not win as a binomial random variable with parameters n = 100 and p = 0.01 . Thus the probabilities that he will win 100 games, 98, 95 games, and 90 games are px (0) = (1 - 0.01) 100 = 0.366, 100! 2 98 px (2) = -, -, ·0.01 (1 - 0.01) = 0.185, 98. 2. 100! 5 95 px(5) = 95! 5! ·0.01 ( 1 - 0.01) = 0.00290, (10) = 100! . 00110(1 - 0 01)90 = 7006 . 10-8 px 90! 1O! ' . . , respectively. Now let us check the corresponding Poisson approximations with >' = 100 · 0.01 = 1. They are: pz (O) = e - l � = 0.368, O. pz (2) = e-l � = 0.184, 2. pz (5) = e- 1 ;! = 0.00306, pz ( lO) = e- 1 � = 1.001 . 10-8. 10. By comparing the binomial PMF values px (k) with their Poisson approximations pz (k), we see that there is close agreement. Suppose now that Kasparov plays simultaneously against just 5 opponents. who are, however, stronger so that his probability of a win per game is 0.9. Here are the binomial probabilities px(k) for n = 5 and p = 0. 1, and the corresponding Poisson approximations pz(k) for >. = np = 0.5: k 0 1 2 3 4 5 px(k) 0.590 0.328 0.0729 0.0081 0.00045 0.00001 pz (k) 0.605 0.303 0.0758 0.0126 0.0016 0.00016 We see that the approximation, while not poor, is considerably less accurate than in the case where n = 100 and p = 0.01. Example 6.1. A packet consisting of a string of n symbols is transmitted over a noisy channel. Each symbol has probability p = 0.0001 of being transmitted in Sec. 6.2 The Poisson Process 309 error, independent of errors in the other symbols. How small should n be in order for the probability of incorrect transmission (at least one symbol in error) to be less than 0.001? Each symbol transmission is viewed as an independent Bernoulli trial. Thus, the probability of a positive number S of errors in the packet is 1 - P(S = 0) = 1 - (1 - p)\" . For this probability to be less than 0.001 . we must have 1 - (1 - 0.0001 t < 0.001 or n < In 0.999 = 10.0045. In 0.9999 We can also use the Poisson approximation for P(S = 0) , which is e->' with >. = np = 0.0001 . n, and obtain the condition 1 - e-O.OuOl .n < 0.001 . which leads to n - In 0.999 = 10.005. < 0.0001 Given that n must be integer, both methods lead to the same conclusion that n can be at most 10. 6.2 THE POISSON PROCESS The Poisson process is a continuous-time analog of the Bernoulli process and applies to situations where there is no natural way of dividing time into discrete periods. To see the need for a continuous-time version of the Bernoulli process. let us consider a possible model of traffic accidents within a city. \\Ve can start by discretizing time into one-minute periods and record a \"success\" during every minute in which there is at least one traffic accident. Assuming the traffic in­ tensity to be constant over time, the probability of an accident should be the same during each period. Under the additional (and quite plausible) assumption that different time periods are independent. the sequence of successes becomes a Bernoulli process. Note that in real life. two or more accidents during the same one-minute interval are certainly possible, but the Bernoulli process model does not keep track of the exact number of accidents. In particular. it does not allow us to calculate the expected number of accidents within a given period. One way around this difficulty is to choose the length of a time period to be very small. so that the probability of two or more accidents becomes negligible. But how small should it be? A second? A millisecond? Instead of making an arbitrary choice, it is preferable to consider a limiting situation where the length of the time period becomes zero. and work with a continuous-time model. We consider an arrival process that evolves in continuous time. in the sense that any real number t is a possible arrival time. We define P(k. r) = P(there are exactly k arrivals during an interval of length r), 310 The Bernoulli and Poisson Processes Chap. 6 and assume that this probability is the same for all intervals of the same length ,. We also introduce a positive parameter A, called the arrival rate or intensity of the process, for reasons that will soon become apparent. Definition of the Poisson Process An arrival process is called a Poisson process with rate A if it has the fol­ lowing properties: (a) (Time-homogeneity) The probability P(k, ,) of k arrivals is the same for all intervals of the same length ,. (b) (Independence) The number of arrivals during a particular interval is independent of the history of arrivals outside this interval. (c) (Small interval probabilities) The probabilities P(k, ,) satisfy P(O, ,) = 1 - A, + 0(,) , P( l, ,) = A, + OI (') , P(k, ,) = Ok (') , for k = 2, 3, ... Here, 0( ,) and Ok ( ,) are functions of , that satisfy . 0( ,) hm -- = 0, 7\"--+0 , lim Ok (') = 0 . 7\"--+0 , The first property states that arrivals are \"equally likely\" at all times. The arrivals during any time interval of length , are statistically the same, i.e., they obey the same probability law. This is a counterpart to the assumption that the success probability p in a Bernoulli process is the same for all trials. To interpret the second property, consider a particular interval [t, tf] , of length tf - t. The unconditional probability of k arrivals during that interval is P(k, tf - t). Suppose now that we are given complete or partial information on the arrivals outside this interval. Property (b) states that this information is irrelevant: the conditional probability of k arrivals during [t, tfl remains equal to the unconditional probability P(k, tf - t). This property is analogous to the independence of trials in a Bernoulli process. The third property is critical. The 0( ,) and Ok ( ,) terms are meant to be negligible in comparison to \" when the interval length , is very small. They can be thought of as the 0(,2) terms in a Taylor series expansion of P(k, ,) . Thus, for small \" the probability of a single arrival is roughly A\" plus a negligible term. Similarly, for small \" the probability of zero arrivals is roughly 1 - A,. Finally, the probability of two or more arrivals is negligible in comparison to P(l, ,) , as , becomes smaller. We 311 are has one arri val wi th probability '\"lo .................... A'Y\"-'.I.&.I . .I.u.lJ''-'& to A61 or zero with probability approxi mately Therefore, the process being studied can be approxinlated by a Bernoulli process1 the approximatioll Inore more as 0 becomes smaller. Figure 6.5: Bernou lli approximation of the Poisson process over an interval of length r. The probability P( k: of k in r is the (bi nomial) probability of k succetises in n = T / fJ in dependent with success probability p = ,\\<5 . While keeping the length T of interval fixed � we let the to zero. We then note that the nurnber n of periods goes to infinity, while the product up rcrnain::s constant and to Ai. these we saw in the previous that binomial PMF converges to a Poisson Pi\\lF with parameter AT. \\Ve are then led to Note a Taylor _ -A T ('\\T)k P(k� T ) - e k\"l ' k = 0, 1, .... ,-, ,\",,,.A\"\"''',,,,, ''' of e-A T yields P(O, T) = e-A T = 1- +O(T)� 1: i ) == == Ai - A2i2 + 0(73 ) = AT + 01 (7) , ........... J.J.,,:).I..:,\"'''-'.I. • .I. ''' with property (c) . 312 The Bernoulli and Poisson Processes Chap. 6 Using our earlier formulas for the mean and variance of the Poisson PMF. we obtain E[NTJ = AT. var(NT ) = AT. where NT denotes the number of arrivals during a time interval of length T. These formulas are hardly surprising. since we are dealing with the limit of a binomial PMF with parameters n = Tlb, P = Ab. mean np = AT, and variance np(1 - p) � np = AT. Let us now derive the probability law for the time T of the first arrival, assuming that the process starts at time zero. ;.rote that we have T > t if and only if there are no arrivals during the interval [0. tJ . Therefore. FT (t) = P (T < t) = 1- P (T > t) = 1 - P(O, t) = 1 - e�M. t > O. We then differentiate the CDF FT(t) of T, and obtain the PDF formula t > O. which shows that the time until the first arrival is exponentially distributed with parameter A. We summarize this discussion in the table that follows. See also Fig. 6.6. Random Variables Associated with the Poisson Process and their Properties • The Poisson with parameter AT. This is the number N\" of arrivals in a Poisson process with rate A, over an interval of length T. Its PMF, mean, and variance are A (AT) k PN,, (k) = P(k, T) =e- \" k! ' k =O,l , . .. , var(NT ) = AT . • The exponential with parameter A. This is the time T until the first arrival. Its PDF, mean, and variance are !T(t) = Ae-At , t 2: 0, 1 var(T) = A2 ' Example 6.8. You get email according to a Poisson process at a rate of A = 0.2 messages per hour. You check your email every hour. What is the probability of finding 0 and 1 new messages'? 6.6: View of the Bernoulli process as the discrete- time version process. We disc retize time in smal l intervals 6 and associate each interval with a Bernoulli trial whose is p = AO . The table sum marizes some of the basic COITe�;ocmd.enlces is COlnslstEmt preceding '-\"UI' '-'' U' ''' U'''' �U'& customers 314 The Bernoulli and Poisson Processes Chap. 6 customers arriving between 9:00 and 9: 10. Also. let N be the number of customers arriving between 9:30 and 9:35. What is the distribution of A! + N? We notice that A! is Poisson with parameter J.l = 10· 10 = 100 and N is Poisson with parameter v = 10 · 5 = 50. Furthermore. Al and N are independent. As shown in Section 4.4, using transforms, M + N is Poisson with parameter J.l + v = 150 (see also Probem 11 in Chapter 4). We will now proceed to derive the same result in a more direct and intuitive manner. Let iii be the number of customers that arrive between 9: 10 and 9:15. Note that iii has the same distribution as N (Poisson with parameter 50) . Furthermore, iii is also independent of AI. Thus. the distribution of Al + N is the same as the distribution of AI + iii. But Iv! + iii is the number of arrivals during an interval of length 15. and has therefore a Poisson distribution with parameter 10 · 15 = 150. This example makes a point that is valid in general. The probability of k arrivals during a set of times of total length T is always given by P(k. T) , even if that set is not an interval. (In this example. we dealt with the set [9:00.9: lOJU [9:30.9:35J . of total length 15.) Independence and Memorylessness The Poisson process has several properties that parallel those of the Bernoulli process, including the independence of nonoverlapping time sets, and the mem­ orylessness of the interarrival time distribution. Given that the Poisson process can be viewed as a limiting ca..<;e of a Bernoulli process. the fact that it inherits the qualitative properties of the latter should be hardly surprising. Independence Properties of the Poisson Process • For any given time t > 0, the history of the process after time t is also a Poisson process, and is independent from the history of the process until time t. • Let t be a given time and let T be the time of the first arrival after time t. Then, T -t has an exponential distribution with parameter �, and is independent of the history of the process until time t. The first property in the above table is establ�shed by observing that the portion of the process that starts at time t satisfies the properties required by the definition of the Poisson process. The independence of the future from the past is a direct consequence of the independence assumption in the definition of the Poisson process. Finally, the fact that T - t has the same exponential distribution can be verified by noting that P(T -t > s) = P (0 arrivals during [t, t + sJ) = P(O, s) = e->'s . This is the memorylessness property, which is analogous to the one for the Bernoulli process. The following examples make use of this property. Sec. 6.2 The Poisson Process 315 Example 6.10. You and your partner go to a tennis court, and have to wait until the players occupying the court finish playing. Assume (somewhat unrealistically) that their playing time has an exponential PDF. Then, the PDF of your waiting time (equivalently, their remaining playing time) also has the same exponential PDF, regardless of when they started playing. Example 6.11. When you enter the bank, you find that all three tellers are busy serving other customers, and there are no other customers in queue. Assume that the service times for you and for each of the customers being served are independent identically distributed exponential random variables. What is the probability that you will be the last to leave? The answer is 1/3. To see this, focus at the moment when you start service with one of the tellers. Then, the remaining time of each of the other two customers being served, as well as your own remaining time, have the same PDF. Therefore, you and the other two customers have equal probability 1/3 of being the last to leave. Interarrival Times An important random variable associated with a Poisson process that starts at time 0, is the time of the kth arrival, which we denote by Yk . A related random variable is the kth interarrival time, denoted by Tk • It is defined by k = 2, 3, ... and represents the amount of time between the (k - l )st and the kth arrival. Note that We have already seen that the time Tl until the first arrival is an exponen­ tial random variable with parameter A. Starting from the time Tl of the first arrival, the future is a fresh-starting Poisson process. t Thus, the time until the next arrival has the same exponential PDF. Furthermore, the past of the process (up to time T1 ) is independent of the future (after time Tl ). Since T2 is deter­ mined exclusively by what happens in the future, we see that T2 is independent of T1 • Continuing similarly, we conclude that the random variables TI , T2 , T3, . . . are independent and all have the same exponential distribution. This important observation leads to an alternative, but equivalent, way of describing the Poisson process. t This statement is a bit stronger than the fact, discussed earlier, that starting from any given deterministic time t the process starts fresh, but is quite intuitive. It can be formally justified using an argument analogous to the one in Example 6.3, by conditioning on all possible values of the random variable T1 . 316 The Bernoulli and Poisson Processes Chap. 6 Alternative Description of the Poisson Process 1. Start with a sequence of independent exponential random variables Tl , T2 , ... , with common parameter A, and let these represent the in­ terarrival times. 2. Record an arrival at times Tl , Tl + T2 , Tl + T2 + T3 . etc. The kth Arrival Time The time Y/\"o of the kt h arrival is equal to the sum Yk = TI + T2 + ... + Tk of k independent identically distributed exponential random variables. This allows us to derivE' formulas for t 11(' mean. variance. and PDF of Yk . which are given in the table that follows. Properties of the kth Arrival Time • The kth arrival time is equal to the sum of the first k interarrival times and the latter are independent exponential random variables with com­ mon parameter A. • The mean and variance of Yk are given by k var(Yk) = var(T1 ) + ... + var(Tk) = A2 ' • The PDF of Yk is given by y 2: 0, and is known (lli the Erlang PDF of order k. To evaluate the PDF jYk of Yk . we argue that for a small b, the product b· jYk (y) approximates the probability that the kth arrival occurs between times Sec. 6.2 The Poisson Process 317 y and y + <5.t When <5 is very small. the probability of more than one arrival during the interval [y, y + <5] is negligible. Thus, the kth arrival occurs between y and y + <5 if and only if the following two events A and B occur: (a) event A: there is an arrival during the interval [y, y + <5] ; (b) event B: there are exactly k - 1 arrivals before time y. The probabilities of these two events are P(A) � A<5, and Ak- 1 yk-Ie->..y P(B) = P(k - 1 .y) = (k -I ) ! . Since A and B are independent, we have Ak- 1 yk- l e- >..y <5fYk (y) � P(y ::s Yk ::s y + <5) � P(A n B) = P(A) P(B) � A<5 (k _ 1) ! ' from which we obtain y ? O. Example 6.12. You call the IRS hotline and you are told that you are the 56th person in line, excluding the person currently being served. Callers depart according to a Poisson process with a rate of ). = 2 per minute. How long will you have to wait on the average until your service starts, and what is the probability you will have to wait for more than 30 minutes? By the memorylessness property, the remaining service time of the person currently being served is exponentially distributed with parameter 2. The service times of the 55 persons ahead of you are also exponential with the same parameter, t For an alternative derivation that does not rely on approximation arguments, note that for a given y ? 0, the event {Yk ::s y} is the same as the event { number of arrivals in the interval [0, y] is at least k} . Thus, the CDF of Yk is given by x k- l k-l \\ (). )n -A Y FYk (y) = P(Yk � y) = L P(n. y) = 1- L P(n. y) = 1- L y � . n. n=k n=O n=O The PDF of Yk can be obtained by differentiating the above expression, which by straightforward calculation yields the Erlang PDF formula 318 The Bernoulli and Poisson Processes Chap. 6 and all of these random variables are independent. Thus, your waiting time in minutes, call it Y, is Erlang of order 56, and E[Y] 56 A 28. The probability that you have to wait for more than 30 minutes is given by the formula 100 A56 55 -Ay P(Y 2:: 30) = 30 Y55� dy. Computing this probability is quite tedious. On the other hand, since Y is the sum of a large number of independent identically distributed random variables, we can use an approximation based on the central limit theorem and the normal tables. Splitting and Merging of Poisson Processes Similar to the case of a Bernoulli process, we can start with a Poisson process with rate A and split it. as follows: each arrival is kept with probability p and discarded with probability 1 - p, independent of what happens to other arrivals. In the Bernoulli case, we saw that the result of the splitting was also a Bernoulli process. In the present context, the result of the splitting turns out to be a Poisson process with rate Ap. Alternatively, we can start with two independent Poisson processes, with rates Al and A2, and merge them by recording an arrival whenever an arrival occurs in either process. It turns out that the merged process is also Poisson with rate Al + A2. Furthermore, any particular arrival of the merged process has probability At /(AI + A2) of originating from the first process, and probability A2/(Al + A2) of originating from the second, independent of all other arrivals and their origins. We discuss these properties in the context of some examples, and at the same time provide the arguments that establish their validity. Example 6. 13. Splitting of Poisson Processes. A packet that arrives at a node of a data network is either a local packet that is destined for that node (this happens with probability p) , or else it is a transit packet that must be relayed to another node (this happens with probability 1 - p) . Packets arrive according to a Poisson process with rate A, and each one is a local or transit packet independent of other packets and of the arrival times. As stated above, the process of local packet arrivals is Poisson with rate Ap. Let us see why. \\Ve verify that the process of local packet arrivals satisfies the defining prop­ erties of a Poisson process. Since A and p are constant (do not change with time) , the first property (time-homogeneity) clearly holds. Furthermore, there is no de­ pendence between what happens in disjoint time intervals, verifying the second property. Finally, if we focus on a small interval of length 6, the probability of a local arrival is approximately the probability that there is a packet arrival, and that this turns out to be a local one, i.e. , A6·p. In addition, the probability of two or more local arrivals is negligible in comparison to 6, and this verifies the third property. Sec. 6.2 The Poisson Process 319 We conclude that local packet arrivals form a Poisson process and, in particular. the number of such arrivals during an interval of length T has a Poisson P1,fF with parameter P>'T. By a symmetrical argument, the process of transit packet arrivals is also Poisson, with rate >.(1 - p). A somewhat surprising fact in this context is that the two Poisson processes obtained by splitting an original Poisson process are independent: see the end-of-chapter problems. Example 6. 14. Merging of Poisson Processes. People with letters to mail arrive at the post office according to a Poisson process with rate >'1 , while people with packages to mail arrive according to an independent Poisson process with rate >'2 . As stated earlier the merged process, which includes arrivals of both types, is Poisson with rate >'1 + >'2 . Let us see why. First, it should be clear that the merged process satisfies the time-homogeneity property. Furthermore. since different intervals in each of the two arrival processes are independent, the same property holds for the merged process. Let us now focus on a small interval of length 8. Ignoring terms that are negligible compared to 8, we have P(O arrivals in the merged process) � (1 - >'18)(1 - >'28) � 1 - (>'1 + >'2 )8, P ( 1 arrival in the merged process) � >'1 8( 1 - >'28) + (1 - >'1 8)>'28 � (>'1 + >'2 )8, and the third property has been verified. Given that an arrival has just been recorded, what is the probability that it is an arrival of a person with a letter to mail? We focus again on a small interval of length 8 around the current time, and we seek the probability P( 1 arrival of person with a letter 11 arrival). Using the definition of conditional probabilities, and ignoring the negligible proba­ bility of more than one arrival, this is P (1 arrival of person with a letter) >'18 --�----���----�--------� � �----� P( 1 arrival) (>'1 + >'2 )8 Generalizing this calculation, we let Lk be the event that the kth arrival corresponds to an arrival of a person with a letter to mail, and we have Furthermore, since distinct arrivals happen at different times, and since, for Poisson processes, events at different times are independent, it follows that the random variables L1 , L2 , ... are independent. Example 6.15. Competing Exponentials. Two light bulbs have independent and exponentially distributed lifetimes Ta and n, with parameters >'a and >'b , respectively. What is the distribution of Z = min{Ta, n}, the first time when a bulb burns out? 320 The Bernoulli and Poisson Processes For all z � 0, we have, Fz (z) = P (min{Ta, Tb} � z) = 1- P (min{Ta, Tb} > z) = 1 - P(Ta > z, n > z) = 1 - P(Ta > Z)P(Tb > z) Chap. 6 This is recognized as the exponential CDF with parameter ).a + ).b. Thus, the mini­ mum of two independent exponentials with parameters ).a and ).b is an exponential with parameter ).a + ).b. For a more intuitive explanation of this fact, let us think of Ta and Tb as the times of the first arrivals in two independent Poisson processes with rates ).a and ).b, respectively. If we merge these two processes, the first arrival time will be min{Ta, Tb}. But we already know that the merged process is Poisson with rate ).a + ).b, and it follows that the first arrival time, min{Ta, Tb}, is exponential with parameter ).a + ).b. The preceding discussion can be generalized to the case of more than two processes. Thus, the total arrival process obtained by merging the arrivals of n independent Poisson processes with arrival rates AI , ... , An is Poisson with arrival rate equal to the sum Al + ... + An . Example 6. 16. More on Competing Exponentials. Three light bulbs have independent exponentially distributed lifetimes with a common parameter ).. What is the expected value of the time until the last bulb burns out? We think of the times when each bulb burns out as the first arrival times in independent Poisson processes. In the beginning, we have three bulbs, and the merged process has rate 3),. Thus, the time Tl of the first burnout is exponential with parameter 3)\" and mean 1/3),. Once a bulb burns out, and because of the memorylessness property of the exponential distribution, the remaining lifetimes of the other two light bulbs are again independent exponential random variables with parameter ).. We thus have two Poisson processes running in parallel, and the remaining time T2 until the first arrival in one of these two processes is now exponential with parameter 2), and mean 1/2),. Finally, once a second bulb burns out, we are left with a single one. Using memorylessness once more, the remaining time T3 until the last bulb burns out is exponential with parameter ). and mean 1/),. Thus, the expected value of the total time is 1 1 1 E[TI + T2 + T3] = 3), + 2), + �. Note that the random variables T1 , T2 , T3 are independent, because of memoryless­ ness. This allows us to also compute the variance of the total time: 1 1 1 var(Tl + T2 + T3) = var(TI ) + var(T2) + var(T3) = 9).2 + 4).2 + ).2 · Sec. 6.2 The Poisson Process 321 Bernoulli and Poisson Processes, and Sums of Random Variables The insights obtained from splitting and merging of Bernoulli and Poisson pro­ cesses can be used to provide simple explanations of some interesting properties involving sums of a random number of independent random variables. Alter­ native proofs, based for example on manipulating PMFsjPDFs, solving derived distribution problems, or using transforms. tend to be unintuitive. We collect these properties in the following table. Properties of Sums of a Random Number of Random Variables Let N, Xl , X2, . . . be independent random variables, where N takes nonneg­ ative integer values. Let Y = Xl + . .. + XN for positive values of N, and let Y = 0 when N = O. • If Xi is Bernoulli with parameter p, and N is binomial with parameters m and q, then Y is binomial with parameters m and pq. • If Xi is Bernoulli with parameter p, and N is Poisson with parameter A, then Y is Poisson with parameter Ap. • If Xi is geometric with parameter p, and N is geometric with param­ eter q, then Y is geometric with parameter pq. • If Xi is exponential with parameter A, and N is geometric with pa­ rameter q, then Y is exponential with parameter Aq. The first two properties are shown in Problem 22, the third property is shown in Problem 6. and the last property is shown in Problem 23. The last three properties were also shown in Chapter 4. by using transforms (see Section 4.4 and the last end-of-chapter problem of Chapter 4) . One more related property is shown in Problem 24. namely that if Nt denotes the number of arrivals of a Poisson process with parameter A within an interval of length t, and T is an interval with length that is exponentially distributed with parameter v and is independent of the Poisson process. then NT + 1 is geometrically distributed with parameter v j (A + v) . Let us also note a related and quite deep fact . namely that the sum of a large number of (not necessarily Poisson) independent arrival processes, can be approximated by a Poisson process with arrival rate equal to the sum of the individual arrival rates. The component processes must have a small rate relative to the total (so that none of them imposes its probabilistic character on the total arrival process) and they must also satisfy some technical mathematical assumptions. Further discussion of this fact is beyond our scope, but we note that it is in large measure responsible for the abundance of Poisson-like processes in practice. For example. the telephone traffic originating in a city consists of 322 The Bernoulli and Poisson Processes Chap. 6 many component processes, each of which characterizes the phone calls placed by individual residents. The component processes need not be Poisson: some people for example tend to make calls in batches� and (usually) while in the process of talking, cannot initiate or receive a second call. However, the total telephone traffic is well-modeled by a Poisson process. For the same reasons, the process of auto accidents in a city� customer arrivals at a store, particle emissions from radioactive material, etc., tend to have the character of the Poisson process. The Random Incidence Paradox The arrivals of a Poisson process partition the time axis into a sequence of interarrival intervals; each interarrival interval starts with an arrival and ends at the time of the next arrival. We have seen that the lengths of these interarrival intervals are independent exponential random variables with parameter A, where A is the rate of the process. More precisely, for every k, the length of the kth interarrival interval has this exponential distribution. In this subsection, we look at these interarrival intervals from a different perspective. Let us fix a time instant t* and consider the length L of the interarrival interval that contains t* . For a concrete context, think of a person who shows up at the bus station at some arbitrary time t* and records the time from the previous bus arrival until the next bus arrival. The arrival of this person is often referred to as a \"random incidence,\" but the reader should be aware that the term is misleading: t* is just a particular time instance, not a random variable. We assume that t* is much larger than the starting time of the Poisson process so that we can be fairly certain that there has been an arrival prior to time t* . To avoid the issue of how large t* should be, we assume that the Poisson process has been running forever, so that we can be certain that there has been a prior arrival, and that L is well-defined. One might superficially argue that L is the length of a \"typicar interarrival interval, and is exponentially distributed, but this turns out to be false. Instead , we will establish that L has an Erlang PDF of order two. This is known as the random incidence phenomenon or paradox, and it can be explained with the help of Fig. 6.7. Let [V, V] be the interarrival interval that contains t* , so that L = V - V. In particular, V is the time of the first arrival prior to t* and V is the time of the first arrival after t* . We split L into two parts, L = (t* - V) + (V - t* ). where t* - V is the elapsed time since the last arrival, and V - t* is the remaining time until the next arrival. Note that t* - V is determined by the past history of the process (before t* ), while V - t* is determined by the future of the process (after time t* ). By the independence properties of the Poisson process� the random variables t* - V and V - t* are independent. By the memorylessness property, the Poisson process starts fresh at time t*, and therefore V - t* is exponential with parameter A. The random variable t* - V is also exponential this is to realize that if we run a a no nl0ves Or backward. A nlore formal argument is obtained by noting that P(t* - > x) = random L ]) = P(O, x) = e-AX, with mean 2/ A. 6.7: Illust ration of the random incidence phenomenon. For a fixed time instant f\"' , the corresponding interarri val interval [V, Vj c o nsists of the elapsed time t* - V and the remai ning ti me V - t* . These two times are indepen dent are expone ntiaHy dist ributed with A, 50 the PDF of their sum is of order two . source probabilistic modeling. is that an at an arbitrary time more likely to fall a large than a small interarrival As a consequence the expected A�\"\"i� \"' AA seen by 1S with 1/ A nlean exponent ial A similar situation arises in example that follows . A person shows up at the bus station at a \"random!! to mean a a a person into an probabi lity 1/ 12, and an interarri val interval of ]ength 5· 1 1 2 + 55 · �� = 50.83, which is considerably 30, is time. 324 The Bernoulli and Poisson Processes Chap. 6 As the preceding example indicates. random incidence is a subtle phe­ nomenon that introduces a bias in favor of larger interarrival intervals, and can manifest itself in contexts other than the Poisson process. In general, whenever different calculations give contradictory results, the reason is that they refer to different probabilistic mechanisms. For instance. considering a fixed nonran­ dom k and the associated random value of the kth interarrival interval is a different experiment from fixing a time t and considering the random K such that the Kth interarrival interval contains t. For a last example with the same flavor, consider a survey of the utilization of town buses. One approach is to select a few buses at random and calculate the average number of riders in the selected buses. An alternative approach is to select a few bus riders at random, look at the buses that they rode and calculate the average number of riders in the latter set of buses. The estimates produced by the two methods have very different statistics, with the second method being biased upwards. The reason is that with the second method, it is much more likely to select a bus with a large number of riders than a bus that is near-empty. 6.3 SUMMARY AND DISCUSSION In this chapter. we introduced and analyzed two memoryless arrival processes. The Bernoulli process evolves in discrete time, and during each discrete time step. there is a constant probability p of an arrival. The Poisson process evolves in continuous time, and during each small interval of length 6 > 0, there is a probability of an arrival approximately equal to A8. In both cases, the numbers of arrivals in disjoint time intervals are assumed independent. The Poisson process can be viewed as a limiting case of the Bernoulli process, in which the duration of each discrete time slot is taken to be a very small number 6. This fact can be used to draw parallels between the major properties of the two processes, and to transfer insights gained from one process to the other. Using the memorylessness property of the Bernoulli and Poisson processes, we derived the following. (a) The PMF of the number of arrivals during a time interval of given length is binomial and Poisson. respectively. (b) The distribution of the time between successive arrivals is geometric and exponential, respectively. (c) The distribution of the time until the kth arrival, is Pascal of order k and Erlang of order k, respectively. Furthermore, we saw that one can start with two independent Bernoulli (respectively, Poisson) processes and \"merge\" them to form a new Bernoulli (re­ spectively. Poisson) process. Conversely. if one \"accepts\" each arrival by tossing a coin with success probability p (\"splitting\" ), the process of accepted arrivals is a Bernoulli or Poisson process whose arrival rate is p times the original rate. Sec. 6.3 Summary and Discussion 325 We finally considered the \"random incidence\" phenomenon where an ex­ ternal observer arrives at some given time and measures the interarrival interval within which he arrives. The probabilistic properties of the measured interval are not \"typical\" because the arriving observer is more likely to fall in a larger interarrival interval. This phenomenon indicates that when talking about a \"typ­ ical\" interval, one must carefully describe the mechanism by which it is selected. Different mechanisms will in general result in different probabilistic properties. 326 The Bernou11i and Poisson Processes Chap. 6 PROBLEMS SECTION 7.1. The Bernoulli Process Problem 1. Each of n packages is loaded independently onto either a red truck (with probability p) or onto a green truck (with probability 1 - p) . Let R be the total number of items selected for the red truck and let G be the total number of items selected for the green truck. (a) Determine the PMF, expected value, and variance of the random variable R. (b) Evaluate the probability that the first item to be loaded ends up being the only one on its truck. (c) Evaluate the probability that at least one truck ends up with a total of exactly one package. (d) Evaluate the expected value and the variance of the difference R - G. (e) Assume that n :2: 2. Given that both of the first two packages to be loaded go onto the red truck, find the conditional expectation, variance, and PMF of the random variable R. Problem 2. Dave fails quizzes with probability 1/4, independent of other quizzes. (a) What is the probability that Dave fails exactly two of the next six quizzes? (b) What is the expected number of quizzes that Dave will pass before he has failed three times? (c) What is the probability that the second and third time Dave fails a quiz will occur when he takes his eighth and ninth quizzes, respectively? (d) What is the probability that Dave fails two quizzes in a row before he passes two quizzes in a row? Problem 3. A computer system carries out tasks submitted by two users. Time is divided into slots. A slot can be idle, with probability PI = 1/6, and busy with probability PB = 5/6. During a busy slot, there is probability PI IB = 2/5 (respectively, P21B = 3/5) that a task from user 1 (respectively, 2) is executed. We assume that events related to different slots are independent. (a) Find the probability that a task from user 1 is executed for the first time during the 4th slot. (b) Given that exactly 5 out of the first 10 slots were idle, find the probability that the 6th idle slot is slot 12. (c) Find the expected number of slots up to and including the 5th task from user 1. Problems 327 (d) Find the expected number of busy slots up to and including the 5th task from user 1. (e) Find the PMF, mean, and variance of the number of tasks from user 2 until the time of the 5th task from user 1. Problem 4. * Consider a Bernoulli process with probability of success in each trial equal to p. (a) Relate the number of failures before the rth success (sometimes called a negative binomial random variable) to a Pascal random variable and derive its PMF. (b) Find the expected value and variance of the number of failures before the rth success. (c) Obtain an expression for the probability that the ith failure occurs before the rth success. Solution. (a) Let Y be the number of trials until the rth success, which is a Pascal random variable of order r. Let X be the number of failures before the rth success, so that X = Y - r. Therefore, px (k) = py (k + r) , and k = 0, 1, ... . (b) Using the notation of part (a) , we have Furthermore. E[X] = E[Y] - r = � _ r = (1 - p)r . p p (1 - p)r var(X) = var(Y) = 2 . P (c) Let again X be the number of failures before the rth success. The ith failure occurs before the rth success if and only if X 2:: i. Therefore, the desired probability is equal to i = 1, 2, .... An alternative formula is derived as follows. Consider the first r + i-I trials. The number of failures in these trials is at least i if and only if the number of successes is less than r. But this is equivalent to the ith failure occurring before the rth success. Hence. the desired probability is the probability that the number of successes in r+i - l trials is less than r. which is i = 1, 2, .... Problem 5. * Random incidence in the Bernoulli process. Your cousin has been playing the same video game from time immemorial. Assume that he wins each 328 The Bernoulli and Poisson Processes Chap. 6 game with probability p. independent of the outcomes of other games. At midnight, you enter his room and witness his losing the current game. What is the PMF of the number of lost games between his most recent win and his first future win? Solution. Let t be the numher of the game when you enter the room. Let !vI be the numher of the most recent pa..c;t game that he won, and let N be the number of the first game to be won in the future. The random variable X = N - t is geometrically dis­ tributed with parameter p. By symmetry and independence of the games, the random variahle Y = t - M is also geometrically distributed with parameter p. The games he lost hetween his most recent win and his first future win are all the games between M and N. Their number L is given by L = N - Al - 1 = X + Y - 1. Thus. L + 1 has a Pascal PMF of order two, and k = 2, 3, .... Hence. pL (i) = P(L + 1 = i + 1) = ip2 (1 _ p)' - I. i = 1, 2 ..... Problem 6. * Sum of a geometric number of independent geometric random variables. Let Y = Xl + ... + XN . where the random variables X, are geometric with parameter p. and N is geometric with parameter q. Assume that the random variables N, Xl . X2 . . .. are independent. Show. without using transforms, that Y is geometric with parameter pq. Hint: Interpret the various random variables in terms of a split Bernoulli process. Solution. We derived this result in Chapter 4. using transforms. but we develop a more intuitive derivation here. We interpret the random variables Xi and N as follows. We view the times Xl . Xl + X2 , etc. as the arrival times in a Bernoulli process with parameter p. Each arrival is rejected with probability 1 - q and is accepted with probability q. \\Ve interpret N as the number of arrivals until the first acceptance. The process of accepted arrivals is obtained by splitting a Bernoulli process and is therefore itself Bernoulli with parameter pq. The random variable Y = Xl + ... + X N is the time of the first accepted arrival and is therefore geometric. with parameter pq. Problem 7. * The bits in a uniform random variable form a Bernoulli pro­ cess. Let Xl , X 2 •••• be a sequence of binary random variables taking values in the set {O, I}. Let Y be a continuous random variable that takes values in the set [0, 1]. We relate X and Y by assuming that Y is the real number whose binary representation is 0.X1 X2X3 . . . . More concretely. we have (a) Suppose that the Xi form a Bernoulli process with parameter p = 1/2. Show that Y is uniformly distributed. Hint: Consider the probability of the event (i - 1) /2k < Y < i /2k . where i and k are positive integers. Problems 329 (b) Suppose that Y is uniformly distributed. Show that the Xi form a Bernoulli process with parameter p = 1/2. Solution. (a) We have Furthermore, 1 P (Y E [0, 1/2]) = P(XI = 0) = 2 = P (Y E [1/2,1]). 1 p(y E [0, 1/4]) = P(XI = O. X2 = 0) = 4' Arguing similarly, we consider an interval of the form [( i- I) /2k . i /2k] , where i and k are positive integers and i � 2k . For Y to fall in the interior of this interval, we need Xl , ... ,Xk to take on a particular sequence of values (namely, the digits in the binary expansion of i- I). Hence, Note also that for any y E [0. 1] ' we have P(Y = y) = 0, because the event {Y = y} can only occur if infinitely many XiS take on particular values, a zero probability event. Therefore, the CDF of Y is continuous and satisfies Since every number y in [0, 1] can be closely approximated by a number of the form i/2k. we have P(Y � y) = y. for every y E [0, 1] , which establishes that Y is uniform. (b) As in part (a). we observe that every possible zero-one pattern for X I, ... , X k is associated to one particular interval of the form [(i - 1) /2k , i /2k] for Y. These intervals have equal length, and therefore have the same probability 1/2k , since Y is uniform. This particular joint PMF for X I , ...• X k , corresponds to independent Bernoulli random variables with parameter p = 1/2. SECTION 7.2. The Poisson Process Problem 8. During rush hour. from 8 a.m. to 9 a.m., traffic accidents occur according to a Poisson process with a rate of 5 accidents per hour. Between 9 a.m. and 11 a.m., they occur as an independent Poisson process with a rate of 3 accidents per hour. What is the PMF of the total number of accidents between 8 a.m. and 11 a.m.? Problem 9. An athletic facility has 5 tennis courts. Pairs of players arrive at the courts and use a court for an exponentially distributed time with mean 40 minutes. Suppose a pair of players arrives and finds all courts busy and k other pairs waiting in queue. What is the expected waiting time to get a court? Problem 10. A fisherman catches fish according to a Poisson process with rate A = 0.6 per hour. The fisherman will keep fishing for two hours. If he has caught at least one fish, he quits. Otherwise, he continues until he catches at least one fish. 330 The Bernoulli and Poisson Processes Chap. 6 (a) Find the probability that he stays for more than two hours. (b) Find the probability that the total time he spends fishing is between two and five hours. (c) Find the probability that he catches at least two fish. (d) Find the expected number of fish that he catches. (e) Find the expected total fishing time, given that he has been fishing for four hours. Problem 11. Customers depart from a bookstore according to a Poisson process with rate A per hour. Each customer buys a book with probability p, independent of everything else. (a) Find the distribution of the time until the first sale of a book. (b) Find the probability that no books are sold during a particular hour. (c) Find the expected number of customers who buy a book during a particular hour. Problem 12. A pizza parlor serves n different types of pizza, and is visited by a number K of customers in a given period of time, where K is a Poisson random variable with mean A. Each customer orders a single pizza, with all types of pizza being equally likely, independent of the number of other customers and the types of pizza they order. Find the expected number of different types of pizzas ordered. Problem 13. Transmitters A and B independently send messages to a single receiver in a Poisson manner, with rates of AA and AB, respectively. All messages are so brief that we may assume that they occupy single points in time. The number of words in a message, regardless of the source that is transmitting it, is a random variable with PMF { 2/6, 3/6, pw(w) = 1/6, 0, and is independent of everything else. if w = 1, if w = 2, if w = 3, otherwise, (a) What is the probability that during an interval of duration t, a total of exactly nine messages will be received? (b) Let N be the total number of words received during an interval of duration t. Determine the expected value of N. (c) Determine the PDF of the time from t = 0 until the receiver has received exactly eight three-word messages from transmitter A. (d) What is the probability that exactly eight of the next twelve messages received will be from transmitter A? Problem 14. Beginning at time t = O. we start using bulbs. one at a time, to illuminate a room. Bulbs are replaced immediately upon failure. Each new bulb is selected independently by an equally likely choice between a type-A bulb and a type-B bulb. The lifetime, X, of any particular bulb of a particular type is a random variable, Problems independent of everything else, with the following PDF: for type-A Bulbs: Ix (x) for type-B Bulbs: Ix (x) { e-x , if x �O, 0, otherwise; { 3e -3x, 0, if x � 0, otherwise. (a) Find the expected time until the first failure. (b) Find the probability that there are no bulb failures before time t. 331 (c) Given that there are no failures until time t, determine the conditional probability that the first bulb used is a type-A bulb. (d) Find the variance of the time until the first bulb failure. (e) Find the probability that the 12th bulb failure is also the 4th type-A bulb failure. (f) Up to and including the 12th bulb failure, what is the probability that a total of exactly 4 type-A bulbs have failed? (g) Determine either the PDF or the transform associated with the time until the 12th bulb failure. (h) Determine the probability that the total period of illumination provided by the first two type-B bulbs is longer than that provided by the first type-A bulb. (i) Suppose the process terminates as soon as a total of exactly 12 bulb failures have occurred. Determine the expected value and variance of the total period of illumination provided by type-B bulbs while the process is in operation. (j) Given that there are no failures until time t, find the expected value of the time until the first failure. Problem 15. A service station handles jobs of two types, A and B. (Multiple jobs can be processed simultaneously.) Arrivals of the two job types are independent Poisson processes with parameters AA = 3 and AB = 4 per minute, respectively. Type A jobs stay in the service station for exactly one minute. Each type B job stays in the service station for a random but integer amount of time which is geometrically distributed, with mean equal to 2, and independent of everything else. The service station started operating at some time in the remote past. (a) What is the mean, variance, and PMF of the total number of jobs that arrive within a given three-minute interval? (b) We are told that during a 10-minute interval, exactly 10 new jobs arrived. What is the probability that exactly 3 of them are of type A? (c) At time 0, no job is present in the service station. What is the PMF of the number of type B jobs that arrive in the future, but before the first type A arrival? (d) At time t = 0, there were exactly two type A jobs in the service station. What is the PDF of the time of the last (before time 0) type A arrival? (e) At time 1, there was exactly one type B job in the service station. Find the distribution of the time until this type B job departs. 332 The Bernoulli and Poisson Processes Chap. 6 Problem 16. Each morning, as you pull out of your driveway, you would like to make a U-turn rather than drive around the block. Unfortunately, U-turns are illegal in your neighborhood, and police cars drive by according to a Poisson process with rate A. You decide to make a U-turn once you see that the road has been clear of police cars for T time units. Let N be the number of police cars you see before you make the U-turn. (a) Find E[N] . (b) Find the conditional expectation of the time elapsed between police cars n - 1 and n, given that N � n. (c) Find the expected time that you wait until you make the U-turn. Hint: Condition on N. Problem 17. A wombat in the San Diego zoo spends the day walking from a burrow to a food tray, eating, walking back to the burrow, resting, and repeating the cycle. The amount of time to walk from the burrow to the tray (and also from the tray to the burrow) is 20 secs. The amounts of time spent at the tray and resting are exponentially distributed with mean 30 secs. The wombat, with probability 1/3, will momentarily stand still (for a negligibly small time) during a walk to or from the tray, with all times being equally likely (and independent of what happened in the past). A photographer arrives at a random time and will take a picture at the first time the wombat will stand still. What is the expected value of the length of time the photographer has to wait to snap the wombat's picture? Problem 18.* Consider a Poisson process. Given that a single arrival occurred in a given interval [0, t), show that the PDF of the arrival time is uniform over [0, t). Solution. Consider an interval [a, b] c [0. t] of length l = b a. Let T be the time of the first arrival, and let A be the event that a single arrival occurred during [0, tJ . We have P(T E [a, b) and A) P(T E [a. bJIA)= peA) . The numerator is equal to the probability P( I, l) that the Poisson process has exactly one arrival during the length l interval [a, b] , times the probability P(O, t - l) that the process has zero arrivals during the set [0, a) U (b, t] . of total length t l. Hence P(T [ b) I A) = pe L l) P(O, t - l) = (Al)e->.le->.(t -l) 1 E a. P( I, t) (At)e -)..t = t' which establishes that T is uniformly distributed. Problem 19.* (a) Let Xl and X2 be independent and exponentially distributed. with parameters Al and A2 , respectively. Find the expected value of max{XI . X2 } ' (b) Let Y be exponentially distributed with parameter AI . Let Z be Erlang of order 2 with parameter ).2 . Assume that Y and Z are independent. Find the expected value of max{Y, Z} . Solution. A direct but tedious approach would be to find the PDF of the random variable of interest and then evaluate an integral to find its expectation. A much Problems 333 simpler solution is obtained by interpreting the random variables of interest in terms of underlying Poisson processes. (a) Consider two independent Poisson processes with rates >'1 and >'2 , respectively. We interpret Xl as the first arrival time in the first process, and X2 as the first arrival time in the second process. Let T = min {X 1 , X 2 } be the first time when one of the processes registers an arrival. Let S = max{X1 , Xd - T be the additional time until both have registered an arrival. Since the merged process is Poisson with rate >'1 + >'2 , we have 1 E[T] = >. >. I + 2 Concerning S. there are two cases to consider. (i) The first arrival comes from the first process; this happens with probability >'1 /(>'1 + >'2 ). We then have to wait for an arrival from the second process, which takes 1/>'2 time on the average. (ii) The first arrival comes from the second process; this happens with probability >'2 /(>'1 + >'2 ). We then have to wait for an arrival from the first process, which takes 1 />' 1 time on the average. Putting everything together, we obtain (b) Consider two independent Poisson processes with rates >'1 and >'2 , respectively. We interpret Y as the first arrival time in the first process, and Z as the second arrival time in the second process. Let T be the first time when one of the processes registers an arrival. Since the merged process is Poisson with rate >'1 + >'2 , we have E[T] = 1 /(>'1 + >'2 ) . There are two cases to consider. (i) The arrival at time T comes from the first process; this happens with probability >' 1/(>'1 + >'2 ). In this case, we have to wait an additional time until the second process registers two arrivals. This additional time is Erlang of order 2, with parameter >'2 , and its expected value is 2/>'2 . (ii) The arrival at time T comes from the second process; this happens with prob­ ability >'2 /(>'1 + >'2 ). In this case, the additional time S we have to wait is the time until each of the two processes registers an arrival. This is the maximum of two independent exponential random variables and, according to the result of part (a) , we have Putting everything together, we have [ ] 1 >'1 2 >'2 E max{ Y, Z} = >. >. + >. >. ' \"\"\\ + >. >. ' E[S]. I + 2 1 + 2 /\\2 1 + 2 where E[S] is given by the previous formula. 334 The Bernoulli and Poisson Processes Chap. 6 Problem 20. * Let Yk be the time of the kth arrival in a Poisson process with rate A. Show that for all Y > 0, Solution. We have 00 00 Ak k-l ->.y L fYk (Y) = L tk - �)! k=l k=l 00 Ak-l k- l _>.y = A L (:- 1�! k=l = A � Amyme->'y L m! m=O = A. (let m = k - 1) The last equality holds because the Amyme->'y 1m! terms are the values of a Poisson PMF with parameter AY and must therefore sum to l. For a more intuitive derivation, let 8 be a small positive number and consider the following events: Ak : the kth arrival occurs between y and y+8; the probability of this event is P(Ak) :::::: fYk (y)8; A: an arrival occurs between y and y + 8; the probability of this event is P(A) :::::: fy (y)8. Suppose that 8 is taken small enough so that the possibility of two or more arrivals during an interval of length 8 can be ignored. With this approximation, the events AI, A2, •.. become disjoint, and their union is A. Therefore, k= l k=l :::::: P(A) and the desired result follows by canceling 8 from both sides. Problem 21. * Consider an experiment involving two independent Poisson processes with rates Al and A2. Let Xl (k) and X2 (k) be the times of the kth arrival in the 1st and the 2nd process, respectively. Show that Solution. Consider the merged Poisson process, which has rate Al + A2 . Each time there is an arrival in the merged process, this arrival comes from the first process Problems 335 (\"success\" ) with probability A1 /(Al + A2 ), and from the second process (\"failure\" ) with probability A2/(Al + A2). Consider the situation after n + m - 1 arrivals. The number of arrivals from the first process is at least n if and only if the number of arrivals from the second process is less than m, which happens if and only if the nth success occurs before the mth failure. Thus, the event {Xl (n) < X2(m)} is the same as the event of having at least n successes in the first n + m 1 trials. Therefore, using the binomial PMF for the number of successes in a given number of trials, we have Problem 22.* Sum of a random number of independent Bernoulli random variables. Let N, X I, X2 .... be independent random variables, where N takes non­ negative integer values, and Xl , X 2, •. , are Bernoulli with parameter p. Let Y = Xl + ... + XN for positive values of N and let Y = 0 when N = O. (a) Show that if N is binomial with parameters m and q, then Y is binomial with parameters m and pq. (b) Show that if N is Poisson with parameter A, then Y is Poisson with parameter Ap. Solution. (a) Consider splitting the Bernoulli process Xl , X2 , ... by keeping successes with probability q and discarding them with probability 1 - q. Then Y represents the number of successes in the split process during the first m trials. Since the split process is Bernoulli with parameter pq, it follows that Y is binomial with parameters m and pq. (b) Consider splitting a Poisson process with parameter A by keeping arrivals with probability q and discarding them with probability 1 q. Then Y represents the number of arrivals in the split process during a unit interval. Since the split process is Poisson with parameter AP, it follows that Y is Poisson with parameter Ap. Problem 23. * Sum of a geometric number of independent exponential ran­ dom variables. Let Y = X I + ... + X N, where the random variables Xi are exponen­ tial with parameter A, and N is geometric with parameter p. Assume that the random variables N, Xl , X2 ,.\" are independent. Show, without using transforms, that Y is exponential with parameter Ap. Hint: Interpret the various random variables in terms of a split Poisson process. Solution. We derived this result in Chapter 4, using transforms, but we develop a more intuitive derivation here. We interpret the random variables X. and N as follows. We view the times Xl , Xl + X2 , etc. as the arrival times in a Poisson process with parameter A. Each arrival is rejected with probability 1 p and is accepted with probability p. We interpret N as the number of arrivals until the first acceptance. The process of accepted arrivals is obtained by splitting a Poisson process and is therefore itself Poisson with parameter Ap. Note that Y = Xl + ... + XN is the time of the first accepted arrival and is therefore exponential with parameter Ap. Problem 24.* The number of Poisson arrivals during an exponentially dis­ tributed interval. Consider a Poisson process with parameter A, and an independent 336 The Bernoulli and Poisson Processes Chap. 6 random variable T, which is exponential with parameter 1/ . Find the PMF of the number of Poisson arrivals during the time interval [0, T] . Solution. Let us view T as the first arrival time in a new, independent, Poisson process with parameter 1/ , and merge this process with the original Poisson process. Each arrival in the merged process comes from the original Poisson process with probability )../().. + 1/) , independent of other arrivals. If we view each arrival in the merged process as a trial, and an arrival from the new process as a success, we note that the number K of trials/ arrivals until the first success has a geometric PMF, of the form ( 1/ ) ( ).. ) k- l pK (k) = ).. + 1/ ).. + 1/ ' k = 1, 2, ... . Now the number L of arrivals from the original Poisson process until the first \"success\" is equal to K - 1 and its PMF is pdl) = PK (l + 1 ) = ( ).. : 1/) ( ).. � I/Y ' 1 = 0, 1, ... . Problem 25. * An infinite server queue. We consider a queueing system with an infinite number of servers, in which customers arrive according to a Poisson process with rate )... The ith customer stays in the system for a random amount of time, denoted by Xl ' We assume that the random variables Xi are independent identically distributed, and also independent from the arrival process. We also assume, for simplicity, that the Xi take integer values in the range 1,2 , ... ,n, with given probabilities. Find the PMF of Nt , the number of customers in the system at time t. Solution. Let us refer to those customers i whose service time Xi is equal to k as \"type-k\" customers. We view the overall arrival process as the merging of n Poisson subprocesses; the kth subprocess corresponds to arrivals of type-k customers, is inde­ pendent of the other arrival subprocesses, and has rate )..Pk, where Pk = P (Xi = k). Let Ntk be the number of type-k customers in the system at time t. Thus, and the random variables Ntk are independent. We now determine the PMF of Ntk . A type-k customer is in the system at time t if and only if that customer arrived between times t - k and t. Thus, Ntk has a Poisson PMF with mean )\"kpk . Since the sum of independent Poisson random variables is Poisson, it follows that Nt has a Poisson PMF with parameter n E[Ntl = ).. L kPk = )\"E[Xd· k=l Problem 26. * Independence of Poisson processes obtained by splitting. Consider a Poisson process whose arrivals are split, with each arrival assigned to one of two subprocesses by tossing an independent coin with success probability p. In Problems 337 Example 6. 13, it was established that each of the subprocesses is a Poisson process. Show that the two subprocesses are independent. Solution. Let us start with two independent Poisson processes PI and P2 , with rates p>. and ( 1 - p)>., respectiyely. We merge the two processes and obtain a Poisson process P with rate >.. We now split the process P into two new subprocesses P� and P� , according to the following rule: an arrival is assigned to subprocess P� (respectively. P� ) if and only if that arrival corresponds to an arrival from subprocess PI (respectively, P2 ). Clearly, the two new subprocesses P� and P� are independent, since they are identical to the original subprocesses PI and P2 . However, P� and P� were generated by a splitting mechanism that looks different than the one in the problem statement. We will now verify that the new splitting mechanism considered here is statistically identical to the one in the problem statement. It will then follow that the subprocesses constructed in the problem statement have the same statistical properties as P� and P� , and are also independent. So, let us consider the above described splitting mechanism. Given that P had an arrival at time t, this was due to either an arrival in PI (with probability p) . or to an arrival in P2 (probability 1 - p). Therefore, the arrival to P is assigned to P� or P� with probabilities p and 1 - p, respectively, exactly as in the splitting procedure described in the problem statement. Consider now the kth arrival in P and let Lk be the event that this arrival originated from subprocess PI ; this is the same as the event that the kth arrival is assigned to subprocess P� . As explained in the context of Example 6. 14, the events Lk are independent. Thus, the assignments of arrivals to the subprocesses P� and P� are independent for different arrivals, which is the other requirement of the splitting mechanism described in the problem statement. Problem 27. * Random incidence in an Erlang arrival process. Consider an arrival process in which the interarrival times are independent Erlang random variables of order 2, with mean 2/>.. Assume that the arrival process has been ongoing for a very long time. An external observer arrives at a given time t. Find the PDF of the length of the interarrival interval that contains t. Solution. We view the Erlang arrival process in the problem statement as part of a Poisson process with rate >.. In particular, the Erlang arrival process registers an arrival once every two arrivals of the Poisson process. For concreteness, let us say that the Erlang process arrivals correspond to even-numbered arrivals in the Poisson process. Let Yk be the time of the kth arrival in the Poisson process. Let K be such that Y K $ t < Y K + 1 . By the discussion of random incidence in Poisson processes in the text, we have that YK+I - YK is Erlang of order 2. The interarrival interval for the Erlang process considered in this problem is of the form [YK, YK+2] or [YK- I, YK+d, depending on whether K is even or odd, respectively. In the first case, the interarrival interval in the Erlang process is of the form (YK+I - YK ) + (YK+2 - YK+d. We claim that YK +2 - YK+I is exponential with parameter >. and independent of YK+I - YK . Indeed, an observer who arrives at time t and notices that K is even, must first wait until the time YK +1 of the next Poisson arrival. At that time, the Poisson process starts afresh, and the time YK +2 - YK+I until the next Poisson arrival is independent of the past (hence, independent of YK+I - YK ) and has an exponential distribution with parameter >., as claimed. This establishes that, conditioned on K being even, the interarrival interval length YK+2 - YK of the Erlang process is Erlang of order 3 (since it is the sum of an exponential random variable 338 The Bernoulli and Poisson Processes Chap. 6 and a random variable which is Erlang of order 2). By a symmetrical argument, if we condition on K being odd, the conditional PDF of the interarrival interval length YK+1 - YK -1 of the Erlang process is again the same. Since the conditional PDF of the length of the interarrival interval that contains t is Erlang of order 3, for every conditioning event, it follows that the unconditional PDF is also Erlang of order 3. 7 Markov Chains Contents 7. 1. Discrete-Time Markov Chains 7.2. Classification of States . . . . 7.3. Steady-State Behavior . . . . 7.4. Absorption Probabilities and Expected Time to Absorption 7.5. Continuous-Time Markov Chains 7.6. Summary and Discussion Problems .......... . · p. 340 · p. 346 · p. 352 · p. 362 · p. 369 · p. 378 · p. 380 339 340 Markov Chains Chap. 7 The Bernoulli and Poisson processes studied in the preceding chapter are memo­ ryless, in the sense that the future does not depend on the past : the occurrences of new �:successes\" or ':arrivals\" do not depend on the past history of the process. In this chapter, we consider processes where the future depends on and can be predicted to some extent by what has happened in the past. We emphasize models where the effect of the past on the future is sum­ marized by a state. which changes over time according to given probabilities. We restrict ourselves to models in which the state can only take a finite number values and can change according to probabilities that do not depend on the time of the change. We want to analyze the probabilistic properties of the sequence of state values. The range of applications of the type of models described in this chapter is truly vast. It includes just about any dynamical system whose evolution over time involves uncertainty, provided the state of the system is suitably defined. Such systems arise in a broad variety of fields, such as. for example. commu­ nications. automatic control, signal processing. manufacturing, economics. and operations research. 7. 1 DISCRETE-TIME MARKOV CHAINS We will first consider discrete-time Markov chains, in which the state changes at certain discrete time instants, indexed by an integer variable n. At each time step n, the state of the chain is denoted by Xn . and belongs to a finite set S of possible states, called the state space. Without loss of generality, and unless there is a statement to the contrary. we will assume that S = {I, . . . . m} , for some positive integer m. The Markov chain is described in terms of its transition probabilities Pij : whenever the state happens to be i, there is probability Pij that the next state is equal to j. :Mathematically. Pij = P(Xn+l = j I Xn = i). i. j E S. The key assumption underlying Markov chains is that the transition probabilities Pij apply whenever state i is visited, no matter what happened in the past, and no matter how state i was reached. J\\lathematically, we assume the Markov property, which requires that P(Xn+l = j I Xn = i. Xn-1 = in-I ..... Xo = io ) = P(Xn+ l = j I Xn = i) = Pi) . for all times n, all states i. j E S. and all possible sequences io . .. . , in- 1 of earlier states. Thus. the probability law of the next state Xn+1 depends on the past only through the value of the present state Xn . The transition probabilities Pij must be of course nonnegative, and sum to one: m L Pij = 1 , for all i. j =l Sec. 7. 1 Discrete-Time Markov Chains 341 We will generally allow the probabilities Pii to be positive, in which case it is possible for the next state to be the same as the current one. Even though the state does not change, we still view this as a state transition of a special type (a \"self-transition\" ) . Specification of Markov Models • A Markov chain model is specified by identifying: (a) the set of states S = {I, . . . , m}, (b) the set of possible transitions, namely, those pairs (i, j) for which Pij > 0, and, (c) the numerical values of those Pij that are positive. • The Markov chain specified by this model is a sequence of random variables XO,X1,X2, . .. , that take values in S, and which satisfy P(Xn+1 = j I Xn = i, Xn-l = in-I , .. . , Xo = io) = Pij , for all times n, all states i, j E S, and all possible sequences io, .. . , in- l of earlier states. All of the elements of a Markov chain model can be encoded in a transition probability matrix, which is simply a two-dimensional array whose element at the ith row and jth column is Pij : Pl l Pl2 Plm P21 P22 P2m Pml pm2 Pmm It is also helpful to lay out the model in the so-called transition probability graph, whose nodes are the states and whose arcs are the possible transitions. By recording the numerical values of Pij near the corresponding arcs, one can visualize the entire model in a way that can make some of its major properties readily apparent. Example 7. 1. Alice is taking a probability class and in each week, she can be either up-to-date or she may have fallen behind. If she is up-to-date in a given week, the probability that she will be up-to-date (or behind) in the next week is 0.8 (or 0.2, respectively). If she is behind in the given week, the probability that she will be up-to-date (or behind) in the next week is 0.6 (or 0.4, respectively). We assume that these probabilities do not depend on whether she was up-to-date or behind in previous weeks, so the problem has the typical Markov chain character (the future depends on the past only through the present). Pi l = 0.8. P12 = probability is P21 = [�:� 0.4] ' grap h is shown in 7. 1. 7. 1: The transition 7 P22 = 0.4, in .L.IA,CU UI.Il'l:' 7. 1. 7.2. A fly moves along a line in unit increments. At time period , it moves one unit to the left with probabiHty 0.3, one unit to the right with probability 0.3, and stays in place with probabiHty independent the movements. spiders are at positions 1 and m: if it is captured by a and the ....... r� ..... ....,..�.:- terminates. We want to construct a Markov chain model , assuming that the fly starts in a position between 1 m . us states 1, 2 , .. . , m, with positions of the fly. The nonzero transi tion probabilities are { 0.31 Pi] ::::::: 0.4, Pu ::::::: 1, pm m ::::::: I, if j = i- lor j = i + 1 , if j = i, for i ::::::: 2, .. . ,m - 1. matrix are in 1 1 7.2: The transi tion probability and the transi tion JL..J .... ,\"\" .up ..... 7.2, for the case where m = 4. ma- 7. 1 State 1: with 2: Machine is ...,.\". ..... 1\"\" . ..... is in two states: [ 1- b b ] . r 1 - r 1 b ..... ....... \" ....... 7 . 3 : 1tansition b T broken 1 'r for JL.J .... ' ........ fJ . .... 7.3 . i 1,2 ,,, e. b 1 - 7.4: Transition probabi lity graph for the second part of Exam ple 7.3. A machine that has remained broken for e = 4 days is replaced by a new , working machine. models. In = io , Xl = il , ... I To verify this property, note that P( Xo = io , =i l} ... � Xn == ) == io, · .. I Xn- 1 == in -l , ... � 1 == in- l ) , we have apply 7 same argument to the term P( Xo == -1) and continue similarly, we eventually the state Xo is p (X 1 == i 1 , ...• X n == I X 0 == io) == Graphically, a state sequence can be identified with a sequence of arcs in the transition probability and the such a the IS by of arcs traversed by the We 7.4. For I we P (Xo = 2� Xl = 2. = 2, = 3, X4 = = to a of is no conditioning on a fixed initial state. we need to specify a probability law for the initial state Xo . Sec. 7. 1 Discrete-Time Markov Chains 345 n-Step Transition Probabilities Many Markov chain problems require the calculation of the probability law of the state at some future time, conditioned on the current state. This probability law is captured by the n-step transition probabilities, defined by Tij (n) = P(Xn j I Xo = i). In words, Tij (n) is the probability that the state after n time periods will be j, given that the current state is i. It can be calculated using the following basic recursion, known as the Chapman-Kolmogorov equation. Chapman-Kolmogorov Equation for the n-Step Transition Probabilities The n-step transition probabilities can be generated. by the recursive formula m Tij (n) = L Tik (n - I)Pkj , k=l starting with for n > 1 , and all i, j, To verify the formula, we apply the total probability theorem as follows: m. P (Xn = j I Xo = i) = L P(Xn- l = k I Xo = i) P(Xn = j I Xn -1 = k, Xo = i) k=l m. = L Tik (n - I)Pkj ; k= l see Fig. 7.5 for an illustration. We have used here the Markov property: once we condition on Xn- l = k, the conditioning on Xo = i does not affect the probability Pkj of reaching j at the next step. We can view Tij (n) as the element at the ith row and jth column of a two­ dimensional array, called the n-step transition probability matrix. t Fig­ ures 7.6 and 7.7 give the n-step transition probabilities Tij (n) for the cases of t Those readers familiar with matrix multiplication, may recognize that the Chapman-Kolmogorov equation can be expressed as follows: the matrix of n-step tran­ sition probabilities TtJ (n) is obtained by multiplying the matrix of (n - I)-step tran­ sition probabilities Ti k(n - 1), with the one-step transition probability matrix. Thus, the n-step transition probability matrix is the nth power of the transition probability matrix. o 1 7.5: Deriva.t ion of the \"'VU C&l-'lUClIolll- \\.()l m,oj:(Q1rOv at state j at time n is the sum of the Chap. 7 probability T, k(n - l)Pkj of the different ways of j. on ity of being rij (n) 7.6, we see this limit does not depend Furt hermore , the probability initial state i n is \"' ...... ......,. .. , but over time this r-. L>Y\",-L> T1 (but by no means all) a 7.7, we see a qualitatively different behavior: (n) on the initial can zero for states. Here, we that are \"absorbing,\" sense that they are infini tely once are states 1 4 to capture of the fly by one of the two spiders. Given enough time: it is certain that some absorbing state will Accordi ngly: probability of being at the 2 a we start to that These examples CLASSIFICATION STATES are this is the subj ect of the states particular 1 some some B 7.6: n-step transi tion probabi lities for the \"up-to-date/behind\" Exam- ple 7 . 1. Observe that as n (n) converges to a limit that does not depend on the in itial state i. once , are not be the case . which this occurs. to be visited again, while In this section, we focus on the we wish to cl assify of a Markov chain with a focus on the freq uency with which are As a .. ...., .. ... ...... Jiiio. a us that a state j is ......... \"J ..... o.J ,\"\" .. from a state i if for some the n-step transition probability Tij (n) , if is positive probability of j , starting from i, after some ...... u.�, ...... v, ..... J.. of time periods. An definition is that is a possi ble 1-, 11 1 . . . , h j, starts at i more (i, id , (il , , in-l ) , (in- l , j) Let A( i) be the set of are accessible from i. We 'II .... ... ·AI:3! V, 'II\" if for j that is from i, i is also UAJ, ... ..., .... ' ... .. all j belong to A(i) we i to A(j) . i, we can only visit states j E i and, given enough ir a an infinite number times. version of argument . ) is it is to end-of-chapter problems for a is if it is not recurrent . Thus, a state i is transient :L ;3 <\\ 1 o n 7.7: shows n-step transi tion probabilities 7.2. These are the of reach- from state i. We observe th at probab ilit ies converge to a limit, hut the limit on the state . In this note th at the Ti 2 (n) and Tz3 (n) of 2 or 3\\ go to zero ! as n increases . if is a state j E AU) that i is from j. 7 state i. there is positive that the state enters such a j. Given enough this win happen, and i cannot be after that . Thus , a transient state will only be visited a finite number see the u,.l.I,O �'-·\"�'-·\"'\" or recu rrence is arcs of tran- [those pairs (i, which Pij > 0] and not the 7 .8 provides an example of a transition prob- a recurrent state, the set are � form a (or simply that states in A( i) are all from no state A(i) is from them . lvlathematically, for a recurrent state i, we have A( i) = A(j) for all j that belong to A( i) ! as can seen from recurrence . In of 7.8, states 3 a class, and state 1 itself also forms a I t can be seen at one recurrent state must be ac(;e:S:Sl from 7. 2 of gIven 7.8: Classification of states given the transition probabi lity Start- from st ate I, the access i b le state is itse lf. and so 1 is a recu rrent state. St ates 1. 3, and 4 are access ible from 2. but 2 is not access ihle from an:v' of t hem , so state 2 is transient . States 3 and 4 are accessible from each other . and are both recurrent . probleIn . It follow::; that must exist at one recurrent at one elM!:). the fonowing conclusion. • A Markov can be decomposed into one or more recurrent classes, • • • possibly some states. recurrent state is '-\"\"'-\" J,-,,,-,,\"\" A is not tlc(..:e:::;::::;l states possibly state. recurrent states are \"'£'1-'''''0I:'&:'' 7 . 9 >\"'r,rHTlI £ll �,Iarkov 1S from a provides a powerful concept ual tool for reasoning about I\\.farkov chains of Hnmber of times: For the purpose of behavior of it is iIn- to analyze chains that consist of a recurrent class. For the it is to particular class of recurre nt states is entered given transient state. These two issues. and focus of Sections ... • . ..... . . .... 0 1.9 : .v llI'rn .... >lJPG of l\\·farkov chain ........ ,_\"' .. . ,.., .. # ... , .. ', ......... into recurrent classes and transient states. if 1- > IS 1 . is if k = 1. .... d if k = 1. 7 7. 2 Figure 7. 10: Structure of a periodic recurrent class . In this example . d = 3. Thus. in a periodic recurrent in order, d recurrent we nlove through the sequence in the same subset . As an example, 7 . 9 1 2) is the same is true of the class '\"-''U' ....... l.i.1J third chain of Fig. All ot her reason is that from i. n. The a way to verify aperiodicity of a recurrent whether there a special n � 1 and a special i E R from which all states in R can (n ) > 0 for an jE an consider the first chain in from state II every state is possible at time n = 3, SO uniq ue rec urrent of that is A converse '-' .... ...... .,v ........ .... · ... ... a rec urrent for 'l • (or to S 1 if k = d) . R. turns out to be true: if n such Tij (n) > 0 be grouped in d from to 1 • The class is a ,...,. .cJ. .... . ' '''' ...... if and only if a n that 352 Markov Chains Chap. 7 7.3 STEADY-STATE BEHAVIOR In Markov chain models, we are often interested in long-term state occupancy behavior, that is, in the n-step transition probabilities Tij (n) when n is very large. We have seen in the example of Fig. 7.6 that the Tij (n) may converge to steady-state values that are independent of the initial state. We wish to understand the extent to which this behavior is typical. If there are two or more classes of recurrent states, it is clear that the limiting values of the Tij (n) must depend on the initial state (the possibility of visiting j far into the future depends on whether j is in the same class as the initial state i). We will, therefore, restrict attention to chains involving a single recurrent class, plus possibly some transient states. This is not as restrictive as it may seem, since we know that once the state enters a particular recurrent class, it will stay within that class. Thus, the asymptotic behavior of a multiclass chain can be understood in terms of the asymptotic behavior of a single-class chain. Even for chains with a single recurrent class, the Tij (n) may fail to converge. To see this, consider a recurrent class with two states, 1 and 2, such that from state 1 we can only go to 2, and from 2 we can only go to 1 (P12 = P21 = 1 ). Then, starting at some state, we will be in that same state after any even number of transitions, and in the other state after any odd number of transitions. Formally, Tii (n) = { 1 , 0, n even, n odd. What is happening here is that the recurrent class is periodic, and for such a class, it can be seen that the Tij (n) generically oscillate. We now assert that for every state j, the probability Tij (n) of being at state j approaches a limiting value that is independent of the initial state i, provided we exclude the two situations discussed above (multiple recurrent classes and/or a periodic class) . This limiting value, denoted by 7r j, has the interpretation 7rj � P(Xn = j) , when n is large, and is called the steady-state probability of j. The following is an important theorem. Its proof is quite complicated and is outlined together with several other proofs in the end-of-chapter problems. Steady-State Convergence Theorem Consider a Markov chain with a single recurrent class, which is aperiodic . Then, the states j are associated with steady-state probabilities 7rj that have the following properties. Sec. 7.3 Steady-State Behavior (a) For each j, we have lim Tij(n) = 1r'j , n-oo for all i. (b) The 1r'j are the unique solution to the system of equations below: (c) We have m 1C'j = L 1r'kPkj , k=l m 1 = L1l'k. k=l j = 1, ... ,m, 1l'j = 0, 1r'j > 0, for all transient states j, for all recurrent states j. 353 The steady-state probabilities 1l'j sum to 1 and form a probability distri­ bution on the state space, called the stationary distribution of the chain. The reason for the qualification \"stationary\" is that if the initial state is chosen according to this distribution, i.e.! if P(Xo = j) 1l'j . j = 1, . .. ,m , then, using the total probability theorem, we have m m P(XI = j) L P(Xo = k)Pkj = L 1l'kPkj = 1l'j, k=l k=l where the last equality follows from part (b) of the steady-state convergence theorem. Similarly, we obtain P(Xn j) = 1l'j, for all n and j. Thus, if the initial state is chosen according to the stationary distribution, the state at any future time will have the same distribution. The equations m 1l'j L 1l'kPkj , j = 1, ... , m, k= l are called the balance equations. They are a simple consequence of part (a) of the theorem and the Chapman-Kolmogorov equation. Indeed, once the con­ vergence of Tij (n) to some 1l' j is taken for granted, we can consider the equation, m Tij (n) = L Tik(n - I)Pkj , k=l 354 Markov Chains Chap. 7 take the limit of both sides as n --+ 00, and recover the balance equations. t Together with the normalization equation m L 7rk = 1, k=l the balance equations can be solved to obtain the 7rj . The following examples illustrate the solution process. Example 7.5. Consider a two-state Markov chain with transition probabilities PI I = 0.8, P2 1 = 0.6, PI2 = 0.2, P22 = 0.4. (This is the same as the chain of Example 7. 1 and Fig. 7.1.) The balance equations take the form 7r2 = 7rl P12 + 7r2P22 , or 7rl = 0.8 . 7rl + 0.6 . 7r2, 7r2 = 0.2 . 7rl + 0.4 ·7r2 . Note that the above two equations are dependent, since they are both equivalent to This is a generic property, and in fact it can be shown that any one of the balance equations can always be derived from the remaining equations. However, we also know that the 7rj satisfy the normalization equation 7rl + 7r2 = 1, which supplements the balance equations and suffices to determine the 7rj uniquely. Indeed, by substituting the equation 7rl = 37r2 into the equation 7rl + 7r2 = 1, we obtain 37r2 + 7r2 = 1, or 7r2 = 0.25, which using the equation 7rt + 7r2 = 1, yields 7rl = 0.75. This is consistent with what we found earlier by iterating the Chapman-Kolmogorov equation (cf. Fig. 7.6). t According to a famous and important theorem from linear algebra (called the Perron-Frob en ius theorem), the balance equations always have a nonnegative solution, for any Markov chain. What is special about a chain that has a single recurrent class, which is aperiodic, is that given also the normalization equation, the solution is unique and is equal to the limit of the n-step transition probabilities Tij (n) . so 1. 11: Transition 1f) = (1 1 355 wet ..... \"., .. .......... states: 1, 2. for r:..x;a..mple 7.6. �UllI1.1F. 0 < p < 1) ..... ..... . 'A ...... U are + p1r2 , 1f2 = 1fo + ptrl . 1 1fo 1ft = --, 3 - p 7r2 = --. 3- p I1 J1' ,j DonI' 3 Door .J 7,,12: Transition in J:\"x.a.mple for the case of m = 5 doors . that 0 < p < 11 it is not in itial every state j can be reached in to see that an and therefore the on some m states : i, i = 1, . . . ,m . o I - p o p 1fl = (1 - p 0 0 o p 0 1 p O p o o 0 7T1 = p1f'i -l + (1 7T Tn. = + p1f'Tn. 1. is o o o I - p 1- o o o 1,= ..• , m -1 , once we r.h .... oy·' .. n 7. 7 case Sec. 7.3 Steady-State Behavior 357 should have the same steady-state probability. This suggests the solution j = 1, ... ,m . Indeed, we see that these 'Trj satisfy the balance equations as well as the normal­ ization equation, so they must be the desired steady-state probabilities (by the uniqueness part of the steady-state convergence theorem). Note that if either p = 0 or p = 1 , the chain still has a single recurrent class but is periodic. In this case, the n-step transition probabilities Tij (n) do not converge to a limit, because the doors are used in a cyclic order. Similarly, if m is even, the recurrent class of the chain is periodic, since the states can be grouped into two subsets, the even and the odd numbered states, such that from each subset one can only go to the other subset. Long-Term Frequency Interpretations Probabilities are often interpreted as relative frequencies in an infinitely long string of independent trials. The steady-state probabilities of a Markov chain admit a similar interpretation, despite the absence of independence. Consider, for example, a Markov chain involving a machine, which at the end of any day can be in one of two states, working or broken down. Each time it breaks down, it is immediately repaired at a cost of $1 . How are we to model the long-term expected cost of repair per day? One possibility is to view it as the expected value of the repair cost on a randomly chosen day far into the future; this is just the steady-state probability of the broken down state. Alternatively, we can calculate the total expected repair cost in n days, where n is very large, and divide it by n. Intuition suggests that these two methods of calculation should give the same result. Theory supports this intuition, and in general we have the following interpretation of steady-state probabilities (a justification is given in the end-of-chapter problems) . Steady-State Probabilities as Expected State Frequencies For a Markov chain with a single class which is aperiodic, the steady-state probabilities 7r j satisfy 1. Vij(n) 7rj = 1m , n--+oo n where Vij (n) is the expected value of the number of visits to state j within the first n transitions, starting from state i. Based on this interpretation, trj is the long-term expected fraction of time that the state is equal to j. Each time that state j is visited, there is probability Pjk that the next transition takes us to state k. We conclude that 7rjpjk can be from j as the long-term o ..... 'lt'\"Ioo ..... ,.\"\",rII fraction of transitions Chap. 7 move the Expected of a Particu1ar Transition lim -=------...;.. - n-oo n with a single class which is '-\" \"--\" \"'-'­ (n) k. the frequency interpretation of 7r j ...... ...... £01 .......... ..., ....... equation m k= l has an intuitive meaning. It expresses the fact that the expected frequency 7fj of to j sum the 1rkPkj of OC:: ,\",O�,\",JU'U of the balance in terms of In a very nu mber of transitions , we expect a fraction 1Tk Pkj that bring the state from k to j. (This also to transitions from j to which occur with .) The sum of the expected of such transitions is the of at state j. t In fact , some stronger statements are also true, such as the fol lowing. Whenever we carry out a probabilistic exp eri ment and a trajectory of the Markov chai n state j is the observed long-term transitions Even though the trajectory is random, 1. which a intro- duces some generic notation for the transition probabil ities. In particular, l = i+ll l= i- ll ., ., . (\"birth\" probabil ity at ( probability at 7.14: Transition probability graph for a birth-death process. i ) , i) . 'i. to i 1 can occur . Therefore , the from i to the expected frequency of transitions to i 1, is 1ri bi , i + 1 to i, which is 1 , i == 0, 1, . . . ,m - 1. Using the local ba] ance eq uations, we 1 from which , using probabilities tri are the normalization computed . t A more formal that i == 1, .. . , m. not on the ..... ................... 0 as follows. The balance .... ..... \"A'U'.U at state 0 is 7To ( 1 - bo ) + 7TI d1 = 11\"0 , which = 7T} is 11\"obo + 11\"1 (1 - - d J) + = 11\"1 . the local balance equation 11\"o bo == 11\"1 d1 at the previous this is rewritten as + 7Tl (1 - bi - ) + == 7Tl , which sim pli fies to 7TIbl == We can then U. a.. l' lUJ.� at states. 7 1 - b. 1\\ 2\\ ... ,m , b ut if 0 (or m + 1), is instantly reftected back to p osi tion 1 (or posi tion m, respectively) . Equivalently, we may assume that when the person is in will stay in that position 1 - b b, a chain model whose states are the positions I! ... ! m. The t ransition probability of the chain is given in 7. 15. l -b l-h 7. 15: Transition probability for the random walk ....... .1\\. ,\"\" ........ '\" 7.8. The local balance equat ions are 1ri +l = p1r\" we can express using the leads to i = l . . . . ,m - l. b p = I- b' \"ITj in terms 11\"1 � as i- I 1fi = P 1rl · i = 1 . .. . . m. .... 00., ........ I = 11\"1 + ... + 11\" TTI. ' we ( m-l ) 1 = 11'1 1 + P + ... + P 11\"1 = --------------- if P = 1 are equally likely) , at a a \"IT, = 1 'l. in a buffer then transmitted . The storage capacity of if m packets are al ready present, new ly at most one event can ih \",\" y.,.n \", ..... in the node (an arrival of a new 1Ju,.i\".n .... \" we assume following occurs: ( a) one new p8,JCKt�L (b) one o ot herwise; ( c) no new no happens with probability 1 - b - d if and with probability 1 - b ot herwise. at one a b > 0; We introduce a rvlarkov with states 0, 1. .. . ,m , correspondi ng to the of in the buffer. The graph is in 1- fJ -(/ 1- II d 7.16: Transition in The local balance equations are i = 0, 1, ... ,TIn - 1. b p = ;1' and obtain 11\"i + 1 = P11\"i , w hi ch leads to i = O, I, .. . ! m. l-d d 7.9. Ug,\"�VAA 1 = 7ro + 7rl + ' .. + 1i\"m , we '-JLJ \"UI. ... and 7ro = { 1 � - . m + I' Using the equation 1T'i = pl 7rO , the if P t- 1, if p t- 1, if p = 1. probabilities are i = 0, 1, ... : m. 362 Markov Chajns Chap. 7 It is interesting to consider what happens when the buffer size m is so large that it can be considered as practically infinite. We distinguish two cases. (a) Suppose that b < d, or p < 1. In this case, arrivals of new packets are less likely than departures of existing packets. This prevents the number of packets in the buffer from growing, and the steady-state probabilities 1i'i decrease with i, as in a (truncated) geometric PMF. We observe that as m -t 00, we have 1 - pm+ l -t 1, and for all i. We can view these as the steady-state probabilities in a system with an infinite buffer. [As a check, note that we have 2::'0 pi (l - p) = 1.] (b) Suppose that b > d, or p > 1. In this case, arrivals of new packets are more likely than departures of existing packets. The number of packets in the buffer tends to increase, and the steady-state probabilities 1i'i increase with i. As we consider larger and larger buffer sizes m, the steady-state probability of any fixed state i decreases to zero: for all i. Were we to consider a system with an infinite buffer, we would have a Markov chain with a countably infinite number of states. Although we do not have the machinery to study such chains, the preceding calculation suggests that every state will have zero steady-state probability and will be \"transient.\" The number of packets in queue will generally grow to infinity, and any particular state will be visited only a finite number of times. The preceding analysis provides a glimpse into the character of Markov chains with an infinite number of states. In such chains, even if there is a single and aperiodic recurrent class, the chain may never reach steady-state and a steady­ state distribution may not exist. 7.4 ABSORPTION PROBABILITIES AND EXPECTED TIME TO ABSORPTION In this section, we study the short-term behavior of Markov chains. We first consider the case where the Markov chain starts at a transient state. We are interested in the first recurrent state to be entered, as well as in the time until this happens. When addressing such questions, the subsequent behavior of the Markov chain (after a recurrent state is encountered) is immaterial. We can therefore focus on the case where every recurrent state k is absorbing, Le. , Pkk = 1, Pkj = 0 for all j i= k. If there is a unique absorbing state k, its steady-state probability is 1 (because all other states are transient and have zero steady-state probability), and will be Sec. 7.4 Absorption Probabilities and Expected Time to Absorption 363 reached with probability 1, starting from any initial state. If there are multiple absorbing states, the probability that one of them will be eventually reached is still 1, but the identity of the absorbing state to be entered is random and the associated probabilities may depend on the starting state. In the sequel, we fix a particular absorbing state, denoted by s, and consider the absorption probability ai that s is eventually reached, starting from i: ai = P(Xn eventually becomes equal to the absorbing state s I Xo = i). Absorption probabilities can be obtained by solving a system of linear equations, as indicated below. Absorption Probability Equations Consider a Markov chain where each state is either transient or absorb­ ing, and fix a particular absorbing state s. Then, the probabilities ai of eventually reaching state s, starting from i, are the unique solution to the equations m ai = L Pij aj, j=1 for all absorbing i 1= s, for all transient i. The equations as = 1, and ai = 0, for all absorbing i 1= s, are evident from the definitions. To verify the remaining equations, we argue as follows. Let us consider a transient state i and let A be the event that state s is eventually reached. We have ai = P (A I X 0 = i) m = L P(A I Xo = i, Xl = j)P(Xl = j I Xo = i) j =l m = L P(A I XI =j)Pij j=l m = L ajPij . j=l (total probability thm. ) (Markov property) The uniqueness property of the solution to the absorption probability equations requires a separate argument, which is given in the end-of-chapter problems. The next example illustrates how we can use the preceding method to calculate the probability of entering a given recurrent class (rather than a given absorbing state). 7. 17: (a) Transition probability graph in Exam ple 7.10. (b) A new graph in wh ich states 4 and 5 have been lumped into the absorbing state 6. 7 state 6, starting from the transient states 2 + OAa3 + O. + the facts al = 0 and a6 = 1 , we \\..I v ... ....... + + 1. a3 = 0. 2a2 + 0.8. This is a system of two equations in the two un knowns a2 and a3 . which can be readily solved to yield a2 = 21 /3 1 a3 = 29/31. 1 probability P, and A $1 at round. Different rounds are ass umed Expected to Absorption independent . The gambler plays continuo usly until he either accumulates a tar- the gambler's corres pond to An states are absorbing. Thus, the problem amou nts to finding = m at each one of these two absorbing states . Of course , these absorpt ion probabilities ..... 0 .... .:..,.,.1\"1 on state i. Figure 1. 18: Transition probability grap h for the gambler's ruin problem 7. 11 ). Here m = 4. Let us set s = m in which case the absorption probability Q1 is the probability state i. sat isfy ao = 0, at = (1 - p)ai-l + pai+ l, i = l, . . . )m -l , am = 1 . These equat ions can be solved in a variety of ways. It turns out there is an elegant Then, by denoting and the equations are as from wh ich we obtai n p = i = l, . .. ,m -l . i = 0, . . . ,'m - 1, p i= l , ... ,m -l . i = l, . .. ,m - l. 366 Markov Chains Chap. 7 This, together with the equation 80 + 81 + ... + 8m-1 = am - ao = 1, implies that and (1 + P + ... + pm -I )80 = 1, 1 80 = ---------:-1 + P + . . . + pm-l Since ao = 0 and ai+l = ai + 8i , the probability ai of winning starting from a fortune i is equal to which simplifies to ai = 80 + 81 + . . . + 8i-1 = (1 + p+ ... + pi- l )80 1 + + i-I P . .. + p 1 + P + ... + pm-I ' { 1-/ 1 m ' - p at = . '/. -, m if P i= 1, if P = 1. The solution reveals that if p > 1, which corresponds to p < 1/2 and unfa­ vorable odds for the gambler, the probability of winning approaches 0 as m -+ 00, for any fixed initial fortune. This suggests that if you aim for a large profit under unfavorable odds, financial ruin is almost certain. Expected Time to Absorption We now turn our attention to the expected number of steps until a recurrent state is entered (an event that we refer to as \"absorption\" ), starting from a particular transient state. For any state i, we denote J.Li = E [number of transi tions until absorption, starting from i] = E[ min{n > 0 I Xn is recurrent} I Xo = i] . Note that if i is recurrent, then J.Li = 0 according to this definition. We can derive equations for the J.Li by using the total expectation theorem. We argue that the time to absorption starting from a transient state i is equal to 1 plus the expected time to absorption starting from the next state, which is j with probability Pij . We then obtain a system of linear equations, stated below, which is known to have a unique solution (see Problem 33 for the main idea). 7. 4 to 367 The ...,.\" ...... ...,. .. 'r ... ..... to J.Ll , •.. , J.Lm , are uniq ue solution to the equations 1 = 0, all m == 1 + for al l transient states i. 7. 12 . ample 7. 2. This corresponds to the Ivlarkov chai n shown in Fig. 7. The states to to possi ble posi tions , the absorbing states 1 and m correspond J..L2 = 1 + of - I + + I . + J..L3 = 1 + fly is 1. = .... m- I . + 112 = (1 + (1 we can second equation and solve for J13 . We obtai n J..L3 = 10/3 and by substitution agai n. J..L2 = 10/3. 1 7. 19: Transition in Example 7. 12. The to can to calculate the expected time to reach a state . starting 368 Markov Chains Chap. 7 from any other state. For simplicity, we consider a Markov chain with a single recurrent class. We focus on a special recurrent state s, and we denote by ti the mean first passage time from state i to state s, defined by ti = E [number of transitions to reach s for the first time, starting from i] = E [ min {n > 0 I X n = s} I X 0 = i] . The transitions out of state s are irrelevant to the calculation of the mean first passage times. We may thus consider a new Markov chain which is identical to the original, except that the special state s is converted into an absorbing state (by setting pss = 1, and Psj = 0 for all j f:. s) . With this transformation, all states other than s become transient. We then compute ti as the expected number of steps to absorption starting from i, using the formulas given earlier in this section. We have m ti = 1 + L Pij tj, j=1 ts = o. for all i f:. s, This system of linear equations can be solved for the unknowns ti , and has a unique solution (see the end-of-chapter problems). The above equations give the expected time to reach the special state s starting from any other state. We may also want to calculate the mean recur­ rence time of the special state s, which is defined as t; = E[number of transitions up to the first return to s, starting from s] = E [ min {n � 1 I X n = s} I Xo = s] . We can obtain t; , once we have the first passage times ti , by using the equation m t; = 1 + L PSjtj . j=1 To justify this equation, we argue that the time to return to s, starting from s, is equal to 1 plus the expected time to reach s from the next state, which is j with probability Psj . We then apply the total expectation theorem. Example 7.13. Consider the \"up-to-date\" - \"behind\" model of Example 7.1. States 1 and 2 correspond to being up-to-date and being behind, respectively, and the transition probabilities are Pu = 0.8, P21 = 0.6, P12 = 0.2, P22 = 0.4. Sec. 7.5 Continuous-Time Markov Chains 369 Let us focus on state s = 1 and calculate the mean first passage time to state 1. starting from state 2. We have tl = 0 and from which t2 = 1 + P21it + P22t2 = 1 + 0.4t2. 1 5 t2 = - = -. 0.6 3 The mean recurrence time to state 1 is given by * 5 4 tl = l+ Plltl + P12t2 = 1+ 0+0.2 · 3 = 3' Equations for Mean First Passage and Recurrence Times Consider a Markov chain with a single recurrent class, and let s be a par­ ticular recurrent state. • The mean first passage times ti to reach state s starting from i, are the unique solution to the system of equations ts = 0, m ti = 1 + L Pijtj , j=l for all i =1= s. • The mean recurrence time t; of state s is given by m t; = 1 + L Psj tj . j= 1 7.5 CONTINUOUS-TIME MARKOV CHAINS In the Markov chain models that we have con�idered so far. we have assumed that the transitions between states take unit time. In this section. we consider a related class of models that evolve in continuous time and can be used to study systems involving continuous-time arrival proce�ses. Example� are distribution centers or nodes in communication networks where some event� of interest (e.g .. arrivals of orders or of new calls) are de�cribed in terms of Poi�son proce�se�. As before, we will consider a proce�� that involves transition� from one state to the next, according to given transition probabilities, but we will model the times spent between transitions as continuous random variables. \\Ve will still assume that the number of states is finite and. in the absence of a statement to the contrary, we will let the state �pacc be the �et S = {I .. . . . m}. 370 Markov Chains Chap. 7 To describe the process, we introduce certain random variables of interest: Xn : the state right after the nth transition; Yn : the time of the nth transition: Tn : the time elapsed between the (n - l)st and the nth transition. For completeness, we denote by Xo the initial state, and we let Yo = O. We also introduce some assumptions. Continuous-Time Markov Chain Assumptions • If the current state is i, the time until the next transition is exponen­ tially distributed with a given parameter Vi , independent of the past history of the process and of the next state . • If the current state is i, the next state will be j with a given probability Pij , independent of the past history of the process and of the time until the next transition. The above assumptions are a complete description of the process and pro­ vide an unambiguous method for simulating it: given that we just entered state i, we remain at state i for a time that is exponentially distributed with parameter Vi , and then move to a next state j according to the transition probabilities Pij. As an immediate consequence. the sequence of states Xn obtained after succes­ sive transitions is a discrete-time Markov chain, with transition probabilities Pij , called the embedded Markov chain. In mathematical terms, our assumptions can be formulated as follows. Let A = {TI = tl , ... , Tn = tn, Xo = io, . . .. Xn- l = in- I , Xn = i} be an event that captures the history of the process until the nth transition. We then have P(Xn+l = j, Tn+l � t I A) = P(Xn+1 = j, Tn+l � t I Xn = i) = P(Xn+1 = j I Xn = i) P(Tn+1 � t I Xn = i) for all t � O. The expected time to the next transition is so we can interpret Vi as the average number of transitions out of state i, per unit time spent at state i. Consequently, the parameter Vi is called the transition Sec. 7. 5 Continuous-Time Markov Chains 371 rate out of state i. Since only a fraction Pij of the transitions out of state i will lead to state j, we may also view qij = ViPij as the average number of transitions from i to j, per unit time spent at i. Accordingly, we call qij the transition rate from i to j. Note that given the transition rates qij , one can obtain the transition rates Vi using the formula m Vi = L qij , j= l and the transition probabilities using the formula qij Pi} = -. Vi Note that the model allows for self-transitions, from a state back to itself, which can indeed happen if a self-transition probability Pii is nonzero. However, such self-transitions have no observable effects: because of the memorylessness of the exponential distribution, the remaining time until the next transition is the same, irrespective of whether a self-transition just occurred or not. For this reason, we can ignore self-transitions and we will henceforth assume that Pii = qii = 0, for all i. Example 7.14. A machine, once in production mode, operates continuously until an alarm signal is generated. The time up to the alarm signal is an exponential random variable with parameter 1. Subsequent to the alarm signal, the machine is tested for an exponentially distributed amount of time with parameter 5. The test results are positive, with probability 1/2, in which case the machine returns to pro­ duction mode, or negative, with probability 1/2, in which case the machine is taken for repair. The duration of the repair is exponentially distributed with parameter 3. We assume that the above mentioned random variables are all independent and also independent of the test results. Let states 1, 2, and 3, correspond to production mode, testing, and repair, respectively. The transition rates are VI = 1, V2 = 5, and V3 = 3. The transition probabilities and the transition rates are given by the following two matrices: [ 0 1 P = 1/2 0 1 0 See Fig. 7.20 for an illustration. [ 0 1 0 1 Q = 5/2 0 5/2 . 3 00 7 7.20: of the Ivlarkov chai n in 7. 14. The indicated next to each arc are the transition rates qij ' We finally 1v1arkov property VA .. ' ... U ........ IS of the state a process [the random ......................... X (t) the state of a present .. \"-\" .... 'Jl'Vu X ( T) for T > t] , is for T < t] . We now elaborate on the relation between a continuous-time Ivlarkov and a corresponding version . will to an description of a continuous-time Markov chain, to a set of equations Zn == X(n8), n==O.l , ... . (the Ivlarkov property of to describe the transition probabilities of Zn. is a probability (n + 1) 8, t a transit ion at time t, notat ion X(t) is A common convention is to let X (t) refer to the state right after the transition , so that (Yn) is same as Sec. 7.5 Continuous-Time Markov Chains 373 further probability Pij that the next state is j. Therefore, Pij = P(Zn+l = j I Zn = i) = ViPij6 + 0(6) = qij6 + 0(6), if j =1= i, where 0(6) is a term that is negligible compared to 6, as 6 gets smaller. The probability of remaining at i [i.e. , no transition occurs between times n6 and (n + 1)6] is Pii = P(Zn+l = i I Zn = i) = 1 - L Pij · j#i This gives rise to the following alternative description. t Alternative Description of a Continuous-Time Markov Chain Given the current state i of a continuous-time Markov chain, and for any j =1= i, the state 6 time units later is equal to j with probability independent of the past history of the process. Example 7. 14 (continued). Neglecting 0(8) terms, the transition probability matrix for the corresponding discrete-time Markov chain Zn is [1 - 8 58/2 38 8 1- 58 o Example 7.15. Queueing. Packets arrive at a node of a communication network according to a Poisson process with rate A. The packets are stored at a buffer with room for up to m packets, and are then transmitted one at a time. However, if a packet finds a full buffer upon arrival, it is discarded. The time required to transmit a packet is exponentially distributed with parameter JJ. The transmission times of different packets are independent and are also independent from all the interarrival times. We will model this system using a continuous-time Markov chain with state X(t) equal to the number of packets in the system at time t [if X(t) > 0, then t Our argument so far shows that a continuous-time Markov chain satisfies this alternative description. Conversely, it can be shown that if we start with this alter­ native description, the time until a transition out of state i is an exponential random variable with parameter Vi = Ej qij . Furthermore, given that such a transition has just occurred, the next state is j with probability qij / Vi = Pij . This establishes that the alternative description is equivalent to the original one. Markov Chains Chap. 7 X(t) - 1 packets are waiting in the queue and one packet is under transmission] . state by one a new packet by one an existing packet departs. To show that X(t) is indeed a Markov chain, we verify we have in the and at the same rates qij . Consider the case where the is empty, the state X (t) is equal to O. A transition out state 0 can only occur if there is a new which case state to 1. are we and (X(t + 8) = 11 (t) = 0) = At5 + {AI if j =l , qOj = 0, Consider next the case where the system is fun, i. e . \\ the state X (t) is to m. A transition out of state m will occur upon the completion of the current at state m - l. the of a transmission is exponential (and in particular, memory less), we (t + 6) = m - 1 I (t) = = p.6 + 0(6) , = { �: if j = m - 1, case X(t) is to some state i, with 0 < i < m. During next £5 time units, there is a probab i li ty .x8 + 0(8) of a new packet arrival, which will bring the state to i + 1, and a probability J..L8 + 0(8) a state to i - l. probability of an of [, is of the of 62 case with other 0(8) terms.] see ( X (t + 8) = i -I I X (t) = i) = JL8 + o(8) ! + 8) = i + 11 (t) = i) = + if j = i + 1, if j = i- I , \" .. \" 7.21 : Transition i= 1, 2 , . . . ,m -l ; in 7. 15. Sec. 7. 5 Continuous-Time Markov Chains 375 Steady-State Behavior We now turn our attention to the long-term behavior of a continuous-time Markov chain and focus on the state occupancy probabilities P(X(t) = i), in the limit as t gets large. We approach this problem by studying the steady-state probabilities of the corresponding discrete-time chain Zn . Since Zn = X(n8), it is clear that the limit 'Trj of P(Zn = j I Zo = i) , if it exists, is the same as the limit of P(X(t) = j I X(O) = i) . It therefore suffices to consider the steady-state probabilities associated with Zn . Reasoning as in the discrete-time case, we see that for the steady-state probabilities to be independent of the initial state, we need the chain Zn to have a single recurrent class, which we will henceforth assume. We also note that the Markov chain Zn is automatically aperiodic. This is because the self-transition probabilities are of the form Pii = 1- 8 Lqij + 0(8): j:j:.i which is positive when 8 is small, and because chains with nonzero self-transition probabilities are always aperiodic. or The balance equations for the chain Zn are of the form m 'Trj = L 'Trk Pkj k=l 'Trj = 'TrjPjj + L 'TrkPkj k:j:.j for all j, = 'Trj (1 - 8 L qjk + 0(8)) + L 'Trk (Qkj8 + 0(8)) . k:j:.j k:j:.j We cancel out the term 'Trj that appears on both sides of the equation, divide by 8, and take the limit as 8 decreases to zero, to obtain the balance equations We can now invoke the Steady-State Convergence Theorem for the chain Zn to obtain the following. Steady-State Convergence Theorem Consider a continuous-time Markov chain with a single recurrent class. Then, the states j are associated with steady-state probabilities 'Tr j that have the following properties. 376 Markov Chains Chap. 7 (a) For each j, we have lim p(X(t) = j I X(O) = i) = 'lrj , t-oo for all i. (b) The 'lrj are the unique solution to the system of equations below: (c) We have 'lrj = 0, 'lrj > 0, j = 1, ... ,m , for all transient states j, for all recurrent states j. To interpret the balance equations, we view 'lrj as the expected long-term fraction of time the process spends in state j. It follows that 'lrkqkj can be viewed as the expected frequency of transitions from k to j (expected number of transitions from k to j per unit time) . It is seen therefore that the balance equations express the intuitive fact that the frequency of transitions out of state j (the left-hand side term 'lrj Lk,cj qjk) is equal to the frequency of transitions into state j (the right-hand side term Lk,cj 7rkqkj). Example 7.14 (continued). The balance and normalization equations for this example are 1 = 71\"1 + 71\"2 + 71\"3 . As in the discrete-time case, one of these equations is redundant, e.g. , the third equation can be obtained from the first two. Still. there is a unique solution: 30 6 71\"1 = 41 ' 71\"2 = 41 ' Thus, for example, if we let the process run for a long time, X{t) will be at state 1 with probability 30/41, independent of the initial state. The steady-state probabilities 7I\"j are to be distinguished from the steady­ state probabilities 1fj of the embedded Markov chain Xn . Indeed, the balance and normalization equations for the embedded Markov chain are Sec. 7. 5 Continuous-Time Markov Chains yielding the solution _ 2 11\" 1 = 5 ' _ 2 11\"2 = 5 ' _ 1 11\"3 = 5' 377 To interpret the probabilities 1i' j, we can say, for example, that if we let the process run for a long time, the expected fraction of transitions that lead to state 1 is equal to 2/5. Note that even though 1i'1 = 1i'2 (that is, there are about as many transitions into state 1 as there are transitions into state 2), we have 11\"1 > 11\"2. The reason is that the process tends to spend more time during a typical visit to state 1 than during a typical visit to state 2. Hence, at a given time t, the process X(t) is more likely to be found at state 1 . This situation is typical, and the two sets of steady-state probabilities (1I\"j and 1i'j) are generically different. The main exception arises in the special case where the transition rates Vi are the same for all i; see the end-of-chapter problems. Birth-Death Processes As in the discrete-time case, the states in a birth-death process are linearly arranged and transitions can only occur to a neighboring state, or else leave the state unchanged; formally, we have qij = 0, for Ii - j I > 1. In a birth-death process, the long-term expected frequencies of transitions from i to j and of transitions from j to i must be the same, leading to the local balance equations for all i, j. The local balance equations have the same structure as in the discrete-time case, leading to closed-form formulas for the steady-state probabilities. Example 7.15 (continued). The local balance equations take the form i = 0, 1, ... , m - 1, and we obtain 1I\"i+ 1 = p7ri , where p = )../J-t. Thus, we have 1I\"i = pi 1l\"0 for all i. The normalization equation 1 = E�o 1I\"i yields m 1 = 11\"0 L/, i=O and the steady-state probabilities are pt 1I\"i = . 1 + p + '\" + pm i = 0, 1, ... , m. 378 Markov Chains Chap. 7 7.6 SUMMARY AND DISCUSSION In this chapter, we have introduced Markov chain models with a finite number of states. In a discrete-time Markov chain, transitions occur at integer times according to given transition probabilities Pij ' The crucial property that dis­ tinguishes Markov chains from general random processes is that the transition probabilities Pij apply each time that the state is equal to i, independent of the previous values of the state. Thus, given the present, the future of the process is independent of the past. Coming up with a suitable Markov chain model of a given physical situ­ ation is to some extent an art. In general, we need to introduce a rich enough set of states so that the current state summarizes whatever information from the history of the process is relevant to its future evolution. Subject to this requirement, we usually aim at a model that does not involve more states than necessary. Given a Markov chain model, there are several questions of interest. (a) Questions referring to the statistics of the process over a finite time horizon. We have seen that we can calculate the probability that the process follows a particular path by multiplying the transition probabilities along the path. The probability of a more general event can be obtained by adding the probabilities of the various paths that lead to the occurrence of the event. In some cases, we can exploit the Markov property to avoid listing each and every path that corresponds to a particular event. A prominent example is the recursive calculation of the n-step transition probabilities, using the Chapman-Kolmogorov equations. (b) Questions referring to the steady-state behavior of the Markov chain. To address such questions, we classified the states of a Markov chain as tran­ sient and recurrent. We discussed how the recurrent states can be divided into disjoint recurrent classes, so that each state in a recurrent class is ac­ cessible from every other state in the same class. We also distinguished between periodic and aperiodic recurrent classes. The central result of Markov chain theory is that if a chain consists of a single aperiodic recur­ rent class, plus possibly some transient states, the probability Tij (n) that the state is equal to some j converges, as time goes to infinity, to a steady­ state probability 7rj , which does not depend on the initial state i. In other words, the identity of the initial state has no bearing on the statistics of Xn when n is very large. The steady-state probabilities can be found by solving a system of linear equations, consisting of the balance equations and the normalization equation Ej 7rj = 1. (c) Questions referring to the transient behavior of a Markov chain. We dis­ cussed the absorption probabilities (the probability that the state eventu­ ally enters a given recurrent class, given that it starts at a given transient state) , and the mean first passage times (the expected time until a particu­ lar recurrent state is entered, assuming that the chain has a single recurrent Sec. 7. 6 Summary and Discussion 379 class) . In both cases, we showed that the quantities of interest can be found by considering the unique solution to a system of linear equations. We finally considered continuous-time Markov chains. In such models, given the current state, the next state is determined by the same mechanism as in discrete-time Markov chains. However, the time until the next transition is an exponentially distributed random variable, whose parameter depends only the current state. Continuous-time Markov chains are in many ways similar to their discrete-time counterparts. They have the same Markov property (the future is independent from the past, given the present) . In fact, we can visualize a continuous-time Markov chain in terms of a related discrete-time Markov chain obtained by a fine discretization of the time axis. Because of this correspon­ dence, the steady-state behaviors of continuous-time and discrete-time Markov chains are similar: assuming that there is a single recurrent class, the occupancy probability of any particular state converges to a steady-state probability that does not depend on the initial state. These steady-state probabilities can be found by solving a suitable set of balance and normalization equations. 380 Markov Chains Chap. 7 PROBLEMS SECTION 7.1. Discrete-Time Markov Chains Problem 1. The times between successive customer arrivals at a facility are inde­ pendent and identically distributed random variables with the following PMF: { 0.2, p(k) = 0.3, 0.5, 0, k= l, k=3, k=4, otherwise. Construct a four-state Markov chain model that describes the arrival process. In this model, one of the states should correspond to the times when an arrival occurs. Problem 2. A mouse moves along a tiled corridor with 2m tiles, where m > 1. From each tile i l' 1, 2m. it moves to either tile i - lor i + 1 with equal probability. From tile 1 or tile 2m, it moves to tile 2 or 2m - 1, respectively, with probability 1. Each time the mouse moves to a tile i $ m or i > m, an electronic device outputs a signal L or R, respectively. Can the generated sequence of signals L and R be described as a Markov chain with states L and R? Problem 3. Consider the Markov chain in Example 7.2, for the case where m = 4, as in Fig. 7.2. and assume that the process starts at any of the four states, with equal probability. Let Yn = 1 whenever the Markov chain is at state 1 or 2, and Yn = 2 whenever the Markov chain is at state 3 or 4. Is the process Yn a Markov chain? SECTION 7.2. Classification of States Problem 4. A spider and a fly move along a straight line in unit increments. The spider always moves towards the fly by one unit. The fly moves towards the spider by one unit with probability 0.3, moves away from the spider by one unit with probability 0.3, and stays in place with probability 0.4. The initial distance between the spider and the fly is integer. When the spider and the fly land in the same position, the spider captures the fly. (a) Construct a Markov chain that describes the relative location of the spider and fly. (b) Identify the transient and recurrent states. Problem 5. Consider a Markov chain with states 1, 2, ... ,9. and the following tran­ sition probabilities: P1 2 = P17 = 1/2, Pi (i + l) = 1 for i l' 1, 6,9, and P6 1 = P91 = 1. Is the recurrent class of the chain periodic or not? Problems 381 Problem 6. * Existence of a recurrent state. Show that in a Markov chain at least one recurrent state must be accessible from any given state, i.e., for any i, there is at least one recurrent j in the set A( i) of accessible states from i. Solution. Fix a state i. If i is recurrent, then every j E A(i) is also recurrent so we are done. Assume that i is transient. Then, there exists a state h E A(i) such that i rJ. A(id. If il is recurrent, then we have found a recurrent state that is accessible from i, and we are done. Suppose now that il is transient. Then, il '# i because otherwise the assumptions il E A(i) and i rJ. A(id would yield i E A(i) and i rJ. A(i). which is a contradiction. Since il is transient, there exists some i2 such that i2 E A(id and i 1 rJ. A (i2)' In particular, i2 E A (i). If i2 is recurrent, we are done. So, suppose that i2 is transient. The same argument as before shows that i2 '# il . Furthermore, we must also have i2 '# i. This is because if we had i2 i, we would have il E A(i) = A(i2), contradicting the assumption it rJ. A(i2)' Continuing this process, at the kth step, we will either obtain a recurrent state ik which is accessible from i, or else we will obtain a transient state ik which is different than all the preceding states i, ii , . . . ,ik-I. Since there is only a finite number of states, a recurrent state must ultimately be obtained. Problem 7.* Consider a Markov chain with some transient and some recurrent states. (a) Show that for some numbers c and \" with c > 0 and 0 < I < 1, we have P(Xn is transient I Xo = i) :5 C/n , for all i and n � 1. (b) Let T be the first time n at which Xn is recurrent. Show that such a time is certain to exist (Le., the probability of the event that there exists a time n at which Xn is recurrent is equal to 1) and that E[T] < 00. Solution. (a) For notational convenience, let qi(n) = P(Xn transient I Xo = i). A recurrent state that is accessible from state i can be reached in at most m steps, where m is the number of states. Therefore, qi (m) < 1. Let {3 = , max qi(m) t=I, ... ,m and note that for all i, we have qi (m) :5 {3 < 1. If a recurrent state has not been reached by time m, which happens with probability at most {3, the conditional probability that a recurrent state is not reached in the next m steps is at most {3 as well, which suggests that qi(2m) :5 {32 . Indeed, conditioning on the possible values of Xm, we obtain qi(2m) = P(X2m transient I Xo = i) L P(X2m transient I Xm = j, Xo = i) P(Xm = j I Xo = i) j transient L P(X2m transient I Xm = j) P(Xm = j I Xo = i) J transient L P(Xm transient I Xo = j) P(Xm = j I Xo = i) j transient 382 � {3 L P(Xm = j I Xo = i) j transient = {3 P(Xm transient I Xo = i) � {32. Continuing similarly, we obtain Markov Chains for all i and k � 1. Chap. 7 Let n be any positive integer, and let k be the integer such that km < n < (k + l)m. Then, we have Thus, the desired relation holds with c = {3- 1 and 'Y = {31/m . (b) Let A be the event that the state never enters the set of recurrent states. Using the result from part (a) , we have P(A) � P(Xn transient) � C\"fn . Since this is true for every n and since 'Y < 1, we must have P (A) = O. This establishes that there is certainty (probability equal to 1) that there is a finite time T that a recurrent state is first entered. We then have DC E[T] = L nP(Xn- 1 transient, Xn recurrent) n=1 00 � L nP(Xn- 1 transient) n=1 n=1 00 = _c_ � n( 1 _ 'Y)'Yn -l 1- 'Y L n=1 c where the last equality is obtained using the expression for the mean of the geometric distribution. Problem 8.* Recurrent states. Show that if a recurrent state is visited once, the probability that it will be visited again in the future is equal to 1 (and, therefore, the probability that it will be visited an infinite number of times is equal to 1). Hint: Modify the chain to make the recurrent state of interest the only recurrent state, and use the result of Problem 7(b) . Solution. Let s be a recurrent state, and suppose that s has been visited once. From then on, the only possible states are those in the same recurrence class as s. Therefore, Problems 383 without loss of generality, we can assume that there is a single recurrent class. Suppose that the current state is some i =f:. s. We want to show that s is guaranteed to be visited some time in the future. Consider a new Markov chain in which the transitions out of state s are disabled, so that pss = 1. The transitions out of states i, for i =f:. s are unaffected. Clearly, s is recurrent in the new chain. Furthermore, for any state i =f:. s, there is a positive probability path from i to s in the original chain (since s is recurrent in the original chain) , and the same holds true in the new chain. Since i is not accessible from s in the new chain, it follows that every i =f:. s in the new chain is transient. By the result of Problem 7(b) , state s will be eventually visited by the new chain (with probability 1) . But the original chain is identical to the new one until the time that s is first visited. Hence, state s is guaranteed to be eventually visited by the original chain s. By repeating this argument, we see that s is guaranteed to be visited an infinite number of times (with probability 1). Problem 9. * Periodic classes. Consider a recurrent class R. Show that exactly one of the following two alternatives must hold: (i) The states in R can be grouped in d > 1 disjoint subsets SI , ... , Sd, so that all transitions from Sk lead to Sk+l, or to SI if k = d. (In this case, R is periodic.) (ii) There exists a time n such that Tij {n) > 0 for all i, j E R. (In this case R is aperiodic. ) Hint: Fix a state i and let d be the greatest common divisor of the elements of the set Q = {n I rii {n) > o}. If d = 1, use the following fact from elementary number theory: if the positive integers 01 , 02, ... have no common divisor other than 1 , then every positive integer n outside a finite set can be expressed in the form n = kl ol + k202 + . .. + ktot for some nonnegative integers kl , ..• , kt , and some t 2: 1. Solution. Fix a state i and consider the set Q = {n I rii {n) > o}. Let d be the greatest common divisor of the elements of Q. Consider first the case where d =f:. 1. For k = 1, . .. , d, let Sk be the set of all states that are reachable from i in ld + k steps for some nonnegative integer i. Suppose that s E Sk and Pss' > O. Since s E Sk , we can reach s from i in ld + k steps for some l, which implies that we can reach s' from i in ld + k + 1 steps. This shows that s' E Sk+l if k < d, and that s' E SI if k = d. It only remains to show that the sets SI , ... , Sd are disjoint. Suppose, to derive a contradiction, that s E Sk and sESe for some k =f:. k'. Let q be the length of some positive probability path from s to i. Starting from i, we can get to s in ld + k steps, and then return to i in q steps. Hence ld + k + q belongs to Q. which implies that d divides k + q. By the same argument, d must also divide k' + q. Hence d divides k - k', which is a contradiction because 1 � Ik - k' i � d - 1 . Consider next the case where d = 1. Let Q = {01 ,02, .. '}' Since these are the possible lengths of positive probability paths that start and end at i, it follows that any integer n of the form n = kl ol + k202 + . . . + ktot is also in Q. (To see this, use kl times a path of length 0 1 , followed by using k2 times a path of length 02 , etc. ) By the number-theoretic fact given in the hint, the set Q contains all but finitely many positive integers. Let ni be such that for all n > ni . Fix some j =f:. i and let q be the length of a shortest positive probability path from i to j, so that q < m, where m is the number of states. Consider some n that satisfies 384 Markov Chains Chap. 7 n > ni + m, and note that n - q > ni + m - q > ni. Thus, we can go from i to itself in n - q steps, and then from i to j in q steps. Therefore, there is a positive probability path from i to j, of length n, so that Tij (n) > O. We have so far established that at least one of the alternatives given in the problem statement must hold. To establish that they cannot hold simultaneously, note that the first alternative implies that Tii(n) = 0 whenever n is not an integer multiple of d, which is incompatible with the second alternative. For completeness, we now provide a proof of the number-theoretic fact that was used in this problem. We start with the set of positive integers 01 ,02, . . . , and assume that they have no common divisor other than 1 . We define M as the set of all positive integers the form 2::=1 kioi, where the ki are nonnegative integers. Note that this set is closed under addition (the sum of two elements of M is of the same form and must also belong to M). Let 9 be the smallest difference between two distinct elements of M. Then, 9 � 1 and 9 � 0i for all i, since Ot and 20i both belong to Af. Suppose that 9 > 1. Since the greatest common divisor of the Oi is 1, there exists some 0i\" which is not divisible by g. We then have for some positive integer f, where the remainder T satisfies 0 < T < g. Furthermore, in view of the definition of g, there exist nonnegative integers k1, k�, ... , kt, k� such that t t L kioi = L k�Oi + g. i=l i=1 Multiplying this equation by f and using the equation 0i\" = fg + T, we obtain t L(fkdoi = L(fk�)Oi + fg = L(fk�)Oi + 0i\" - T. t=l t=l i=l This shows that there exist two numbers in the set M, whose difference is equal to T. Since 0 < T < g, this contradicts our definition of 9 as the smallest possible difference. This contradiction establishes that 9 must be equal to 1. Since 9 = 1, there exists some positive integer x such that x E M and x + 1 E Af . We will now show that every integer n larger than OIX belongs to M. Indeed, by dividing n by 01 , we obtain n = k01 + T, where k � x and where the remainder T satisfies 0 � T < 01. We rewrite n in the form n = X(OI - T) + (x + I)T + (k - X)Ol. Since X, x + 1, and 01 all belong to M, this shows that n is the sum of elements of M and must also belong to M, as desired. SECTION 7.3. Steady-State Behavior Problem 10. Consider the two models of machine failure and repair in Example 7.3. Find conditions on b and T for the chain to have a single recurrent class which is Problem 1 A professor gives tests that are hard , medium, or next test win be next test the same difficulty, and a probability for of the other two levels of difficulty. Construct an appropriate Markov chain and find the steady-state probabilities. on any way to poor on way , Now I if the is one of his n fishing for the trip, but if the weather is bad, he will not bring a fishing rod with him. We want to find the probabi lity the trip to or the (a) n + 1 states (b) is the on a \"\" ..... ..... \"'�� ' ...... ... but without a fishing rod? chain, it is already in (a) (b) (c) (d ) (e) each state i! 7.22 : Transit ion probability graph for Problem 11. probability that current state is i. we is a the process was state 2 n.orA1I\"0 that this change of state was a birth. first tran- 386 Markov Chains Chap. 7 (f) The conditional probability that the first observed transition is a birth given that it resulted in a change of state. (g) The conditional probability that the first observed transition leads to state 2, given that it resulted in a change of state. Problem 14. Consider a Markov chain with given transition probabilities and with a single recurrent class that is aperiodic. Assume that for n � 500, the n-step transition probabilities are very close to the steady-state probabilities. (a) Find an approximate formula for P(XlOOO = j, XlOOl = k, X2000 = II Xo = i). (b) Find an approximate formula for P(XlOOO = i I XlO01 = j). Problem 15. Ehrenfest model of diffusion. We have a total of n balls, some of them black, some white. At each time step, we either do nothing, which happens with probability f, where 0 < f < 1, or we select a ball at random, so that each ball has probability (1 - f) / n > 0 of being selected. In the latter case, we change the color of the selected ball (if white it becomes black, and vice versa), and the process is repeated indefinitely. What is the steady-state distribution of the number of white balls? Problem 16. Bernoulli-Laplace model of diffusion. Each of two urns contains m balls. Out of the total of the 2m balls, m are white and m are black. A ball is simultaneously selected from each urn and moved to the other urn, and the process is indefinitely repeated. What is the steady-state distribution of the number of white balls in each urn? Problem 17. Consider a Markov chain with two states denoted 1 and 2, and transition probabilities Pl l = 1 - 0:, P12 = 0:, P21 = {3, P22 = 1 - {3, where 0: and {3 are such that 0 < 0: < 1 and 0 < (3 < 1. (a) Show that the two states of the chain form a recurrent and aperiodic class. (b) Use induction to show that for all n, we have {3 0:(1 - 0: - (3)n rl l (n) = -- {3 + (3 ' 0:+ 0:+ r21 (n) = _{3 _ _ �{3( .:..- l_-_a_- � {3) � n a + {3 a + {3 0: 0:(1 - 0: - (3)n r12 (n) = -- {3 - (3 ' 0:+ 0:+ 0: (3( 1 - a - (3)n r22 (n) = -- {3 + (3 0 + 0 + (c) What are the steady-state probabilities 11\"1 and 11\"2? Problem 18. The parking garage at MIT has installed a card-operated gate, which, unfortunately, is vulnerable to absent-minded faculty and staff. In particular, in each day, a car crashes the gate with probability P, in which case a new gate must be installed. Also a gate that has survived for m days must be replaced as a matter of periodic maintenance. What is the long-term expected frequency of gate replacements? Problems 387 Problem 19.* Steady-state convergence. Consider a Markov chain with a single recurrent class, and assume that there exists a time n such that Tij (n) > 0, for all i and all recurrent j. (This is equivalent to assuming that the class is aperiodic.) We wish to show that for any i and j, the limit lim Tij (n) n-+oc exists and does not depend on i. To derive this result, we need to show that the choice of the initial state has no long-term effect. To quantify this effect, we consider two different initial states i and k, and consider two independent Markov chains, Xn and Yn , with the same transition probabilities and with Xo = i, Yo = k. Let T = min{n I Xn = Yn } be the first time that the two chains enter the same state. (a) Show that there exist positive constants c and \"y < 1 such that (b) Show that if the states of the two chains became equal by time n, their occupancy probabilities at time n are the same, that is, P(Xn = j I T � n) = P(Yn = j I T � n). (c) Show that ITij (n) - Tkj (n) 1 � C\"Yn , for all i, j, k, and n. Hint: Condition on the two events {T > n} and {T � n}. (d) Let qj (n) = maxi Tij (n) and qj (n) = mini Tij (n). Show that for all n. (e) Show that the sequence Tij (n) converges to a limit that does not depend on i. Hint: Combine the results of parts (c) and (d) to show that the two sequences qj (n) and qj (n) converge and have the same limit. Solution. (a) The argument is similar to the one used to bound the PMF of the time until a recurrent state is entered (Problem 7). Let I be some recurrent state and let {3 = mini Til (n) > O. No matter what is the current state of Xn and Yn , there is probability of at least {32 that both chains are at state l after n time steps. Thus, Similarly, and 388 This implies that P(T � n) � ern , where 'Y = (1 - (32 ) I/n, and c = 1/(1 - (32 )'n. Markov Chains Chap. 7 (b) We condition on the possible values of T and on the common state l of the two chains at time T, and use the total probability theorem. We have n m P(Xn = j 1 T � n) = � � P(Xn = j 1 T = t, Xt = l) P(T = t, Xt = I I T � n) Similarly, t=O 1=1 n m = � � P(Xn = j 1 Xt = l) P(T = t, Xt = II T � n) t=O 1=1 n m = � � rlj (n - t) P(T = t, Xt = II T � n). t=o 1=1 n m P(Yn = j 1 T � n) = �� rlj(n - t) P(T = t, Yt = I I T � n). t=o 1=1 But the events {T = t, Xt = l} and {T = t, Yt = l} are identical, and therefore have the same probability, which implies that P(Xn = j 1 T � n) = P(Yn = j 1 T � n). (c) We have rij (n) = P(Xn = j) = P(Xn = j 1 T � n) P(T � n) + P(Xn = j 1 T > n) P(T > n) and rkj (n) = P(Yn = j) = P(Yn = j 1 T � n) P(T � n) + P(Yn = j 1 T > n) P(T > n). By subtracting these two equations, using the result of part (b) to eliminate the first terms in their right-hand sides, and by taking the absolute value of both sides, we obtain Irij (n) - rkj (n)1 � Ip(Xn = j 1 T > n) P(T > n) - P(Yn = j 1 T > n) P(T > n) 1 � P(T > n) � ern . (d) By conditioning on the state after the first transition, and using the total probability theorem, we have the following variant of the Chapman-Kolmogorov equation: m rij (n + 1) = � Pikrkj (n). k=1 Problems Using this equation, we obtain m m qt (n + 1) = m�x TiJ(n + 1) = max \"\" PikTkj(n) ::::; m� \"\" Pikqt (n) = qt (n). 1 t L-t t L-t k=l k=l 389 The inequality q; (n) ::::; q; (n + 1) is established by a symmetrical argument. The inequality q; (n + 1) ::::; qt (n + 1) is a consequence of the definitions. (e) The sequences q; (n) and qt (n) converge because they are monotonic. The inequal­ ity ITij(n) - TkJ(n) 1 ::::; e,n , for all i and k, implies that qj (n) - qj (n) ::::; ern . Taking the limit as n ---+ 00, we obtain that the limits of qj (n) and qj (n) are the same. Let 1T'j denote this common limit. Since qj (n) ::::; Tij(n) ::::; qj (n) , it follows that TiJ (n) also converges to 1T'j , and the limit is independent of i. Problem 20. * Uniqueness of solutions to the balance equations. Consider a Markov chain with a single recurrent class, plus possibly some transient states. (a) Assuming that the recurrent class is aperiodic, show that the balance equations together with the normalization equation have a unique nonnegative solution. Hint: Given a solution different from the steady-state probabilities, let it be the PMF of Xo and consider what happens as time goes to infinity. (b) Show that the uniqueness result of part (a) is also true when the recurrent class is periodic. Hint: Introduce self-transitions in the Markov chain, in a manner that results in an equivalent set of balance equations, and use the result of part (a). Solution. (a) Let 1T'1 , ••• , 1T'm be the steady-state probabilities, that is, the limits of the Tij(n). These satisfy the balance and normalization equations. Suppose that there is another nonnegative solution 1rI , ... , 1rm. Let us initialize the Markov chain according to these probabilities, so that P(Xo = j) = 1rj for all j. Using the argument given in the text, we obtain P(Xn = j) = 1rJ , for all times. Thus, 1rj = lim P(Xn = j) n -oo (b) Consider a new Markov chain, whose transition probabilities Pij are given by Pii = (1 a)pii + a, Here, a is a number satisfying 0 < a < 1. The balance equations for the new Markov chain take the form 1T'j = 1T'j ( 1 - a)pii + a) + L 1T'i ( l - a)Pij , i=h 390 Markov Chains Chap. 7 or m (1 - O:)7rj = (1 - 0:) L 7riPij · i=l These equations are equivalent to the balance equations for the original chain. Notice that the new chain is aperiodic, because self-transitions have positive probability. This establishes uniqueness of solutions for the new chain, and implies the same for the original chain. Problem 21. * Expected long-term frequency interpretation. Consider a Markov chain with a single recurrent class which is aperiodic. Show that 1. Vij (n) 7rj = 1m --, n-oo n for all i, j = 1, . . . , m, where the 7rj are the steady-state probabilities, and Vij(n) is the expected value of the number of visits to state j within the first n transitions, starting from state i. Hint: Use the following fact from analysis. If a sequence an converges to a number a, the sequence bn defined by bn = (lin) 2:�= 1 ak also converges to a. Solution. We first assert that for all n, i, and j, we have n Vij(n) = L rij (k). k=l To see this, note that where h is the random variable that takes the value 1 if X k = j, and the value 0 otherwise, so that Since E [h I Xo = i] = rij (k). n Vij (n) = .!. '\"' rij(k), n n L k=l and rij (k) converges to 7rj , it follows that vij (n)ln also converges to 7rj , which is the desired result. For completeness, we also provide the proof of the fact given in the hint, and which was used in the last step of the above argument. Consider a sequence an that converges to some a, and let bn = (lin) 2:�=1 ak . Fix some f > O. Since an converges to a, there exists some no such that ak � a+ (f/2), for all k > no. Let also c = maxk ak. We then have The limit of the right-hand side, as n tends to infinity, is a + (f/2). Therefore, there exists some nl such that bn � a + f, for every n 2: nl . By a symmetrical argument, Problems 391 there exists some n2 such that bn � a - €, for every n � n2 . We have shown that for every € > 0, there exists some n3 (namely, n3 = max{nl ,n2}) such that Ibn - al ::; €, for all n � n3. This means that bn converges to a. Problem 22. * Doubly stochastic matrices. Consider a Markov chain with a single recurrent class which is aperiodic, and whose transition probability matrix is doubly stochastic, i.e., it has the property that the entries in any column (as well as in any row) add to unity, so that m L Pij = 1 , j = 1, . . . ,m. i=1 (a) Show that the transition probability matrix of the chain in Example 7.7 is doubly stochastic. (b) Show that the steady-state probabilities are j = 1, ... ,m. (c) Suppose that the recurrent class of the chain is instead periodic. Show that 11\"1 = .. . = 1I\"m = 11m is the unique solution to the balance and normalization equations. Discuss your answer in the context of Example 7.7 for the case where m is even. Solution. (a) Indeed the rows and the columns of the transition probability matrix in this example all add to 1. (b) We have m \"\"' �Pij = �. Lm m i=1 Thus, the given probabilities 1I\"j = 11m satisfy the balance equations and must therefore be the steady-state probabilities. (c) Let (11\"1 , ••• , 1I\"m) be a solution to the balance and normalization equations. Consider a particular j such that 1I\"j � 1I\"i for all i, and let q = 1I\"j . The balance equation for state j yields m m q = 1I\"j = L 1I\"iPij ::; q L Pij = q, i=1 i=1 where the last step follows because the transition probability matrix is doubly stochas­ tic. It follows that the above inequality is actually an equality and m m L 1I\"iPij = L qPij . 1=1 i= 1 Since 1I\"i ::; q for all i, we must have 1I\"iP1j = qPij for every i, Thus, 1I\"i = q for every state i from which a transition to j is possible. By repeating this argument, we see that 1I\"i = q for every state i such that there is a positive probability path from i to j. Since all states are recurrent and belong to the same class, all states i have this property, 392 7 and 1Tl is the same for all i . S ince the 1Ti add to L we obtain 1Tl = 11m for 't. m is even is \"-,.\"\"' ... ... ,, .... the we shows the balance and normalizat ion equations. Problem 23. * Consider the queueing Exam ple but assume that probabi li ties of a packet arrival and a packet transmission depend on the state of the following occurs: (i) one new this A.UIIJ ..... . ;:;. ... '\" h, > 0 for i < m. and bm = O. (ii) one d i > 0 if i � I! and are i a (iii) no new packet arrives and no \"' ....... \"\"' ... ... AJi',. n!:l,i\"IJ'''�'' I\",\"\\rn n l.o,I\"OO one a pens with probability 1 - bi - di if i � I, and with probability 1 - bi if i = Calculate Solution. We a chain states are 0, 1 , ... , m, to the number of packets currently stored at the node. The transition probability graph is gi ven in 7.23. the form Thus we 7.23: Transit ion to we 'iTj+ 1 = Pi 'iTi, where for Problem 23. i = 0. 1. . .. . m - 1. 7rj = \"' Pi - l t = l, ... ,m . By 1 = 'iTo + 'iT l + ... + 1Tm , we obtain 1 = 11\"0( 1 + Po + POP I + . . . + Po' . . d , 1 11\"0 = --------------------------- 1 + po + POPl + . . . + Po ... Pm - I Problems The remaining steady-state probabilities are Po ' . . pt -l 7T\"i = , 1 + po + POP I + ... + po . .. pm-l 393 i = 1, ... ,m . Problem 24. * Dependence of the balance equations. Show that if we add the first m - 1 balance equations 7T\"j = 2:;: 1 7T\"kPkj , for j = 1, . .. , m - 1, we obtain the last equation 7T\"m = 2:;;= 1 7T\"kPkm' Solution. By adding the first m - 1 balance equations, we obtain m-l m-l m L 7T\") = L L 7T\"kPkj j=1 j=1 k=1 m m-l = L 7T\"k L Pk) k=1 )= 1 m = L 7T\"k ( 1 - Pk m ) k=1 m-l m = 7T\"m + L 7T\"k - L 7T\"kpkm· k=1 k=1 This equation is equivalent to the last balance equation 7T\"m = 2:;;= 1 7T\"kPkm' Problem 25. * Local balance equations. We are given a Markov chain that has a single recurrent class which is aperiodic. Suppose that we have found a solution 7T\"1, •.. , 7T\" m to the following system of local balance and normalization equations: m L 7T\"i = 1 , i= 1 i, j = I, . . . ,m , i = 1, .. . ,m . (a) Show that the 7T\"J are the steady-state probabilities. (b) What is the interpretation of the equations 7T\"iPij = 7T\"jpji in terms of expected long-term frequencies of transitions between i and j? (c) Construct an example where the local balance equations are not satisfied by the steady-state probabilities. Solution. (a) By adding the local balance equations 7T\"iPij = 7T\"jpji over i, we obtain m m L 7T\"iPij = L 7T\"jpji = 7T\"j , i=1 i=1 so the 7T\"j also satisfy the balance equations. Therefore, they are equal to the steady­ state probabilities. 394 Markov Chains Chap. 7 (b) We know that 'TriPij can be interpreted as the expected long-term frequency of transitions from i to j, so the local balance equations imply that the expected long­ term frequency of any transition is equal to the expected long-term frequency of the reverse transition. (This property is also known as time reversibility of the chain.) (c) We need a minimum of three states for such an example. Let the states be 1, 2, 3, and let P12 > 0, P13 > 0, P21 > 0, P32 > 0, with all other transition probabilities being 0. The chain has a single recurrent aperiodic class. The local balance equations do not hold because the expected frequency of transitions from 1 to 3 is positive, but the expected frequency of reverse transitions is 0. Problem 26.* Sampled Markov chains. Consider a Markov chain Xn with tran­ sition probabilities Pij, and let rij (n) be the n-step transition probabilities. (a) Show that for all n � 1 and l � 1, we have m rij(n + l) L rik (n)rkj (l). k=l (b) Suppose that there is a single recurrent class, which is aperiodic. We sample the Markov chain every l transitions, thus generating a process Yn, where Yn = X/no Show that the sampled process can be modeled by a Markov chain with a single aperiodic recurrent class and transition probabilities rij (l) . (c) Show that the Markov chain of part (b) has the same steady-state probabilities as the original process. Solution. (a) We condition on Xn and use the total probability theorem. We have rij (n + l) = P(Xn+l = j I Xo = i) m = L P(Xn = k ! Xo = i) P(Xn+1 = j ! Xn = k, Xo = i) m = L P(Xn = k I Xo = i) P(Xn+1 = j I Xn = k) k=l m = L rzk (n)rkj(l), k== l where in the third equality we used the Markov property. (b) Since Xn is Markov, once we condition on X/n, the past of the process (the states Xk for k < In) becomes independent of the future (the states Xk for k > In) . This implies that given Yn, the past (the states Yk for k < n) is independent of the future (the states Yk for k > n). Thus, Yn has the Markov property. Because of our assumptions on Xn , there is a time n such that P(Xn =j!Xo = i) > 0, for every n � n, every state i, and every state j in the single recurrent class R of the process Xn . This implies that P(Yn = j I Yo = i) > 0, Problems 395 for every n � 11, every i, and every j E R. Therefore, the process Yn has a single recurrent class, which is aperiodic. (c) The n-step transition probabilities rij (n) of the process Xn converge to the steady­ state probabilities 7rj . The n-step transition probabilities of the process Yn are of the form rij (ln) , and therefore also converge to the same limits 7rj . This establishes that the 7rj are the steady-state probabilities of the process Yn . Problem 27.* Given a Markov chain Xn with a single recurrent class which is aperi­ odic, consider the Markov chain whose state at time n is (Xn- 1 , Xn ). Thus, the state in the new chain can be associated with the last transition in the original chain. (a) Show that the steady-state probabilities of the new chain are TJij = 7riPij , where the 7ri are the steady-state probabilities of the original chain. (b) Generalize part (a) to the case of the Markov chain (Xn-k , Xn- k+ l, ... ,Xn), whose state can be associated with the last k transitions of the original chain. Solution. (a) For every state (i, j) of the new Markov chain, we have p( (Xn - 1 , Xn ) = (i, j)) = P(Xn-1 = i) P(Xn = j I Xn-1 = i) = P(Xn-1 = i) Pij. Since the Markov chain Xn has a single recurrent class which is aperiodic, P(Xn- 1 = i) converges to the steady-state probability 7ri, for every i. It follows that p( (Xn- 1, Xn ) = (i, j)) converges to 7riPij , which is therefore the steady-state probability of (i, j). (b) Using the multiplication rule, we have Therefore, by an argument similar to the one in part (a) , the steady-state probability of state (io, . . . , ik) is equal to 7rioPioil .. . Pik_ lik. SECTION 7.4. Absorption Probabilities and Expected Time to Ab­ sorption Problem 28. There are m classes offered by a particular department, and each year, the students rank each class from 1 to m, in order of difficulty, with rank m being the highest. Unfortunately, the ranking is completely arbitrary. In fact, any given class is equally likely to receive any given rank on a given year (two classes may not receive the same rank) . A certain professor chooses to remember only the highest ranking his class has ever gotten. (a) Find the transition probabilities of the Markov chain that models the ranking that the professor remembers. (b) Find the recurrent and the transient states. ( c) Find the expected number of years for the professor to achieve the highest ranking given that in the first year he achieved the ith ranking. 1.24: Transition Consider the !vlarkov probabi l it ies are to 6 71\"1 == - . 9 7r2 == -. 1 Chap. 7 for 29. specified . The steady-state 6 10 71\"3 == -, 7f4 == -. Assume that the process is in state 1 j ust before t he fi rst transit ion. ( a) is transition? that process will in state 1 sixth (b) Determine the expected value and variance of the number of transitions up to next process ret urns to state 1 . (c) Wh at is (approximately) probability that the state the system resulting 1000 is state IDOl? Problem Consi der the 1\\I ar kov chai n sp ecified in Fig. 7.25. 7.25: Transi tion for Problem 30 . (a) transient and recurrent states. Also. determine the recurrent classes ones . if are n.c.1I\"'1nrl (b) Do there exist steady-state probabilities given t he ..... ... r�,.L\">.\"c starts state I? (c) are exist steady-state probabilities are the process starts state Problems 397 (d) Assume that the process starts in state 1 but we begin observing it after it reaches steady-state. (i) Find the probability that the state increases by one during the first transi­ tion we observe. (ii) Find the conditional probability that the process was in state 2 when we started observing it, given that the state increased by one during the first transition that we observed. (iii) Find the probability that the state increased by one during the first change of state that we observed. ( e) Assume that the process starts in state 4. (i) For each recurrent class, determine the probability that we eventually reach that class. (ii) What is the expected number of transitions up to and including the tran­ sition at which we reach a recurrent state for the first time? Problem 31. * Absorption probabilities. Consider a Markov chain where each state is either transient or absorbing. Fix an absorbing state s. Show that the prob­ abilities ai of eventually reaching s starting from a state i are the unique solution to the equations as = 1, ai = 0, m ai = L Pijaj, j=l for all absorbing i t= s, for all transient i. Hint: If there are two solutions, find a system of equations that is satisfied by their difference, and look for its solutions. Solution. The fact that the at satisfy these equations was established in the text, using the total probability theorem. To show uniqueness, let ai be another solution, and let t5i = ai - ai . Denoting by A the set of absorbing states and using the fact t5j = 0 for all j E A, we have m t5i = L Pijt5j = L Pijt5j, j=l j�A for all transient i. Applying this relation m successive times, we obtain Hence t5i = L P1it L Pith '\" L Pjm- ljm . t5jm · it �A h�A jm�A = P(XI � A, ... ,Xm � A I Xo = i) . lt5jm I =:; P(XI � A . . . . , Xm � A I Xo = i) . max lt5j l · jltA 398 The above relation holds for all transient i, so we obtain where max 18j I ::; f3 . max 18j I, j� A j�A Markov Chains f3 = P(XI � A, . . . , Xm � A IXo = i). Chap. 7 Note that f3 < 1, because there is positive probability that Xm is absorbing, regardless of the initial state. It follows that maXj�A 18j I = 0, or ai = at for all i that are not absorbing. We also have aj = aj for all absorbing j, so ai = ai for all i. Problem 32. * Multiple recurrent classes. Consider a Markov chain that has more that one recurrent class, as well as some transient states. Assume that all the recurrent classes are aperiodic. (a) For any transient state i, let ai (k) be the probability that starting from i we will reach a state in the kth recurrent class. Derive a system of equations whose solution are the ai (k) . (b) Show that each of the n-step transition probabilities nj (n) converges to a limit, and discuss how these limits can be calculated. Solution. (a) We introduce a new Markov chain that has only transient and absorbing states. The transient states correspond to the transient states of the original, while the absorbing states correspond to the recurrent classes of the original. The transition probabilities Pij of the new chain are as follows: if i and j are transient, Pij = Pij ; if i is a transient state and k corresponds to a recurrent class, Pik is the sum of the transition probabilities from i to states in the recurrent class in the original Markov chain. The desired probabilities ai (k) are the absorption probabilities in the new Markov chain and are given by the corresponding formulas: ai (k) = Pik + L Pijaj (k) , for all transient i. j: transient (b) If i and j are recurrent but belong to different classes, nj (n) is always o. If i and j are recurrent but belong to the same class, Tij (n) converges to the steady-state probability of j in a chain consisting of only this particular recurrent class. If j is transient, Tij (n) converges to O. Finally, if i is transient and j is recurrent, then Tij(n) converges to the product of two probabilities: (1) the probability that starting from i we will reach a state in the recurrent class of j, and (2) the steady-state probability of j conditioned on the initial state being in the class of j. Problem 33. * Mean first passage times. Consider a Markov chain with a single recurrent class, and let s be a fixed recurrent state. Show that the system of equations ts = 0, m ti = 1 + L Pijtj , j=l for all i f: s, satisfied by the mean first passage times, has a unique solution. Hint: If there are two solutions, find a system of equations that is satisfied by their difference, and look for its solutions. Problems 399 Solution. Let ti be the mean first passage times. These satisfy the given system of equations. To show uniqueness, let Ii be another solution. Then we have for all i =I- s ti = 1 + L Pij tj , j#s Ii = 1 + L PijIj , j#s and by subtraction, we obtain 8i = L Pij8j , j#s where 8i = Ii - ti . By applying m successive times this relation, if follows that 8i = L PiiI L PiIh ·· · L Pjm-Iim . 8jm · iI #s h #s jm#s Hence, we have for all i =I- s = P (XI =I- s, ... , Xm =I- slXo = i) · max l8jl· j On the other hand, we have P (XI =I- s, ... , Xm =I- s I Xo = i) < 1. This is because starting from any state there is positive probability that s is reached in m steps. It follows that all the 8i must be equal to zero. Problem 34. * Balance equations and mean recurrence times. Consider a Markov chain with a single recurrent class, and let s be a fixed recurrent state. For any state i, let Pt = E [N umber of visits to i between two successive visits to s] , where by convention, ps = 1. (a) Show that for all i, we have (b) Show that the numbers m Pi = L PkPki . k= l Pi 7r' --1 - t:' i = 1, . . . ,m , sum to 1 and satisfy the balance equations, where t; is the mean recurrence time of s (the expected number of transitions up to the first return to s, starting from s) . (c) Show that if 7rl , ..• , 7r m are nonnegative, satisfy the balance equations, and sum to 1, then 7ri = { t� ' 0, if i is recurrent, if i is transient, 400 Markov Chains Chap. 7 where t; is the mean recurrence time of i. (d) Show that the distribution of part (b) is the unique probability distribution that satisfies the balance equations. Note: This problem not only provides an alternative proof of the existence and unique­ ness of probability distributions that satisfy the balance equations, but also makes an intuitive connection between steady-state probabilities and mean recurrence times. The main idea is to break the process into \"cycles,\" with a new cycle starting each time that the recurrent state s is visited. The steady-state probability of s can be interpreted as the long-term expected frequency of visits to state s, which is inversely proportional to the average time between consecutive visits (the mean recurrence time) ; cf. part (c) . Furthermore, if a state i is expected to be visited, say, twice as often as some other state j during a typical cycle, it is plausible that the long-term expected frequency 7ri of state i will be twice as large as 7rj . Thus, the steady-state probabilities 7ri should be proportional to the expected number of visits Pi during a cycle; cf. part (b) . Solution. (a) Consider the Markov chain Xn, initialized with Xo = s. We claim that for all i 00 Pi = L P(X1 # s, ... , Xn-1 # s, Xn = i). n=l To see this, we first consider the case i # s, and let In be the random variable that takes the value 1 if Xl # S, ••• , Xn-1 # s, and Xn = i, and the value 0 otherwise. Then, the number of visits to state i before the next visit to state s is equal to 2::=1 In. Thus,t [00 ] 00 DC Pi = E �In = �E[Inl = �P(X1 # S, . . . ,Xn-1 # s,Xn = i). t The interchange of the infinite summation and the expectation in the subsequent calculation can be justified by the following argument. We have for any k > 0, Let T be the first positive time that state s is visited. Then, Since the mean recurrence time 2::1 t P(T = t) is finite, the limit, as k -+ 00 of 2:�k+2 t P(T = t) is equal to zero. We take the limit of both sides of the earlier equation, as k -+ 00, to obtain the desired relation Problems 401 When i = s, the events {Xl '# s, ... ,Xn-l '# s, Xn = s}, for the different values of n, form a partition of the sample space, because they corre­ spond to the different possibilities for the time of the next visit to state s. Thus, :x: L P(XI '# S , ••• ,Xn-l '# s, Xn = s) = 1 = ps , n=l which completes the verification of our assertion. We next use the total probability theorem to write for n � 2, P(XI '# S, ••• ,Xn- l '# s, Xn i) = L P(XI '# S, . .. ,Xn-2 '# s,Xn- 1 = k)Pki. ki's We thus obtain 00 Pi = L P(XI '# S, ••. ,Xn-l '# s,Xn = i) n=l 00 = Psi + L P(XI '# S, •.• ,Xn- 1 '# s, Xn = i) n=2 :x: = Psi + L L P(XI '# S, ••• , Xn -2 '# S , Xn- 1 = k)Pki n=2 ki's 00 =Psi + L Pki L P(X1 ,#s, ... , Xn-2 ,#s,Xn- 1 = k) ki's n=2 = Pspsi + L PkiPk ki's m = L PkPki . k=l (b) Dividing both sides of the relation established in part (a) by t; , we obtain 1n lI'i = L lI'kPki , k=l where lI'i = pdt; . Thus, the lI'i solve the balance equations. Furthermore, the lI'i are nonnegative, and we clearly have 2:::;:1 Pi = t; or 2:::;:1 lI'i = 1. Hence, (11'1 , •.• , lI'm ) is a probability distribution. (c) Consider a probability distribution (11'1 , . . . , 11' m) that satisfies the balance equations. Fix a recurrent state 5, let t; be the mean recurrence time of s. and let ti be the mean 402 Markov Chains Chap. 7 first passage time from a state i i= s to state s. We will show that 7rst; = 1. Indeed, we have t: = 1 + L PSj tj ' j#s ti = 1 + L Pij tj , j#s for all i i= s. MUltiplying these equations with 7rs and 7ri , respectively, and adding, we obtain m 7rst: + L 7riti = 1 + L 7ri L Pij tj . i=l By using the balance equations, the right-hand side is equal to m i=l j'i-s m j 'i-s i=l By combining the last two equations, we obtain 7rst; = 1. j'i-s Since the probability distribution (7rI , .. . , 7r Tn ) satisfies the balance equations, if the initial state Xo is chosen according to this distribution, all subsequent states Xn have the same distribution. If we start at a transient state i, the probability of being at that state at time n diminishes to 0 as n - 00. It follows that we must have 7ri = o. (d) Part (b) shows that there exists at least one probability distribution that satisfies the balance equations. Part (c) shows that there can be only one such probability distribution. Problem 35. * The strong law of large numbers for Markov chains. Consider a finite-state Markov chain in which all states belong to a single recurrent class which is aperiodic. For a fixed state s, let Yk be the time of the kth visit to state s. Let also Vn be the number of visits to state s during the first n transitions. (a) Show that Yk /k converges with probability 1 to the mean recurrence time t; of state s. (b) Show that Vn/n converges with probability 1 to 1ft; . (c) Can you relate the limit of Vn/n to the steady-state probability of state s? Solution. (a) Let us fix an initial state i, not necessarily the same as s. Thus, the random variables Yk+l - Yk , for k 2:: 1, correspond to the time between successive visits to state s. Because of the Markov property (the past is independent of the future, given the present), the process \"starts fresh\" at each revisit to state s and, therefore, the random variables Yk+l - Yk are independent and identically distributed, with mean equal to the mean recurrence time t; . Using the strong law of large numbers, we obtain with probability 1. Problems 403 (b) Let us fix an element of the sample space (a trajectory of the Markov chain). Let Yk and Vn be the values of the random variables Yk and Vn , respectively. Furthermore, let us assume that the sequence Yk/ k converges to t;; according to the result of part (a), the set of trajectories with this property has probability 1. Let us consider some n between the time of the kth visit to state s and the time just before the next visit to that state: Yk � n < Yk+!- For every n in this range, we have Vn = k, and also from which we obtain Note that 1 1 1 -- < - � -, Yk+! n Yk _ k_ < Vn < .!:.. . Yk+! - n - Yk lim _ k_ = lim k + 1 . lim _k_ = lim .!:.. = .!.. k-oo Yk+! k-oo Yk+! k-oo k + 1 k_oo Yk t; If we now let n go to infinity, the corresponding values of k, chosen to satisfy Yk � n < Yk+! also go to infinity. Therefore, the sequence vn/n is between two sequences both of which converge to l/t; , which implies that the sequence vn/n converges to l/t; as well. Since this happens for every trajectory in a set of trajectories that has probability equal to 1, we conclude that Vn/n converges to l/t; , with probability 1. (c) We have l/t; = 1rs , as established in Problem 35. This implies the intuitive result that Vn/n converges to 1rs , with probability 1. Note: It is tempting to try to establish the convergence of Vn/n to 1r1J by combining the facts that Vn/n converges [part (b)] together with the fact that E[Vnl/n converges to 1rs (cf. the long-term expected fre­ quency interpretation of steady-state probabilities in Section 7.3) . However, this line of reasoning is not valid. This is because it is generally possible for a sequence Yn of random variables to converge with probability 1 to a constant, while the expected val­ ues converge to a different constant. An example is the following. Let X be uniformly distributed in the unit interval [0, 1]. let Yn = {O, n, if X � l/n, if X < l/n. As long as X is nonzero (which happens with probability 1), the sequence Yn converges to zero. On the other hand, it can be seen that 1 n 1 E[Yn] = P(X < l/n) E[Yn IX < l/n] = �. 2' = 2' SECTION 7.5. Continuous-Time Markov Chains for all n. Problem 36. A facility of m identical machines is sharing a single repairperson. The time to repair a failed machine is exponentially distributed with mean 1/>.. A machine 404 Markov Chains Chap. 7 once operational, fails after a time that is exponentially distributed with mean 1/ J.L. All failure and repair times are independent. (a) Find the steady-state probability that there is no operational machine. (b) Find the expected number of operational machines, in steady-state. Problem 37. Empty taxis pass by a street corner at a Poisson rate of two per minute and pick up a passenger if one is waiting there. Passengers arrive at the street corner at a Poisson rate of one per minute and wait for a taxi only if there are less than four persons waiting; otherwise they leave and never return. Penelope arrives at the street corner at a given time. Find her expected waiting time, given that she joins the queue. Assume that the process is in steady-state. Problem 38. There are m users who share a computer system. Each user al­ ternates between \"thinking\" intervals whose durations are independent exponentially distributed with parameter A, and an \"active\" mode that starts by submitting a ser­ vice request. The server can only serve one request at a time, and will serve a request completely before serving other requests. The service times of different requests are independent exponentially distributed random variables with parameter J.L, and also independent of the thinking times of the users. Construct a Markov chain model and derive the steady-state distribution of the number of pending requests, including the one presently served, if any. Problem 39. * Consider a continuous-time Markov chain in which the transition rates Vi are the same for all i. Assume that the process has a single recurrent class. (a) Explain why the sequence Yn of transition times form a Poisson process. (b) Show that the steady-state probabilities of the Markov chain X(t) are the same as the steady-state probabilities of the embedded Markov chain Xn . Solution. (a) Denote by V the common value of the transition rates Vi . The sequence {Yn} is a sequence of independent exponentially distributed time intervals with param­ eter v. Therefore they can be associated with the arrival times of a Poisson process with rate v. (b) The balance and normalization equations for the continuous-time chain are 7rj L qjk = L7rkQkj, k¢j k¢J m 1 = L7rk. k=l j = 1, . . . ,m , By using the relation qjk = VPJk, and by canceling the common factor V, these equations are written as 7rj LPJk = L7rkPkj, k¢J k¢j m j = 1, ... ,m, Problems We have Ek#j p] k = 1 - Pjj , so the first of these two equations is written as or 7rj (l - Ph ) = L 7rkPkj , k#j m 7rj = L 7rkPk] . k=l j = l, . .. , m. 405 These are the balance equations for the embedded Markov chain, which have a unique solution since the embedded Markov chain has a single recurrent class, which is aperi­ odic. Hence the 7rj are the steady-state probabilities for the embedded Markov chain. 8 Baye sian Statistical Inference Contents 8.1. Bayesian Inference and the Posterior Distribution 8.2. Point Estimation, Hypothesis Testing, and the MAP Rule 8.3. Bayesian Least Mean Squares Estimation 8.4. Bayesian Linear Least Mean Squares Estimation 8.5. Summary and Discussion Problems .... ... .... ...... . · p. 412 .. p. 420 · p. 430 · p. 437 · p. 444 · p. 446 407 408 Bayesian Statistical Inference Chap. 8 Statistical inference is the process of extracting information about an unknown variable or an unknown model from available data. In this chapter and the next one we aim to: (a) Develop an appreciation of the main two approaches (Bayesian and classi­ cal) , their differences, and similarities. (b) Present the main categories of inference problems (parameter estimation, hypothesis testing, and significance testing). ( c) Discuss the most important methodologies (maximum a posteriori pro ba­ bility rule, least mean squares estimation, maximum likelihood, regression, likelihood ratio tests, etc. ). (d) Illustrate the theory with some concrete examples. Probability versus Statistics Statistical inference differs from probability theory in some fundamental ways. Probability is a self-contained mathematical subject, based on the axioms in­ troduced in Chapter 1. In probabilistic reasoning, we assume a fully specified probabilistic model that obeys these axioms. We then use mathematical meth­ ods to quantify the consequences of this model or answer various questions of interest. In particular, every unambiguous question has a unique correct answer, even if this answer is sometimes hard to find. The model is taken for granted and, in principle, it need not bear any resemblance to reality (although for the model to be useful, this would better be the case). Statistics is different, and it involves an element of art. For any particular problem, there may be several reasonable methods, yielding different answers. In general, there is no principled way for selecting the \"best\" method, unless one makes several assumptions and imposes additional constraints on the inference problem. For instance, given the history of stock market returns over the last five years, there is no single \"best\" method for estimating next year's returns. We can narrow down the search for the \"right\" method by requiring cer­ tain desirable properties (e.g., that the method make a correct inference when the number of available data is unlimited) . The choice of one method over an­ other usually hinges on several factors: performance guarantees, past experience, common sense, as well as the consensus of the statistics community on the ap­ plicability of a particular method on a particular problem type. We will aim to introduce the reader to some of the most popular methods/choices, and the main approaches for their analysis and comparison. Bayesian versus Classical Statistics Within the field of statistics there are two prominent schools of thought, with op­ posing views: the Bayesian and the classical (abo called frequentist). Their fundamental difference relates to the nature of the unknown models or variables. In the Bayesian view. they are treated as random variables with known distri- 409 butions. In the classical view, they are treated as deterministic quantities that happen to be unknown. The Bayesian approach essentially tries to move the field of statistics back to the realm of probability theory, where every question has a unique answer. In particular, when trying to infer the nature of an unknown model, it views the model as chosen randomly from a given model class. This is done by introducing a random variable 8 that characterizes the model, and by postulating a prior probability distribution pe(O) . Given the observed data x, one can, in principle, use Bayes' rule to derive a posterior probability distribution Pel x (O I x) . This captures all the information that x can provide about O. By contrast, the classical approach views the unknown quantity 0 as a constant that happens to be unknown. It then strives to develop an estimate of 0 that has some performance guarantees. This introduces an important conceptual difference from other methods in this book: we are not dealing with a single probabilistic model, but rather with multiple candidate probabilistic models, one for each possible value of O. The debate between the two schools has been ongoing for about a century, often with philosophical overtones. Furthermore, each school has constructed examples to show that the methods of the competing school can sometimes produce unreasonable or unappealing answers. We briefly review some of the arguments in this debate. Suppose that we are trying to measure a physical constant, say the mass of the electron, by means of noisy experiments. The classical statistician will argue that the mass of the electron, while unknown, is just a constant, and that there is no justification for modeling it as a random variable. The Bayesian statistician will counter that a prior distribution simply reflects our Rtate of knowledge. For example, if we already know from past experiments a rough range for this quantity, we can express this knowledge by postulating a prior distribution which is concentrated over that range. A classical statistician will often object to the arbitrariness of picking a par­ ticular prior. A Bayesian statistician will counter that every statistical procedure contains some hidden choices. Furthermore, in some cases, classical methods turn out to be equivalent to Bayesian ones, for a particular choice of a prior. By locating all of the assumptions in one place, in the form of a prior, the Bayesian statistician contends that these assumptions are brought to the surface and are amenable to scrutiny. Finally, there are practical considerations. In many cases, Bayesian meth­ ods are computationally intractable, e.g., when they require the evaluation of multidimensional integrals. On the other hand, with the availability of faster computation, much of the recent research in the Bayesian community focuses on making Bayesian methods practical. Model versus Variable Inference Applications of statistical inference tend to be of two different types. In model inference, the object of study is a real phenomenon or process for which we 410 Bayesian Statistical Inference Chap. 8 wish to construct or validate a model on the basis of available data (e.g., do planets follow elliptical trajectories?). Such a model can then be used to make predictions about the future, or to infer some hidden underlying causes. In variable inference, we wish to estimate the value of one or more unknown variables by using some related, possibly noisy information (e.g., what is my current position, given a few GPS readings?). The distinction between model and variable inference is not sharp; for example, by describing a model in terms of a set of variables, we can cast a model inference problem as a variable inference problem. In any case, we will not emphasize this distinction in the sequel, because the same methodological principles apply to both types of inference. In some applications, both model and variable inference issues may arise. For example, we may collect some initial data, use them to build a model, and then use the model to make inferences about the values of certain variables. Example 8.1. A Noisy Channel. A transmitter sends a sequence of binary messages 8i E {a, I}, and a receiver observes i = 1, ... ,n, where the Wi are zero mean normal random variables that model channel noise, and a is a scalar that represents the channel attenuation. In a model inference setting, a is unknown. The transmitter sends a pilot signal consisting of a sequence of messages S} , ..• , Sn , whose values are known by the receiver. On the basis of the observations Xl , ... , Xn , the receiver wishes to estimate the value of a, that is, build a model of the channel. Alternatively, in a variable inference setting, a is assumed to be known (possi­ bly because it has already been inferred using a pilot signal, as above). The receiver observes Xl , ... , X n. and wishes to infer the values of 8} , ... , 8n . A Rough Classification of Statistical Inference Problems We describe here a few different types of inference problems. In an estimation problem, a model is fully specified, except for an unknown, possibly multidimen­ sional, parameter (), which we wish to estimate. This parameter can be viewed as either a random variable (Bayesian approach) or as an unknown constant (classical approach) . The usual objective is to arrive at an estimate of () that is close to the true value in some sense. For example: (a) In the noisy transmission problem of Example 8. 1, use the knowledge of the pilot sequence and the observations to estimate a. (b) Using polling data, estimate the fraction of a voter population that prefers candidate A over candidate B. (c) On the basis of historical stock market data, estimate the mean and vari­ ance of the daily movement in the price of a particular stock. 411 In a binary hypothesis testing problem, we start with two hypotheses and use the available data to decide which of the two is true. For example: (a) In the noisy transmission problem of Example 8. 1, use the knowledge of a and Xi to decide whether Si was 0 or l. (b) Given a noisy picture, decide whether there is a person in the picture or not. (c) Given a set of trials with two alternative medical treatments, decide which treatment is most effective. More generally, in an m-ary hypothesis testing problem, there is a finite number m of competing hypotheses. The performance of a particular method is typically judged by the probability that it makes an erroneous decision. Again, both Bayesian and classical approaches are possible. In this chapter, we focus primarily on problems of Bayesian estimation, but also discuss hypothesis testing. In the next chapter, in addition to estimation, we discuss a broader range of hypothesis testing problems. Our treatment is introductory and far from exhausts the range of statistical inference problems encountered in practice. As an illustration of a different type of problem, consider the construction of a model of the form Y = g(X) + W that relates two random variables X and Y. Here W is zero mean noise, and 9 is an unknown function to be estimated. Problems of this type, where the uncertain object (the function 9 in this case) cannot be described by a fixed number of parameters, are called nonparametric and are beyond our scope. Major Terms, Problems, and Methods in this Chapter • Bayesian statistics treats unknown parameters as random variables with known prior distributions. • In parameter estimation, we want to generate estimates that are close to the true values of the parameters in some probabilistic sense. • In hypothesis testing, the unknown parameter takes one of a finite number of values, corresponding to competing hypotheses; we want to choose one of the hypotheses, aiming to achieve a small probability of error. • Principal Bayesian inference methods: (a) Maximum a posteriori probability (MAP) rule: Out of the possible parameter values/hypotheses, select one with maximum conditional/posterior probability given the data (Section 8.2). (b) Least mean squares (LMS) estimation: Select an estimator /fun­ ction of the data that minimizes the mean squared error between the parameter and its estimate (Section 8.3) . 1 412 (c) Select an we is ......... , .... ...... ...... .L ...... 'UL as a variable or as a of random 8 represent phY:::iical quantities! such as the position velocity of a or a unless the f\"J\"'\\Y,9\" .... .... We to extract = (Xl . .... )(n ) of ....... ... ... ...... .... \"\"'. measure- this , we assunle that we know the joint we (a) or fe . ae .. tJr..;T', ....... \"AI J;;,. on whether is or con- tinuous. (b) A distri bution p X I e or on whether X is crete or cont inuous. a value :1: of X has been observed, a complete answer to the Bayesian inference problem provided by the posterior distribution Pe l x (() I f e I x (() I of :::iec 1 . is by of Bayes ' rule. It encapsul ates there is to know about the available information . it is fu rther 8.1. A summary of a i nference modeL The distri but ion of the e and observation X, or and cond it ional PfvlF jPDF. Given the val ue x of the observation X, the is using The can be used to answer add itional inferen ce questionSi for the calc ulation of estimates of and probab il i t ies or error var iances. Sec. 8. 1 Bayesian Inference and the Posterior Distribution 413 Summary of Bayesian Inference • We start with a prior distribution pe or ie for the unknown random variable e. • We have a model PXle or iX le of the observation vector X. • After observing the value x of X, we form the posterior distribution of e, using the appropriate version of Bayes' rule. Note that there are four different versions of Bayes' rulp. which we repeat here for easy reference. They correspond to the different combinations of discrete or continuous e and X. Yet. all four versions are syntactically similar: starting from the simplest version (all variables are discrete) . we only need to replace a PMF with a PDF and a sum with an integral when a continuous random variable is involved. Furthermore, when e is multidimensional. the corresponding sums or integrals are to be understood as multidimensional. The Four Versions of Bayes' Rule • e discrete, X discrete: • e discrete, X continuous: (0 I ) - pe (O)ix le (x I 0) Pe lx x- L pe ( 0' ) i x Ie (x I 0') (Jf • 8 continuous, X discrete: • e continuous, X continuous: 414 Bayesian Statistical Inference Chap. 8 Let us illustrate the calculation of the posterior with some examples. Example 8.2. Romeo and Juliet start dating, but Juliet will be late on any date by a random amount X, uniformly distributed over the interval [0, OJ. The parameter 0 is unknown and is modeled as the value of a random variable e, uniformly distributed between zero and one hour. Assuming that Juliet was late by an amount x on their first date, how should Romeo use this information to update the distribution of 8? Here the prior PDF is !e (O) = { 1, 0, if ° � 0 � 1, otherwise, and the conditional PDF of the observation is !X e (x I 0) = { I/O, if ° � � � 0, I 0, otherwIse. Using Bayes' rule, and taking into account that !e (O) !xle(x I 0) is nonzero only if ° � x � 0 � 1, we find that for any x E [0, 1] ' the posterior PDF is � (1I 1 ) _ !e(O) !x le (x I O) JelX u X - I 1 !e (O') !x le (X I 0') dO' and !elx (O I x) = ° if 0 < x or 0 > l. 1/0 1 if x � 0 � 1, 11 .!. dO' 0' x O · I log xl' Consider now a variation involving the first n dates. Assume that Juliet is late by random amounts Xl , ... , Xn , which given 8 = 0, are uniformly distributed in the interval [0, OJ, and conditionally independent. Let X = (X I, ... , X n) and x = (Xl, ... , Xn) . Similar to the case where n = 1, we have where The posterior PDF is if x � 0 � 1, otherwise, x = max{xI, . .. , Xn }. { C(X) !eIX (O I x) = 0;:;-' 0, if x � 0 � 1, otherwise, where c(x) is a normalizing constant that depends only on x: 1 c(x) = -1:----- r 1 , Jx (O,)n dO Sec. 8. 1 Bayesian Inference and the Posterior Distribution 415 Example 8.3. Inference of a Common Mean of Normal Random Vari­ ables. We observe a collection X = (Xl , ... , X n) of random variables, with an unknown common mean whose value we wish to infer. We assume that given the value of the common mean, the Xi are normal and independent, with known vari­ ances (7?, ... , (7�. In a Bayesian approach to this problem, we model the common mean as a random variable 8, with a given prior. For concreteness, we assume a normal prior, with known mean Xo and known variance (75. Let us note, for future reference, that our model is equivalent to one of the form i = 1, ... ,n, where the random variables 8, WI , ... , W n are independent and normal, with known means and variances. In particular, for any value 8, E[Wd = E[Wi 18 = 8] = 0, A model of this type is common in many engineering applications involving several independent measurements of an unknown quantity. and According to our assumptions, we have { (8 - XO)2 } !e (8) = CI . exp - 2(75 ' !X IS(X 19) = c, . exp { - (XI2�/)'} . .. exp { - (xn2�t)'} , where Cl and C2 are normalizing constants that do not depend on 8. We invoke Bayes' rule, t (8 I ) _ !e (8)!xle(x I 8) JelX x - J ' !e (8')!xle (x I 8') d8' and note that the numerator term, !e (8)!x le(x I 8) , is of the form { n 2 } (Xi - 8) CIC2 . exp - L 2(72 . i=O t After some algebra, which involves completing the square inside the exponent, we find that the numerator is of the form where m= n d . exp { _ (8 �:) 2 } , L Xi/(7; i=O n v= 1 n L 1/(7; L 1/(7; i=O i=O 416 Bayesian Statistical Inference Chap. 8 and d is a constant, which depends on the Xi but does not depend on O. Since the denominator term in Bayes' rule does not depend on 0 either, we conclude that the posterior PDF has the form { (0 - m)2 } f e I x (0 I x) = a . exp - 2v ' for some normalizing constant a, which depends on the Xi , but not on O. We recognize this as a normal PDF, and we conclude that the posterior PDF is normal with mean m and variance v. As a special case suppose that 0'5 , O'i , ... ,O'� have a common value 0'2. Then, the posterior PDF of 8 is normal with mean and variance Xo + . .. + Xn m = ----­n+l 0'2 v = -- , n+ l respectively. In this case, the prior mean Xo acts just as another observation, and contributes equally to determine the posterior mean m of 8. Notice also that the standard deviation of the posterior PDF of 8 tends to zero, at the rough rate of 1/ JTi\" as the number of observations increases. If the variances 0'7 are different, the formula for the posterior mean m is still a weighted average of the Xi, but with a larger weight on the observations with smaller variance. The preceding example has the remarkable property that the posterior distribution of e is in the same family as the prior distribution, namely, the family of normal distributions. This is appealing for two reasons: (a) The posterior can be characterized in terms of only two numbers, the mean and the variance. (b) The form of the solution opens up the possibility of efficient recursive inference. Suppose that after Xl , ... , X n are observed, an additional observation Xn+ 1 is obtained. Instead of solving the inference problem from scratch, we can view fS lxl , ... ,Xn as our prior, and use the new observation to obtain the new posterior fS l xl, ... ,Xn ,Xn+l ' We may then apply the solution of Example 8.3 to this new problem. It is then plausible (and can be formally established) that the new posterior of e will have mean and variance (m/v) + (Xn+I /O'�+l ) (l/v) + (1 /0'�+ 1) 1 (l/v) + (l/O'�+ l ) , where m and v are the mean and variance of the old posterior fSlxl ,\"\" Xn ' This situation where the posterior is in the same family of distributions as the prior is not very common. Besides the normal family, another prominent example involves coin tosses/Bernoulli trials and binomial distributions. Sec. 8. 1 Bayesian Inference and the Posterior Distribution 417 Example 8.4. Beta Priors on the Bias of a Coin. We wish to estimate the probability of heads, denoted by 0, of a biased coin. We model 0 as the value of a random variable 8 with known prior PDF fe . We consider n independent tosses and let X be the number of heads observed. From Bayes' rule, the posterior PDF of e has the form, for 0 E [0, 1], felx (0 I k) = cfe (O)Pxle(k I 0) = d fe (O)Ok(1 _ O)n-k, where c is a normalizing constant (independent of 0), and d = cG) . Suppose now that the prior is a beta density with integer parameters a > 0 and (3 > 0, of the form { B( 1 (3) 00- 1 ( 1 _ O)f3- 1 , if 0 < 0 < 1, fe (O) = a, 0, otherwise, where B(a, (3) is a normalizing constant, known as the Beta function, given by B( (3) = 11 00- 1 (1 _ O)f3-1 dO = (a - I)! ((3 - I)! . a, 0 (a + (3- 1)! ' the last equality can be obtained from integration by parts, or through a proba­ bilistic argument (see Problem 30 in Chapter 3). Then, the posterior PDF of e is of the form f (0 I k) = d Ok+O-l (1 _ O)n-k+f3-1 elx B(a, (3) , and hence is a beta density with parameters a' = k + a, (3' = n - k + (3. o :::; 0 :::; 1, In the special case where a = (3 = 1, the prior fe is the uniform density over [0, 1] . In this case. the posterior density is beta with parameters k + 1 and n - k + 1. The beta density arises often in inference applications and has interesting properties. In particular, if e has a beta density with integer parameters a > 0 and (3 > 0, its mth moment is given by E[em] = 1 11 om+o-l (1 _ O)f3-1 dO B(a. 8) 0 B(a + m, (3) - B(a, (3) a(a + 1) .. . (a + m - 1) - (a + (3)(a + (3 + 1) . . . (a + (3 + m - 1) ' The preceding examples involved a continuous random variable e, and were typical of parameter estimation problems. The following is a discrete example, and is typical of those arising in binary hypothesis testing problems. 418 Bayesian Statistical Inference Chap. 8 Example 8.5. Spam Filtering. An email message may be \"spam\" or \"legit­ imate.\" We introduce a parameter 8, taking values 1 and 2, corresponding to spam and legitimate, respectively, with given probabilities pe(l) and pe(2). Let {WI , . . . , wn} be a collection of special words (or combinations of words) whose appearance suggests a spam message. For each i, let Xi be the Bernoulli random variable that models the appearance of Wi in the message (Xi = 1 if W1 appears and Xi = 0 if it does not). We assume that the conditional probabilities pX1le(Xi 1 1) and PXile(Xi 1 2), Xi = 0, 1, are known. For simplicity we also assume that conditioned on 8, the random variables X I, ... ,Xn are independent. We calculate the posterior probabilities of spam and legitimate messages using Bayes' rule. We have n pe(m) IIpxi,e(xi 1m) P(8 = m I XI = XI, ... , Xn = Xn) = ---=-2---i-=-ln------ m = 1, 2. �pe(j) IIpxile(xi I j) These posterior probabilities may be used to classify the message as spam or legit­ imate, by using methods to be discussed later. Multiparameter Problems Our discussion has so far focused on the case of a single unknown parameter. The case of multiple unknown parameters is entirely similar. Our next example involves a two-dimensional parameter. Example 8.6. Localization Using a Sensor Network. There are n acous­ tic sensors, spread out over a geographic region of interest. The coordinates of the ith sensor are (ai, bd . A vehicle with known acoustic signature is located in this region, at unknown Cartesian coordinates 8 = (8 1 , 82) . Every sensor has a distance-dependent probability of detecting the vehicle (i.e., \"picking up\" the vehi­ cle's signature) . Based on which sensors detected the vehicle, and which ones did not, we would like to infer as much as possible about its location. The prior PDF fe is meant to capture our beliefs on the location of the vehicle, possibly based on previous observations. Let us assume, for simplicity, that 81 and 82 are independent normal random variables with zero mean and unit variance, so that f (0 0) - � -(Oi + O�)/2 e I, 2 - 27r e . Let Xi be equal to 1 (respectively, 0) if sensor i has detected the vehicle. To model signal attenuation, we assume that the probability of detection decreases exponentially with the distance between the vehicle and the sensor, which we denote by di (01 , (2). More precisely, we use the model 8. 1 419 8.2. LOC:a11Z;a.tu:>n a. sensor network . we assume = 1. is + iE S if/.S Xl = 1 i E the numerator over IX ... J , ... , integral 420 POINT HYPOTHESIS TESTING, AND THE discuss its \"-\", ...\" ,,, ... > .... , ,,\",,, X of we a posterior distribution PSI X (0 I x) [or fS lx (0 I ........................... the Fig. 8.3) . a x(Olx) , (0 I ( 8 discrete) , (8 8.3. Illustrat ion of the IvIAP rule for inference of a continuous parameter and a rt'� I\"'l\"ol�o 8 Equivalently, the probability an incorrect decision [for each observation value x, as well as overall probability of error over x)] .t t To state this more precisely, let us consider a genera] decision rule, which upon val ue x, of () g(x) . Denote by ( - ) I are to 1 urn,o'n Lll \"£l>r the decision rule the MAP rule) a correct decision ; thus , the event {I = I} is the same as the event {g(X) = ! and similarly for gMAP. By the definition of the rule , E[I I = any possible I X) :::; (gMAP (X) = e I X) = E[IMAP I Xl, law Sec. 8.2 Point Estimation, Hypothesis Testing, and the MAP Rule 421 The form of the posterior distribution, as given by Bayes' rule, allows an important computational shortcut: the denominator is the same for all 0 and depends only on the value x of the observation. Thus, to maximize the posterior, we only need to choose a value of 0 that maximizes the numerator pe(O)pxle(x I 0) if e and X are discrete, or similar expressions if e and/or X are continuous. Calculation of the denominator is unnecessary. The Maximum a Posteriori Probability (MAP) Rule • Given the observation value x, the MAP rule selects a value B that maximizes over 0 the posterior distribution Pelx (0 I x) (if e is discrete) or felx (O I x) (if e is continuous). • Equivalently, it selects 0 that maximizes over 0: pe(O)Pxle (x I 0) pe (O)fxle (x I 0) fe(O)pxle (x I 0) fe (O)fxle (x I 0) (if e and X are discrete) , (if 8 is discrete and X is continuous), (if e is continuous and X is discrete) , (if e and X are continuous). • If e takes only a finite number of val ues, the MAP rule minimizes (over all decision rules) the probability of selecting an incorrect hypothesis. This is true for both the unconditional probability of error and the conditional one, given any observation value x. Let us illustrate the MAP rule by revisiting some of the examples in the preceding section. Example 8.3 (continued). Here, 8 is a normal random variable, with mean Xo and variance 0-6. We observe a collection X = (Xl , ... , Xn ) of random variables which conditioned on the value () of 8, are independent normal random variables with mean () and variances o,f .. .. . O'�. We found that the posterior PDF is normal E[I] � E[IMAP] , or p(g(X) = 8) � P(gMAP(X) = 8) . Thus, the MAP rule maximizes the overall probability of a correct decision over all decision rules g. Note that this argument is mostly relevant when 8 is discrete. If 8, when conditioned on X = x, is a continuous random variable. the probability of a correct decision is 0 under any rule. 422 with mean m and variance v, given by n L xi/a? m = E[e I X = xl = _i=�� __ L l/a; i=O Bayesian Statistical Inference Chap. 8 1 v = var{e I X = x) = -n�-- L I/a; t=O Since the normal PDF is maximized at its mean, the MAP estimate is iJ = m. Example 8.5 (continued). Here the parameter e takes values I and 2, corre­ sponding to spam and legitimate messages, respectively, with given probabilities pe {l) and pe (2), and Xi is the Bernoulli random variable that models the appear­ ance of Wi in the message (Xi = 1 if Wi appears and Xi = 0 if it does not). We have calculated the posterior probabilities of spam and legitimate messages as n m= 1, 2. Suppose we want to classify a message as spam or legitimate based on the cor­ responding vector (Xl , ... , xn ) . Then, the MAP rule decides that the message is spam if pee = 11 Xl = Xl ,···, Xn = Xn) > pee = 2 1 Xl = Xl , . .. , Xn = Xn ) , or equivalently, if n n i=l i=l Point Estimation In an estimation problem, given the observed value x of X , the posterior dis­ tribution captures all the relevant information provided by x. On the other hand, we may be interested in certain quantities that summarize properties of the posterior. For example, we may select a point estimate, which is a single numerical value that represents our best guess of the value of e. Let us introduce some concepts and terminology relating to estimation. For simplicity, we assume that e is one-dimensional, but the methodology extends to other cases. We use the term estimate to refer to the numerical value 8 that we choose to report on the basis of the actual observation x. The value of 8 is to be determined by applying some function 9 to the observation x, resulting in 8 = g(x). The random variable e = g(X) is called an estimator, and its realized value equals g(x) whenever the random variable X takes the value x. Sec. 8.2 Point Estimation, Hypothesis Testing, and the MAP Rule 423 The reason that e is a random variable is that the outcome of the estimation procedure depends on the random value of the observation. We can use different functions 9 to form different estimators; some will be better than others. For an extreme example, consider the function that satisfies g(x) = 0 for all x. The resulting estimator, e = 0, makes no use of the data, and is therefore not a good choice. We have already seen two of the most popular estimators: (a) The Maximum a Posteriori Probability (MAP) estimator. Here, having observed x, we choose an estimate () that maximizes the posterior distribution over all (), breaking ties arbitrarily. (b) The Conditional Expectation estimator, introduced in Section 4.3. Here, we choose the estimate {} = E[8 1 X = xl . The conditional expectation estimator will be discussed in detail in the next section. It will be called there the least mean squares (LMS) estimator because it has an important property: it minimizes the mean squared error over all estimators, as we show later. Regarding the MAP estimator, we have a few remarks. (a) If the posterior distribution of 8 is symmetric around its (conditional) mean and unimodal (i.e. , has a single maximum), the maximum occurs at the mean. Then, the MAP estimator coincides with the conditional expectation estimator. This is the case, for example, if the posterior distribution is guaranteed to be normal, as in Example 8.3. (b) If 8 is continuous, the actual evaluation of the MAP estimate {} can some­ times be carried out analytically; for example, if there are no constraints on (), by setting to zero the derivative of !el x(() I x) , or of log !elx(() I x) , and solving for (). In other cases, however, a numerical search may be required. Point Estimates • An estimator is a random variable of the form e = g(X), for some function g. Different choices of 9 correspond to different estimators. • An estimate is the value {} of an estimator, as determined by the realized value x of the observation X. • Once the value x of X is observed, the Maximum a Posteriori Probability (MAP) estimator, sets the estimate {} to a value that maximizes the posterior distribution over all possible values of (). • Once the value x of X is observed, the Conditional Expectation (LMS) estimator sets the estimate {} to E[e I X = xl . 424 Bayesian Statistical Inference Chap. 8 Example S.7. Consider Example 8.2. in which Juliet is late on the first date by a random amount X. The distribution of X is uniform over the interval [0, e] , and e is an unknown random variable with a uniform prior PDF fe over the interval [0, 1] . In that example, we saw that for x E [0, 1]' the posterior PDF is if x � 0 � 1, otherwise. For a given x. felx «(} I x) is decreasing in 0, over the range [x, 1] of possible values of e. Thus. the :t>.fAP estimate is equal to x. Note that this is an \"optimistic\" estimate. If Juliet is late by a small amount on the first date (x R:: 0) , the estimate of future lateness is also small. The conditional expectation estimate turns out to be less \"optimistic.\" In particular, we have 11 1 1 - x E[e I X = x] = x 0 O . I log xl dO = I log xl ' The two estimates are plotted as functions of x in Fig. 8.4. It can be seen that for any observed lateness x. E[e I X = x] is larger than the MAP estimate of e . 0.9 0.8 0.7 0.6 0.5 0.4 . 0.3 0.2 • 0.1 ,/ ,/ 0 0 . ,-;: MAP Estimates ••• •••• • • •• :, Conditional Expectation Estimates • • •• • •• • • • • • • •• • • • • ,/ ,/ ,/ . ' .. ' . ' . ' .. ' . ' .' . ' . ' .' . ' . ' . ' .' ...... .... /' ,/ ,/ ,/ ,/ ,/ ,/ ,/ ............... ,/ ,/ ,/ ,/ ,/ ,/ ,/ ,/ ,/ ,/ ,/ 0.2 0.4 0.6 0.8 x Figure 8.4. MAP and conditional expectation estimates as functions of the observation x in Example 8.7. Example S.S. We consider the model in Example 8.4, where we observe the number X of heads in n independent tosses of a biased coin. We assume that the prior distribution of e, the probability of heads, is uniform over [0, 1]. We will derive the MAP and conditional expectation estimators of e. Sec. 8.2 Point Estimation, Hypothesis Testing, and the MAP Rule 425 As shown in Example 8.4, when X = k, the posterior PDF of 8 is a beta density with parameters Q: = k + 1 and /3 = n - k + 1: ielx (9I k) = B(k + l,n - k+ l) 9 1- 9 , i 9E 0,1 , { 1 k ( )n-k f [ 1 0, otherwise. This posterior PDF turns out to have a single peak. To find its location, we dif­ ferentiate the expression 9k (1 - 9)n-k with respect to 9, and set the derivative to zero, to obtain which yields This is the MAP estimate. A k L) _ _ u - . n To obtain the conditional expectation estimate, we use the formula for the mean of the beta density (cf. Example 8.4): E[8IX = k] = k + 1 . n+2 Note that for large values of n, the MAP and conditional expectation estimates nearly coincide. In the absence of additional assumptions, a point estimate carries no guar­ antees on its accuracy. For example, the MAP estimate may lie quite far from the bulk of the posterior distribution. Thus. it is usually desirable to also re­ port some additional information, such as the conditional mean squared error E [( e - e)2 I X = x] . In the next section, we will discuss this issue further. In particular, we will revisit the two preceding examples and we will calculate the conditional mean squared error for the MAP and conditional expectation estimates. Hypothesis Testing In a hypothesis testing problem, e takes one of m values, (h , . . . , ()m , where m is usually a small integer; often m = 2, in which case we are dealing with a binary hypothesis testing problem. We refer to the event {e = ()d as the ith hypothesis, and denote it by Hi . Once the value x of X is observed, we may use Bayes' rule to calculate the posterior probabilities P(8 = ()i I X = x) = Pelx (()i I x) , for each i. We may then select the hypothesis whose posterior probability is largest, according to the MAP rule. (If there is a tie, with several hypotheses attaining the largest posterior probability, we can choose among them arbitrarily. ) As mentioned earlier, the MAP rule is optimal in the sense that it maximizes the probability of correct decision over all decision rules. 426 Bayesian Statistical Inference Chap. 8 The MAP Rule for Hypothesis Testing • Given the observation value x, the MAP rule selects a hypothesis Hi for which the value of the posterior probability P( e = (h I X = x) is largest. • Equivalently, it selects a hypothesis Hi for which pe((h )Px le(x I (h ) (if X is discrete) or pe (Oi )!xle(x I (h ) (if X is continuous) is largest. • The MAP rule minimizes the probability of selecting an incorrect hy­ pothesis for any observation value x, as well as the probability of error over all decision rules. Once we have derived the MAP rule, we may also compute the correspond­ ing probability of a correct decision (or error), as a function of the observation value x. In particular, if 9MAP (X) is the hypothesis selected by the MAP rule when X = x, the probability of correct decision is P(8 = 9MAP(X) I X = x) . Furthermore, if Si is the set of all x such that the MAP rule selects hypothesis Hi , the overall probability of correct decision is p(e = 9MAP (X)) = LP(e = Oi ,X E Sd, 1 and the corresponding probability of error is The following is a typical example of MAP rule calculations for the case of two hypotheses. Example 8.9. We have two biased coins, referred to a..<; coins 1 and 2, with prob­ abilities of heads equal to PI and P2 , respectively. We choose a coin at random (either coin is equally likely to be chosen) and we want to infer its identity, based on the outcome of a single toss. Let e = 1 and 8 = 2 be the hypotheses that coin 1 or 2, respectively, was chosen. Let X be equal to 1 or 0, depending on whether the outcome of the toss was a head or a tail, respectively. Using the MAP rule, we compare pe (1)Px le(x 11 ) and pe (2)px le(x 1 2) , and decide in favor of the coin for which the corresponding expression is largest. Since pe (l) = pe (2) = 1/2, we only need to compare PX le(x 11) and PX le(x 12), and select the hypothesis under which the observed toss outcome is most likely. Thus, for example, if PI = 0.46, P2 = 0.52. and the outcome was a tail we notice that P(tail l8 = 1) = 1- 0.46 > 1 -0.52 = P(tail l8 = 2), and decide in favor of coin 1. ing to we shou ld select which out­ come is most li kel y [this critically depends on the assumption pe ( l) = pe (2) = 1/2] . Thus , if X = k, we should decide that = 1 if = 2 ! ') k ( )n-k k( )n-k PI I - PI > P2 1 - P2 , Figure 8.5. The MAP rule for Example 8.9, in the case where n 50 , Pi = 0.46 , and P2 = 0.52. It the posterior probabilities = ilX = = c(k) pe (i) = pe ( i) = k Ie = i) ( 1- i = 1, 2, where c( k) is a. chooses the e = i that has the largest posterior probabili ty. Because = Pe (2) = 1/2 in this example, the MAP rule chooses the hypothesis e = i for which p� (1 _pdn- k is The rule is to e = 1 if k :5 k\"' , where k'* = and to e = 2 otherwise. is yo\" \"\"',, .... o. it is by a observation space into the two disjoi nt sets in which each of the two hypot heses is error is obtained by using the total probability (8 = 1 , > ) + P(8 = X::; ) = pe ( l ) k= k\"' +l 8 is a constant . of error for a threshold- ty pe of decision rule, as a function of the threshold k- . The MAP rule , which in current example C01�re�So()n(lS ,;-ta,,.,. .. ,,,, . ...... .... , and Threshold 8.6. A of the of error for a of decision rule that e = 1 if Ie � k\" and as a of the threshold k 'll' (cf. Example 8.9) . The problem data here are n = 50 , P i = and P2 = 0.52. the same as in 8.5. The threshold of the rule is k- = and minimizes probability of error. The following is a classical example from communication 'V .... , ... ... .. 'V'V .. [respec tively, (b1 , • .• I bn )] . We assume that the two candidate signals In is a \"energy,!l , ai + . .. + + ... + b� . The receiver observes transmitted , but by More it obtains the i = 1, . .. ,n , where we assume that the Wi are standard normal random variables! indepe ndent of inde pendent the Sec. 8.2 Point Estimation, Hypothesis Testing, and the MAP Rule 429 Under the hypothesis e = 1, the Xi are independent normal random vari­ ables, with mean ai and unit variance. Thus, Similarly, From Bayes' rule, the probability that the first message was transmitted is After expanding the squared terms and using the assumption ai + ... + a� bi + . .. + b� , this expression simplifies to The formula for p(e = 21 X = x) is similar, with the ai in the numerator replaced by b •. According to the MAP rule, we should choose the hypothesis with maximum posterior probability, which yields: select e = 1 if select e = 2 if n n L aiXi > L biXi, i= l i=l n n L aiXi < L b.Xi. i=l i= l (If the inner products above are equal, either hypothesis may be selected.) This particular structure for deciding which signal was transmitted is called a matched filter: we \"match\" the received signal (Xl , .. . , xn ) with each of the two candidate signals by forming the inner products L�= l aiXi and L�= l biXi; we then select the hypothesis that yields the higher value (the \"best match\" ). This example can be generalized to the case of m > 2 equally likely messages. We assume that for message k, the transmitter sends a fixed signal (af , ... , a�) , where (af)2 + ... + (a�) 2 is the same for all k. Then, under the same noise model, a similar calculation shows that the MAP rule decodes a received signal (Xl , ... , Xn ) as the message k for which L�=l afx. is largest. 430 LEAST MEAN ESTIMATION we in more detail the cond itional 'O' ...,. ''' ,''''' .. �..,�VA'V' .... 8 we show that it resul ts in the least possible mean squared error (hence mean some of its ot her properties. We by ,..A'ri C 1\"-1 mean of '-'''-' '''''6 '''' . ..... '' ..... /->\\ e w ith a con- estimation efror is random errOf [(9 - 8)2] is a ........... \".,L'-''-' .. IJ\"' ............. on and can minimized over (). this criterion , it turns out that the best possible estimate is to set {} equal to E[e] , as we proceed to [(9 - we + uses = var( Z) + (E[ Z]) 21 2 holds because when the constant iJ is subtracted froln the random variable 9, the by to {} = E[8] Fig. 8.7) . 8.7: The mean squared error E [(9 - 1 as a function of the estimate 8, is a in 8, and is minimized when 8 = . The minimum value of the mean error is var(e) . •• \"\"' ..... .-..L�\"\"' now that we use an observation we know the error Sec. 8.3 Bayesian Least Mean Squares Estimation 431 Generally, the (unconditional) mean squared estimation error associated with an estimator g(X) is defined as If we view E[8 1 X] as an estimator/function of X, the preceding analysis shows that out of all possible estimators, the mean squared estimation error is mini­ mized when g(X) = E[8 1 X] .t Key Facts About Least Mean Squares Estimation Thus, • In the absence of any observations, E[(8 - 0)2] is minimized when 0= E[8] : � for all (). • For any given value x of X, E[(8 - 0)2 1 X = x] is minimized when 0=E[8IX =x]: E [(8 - E[8 I X=xj) 2 1 X=x] <E [(8 -0)2 IX =x], for all O. • Out of all estimators g(X) of 8 based on X, the mean squared esti­ mation error E [ (8 - g(X)) 2] is minimized when g(X) = E[e I X] : for all estimators g(X). t For any given value x of X, g(x) is a number, and therefore, which is now an inequality between random variables (functions of X). We take ex­ pectations of both sides, and use the law of iterated expectations, to conclude that for all estimators g(X). 8 be uniformly distributed over the interval [4, 10] and suppose we assume independent of e. some error W. we I\"'\\he,., .. -\" o x = + W is uniformly over 1. 1) and E[e I , we note i f 4 ::; e ::; 10, (8) = Cond itioned on to some 8, is same as 8 + W, and is uniformly dist ributed over the interval [8 - 1: 8 + 11 . Thus, the joint PDF is by (O, X) = !e (8)/x I9 1 1 1 = = 6 2 if 4 ::; () ::; 10 and () - 1 ::; x ::; e + I, and is zero for an other values of (() , x) . The parallelogram in the right-hand side of is the set of wh ich fa, x (0, is nonzero. e e 8.8: The PDFs in PDF of e and X is uniform over the shown on the the val ue x of the random variable X = e + W, depends on x and is represented by the linear function shown on the right . Given that X = x, the posterior PDF fe lx to a ..... . � ..... .,,\".H .. :' '''' val ue x of X 1 the mean fu nction of error , defined as = x] . is the It is a of x, in wh ich Juliet is late on the first date by a random amou nt X that is uniformly distributed over the interval [0, 8j . Here , is an unknown a over [0, 1] . that we saw that the MAP is equal to x and that the Sec. Least Mean Sq uares Estinl ation 1 3 8.9: The conditional mean error in 8. 11, as a function of the observed va.lue x of X. Note that certain values of the observation are more if X = 3, we are certain that 9 = 4, and the cond itional mean ........ \"' ......... ........ IS E[9jX = I -x xl dO = I xl ' Let us calculate the cond itional mean error for MAP LMS estimates. Given X = x, for any iJ, we have '\" 2 '\" 2 I 11 [(8 - 8) I X = x] = x (8 - 8) . fJl log xl d8 = [({P - 2 1 + 8 ) , 8 1 log x l dO = - iJ --.;...----.;.. + --- the MAP estimate , () = X, t he conditional mean error is = + ---:------:-- mean 1- 21 log xl ( )2 I- x log x conditional mean errors of two are error is Fig. 8. 10, as functions of x. and it can be seen that the LMS estimator uni- smaller mean squared error. This is a manifestation of the general optimality ...... \"\"r' .......... ..... .. of we 434 o - o 0.1 Bayesian Statistical Inference Estimates 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 Mean Squared Error 0.2 r---....,..--,---r--�--,-------r-----,;----r----.-----, 0.15 f 0.1 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 x Chap. 8 Figure 8. 10. MAP and LMS estimates, and their conditional mean squared errors as functions of the observation x in Example 8. 12. Example 8. 13. We consider the model in Example 8.8, where we observe the number X of heads in n independent tosses of a biased coin. We assume that the prior distribution of 8, the probability of heads, is uniform over [0, 1]. In that example, we saw that when X = k, the posterior density is beta with parameters Q = k + 1 and {3 = n - k + 1, and that the MAP estimate is equal to kin. By using the formula for the moments of the beta density (d. Example 8.4) , we have E[8Tfl I X =k] = (k + l)(k +2) ·· · (k + m) , (n + 2)(n + 3) ·· · (n + m + 1) and in particular, the LMS estimate is E[8 1 X = k] = k + 1 . n+2 Given X = k, the conditional mean squared error for any estimate {j is E [({j - 8)21 X = k] = {j2 - 2{j E [8 1 X = k] + E [821 X = k] = {j2 _ 2{j k+ 1 + (k + l)(k +2) . n+2 (n + 2) (n +3) The conditional mean squared error of the MAP estimate is E[(O - S)2 1 X=k] =E [(� - Sr I X=k] _ � 2 _ 2 � . k + 1 + (k + l)(k + 2) n n n+2 (n + 2)(n+3)\" Sec. 8.3 Bayesian Least Mean Squares Estimation The conditional mean squared error of the LMS estimate is E[(t� - e)2 1 X= k] =E[S2 IX=k] - (E[SI X=kJ) 2 = (k + 1)(k +2) _ ( k+ 1 ) 2 (n + 2)(n + 3) n+2 435 The results are plotted in Fig. 8.11 for the case of n = 15 tosses. Note that, as in the preceding example, the LMS estimate has a uniformly smaller conditional mean squared error. Estimates 0.8 MAP Estimates - - - LMS Estimates 0.6 0.4 0.2 0 0 5 10 15 k Mean Squared Errors 0.01 5 0.01 /' /' \"- 0.005 \"- \"- 0 0 5 10 15 k Figure 8.11. MAP and LMS estimates, and corresponding conditional mean squared errors as functions of the observed number of heads k in n = 15 tosses (cf. Example 8. 13). Some Properties of the Estimation Error Let us use the notation e = E[9 IXj, for the LMS estimator and the associated estimation error, respectively. The random variables e and e have a number of useful properties, which were derived in Section 4.3 and for easy reference are repeated below. (Note the change in notation: while in Section 4.3, the observation was denoted by Y and the estimated parameter was denoted by X, here they are denoted by X and 9, respectively. ) 436 Bayesian Statistical Inference Chap. 8 Properties of the Estimation Error • The estimation error 8 is unbiased, I.e. , it has zero unconditional and conditional mean: E[e] =0, E[e I X = x] = 0, for all x. • The estimation error e is uncorrelated with the estimate 8: coV(8, e) = 0. • The variance of 8 can be decomposed as var(8) = var(8) + var(e) . Example 8. 14. Let us say that the observation X is uninformative if the mean squared estimation error E[82] = var(8) is the same as var(e). the unconditional variance of e. When is this the case? Using the formula var(e) = var(8) + var(8), we see that X is uninformative if and only if var (e) = O. The variance of a random variable is zero if and only if that random variable is a constant, equal to its mean. We conclude that X is uninformative if and only if the estimate e = E[e I X] is equal to E[e] , for every value of X. If e and X are independent, we have E[e I X = x] = E[e] for all x, and X is indeed uninformative, which is quite intuitive. The converse, however, is not true: it is possible for E[e I X = x] to be always equal to the constant E[e] , without e and X being independent. (Can you construct an example?) The Case of Multiple Observations and Multiple Parameters The preceding discussion was phrased as if X were a single random variable. However, the entire argument and its conclusions apply even if X is a vector of random variables, X = (Xl , ... , Xn). Thus, the mean squared estimation error is minimized if we use E[8 I Xl .. .. ,Xn] as our estimator, i.e. , for all estimators g(XI , ... , Xn). This provides a complete solution to the general problem of LMS estima­ tion, but is often difficult to implement, for the following reasons: Sec. 8.4 Bayesian Linear Least Mean Squares Estimation 437 (a) In order to compute the conditional expectation E[8 I Xl ,\" \" Xn], we need a complete probabilistic model, that is, the joint PDF fe.xl,\" \"Xn, (b) Even if this joint PDF is available, E[8 I Xl , ... , Xnl can be a very com- plicated function of Xl , ... , X n . As a consequence, practitioners often resort to approximations of the conditional expectation or focus on estimators that are not optimal but are simple and easy to implement. The most common approach, discussed in the next section, involves a restriction to linear estimators. Finally, let us consider the case where we want to estimate multiple pa­ rameters 81 , .. . ,8m. It is then natural to consider the criterion and minimize it over all estimators 81 , . .. , 8m . But this is equivalent to find­ ing, for each i, an estimator 8i that minimizes E[(8i - 8i)2], so that we are essentially dealing with m decoupled estimation problems, one for each unknown parameter 8i , yielding 8i = E [8i I Xl , ... , Xn], for all i. 8.4 BAYESIAN LINEAR LEAST MEAN SQUARES ESTIMATION In this section, we derive an estimator that minimizes the mean squared error within a restricted class of estimators: those that are linear functions of the observations. While this estimator may result in higher mean squared error, it has a significant practical advantage: it requires simple calculations, involving only means, variances. and covariances of the parameters and observations. It is thus a useful alternative to the conditional expectation/LMS estimator in cases where the latter is hard to compute. A linear estimator of a random variable 8, based on observations Xl , ... , X n. has the form Given a particular choice of the scalars aI , ... ,an, b, the corresponding mean sq uared error is The linear LMS estimator chooses aI , ... , an , b to minimize the above expression. We first develop the solution for the case where n = 1, and then generalize. Linear Least Mean Squares Estimation Based on a Single Observation We are interested in finding a and b that minimize the mean squared estimation error E[(8 - aX - b)2] associated with a linear estimator aX + b of 8. Suppose that a has already been chosen. How should we choose b? This is the same as 438 Bayesian Statistical Inference Chap. 8 choosing a constant b to estimate the random variable 8 - aX. By the discussion in the beginning of Section 8.3, the best choice is b = E[8 - aX] = E[8] - aE[X] . With this choice of b, it remains to minimize, with respect to a, the expression E [ (8 - aX - E[8] + aE[X]) 2] . We write this expression as var(8 - aX) = a� + a2a� + 2cov(8, -aX) = a� + a2a� - 2a · cov(8, X), where ae and a x are the standard deviations of 8 and X, respectively, and cov(8,X) = E [(8 - E[8]) (X - E[X])] is the covariance of 8 and X. To minimize var(8 - aX) (a quadratic function of a), we set its derivative to zero and solve for a. This yields where cov(8, X) paeax ae a = a2 - a2 = p- , x x ax cov(8, X) p= ---­ aeax is the correlation coefficient. With this choice of a, the mean squared estimation error of the resulting linear estimator 8 is given by var(8 - 8) = a� + a2a� - 2a . cov(8, X) a2 ae = a� + p2 � a� - 2p-paea x ax ax = (1 - p2)a� . Linear LMS Estimation Formulas • The linear LMS estimator 8 of 8 based on X is 8 = E[8] + cov(8, X) (X - E[X]) = E[8] + P ae (X - E[X]) , var(X) ax where cov(8, X) p= aeax is the correlation coefficient. • The resulting mean squared estimation error is equal to Sec. 8.4 Bayesian Linear Least Mean Squares Estimation 439 The formula for the linear LMS estimator only involves the means, vari­ ances, and covariance of 8 and X. Furthermore, it has an intuitive interpreta­ tion. Suppose, for concreteness, that the correlation coefficient p is positive. The estimator starts with the baseline estimate E[8] for 8, which it then adjusts by taking into account the value of X - E[X]. For example, when X is larger than its mean, the positive correlation between X and 8 suggests that 8 is expected to be larger than its mean. Accordingly, the resulting estimate is set to a value larger than E[8]. The value of p also affects the quality of the estimate. When Ipi is close to 1, the two random variables are highly correlated, and knowing X allows us to accurately estimate 8, resulting in a small mean squared error. We finally note that the properties of the estimation error presented in Section 8.3 can be shown to hold when 8 is the linear LMS estimator; see the end-of-chapter problems. Example 8.15. We revisit the model in Examples 8.2, 8.7, and 8. 12, in which Juliet is always late by an amount X that is uniformly distributed over the interval [0, e] , and 8 is a random variable with a uniform prior PDF Ie (0) over the interval [0, 1] . Let us derive the linear LMS estimator of e based on X. Using the fact that E[X 18] = e /2 and the law of iterated expectations, the expected value of X is E[X] = E[E[X I eJ] = E [�] = E� e] = �. Furthermore, using the law of total variance (this is the same calculation as in Example 4.17 of Chapter 4), we have 7 var(X) = 144 ' We now find the covariance of X and 8, using the formula and the fact We have cov(e, X) = E[eX] - E[e] E[X] , 2 ()2 1 1 1 E[e ] = var(8) + E[8] = 12 + 4 = 3' E[eX] � E [E[eX I ell � E [eE[X I ell � E [�2l = �, where the first equality follows from the law of iterated expectations, and the second equality holds since for all 0, E[eX Ie = 0] = E[OX I e = 0] = OE[X Ie = 0] . 440 Thus, Bayesian Statistical Inference 1 1 1 1 cov(8, X) = E[eX] - E[e] E[X] = - - - . - = - . 6 2 4 24 The linear LMS estimator is e = E[e] cov(e, X) (X - E[X]) = ! 1/24 (X - !) = �X � . + var(X) 2 + 7/144 4 7 + 7 Chap. 8 The corresponding conditional mean squared error is calculated using the formula derived in Example 8. 12, and substituting the expression just derived, {} = (6/7) x + (2/7). In Fig. 8. 12, we compare the linear LMS estimator with the MAP estimator and the LMS estimator (cf. Examples 8.2, 8.7, and 8.12). Note that the LMS and linear LMS estimators are nearly identical for much of the region of interest, and so are the corresponding conditional mean squared errors. The MAP estimator has significantly larger mean squared error than the other two estimators. For x close to 1, the linear LMS estimator performs worse than the other two estimators, and indeed may give an estimate {} > 1, which is outside the range of possible values of e. Estimates 1.5 - - MAP Estimates + LMS Estimates Linear LMS Estimates �� - - 0.5 o o - - 0.1 0.2 -- 0.3 ------- 0.4 0.5 0.6 Mean Squared Error � ----- 0.7 0.8 0.9 0.2�--�----�---r----r---�----�--�----�--�--� 0.15 I 0.1 0.05 0.1 0.2 0.3 0.4 0.5 x 0.6 0.7 0.8 0.9 Figure 8.12. Three estimators and their mean squared errors, as functions of the observed value x. for the problem in Example 8. 15. Sec. 8.4 Bayesian Linear Least Mean Squares Estimation 441 Example 8.16. Linear LMS Estimation of the Bias of a Coin. We revisit the coin tossing problem of Examples 8.4, 8.8, and 8. 13, and derive the linear LMS estimator. Here, the probability of heads of the coin is modeled as a random variable e whose prior distribution is uniform over the interval [0, 1] . The coin is tossed n times, independently, resulting in a random number of heads, denoted by X. Thus, if e is equal to 0, the random variable X has a binomial distribution with parameters n and O. We calculate the various coefficients that appear in the formula for the linear LMS estimator. We have E[e] = 1/2, and E[X] = E[E[X I en = E[ne] = %. The variance of e is 1/12, so that ue = 1/v'I2. Also, as calculated in the previous example, E[e2] = 1/3. If 9 takes the value 0, the (conditional) variance of X is nO(1 - 0). Using the law of total variance, we obtain var(X) = E[var(X 19)] + var(E[X 19]) =E [ne(l -e)] + var(n9) n n n2 = 2\" -\"3 + 12 n(n + 2) 12 In order to find the covariance of X and e, we use the formula n cov(9, X) = E[eX] - E[e] E[X] = E[eX] - 4. Similar to Example 8. 15, we have so that n n n cov(9 X) = - - - = -, 3 4 12 · Putting everything together, we conclude that the linear LMS estimator takes the form Notice that this agrees with the LMS estimator that we derived in Example 8.13. This should not be a surprise: if the LMS estimator turns out to be linear, as was the case in Example 8. 13, then that estimator is also optimal within the smaller class of linear estimators. 442 Bayesian Statistical Inference Chap. 8 The Case of Multiple Observations and Multiple Parameters The linear LMS methodology extends to the case of multiple observations. There is an analogous formula for the linear LMS estimator, derived in a similar man­ ner. It involves only means, variances, and covariances between various pairs of random variables. Also, if there are multiple parameters 8i to be estimated, we may consider the criterion and minimize it over all estimators 81 , . . . ,8m that are linear functions of the observations. This is equivalent to finding, for each i, a linear estimator 8i that minimizes E[(8i - 8i)2] , so that we are essentially dealing with m decoupled linear estimation problems, one for each unknown parameter. In the case where there are multiple observations with a certain indepen­ dence property, the formula for the linear LMS estimator simplifies as we will now describe. Let 8 be a random variable with mean J.l and variance a5, and let Xl ,\" \" Xn be observations of the form where the Wi are random variables with mean 0 and variance a; . which rep­ resent observation errors. Under the assumption that the random variables 8, WI , ... , Wn are uncorrelated, the linear LMS estimator of 8, based on the observations Xl , ... , Xn , turns out to be n J.l/a6 + LXi/a; 8 = i=l n L1/a; i=O The derivation involves forming the function and minimizing it by setting to zero its partial derivatives with respect to al , ... , an , b. After some calculation (given in the end-of-chapter problems) , this results in b = J.l/a6 n , L1/a; i=O l/aJ aj = n j = 1, .. . ,n, L1 /a; i=O from which the formula for the linear LMS estimator given earlier follows. Sec. 8.4 Bayesian Linear Least Mean Squares Estimation 443 Linear Estimation and Normal Models The linear LMS estimator is generally different from and, therefore, inferior to the LMS estimator E[8 1 Xl , . . . , Xn]. However, if the LMS estimator happens to be linear in the observations Xl , ... ,Xn, then it is also the linear LMS estimator, i.e.� the two estimators coincide. An important example where this occurs is the estimation of a normal ran­ dom variable 8 on the basis of observations Xi = 8 + Wi , where the Wi are independent zero mean normal noise terms, independent of 8. This is the same model as in Example 8.3, where we saw that the posterior distribution of 8 is normal and that the conditional mean is a linear function of the observations. Thus, the LMS and the linear LMS estimators coincide. Indeed, the formula for the linear LMS estimator given in this section is consistent with the expression for the posterior mean {j in Example 8.3 (the notation J.l here corresponds to Xo in Example 8.3). This is a manifestation of a property that can be shown to hold more generally: if 8, X I, ... ,Xn are all linear functions of a collection of independent normal random variables, then the LMS and the linear LMS esti­ mators coincide. They also coincide with the MAP estimator, since the normal distribution is symmetric and unimodal. The above discussion leads to an interesting interpretation of linear LMS estimation: the estimator is the same as the one that would have been obtained if we were to pretend that the random variables involved were normal, with the given means, variances, and covariances. Thus, there are two alternative perspectives on linear LMS estimation: either as a computational shortcut (avoid the evaluation of a possibly complicated formula for E[8 1 Xj ), or as a model simplification (replace less tractable distributions by normal ones) . The Choice of Variables in Linear Estimation Let us point out an important difference between LMS and linear LMS estima­ tion. Consider an unknown random variable 8, observations Xl , .'\" Xn , and transformed observations Yi = h(Xi), i = 1, . . . , n, where the function h is one­ to-one. The transformed observations Yi convey the same information as the original observations Xi, and therefore the LMS estimator based on YI , . .. , Yn is the same as the one based on X I , .. . , X n: E [81 h(XI ), . . . , h(Xn )] = E[8 1 Xl , . . . , Xn]. On the other hand, linear LMS estimation is based on the premise that the class of linear functions of the observations X I, . . . ,Xn contains reasonably good estimators of 8; this may not always be the case. For example, suppose that 8 is the unknown variance of some distribution and X I, ... ,Xn represent independent random variables drawn from that distribution. Then, it would be unreasonable to expect that a good estimator of 8 can be obtained with a linear function of Xl , ... ,Xn. This suggests that it may be helpful to transform the 444 Bayesian Statistical Inference Chap. 8 observations so that good estimators of e can be found within the class of linear functions of the transformed observations. Suitable transformations may not always be obvious, but intuition into the structure of the given problem, may suggest some good choices: see Problem 17 for a simple example. 8.S SUMMARY AND DISCUSSION We have introduced statistical inference methods that aim to extract information about unknown variables or models from probabilistically related observations. We have focused on the ca.'le where the unknown is a (possibly multidimensional) parameter () � and we have discussed hypothesis testing and estimation problems. We have drawn a distinction between the Bayesian and classical inference approaches. In this chapter 1 we have discussed Bayesian methods, which treat the parameter as a random variable e with known prior distribution. The key object of interest here is the posterior distribution of e given the observations. The posterior can in principle be calculated using Bayes' rule. although in prac­ tice, this may be difficult. The MAP rule. which maximizes the posterior over (). is a general inference method that can address both estimation and hypothesis testing problems. We discussed two other methods for parameter estimation: the LMS (or conditional expectation) estimator and the linear LMS estimator, both of which are based on minimization of the mean squared error between e and its estimate. The latter estimator results in higher mean squared error. but requires simple calcu­ lations, involving only means. variances. and covariances of the parameters and observations. Under normality assumptions on the parameter and observations, the MAP and the two L,£\\18 estimators coincide. Sec. 8.5 Problems 445 PROBL EMS SECTION 8. 1. Bayesian Inference and the Posterior Distribution Problem 1. Artemisia moves to a new house and she is \"fifty-percent sure\" that the phone number is 2537267. To verify this. she uses the house phone to dial 2537267. she obtains a busy signal. and concludes that this is indeed the correct number. Assuming that the probability of a typical seven-digit phone number being busy at any given time is 1 <ft. what is the probability that Artemisia's conclusion was correct? Problem 2. Nefeli. a student in a probability class. takes a multiple-choice test with 10 questions and 3 choices per question. For each question. there are two equally likely possibilities, independent of other questions: either she knows the answer, in which case she answers the question correctly. or else she guesses the answer with probability of success 1/3. (a) Given that Nefeli answered correctly the first question, what is the probability that she knew the answer to that question? (b) Given that Nefeli answered correctly 6 out of the 10 questions, what is the pos­ terior PMF of the number of questions of which she knew the answer? SECTION 8.2. Point Estimation, Hypothesis Testing, and the MAP Rule Problem 3. The number of minutes between successive bus arrivals at Alvin's bus stop is exponentially distributed with parameter e, and Alvin's prior PDF of e is !e (O) = { 100. O. if 0 E [0. 1/5]' otherwise. (a) Alvin arrives on Monday at the bus stop and has to wait 30 minutes for the bus to arrive. What is the posterior PDF. and the �IAP and conditional expectation estimates of E>? (b) Following his Monday experience. Alvin decides to estimate e more accurately. and records his waiting times for five days. These are 30. 25. 15. 40. and 20 minutes, and Alvin assumes that his observations are independent . What is the posterior PDF, and the MAP and conditional expectation estimates of e given the five-day data? Problem 4. Students in a probability class take a multiple-choice test with 10 questions and 3 choices per question. A student who knows the answer to a question will answer it correctly, while a student that does not will guess the answer with probability of success 1/3. Each student is equally likely to belong to one of three categories 446 Bayesian Statistical Inference Chap. 8 i = 1, 2, 3: those who know the answer to each question with corresponding probabilities Oi, where 01 = 0.3, 02 = 0.7, and 03 = 0.95 (independent of other questions) . Suppose that a randomly chosen student answers k questions correctly. (a) For each possible value of k, derive the MAP estimate of the category that this student belongs to. (b) Let M be the number of questions that the student knows how to answer. Derive the posterior PMF, and the MAP and LMS estimates of M given that the student answered correctly 5 questions. Problem 5. Consider a variation of the biased coin problem in Example 8.4, and assume the probability of heads, e, is distributed over [0, 1] according to the PDF !e (O) = 2 - 4 1 � - 01 , o E [0,1] . Find the MAP estimate of e, assuming that n independent coin tosses resulted in k heads and n - k tails. Problem 6. Professor May B. Hard, who has a tendency to give difficult problems in probability quizzes, is concerned about one of the problems she has prepared for an upcoming quiz. She therefore asks her TA to solve the problem and record the solution time. May's prior probability that the problem is difficult is 0.3, and she knows from experience that the conditional PDF of her TA 's solution time X, in minutes, is { c e - O.04x !Tle (x I e = 1) = 01 , if 8 = 1 (problem is difficult), and is if 5 � x � 60, otherwise, { c e -O. 16x if 5 � x � 60, !Tle (x I e = 2) = 0 2 ' otherwise, if e = 2 (problem is not difficult) , where Cl and C2 are normalizing constants. She uses the MAP rule to decide whether the problem is difficult. (a) Given that the TA's solution time was 20 minutes, which hypothesis will she accept and what will be the probability of error? (b) Not satisfied with the reliability of her decision, May asks four more TAs to solve the problem. The TAs' solution times are conditionally independent and iden­ tically distributed with the solution time of the first TA. The recorded solution times are 10, 25, 15, and 35 minutes. On the basis of the five observations, which hypothesis will she now accept, and what will be the probability of error? Problem 7. We have two boxes, each containing three balls: one black and two white in box 1; two black and one white in box 2. We choose one of the boxes at random, where the probability of choosing box 1 is equal to some given p, and then draw a ball. (a) Describe the MAP rule for deciding the identity of the box based on whether the drawn ball is black or white. Sec. 8. 5 Problems 447 (b) Assuming that p = 1/2, find the probability of an incorrect decision and compare it with the probability of error if no ball had been drawn. Problem 8. The probability of heads of a given coin is known to be either qo (hypothesis Ho) or ql (hypothesis HI ). We toss the coin repeatedly and independently, and record the number of heads before a tail is observed for the first time. We assume that 0 < qo < ql < 1, and that we are given prior probabilities P(Ho) and P(HI). For parts (a) and (b) , we also assume that P(Ho) = P(HI ) = 1/2. (a) Calculate the probability that hypothesis HI is true, given that there were exactly k heads before the first tail. (b) Consider the decision rule that decides in favor of hypothesis HI if k � k* , where k* is some nonnegative integer, and decides in favor of hypothesis Ho otherwise. Give a formula for the probability of error in terms of k* , qo, and ql . For what value of k* is the probability of error minimized? Is there another type of decision rule that would lead to an even lower probability of error? (c) Assume that qo = 0.3, ql = 0.7, and P(HI) > 0.7. How does the optimal choice of k* (the one that minimizes the probability of error) change as P(HI ) increases from 0.7 to 1.0? Problem 9. * Consider a Bayesian hypothesis testing problem involving m hypothe­ ses, and an observation vector X = (X I, ... , X n). Let gn (X I, ... , X n) be the decision resulting from the MAP rule based on Xl , ... , Xn , and gn-l (Xl ,' .. , Xn- d the deci­ sion resulting from the MAP rule based on Xl , ... , Xn- l (i.e. , the MAP rule that uses only the first n - 1 components of the observation vector). Let x = (Xl , . . . , Xn ) be the realized value of the observation vector, and let en(XI , . .. ,Xn) = P(8 ¥- gn (XI , ... ,Xn) I Xl = Xl , . .. , Xn = Xn), en- I(XI , ... , Xn-d =P (8¥-gn-I(XI , ... ,xn-d I Xl =XI , ... ,Xn-1 = Xn-l ), be the corresponding probabilities of error. Show that so making the MAP decision with extra data cannot increase the probability of error. Solution. We view gn-l (Xl , ... , Xn-d as a special case of a decision rule based on all components Xl , ... , Xn of the observation vector. Since the MAP rule gn (XI , ... , Xn ) minimizes the probability of error over all decision rules based on X I, ... , X n, the result follows. SECTION 8.3. Bayesian Least Mean Squares Estimation Problem 10. A police radar always overestimates the speed of incoming cars by an amount that is uniformly distributed between 0 and 5 miles/hour. Assume that car speeds are uniformly distributed between 55 and 75 miles/hour. What is the LMS estimate of a car's speed based on the radar's measurement? Problem 11. The number 8 of shopping carts in a store is uniformly distributed between 1 and 100. Carts are sequentially numbered between 1 and 8. You enter 448 Bayesian Statistical Inference Chap. 8 the store, observe the number X on the first cart you encounter, assumed uniformly distributed over the range 1, ... ,8, and use this information to estimate 8. Find and plot the MAP estimator and the LMS estimator. Hint: Note the resemblance with Example 8.2. Problem 12. Consider the multiple observation variant of Example 8.2: given that 8 = 8, the random variables Xl , ... , Xn are independent and uniformly distributed on the interval [0,8], and the prior distribution of 8 is uniform on the interval [0, 1]. Assume that n > 3. (a) Find the LMS estimate of 8, given the values X l , ..• ,xn of XI , ... , Xn . (b) Plot the conditional mean squared error of the MAP and LMS estimators, as functions of x = max{xI, ... , xn}, for the case n = 5. (c) If x is held fixed at x = 0.5, how do the MAP and the LMS estimates, and the corresponding conditional mean squared errors behave as n - oo? Problem 13.* (a) Let Y1 , ••• , Yn be independent identically distributed random variables and let Y = E + ... + Yn . Show that Y E[Yl l Y] = -. n (b) Let a and W be independent zero-mean normal random variables, with posi­ tive integer variances k and m, respectively. Use the result of part (a) to find E[a I a + W], and verify that this agrees with the conditional expectation for­ mula in Example 8.3. Hint: Think of 8 and W as sums of independent random variables. (c) Repeat part (b) for the case where e and W are independent Poisson random variables with integer means ..x and IL, respectively. Solution. (a) By symmetry, we see that E[Yi I Y] is the same for all i. Furthermore, E[Y} + ... + Yn I Y] E[Y I Y] = Y. Therefore, E[Yll Y] = Yin. (b) We can think of a and W as sums of independent standard normal random vari­ ables: W=Wl+ \" ' + Wm , We identify Y with a + W and use the result from part (a) , to obtain Thus, 8+W E[8d e + W] = k . +m k E[e I e + W] = E[e} + ... + ek Ie + W] = k (8 + W). +m Sec. 8.5 Problems 449 The formula for the conditional mean derived in Example 8.3, specialized to the current context (zero prior mean and a single measurement) shows that the conditional expectation is of the form consistent with the answer obtained here. (c) We recall that the sum of independent Poisson random variables is Poisson. Thus the argument in part (b) goes through, by thinking of 8 and W as sums of A (respec­ tively, J.t) independent Poisson random variables with mean one. We then obtain E[818 + W] = SECTION 8.4. Bayesian Linear Least Mean Squares Estimation Problem 14. Consider the random variables e and X in Example 8. 11. Find the linear LMS estimator of 8 based on X, and the associated mean squared error. Problem 15. For the model in the shopping cart problem (Problem 11), derive and plot the conditional mean squared error, as a function of the number on the observed cart, for the MAP, LMS, and linear LMS estimators. Problem 16. The joint PDF of random variables X and e is of the form /x,e (x,O) = {OC\" if (x, O) E S, otherwise, where c is a constant and S is the set S = {(x, O) I 0 � x � 2, 0 � 0 � 2, x-I � 0 � x}. We want to estimate e based on X. (a) Find the LMS estimator g(X) of e. (b) Calculate E [(e - g(X»2 1 X = x] , E [g(X)] , and var(g(X» . (c) Calculate the mean squared error E [(e-g(X» 2]. Is it the same as E [var(e I X)]? (d) Calculate var(8) using the law of total variance. (e) Derive the linear LMS estimator of e based on X, and calculate its mean squared error. Problem 17. Let e be a positive random variable, with known mean J..L and variance (12, to be estimated on the basis of a measurement X of the form X = v'8 W. We assume that W is independent of e with zero mean, unit variance, and known fourth moment E[W4]. Thus, the conditional mean and variance of X given e are 0 and 450 Bayesian Statistical Inference Chap. 8 8, respectively, so we are essentially trying to estimate the variance of X given an observed value. Find the linear LMS estimator of e based on X, and the linear LMS estimator of 8 based on X2. Problem 18. Swallowed Buft'on's needle. A doctor is treating a patient who has accidentally swallowed a needle. The key factor in whether to operate on the patient is the length e of the needle, which is unknown, but is assumed to be uniformly distributed between 0 and I > O. We wish to form an estimate of 8 based on X, its projected length in an X-ray. We introduce a two-dimensional coordinate system and write X = ecos w, where W is the acute angle formed by the needle and one of the axes. We assume that W is uniformly distributed in the interval [0, 7r /2] ' and is independent from e. (a) Find the LMS estimator E[e I Xl . In particular, derive FXle (x I 0) , fXle(x I 0) , fx ( x) , felx (O I x) , and then compute E[e I X = xl . Hint: You may find the following integration formulas useful: I b 1 do. = log (a. + vi 0.2 _ c2) I b , a J0.2 - c2 a I b b a. do. = vi 0.2 - c21 . a J0.2 - c2 a (b) Find the linear LMS estimate of e based on X, and the associated mean squared error. Problem 19. Consider a photodetector in an optical communications system that counts the number of photons arriving during a certain interval. A user conveys infor­ mation by switching a photon transmitter on or off. Assume that the probability of the transmitter being on is p. If the transmitter is on, the number of photons trans­ mitted over the interval of interest is a Poisson random variable e with mean ).. If the transmitter is off, the number of photons transmitted is zero. Unfortunately, regardless of whether or not the transmitter is on or off, photons may still be detected due to a phenomenon called \"shot noise.\" The number N of detected shot noise photons is a Poisson random variable with mean /1. Thus, the total number X of detected photons is equal to e + N if the transmitter is on, and is equal to N otherwise. We assume that N and 8 are independent, so that e + N is also Poisson with mean ). + /1. (a) What is the probability that the transmitter was on, given that the photodetector detected k photons? (c) Describe the MAP rule for deciding whether the transmitter was on. (d) Find the linear LMS estimator of the number of transmitted photons, based on the number of detected photons. Problem 20. * Estimation with spherically invariant PDFs. Let 8 and X be continuous random variables with joint PDF of the form fe.x (0, x) = h( q(O, x)) , where h is a nonnegative scalar function, and q(O, x) is a quadratic function of the form q(O, x) = a(O - 0)2 + b(x - X)2 - 2c(0 - O)(x - x) . Sec. 8.5 Problems 451 Here a, b, c, 8, x are some scalars with a j O. Derive the LMS and linear LMS estimates, for any x such that E[e I X = x] is well-defined and finite. Assuming that q(O, x) � 0 for all x, 0, and that h is monotonically decreasing, derive the MAP estimate and show that it coincides with the LMS and linear LMS estimates. Solution. The posterior is given by I (0 1 ) = fe ,x (O , x) = h(q(O, x)) Je lx x fx (x) fx (x) · To motivate the derivation of the LMS and linear LMS estimates, consider first the MAP estimate, assuming that q(O, x) � 0 for all x, 0, and that h is monotonically decreasing. The MAP estimate maximizes h( q(O, x)) and, since h is a decreasing function, it minimizes q( 0, x) over O. By setting to 0 the derivative of q( 0, x) with respect to 0, we obtain � - c o = 0 + - (x - x) . a (We are using here the fact that a nonnegative quadratic function of one variable is minimized at a point where its derivative is equal to 0.) We will now show that B is equal to the LMS and linear LMS estimates [without the assumption that q(O, x) � 0 for all x, 0, and that h is monotonically decreasing] . We write - � c 0 - 0 = 0 - 0 + -(x - x) , a and substitute in the formula for q(O, x) to obtain after some algebra � 2 C 2 ( 2) q(O, x) =a(O-O) + b - -;;: (x - x) . Thus, for any given x, the posterior is a function of 0 that is symmetric around 8. This implies that B is equal to the conditional mean E[e I X = x] , whenever E[e I X = x] is well-defined and finite. Furthermore, we have - c E[e IX] = 0 + -(X -x). a Since E[e I X] is linear in X, it is also the linear LMS estimator. Problem 21. * Linear LMS estimation based on two observations. Consider three random variables e, X, and Y, with known variances and covariances. Assume that var(X) > 0, var(Y) > 0, and that Ip(X, Y) I =j:. 1. Give a formula for the linear LMS estimator of e based on X and Y, assuming that X and Y are uncorrelated, and also in the general case. Solu tion. We consider a linear estimator of the form e = aX + bY + c and choose a, b, and c to minimize the mean squared error E [(e - aX - bY - C) 2] . Suppose that a and b have already been chosen. Then, c must minimize E [(8 - aX - bY - C) 2] , so c = E[e] - aE[X] - bErYl . 452 Bayesian Statistical Inference Chap. 8 It follows that a and b minimize E [( (8 - E[8]) - a(X - E[X]) - b(Y - E[Y])) 2] . We may thus assume that 8, X, and Y are zero mean, and in the final formula subtract the means. Under this assumption, the mean squared error is equal to E [(8 - aX - by)2] = E[82] + a2E[X2] + b2E[y2] _ 2aE[8X] - 2bE[8Y] + 2abE[XY]. Assume that X and Y are uncorrelated, so that E[XY] = E[X] E[Y] = O. We differentiate the expression for the mean squared error with respect to a and b, and set the derivatives to zero to obtain _ E[8X] _ cov(8, X) a - - , E[X2] var(X) Thus, the linear LMS estimator is b = E[8Y] E[Y2] cov(8, Y) var(Y) . 8 = E[8] + cov(8, X) (X _ E[Xl) + cov(8, Y) (Y - E[Y]). var(X) var(Y) If X and Y are correlated, we similarly set the derivatives of the mean squared er­ ror to zero. We obtain and then solve a system of two linear equations in the unknowns a and b, whose solution is var(Y)cov(8, X) - cov(8, Y)cov(X, Y) a - --����--��--������ - var(X)var(Y) - cov2(X, Y) , b = var(X)cov(8, Y) - cov(8, X)cov(X, Y) . var(X)var(Y) - cov2(X, Y) Note that the assumption Ip(X, Y) I =/:. 1 guarantees that the denominator in the pre­ ceding two equations is nonzero. Problem 22. * Linear LMS estimation based on multiple observations. Let 8 be a random variable with mean J-L and variance a5, and let Xl , ... , Xn be observations of the form Xi =8+Wi, where the observation errors Wi are random variables with mean 0 and variance a;. We assume that the random variables e, WI , ... , Wn are independent. Verify that the linear LMS estimator of e based on X I , .. . , X n is n J-L/a5 + LXi/a; , i=I 8 = -----::----­n L l/a; i=O by minimizing over al , ... , an, b the function Sec. 8. 5 Problems Solution. We will show that the minimizing values of aI, ... ,an. b are b\" = I1la'5 n LIla; i=O \" I/a; aj = n j = 1, ... , n. LIla; i=O 453 To this end, it is sufficient to show that the partial derivatives of h, with respect to aI, ... , an, b, are all equal to 0 when evaluated at ai, ... , a�, b\". (Because the quadratic function h is nonnegative, it can be shown that any point at which its derivatives are zero must be a minimum.) By differentiating h, we obtain oh ob From the expressions for b\" and a;, we see that Using this equality and the facts n b* La: -1 = --. . 11 .=1 E[e] = 11, E[Wi] = 0, it follows that oh ob Using, in addition, the equations E[X, (I1 - 8)] = E[(8 -11 + W. + 11) (11 - 8)] 2 = -ao , E[Xi Wi] = E[(8 + WdWi] = a;, for all i, =0. for all i and j with i =J. j, we obtain oh oa. o \". b\" = E [x; ( « ) 8 + t.a:w. + b-) 1 1 = 0. 454 Bayesian Statistical Inference Chap. 8 where the last equality holds in view of the definitions of ai and b* . Problem 23. * Properties of LMS estimation. Let e and X be two random variables with positive variances. Let e L be the linear LMS estimator of e based on X, and let e L = e L - e be the associated error. Similarly, let e be the LMS estimator E[e I X] of e based on X, and let e = e - e be the associated error. (a) Show that the estimation error Eh satisfies (b) Show that the estimation error e L is uncorrelated with the observation X. (c) Show that the variance of e can be decomposed as var(8) = var(e) + var(8L). (d) Show that the LMS estimation error e is un correlated with any function h(X) of the observation X. (e) Show that e is not necessarily independent from X. (f) Show that the linear LMS estimation error 8 L is not necessarily uncorrelated with every function h(X) of the observation X, and that E[eL I X = x] need not be equal to zero for all x. Solution. (a) We have eL = E[e] + cov(�, X) (X - E[XJ) . ax Taking expectations of both sides, we obtain E[eL] = E[e], or E[eL] = o. (b) Using the formula for eL, we obtain E[(9L - e)x] = E [( E[e] + covS1' X) (X - E[XI)) X - ex 1 = E [E[e] X + covS� X) (X2 - XE[XI) - ex 1 _ cov(e, X)E[X2] cov(e, X) (E[Xl) 2 _ (E[eX] _ E[e] E[Xl) O\"� a� = cov(e, X) (E[�2] _ (E[�J) 2 - 1) ax o\"x = cov( e, X) (�i - 1) =0. The fact E[8LX] = 0 we just established, together with the fact E[8Ll = 0 from part (a), imply that Sec. 8.5 Problems 455 (c) Since COV(8L, X) = 0 and 8L is a linear function of X, we obtain COV(8L, 8L) = O. Thus, var(8) = var(8L - 8L) = var(8L) + var( -8L) + 2cov(8L ' -8L) = var(Eh) + var(8L) - 2cov(8L' 8L) = var(8L) + var(8L ). (d) This is because E[8] = 0 and E[8h(X)] = E[(E[8 I X] - 8) h(X)] = E[E[8 I X]h(X)] - E[8h(X)] = E[E[8h(X) I Xl] E[8h(X)] = E[8h(X)] - E[8h(X)] = 0. (e) Let 8 and X be discrete random variables with joint PMF (0 ) _ { 1/3, for (O, x) = (0, 0), (1,1), (-1, 1), pe.x , x - h' 0, ot erWlse. In this example, we have X = 181, so that X and 8 are not independent. Note that E[8 I X = xl = 0 for all possible values x, so E[8 I Xl = O. Thus, we have 8 = -8. Since 8 and X are not independent, 8 and X are not independent either. (f) Let 8 and X be discrete random variables with joint PMF ( Ll ) { 1/3, for (O, x) = (0, 0), (1, 1) , (1, -1), pe,x v, x = . 0, otherwlse. In this example, we have 8 = IXI. Note that E[X] = 0 and E[8Xl = 0, so that X and 8 are uncorrelated. We have 8L = E[8] = 2/3, and 8L = (2/3) - 8 = (2/3) - lXI, which is not independent from X. Furthermore, we have E[8L I X = xl = (2/3) - lxi , which takes the different values 2/3 and -1/3, depending on whether x = 0 or Ixl = 1. Problem 24. * Properties of linear LMS estimation based on multiple obser­ vations. Let 8, Xl , ... , Xn be random variables with given variances and covariances. Let 8L be the linear LMS estimator of 8 based on Xl , ... , Xn, and let 8L = 8L - 8 be the associated error. Show that E[8Ll = 0 and that Eh is uncorrelated with Xi for every i. Solution. We start by showing that E[8LXi] = 0, for 'all i. Consider a new linear estimator of the form 8L +aX1, where a is a scalar parameter. Since 8L is a linear LMS estimator, its mean squared error E [ (8 L - e) 2] is no larger than the mean squared error h(a) = E[(8L + aXi - 8)2] of the new estimator. Therefore, the function heel) attains its minimum value when a = 0, and (dh/da:)(O) = O. Note that h(a) = E (8L + aXd = E[8Ll + aE[8LX1l + a E[Xi l. [ - 2] - 2 - 2 2 The condition (dh/da)(O) = 0 yields E[8LXi] O. Let us now repeat the above argument, but with the constant 1 replacing the random variable Xi. Following the same steps, we obtain E[8Ll = O. Finally, note that cov(Eh , Xd = E[8LXi] - E[8L] E[X1J = 0 - O· E[X1] = 0, so that 8 L and X1 are uncorrelated. 9 Classical Statistical Inference Contents 9.1. Classical Parameter Estimation . 9.2. Linear Regression . . . . 9.3. Binary Hypothesis Testing 9.4. Significance Testing . . . 9.5. Summary and Discussion Problems ....... . · p. 460 · p. 475 · p. 485 · p. 495 · p. 506 · p. 507 457 458 9 our contrast , in losophy: we view unknown unknown quantity. The ob�ervation X b random [if X is or (x; (J ) [if X i� on 9. 1). Thu�, instead of working within a single probabilistic model , we will m1.llt'iple a one th at Dosse:ss��s is : for some a worst case viewpoint : a is not ..... \\JJd.L1 A'U-'-'A fulfill Ollr can unless it so ..... ....... \"'& &.1 ..... '-1 worst possible -- ------------- 1 1 1 I etc. 1 1 _-__ ___ _______ � 9. 1. of a classi cal inference modeL For each value of 6, we have a distri bution Px (x; B) . The value x of the observation X is used to a Or select a etc . Our will generally the dependence of probabilities on e. we will [h(X )] the £>\" ....... £>1\">..- .\"' ...... of a randonl variable h( X) as a function of e. SimiJarly, we will use notation Pe (A) to the probability of an Note that only indicates a functional dependence, not in the probabilistic sense. The two sections fOCllS on eter. error possible values the distributed (Li.d. ) that the expected error with high the unknown paralneter. 459 The third section deals with binary hypothesis testing problems. Here, we develop methods that bear similarity with the (Bayesian) MAP method, discussed in the preceding chapter. In particular, we calculate the \"likelihood\" of each hypothesis under the observed data, and we choose a hypothesis by comparing the ratio of the two likelihoods with a suitably chosen threshold. The last section addresses different types of hypothesis testing problems. For an example, suppose a coin is tossed n times, the resulting sequence of heads and tails is observed. and we wish to decide whether the coin is fair or not . The main hypothesis that we wish to test is whether p = 1/2, where p denotes the unknown probability of heads. The alternative hypothesis (p i= 1/2) is composite, in the sense that it consists of several, possibly infinitely many, subhypotheses (e.g. , p = 0. 1. p = 0.4999. etc.). It is clear that no method can reliably distinguish between a coin with p = 0.5 and a coin with p = 0.4999 on the basis of a moderate number of observations. Such problems are usually approached using the methodology of significance testing. Here, one asks the question: \"are the observed data compatible with the hypothesis that p = 0.5?\" Roughly speaking, a hypothesis is rejected if the observed data are unlikely to have been generated \"accidentally\" or \"by chance.\" under that hypothesis. Major Terms, Problems, and Methods in this Chapter • Classical statistics treats unknown parameters as constants to be determined. A separate probabilistic model is assumed for each pos­ sible value of the unknown parameter. • In parameter estimation, we want to generate estimates that are nearly correct under any possible value of the unknown parameter. • In hypothesis testing, the unknown parameter takes a finite number m of values ( m > 2), corresponding to competing hypotheses; we want to choose one of the hypotheses, aiming to achieve a small probability of error under any of the possible hypotheses. • In significance testing, we want to accept or reject a single hypoth­ esis, while keeping the probability of false rejection suitably small. • Principal classical inference methods in this chapter: (a) Maximum likelihood (ML) estimation: Select the parame­ ter that makes the observed data \"most likely,\" i.e., maximizes the probability of obtaining the data at hand (Section 9. 1). (b) Linear regression: Find the linear relation that matches best a set of data pairs, in the sense that it minimizes the sum of the squares of the discrepancies between the model and the data (Section 9.2). 460 Classical Statistical Inference Chap. 9 (c) Likelihood ratio test: Given two hypotheses, select one based on the ratio of their \"likelihoods,\" so that certain error probabil­ ities are suitably small (Section 9.3) . (d) Significance testing: Given a hypothesis, reject it if and only if the observed data falls within a certain rejection region. This re­ gion is specially designed to keep the probability of false rejection below some threshold (Section 9.4) . 9.1 CLASSICAL PARAMETER ESTIMATION In this section. we focus on parameter estimation, using the classical approach where the parameter e is not random. but is rather viewed as an unknown con­ stant. We first introduce some definitions and associated properties of estima­ tors. We then discuss the maximum likelihood estimator. which may be viewed as the classical counterpart of the Bayesian MAP estimator. We finally focus on the simple but important example of estimating an unknown mean, and possibly an unknown variance. We also discuss the associated issue of constructing an interval that contains the unknown parameter with high probability (a \"confi­ dence interval\" ). The methods that we develop rely heavily on the laws of large numbers and the central limit theorem (cf. Chapter 5). Properties of Estimators Given observations X = (Xl . . . . . Xn). an estimator is a random variable of the form 8 = g(X ) , for some function g. Note that since the distribution of X depends on e. the same is true for the distribution of 8. We use the term estimate to refer to an actual realized value of 8. Sometimes, particularly when we are interested in the role of the number of observations n, we use the notation 8n for an estimator. It is then also appropriate to view 8n as a sequence of estimators (one for each value of n) . The mean and variance of en are denoted Et/J8n] and vart/ (8n), respectively. and are defined in the usual way. Both Et/ [en] and vart/ (8n) are numerical functions of e. but for simplicity. when the context is clear we sometimes do not show this dependence. We introduce some terminology related to various properties of estimators. Terminology Regarding Estimators Let 8n be an estimator of an unknown parameter e, that is, a function of n observations Xl , ... , Xn whose distribution depends on e. Sec. 9. 1 Classical Parameter Estimation 461 • The estimation error, denoted by en, is defined by en = en - e. • The bias of the estimator, denoted by be (en) , is the expected value of the estimation error: • The expected value, the variance, and the bias of en depend on e, while the estimation error depends in addition on the observations Xl , ... ,Xn. • We call en unbiased if Ee [en] = e, for every possible value of e. • We call e n asymptotically unbiased if limn-->oo Ee [en] = e, for every possible value of e. • We call en consistent if the sequence en converges to the true value of the parameter e, in probability, for every possible value of e. An estimator, being a function of the random observations. cannot be ex­ pected to be exactly equal to the unknown value (). Thus, the estimation error will be generically nonzero. On the other hand, if the average estimation error is zero. for every possible value of e, then we have an unbiased estimator, and this is a desirable property. Asymptotic unbiasedness only requires that the es­ timator become unbiased as the number n of observations increases. and this is desirable when n is large. Besides the bias be (en ) , we are usually interested in the size of the estima­ tion error. This is captured by the mean squared error Ee [e�] . which is related to the bias and the variance of en according to the following formula: t Ee [8�] = b�(en) + vare (ell ) . This formula is important because in many statistical problems. there is a trade­ off between the two terms on the right-hand-side. Often a r('duction in the variance is accompanied by an increase in the bias. Of course. a good estimator is one that manages to keep both terms small. We will now discuss some specific estimation approaches. starting with maximum likelihood estimation. This is a general method that bears similarity to MAP estimation. introduced in the context of Bayesian inference. We will subsequently consider the simple but important case of estimating the mean and variance of a random variable. This will bring about a connection with our discussion of the laws of large numbers in Chapter 5. t This is all application of the formula E[X2 ] = (E[xl ) 2 + var(X). with X = en and where the expectation is taken with respect to the distribution corresponding to (): we are also using the facts Eo [8n] = bo (8n ) and varo (8n ) = varo(8n - ()) = varo (8n). , . .. , X n; to if IS '-''U' ......................... 'UU I as () x 9.2. X is () takes one of the m values Given the value of the observation X Xl the values of the likeli hood fu nction p X Ot ) become avai lable for al l il and a value of () tha.t maxim izes p X is selected . , .. . ! Xl1 ; 0) = to n i ::::: 1 9 conve- \" .. Xn ; - n n Sec. 9. 1 Classical Parameter Estimation 463 over O. When X is continuous, there is a similar possibility, with PMFs replaced by PDFs: we maximize over 0 the expression n n i=l i=l The term \"likelihood\" needs to be interpreted properly. In particular, hav­ ing observed the value x of X, px (x; 0) is not the probability that the unknown parameter is equal to O. Instead, it is the probability that the observed value x can arise when the parameter is equal to O. Thus, in maximizing the likelihood, we are asking the question: \"What is the value of 0 under which the observations we have seen are most likely to arise?\" Recall that in Bayesian MAP estimation, the estimate is chosen to maxi­ mize the expression pe (O) px l e (x I 0) over all 0, where pe (O) is the prior PMF of an unknown discrete parameter O. Thus, if we view px (x; 0) as a conditional PMF, we may interpret ML estimation as MAP estimation with a flat prior, i.e., a prior which is the same for all 0, indicating the absence of any useful prior knowledge. Similarly, in the case of continuous 0 with a bounded range of possible values, we may interpret ML estimation as MAP estimation with a uniform prior: le (O) c for all 0 and some constant c. Example 9.1. Let us revisit Example 8.2, in which Juliet is always late by an amount X that is uniformly distributed over the interval [0, 0] , and 0 is an unknown parameter. In that example. we used a random variable e with flat prior PDF 1e (0) (uniform over the interval [0, 1]) to model the parameter. and we showed that the MAP estimate is the value x of X. In the classical context of this section, there is no prior, and 0 is treated as a constant, but the ML estimate is also tJ = x. Example 9.2. Estimating the Mean of a Bernoulli Random Variable. We want to estimate the probability of heads, 0, of a biased coin, based on the outcomes of n independent tosses Xl ,\" .. Xn (Xi = 1 for a head, and Xi = ° for a tail). This is similar to the Bayesian setting of Example 8.8, where we assumed a flat prior. We found there that the peak of the posterior PDF (the MAP estimate) is located at 0 = kin, where k is the number of heads observed. It follows that kin is also the ML estimate of 0, so that the ML estimator is A Xl + .. . + Xn en = ��---';\":' n This estimator is unbiased. It is also consistent, because en converges to 0 in probability, by the weak law of large numbers. It is interesting to compare the ML estimator with the LMS estimator, ob­ tained with a Bayesian approach in Example 8.8. We showed there that with a flat prior, the posterior mean is (k + l)/(n + 2) . Thus, the ML estimate, kin, is similar but not identical to the LMS estimate obtained with the Bayesian approach. However, as n - 00. the two estimates asymptotically coincide. 464 Cla.ssical Statistical Inference Chap. 9 Example 9.3. Estimating the Parameter of an Exponential Random Vari­ able. Customers arrive to a facility, with the ith customer arriving at time Yi. We assume that the ith interarrival time, Xi = Yi - Yi-l (with the convention Yo = 0) is exponentially distributed with unknown parameter (), and that the random vari­ ables Xl , . . . ,Xn are independent. (This is the Poisson arrivals model, studied in Chapter 6.) We wish to estimate the value of () (interpreted as the arrival rate), on the basis of the observations XI , ... , X n. The corresponding likelihood function is n n t=1 i=1 and the log-likelihood function is log Ix (x; 0) = n log () - OYn, where n Yn = L Xi. i=1 The derivative with respect to () is (n/()) - Yn, and by setting it to 0, we see that the maximum of log Ix (x; 0), over 0 � 0, is attained at On = n/Yn. The resulting estimator is � (Yn ) -1 8n = -n It is the inverse of the sample mean of the interarrival times, and it can be inter­ preted as an empirical arrival rate. Note that by the weak law of large numbers, Yn/n converges in probability to E[Xtl = I/O, as n -+ oc. This can be used to show that en converges to () in probability, so the estimator is consistent. Our discussion and examples so far have focused on the case of a single unknown parameter (). The next example involves a two-dimensional parameter. Example 9.4. Estimating the Mean and Variance of a Normal. Consider the problem of estimating the mean JL and variance v of a normal distribution using n independent observations XI , ... , X n. The parameter vector here is () = (JL, v). The corresponding likelihood function is After some calculation it can be written as t 1 { ns� } { n(mn - JL)2 } Ix (x; JL, v) = (2rrv)n/2 . exp - 2v . exp - 2v ' Sec. 9. 1 Classical Parameter Estimation where mn is the realized value of the random variable n Mn = � L Xl' i=l and 8� is the realized value of the random variable The log-likelihood function is n n n8� n(mn - J-l)2 10g fx(x; J-l, v) = - \"2 ·log(2rr) - \"2 . log v - 2v - 2v 465 Setting to zero the derivatives of this function with respect to J-l and v, we obtain the estimate and estimator, respectively, Note that Mn is the sample mean, while S! may be viewed as a \"sample variance.\" As will be shown shortly, E9[S�l converges to v as n increases, so that S� is asymp­ totically unbiased. Using also the weak law of large numbers, it can be shown that Mn and S� are consistent estimators of J-l and v, respectively. Maximum likelihood estimation has sOAme appealing properties. For exam­ ple, it obeys the invariance principle: if en is the ML estimate of 0, then for any one-to-one function h of 0, the 1\\IL estimate of the parameter ( = h(O) is h(en). Also. when the observations are Li.d., and under some mild additional assumptions, it can be shown that the ML estimator is consistent . Another interesting property is that when 0 is a scalar parameter, then under some mild conditions, the ML estimator has an asymptotic normality property. In particular. it can be shown that the distribution of (en - O)/a(en ), where a2 (en ) is the variance of en , approaches a standard normal distribution. Thus, if we are able to also estimate a(8n), we can use it to derive an error vari­ ance estimate based on a normal approximation. When 0 is a vector parameter, a similar statement applies to each one of its components. t To verify this. write for i = 1, . . . , n, sum over i, and note that n n ,=1 i= l 466 Classical Statistical Inference Chap. 9 Maximum Likelihood Estimation • We are given the realization x = (Xl, . . . , Xn ) of a random vector X = (Xl , ... , Xn ), distributed according to a PMF PX(Xj e) or PDF !x(Xj e) . • The maximum likelihood (ML) estimate is a value of e that maximizes the likelihood function, px(x; e) or fx(x; e) , over all e. • The ML estimate of a one-to-one function h(e) of e is h(en ), where en is the ML estimate of e (the invariance principle) . • When the random variables Xi are i.i.d., and under some mild addi­ tional assumptions, each component of the ML estimator is consistent and asymptotically normal. Estimation of the Mean and Variance of a Random Variable We now discuss the simple but important problem of estimating the mean and the variance of a probability distribution. This is similar to the preceding Exam­ ple 9.4, but in contrast with that example, we do not assume that the distribution is normal. In fact, the estimators presented here do not require knowledge of the distributions px(x; e) [or fx (x; e) if x is continuous] . Suppose that the observations Xl . . . . , Xn are LLd .. with an unknown com­ mon mean e. The most natural estimator of e is the sample mean: Xl + ... + Xn A1n = -----­ n This estimator is unbiased, since Eo[AIn] = Eo[X] = e. Its mean squared error is equal to its variance, which is v/ n, where v is the common variance of the Xi . Note that the mean squared error does not depend on e. Furthermore, by the weak law of large numbers, this estimator converges to e in probability, and is therefore consistent. The sample mean is not necessarily thAe estimator with the smallest vari­ ance. For example, consider the estimator en = O. which ignores the observa­ tions and always yields an estimate of zero. The variance of en is zero, but its bias is bo (en ) = -e. In particular, the mean squared error depends on e and is equal to e2 . The next example compares the sample mean with a Bayesian MAP esti­ mator that we derived in Section 8.2 under certain assumptions. Example 9.5. Suppose that the observations Xl , ... ,Xn are normal, Li.d. , with an unknown common mean O. and known variance v. In Example 8.3, we used a Bayesian approach, and assumed a normal prior distribution on the parameter Sec. 9. 1 Classical Parameter Estimation 467 (). For the case where the prior mean of () was zero, we arrived at the following estimator: A Xl + ... + Xn en = . n + l This estimator is biased, because El den] = n()/(n + 1) and b9(en) = -()/(n + 1). However, limn_a;) b9(en) = 0, so en is asymptotically unbiased. Its variance is and it is slightly smaller than the variance v/n of the sample mean. Note that in the special case of this example, var9 (en) is independent of (). The mean squared error is equal to Suppose that in addition to the sample mean/estimator of (), Xl + ··· + Xn Mn = , n we are interested in an estimator of the variance v. A natural one is which coincides with the ML estimator derived in Example 9.4 under a normality assumption. U sing the facts we have E(9,v) [xl] = ()2 + V , E(e,\") [ s!] = ! E(e,\") [t. Xl -2Mn t. Xi + nM� 1 = E(e,\") [ ! t Xl - 2M� + M� ] = E(9,v) [� t Xl - M�] 1= 1 = ()2 + V - (()2 + �) n- l = -- v. n 468 Classical Statistical Inference Chap. 9 Thus, S� is not an unbiased estimator of v, although it is asymptotically unbi­ ased. We can obtain an unbiased variance estimator after some suitable scaling. This is the estimator n � 2 1 L n -2 Sn = -- (Xi - Aln ) 2 = -- Sn . n- l n-l i=l The preceding calculation shows that E(8,v) [S�] = v, so S� is an unbiased estimator of v, for all n. However. for large n, the estimators � -2 S� and Sn are essentially the same. Estimates of the Mean and Variance of a Random Variable Let the observations Xl , . . . , Xn be i.i.d., with mean (J and variance v that are unknown. • The sample mean Xl + \"' + Xn Atfn = ------ n is an unbiased estimator of (J, and its mean squared error is vln. • Two variance estimators are n S� = n I l L(Xi - Mn)2 . i=l • The estimator S� coincides with the ML estimator if the Xi are nor­ mal. It is biased but asymptotically unbiased. The estimator S� is unbiased. For large n, the two variance estimators essentially coincide. Confidence Intervals Consider an estimator en of an unknown parameter (J. Besides the numerical value provided by an estimate. we are often interested in constructing a so-called confidence interval. Roughly speaking, this is an interval that contains (J with a certain high probability, for every possible value of (J. For a precise definition, let us first fix a desired confidence level, 1 - Q, where Q is typically a small number. We then replace the point estimator en by Sec. 9. 1 Classical Parameter Estimation 469 a lower estimator 8;;- and an upper estimator 8;t\" , designed so that 8;;- ::; 8;t\" , and for every possible value of (). Note that, similar to estimators, 8;;- and 8;t' , are functions of the observations, and hence random variables whose distributions depend on e. We call [8;;- , 8;i] a 1 - Q confidence interval. Example 9.6. Suppose that the observations Xi are LLd. normal, with unknown mean () and known variance v. Then, the sample mean estimator is normal,t with mean () and variance v/n. Let Q = 0.05. Using the CDF 4>(z) of the standard normal (available in the normal tables) , we have 4>(1.96) = 0.975 = l-Q/2 and we obtain P9 (len - ()I ::; 1.96) = 0.95 . Nn We can rewrite this statement in the form which implies that [ A fV A m en - 1.96y ;;' en + 1.96y ;;J is a 95% confidence intervaL where we identify e� and e� with en - l.96 Nn and en + 1.96 v'v/n, respectively. In the preceding example, we may be tempted to describe the concept of a 95% confidence interval by a statement such as \"the true parameter lies in the confidence interval with probability 0.95.\" Such statements, however, can be ambiguous. For example, suppose that after the observations are obtained, the confidence interval turns out to be [-2.3, 4. 1] . We cannot say that e lies in [-2.3, 4.1] with probability 0.95, because the latter statement does not involve any random variables; after all, in the classical approach, e is a constant. In­ stead, the random entity in the phrase \"the true parameter lies in the confidence interval\" is the confidence interval, not the true parameter. For a concrete interpretation, suppose that () is fixed. We construct a confidence interval many times, using the same statistical procedure, i.e., each t We are using here the important fact that the sum of independent normal random variables is normal (see Chapter 4). 470 Classical Statistical Inference Chap. 9 time, we obtain an independent collection of n observations and construct the corresponding 95% confidence interval. We then expect that about 95% of these confidence intervals will include (). This should be true regardless of what the value of () is. Confidence Intervals • A confidence interval for a scalar unknown parameter () is an interval whose endpoints 8;; and et bracket () with a given high probability. • 8;; and at are random variables that depend on the observations Xl , . .. , Xn . • A 1 - 0: confidence interval is one that satisfies for all possible values of (). Confidence intervals are usually constructed by forming an interval around an estimator 8n (cf. Example 9.6). Furthermore, out of a variety of possible confidence intervals, one with the smallest possible width is usually desirable. However, this construction is sometimes hard because the distribution of the error 8n :- () is either unknown or depends on (). Fortunately, for many important models, en - () is asymptotically normal and asymptotically unbiased. By this we mean that the CDF of the random variable en - () .J vare (en ) approaches the standard normal CDF as n increases, for every value of (). We may then proceed exactly as in our earlier normal example (Example 9.6), provided that vare (8n ) is known or can be approximated, as we now discuss. Confidence Intervals Based on Estimator Variance Approximati�ns Suppose that the observations Xi are i.i.d. with mean () and variance v that are unknown. We may estimate () with the sample mean A X1+ .. . + Xn en = ------ n and estimate v with the unbiased estimator n A I L A s� = -- (Xi - en )2 n-l i=l Sec. 9. 1 Classical Parameter Estimation 471 that we introduced earlier. In particular, we may estimate the variance v / n of the sample mean by S�/n. Then, for a given 0, we may use these estimates and the central limit theorem to construct an (approximate) 1 - 0 confidence interval. This is the interval where z is obtained from the relation o �(z) = l-- 2 and the normal tables, and where Sn is the positive square root of S� . For instance, if 0 = 0.05, we use the fact �(1 .96) = 0.975 = 1 - 0/2 (from the normal tables) and obtain an approximate 95% confidence interval of the form Note that in this ?pproach, there are two different approximations in effect. First, we are treating en as if it were a normal random variable; second, we are replacing the true variance v/n of en by its estimate S�/n. Even in the special case where the Xi are normal random variables, the confidence interval produced by the preceding procedure is still approximate. The reason is that S� is only an approximation to the true variance v, and the random variable yn (en - 8) Tn = � Sn is not normal. However, for normal Xi , it can be shown that the PDF of Tn does not depend on 8 and v, and can be computed explicitly. It is called the t-distribution with n - 1 degrees of freedom. t Like the standard normal PDF, it is symmetric and bell-shaped, but it is a little more spread out and has heavier tails (see Fig. 9.3). The probabilities of various intervals of interest are available in tables, similar to the normal tables. Thus, when the Xi are normal (or nearly normal) and n is relatively small, a more accurate confidence interval is of the form t The t-distribution has interesting properties and can be expressed in closed form, but the precise formula is not important for our purposes. Sometimes it is called the \"Student's distribution.\" It was published in 1908 by William Gosset while he was employed at a brewery in Dublin. He wrote his paper under the pseudonym Student because he was prohibited from publishing under his own name. Gosset was concerned with the selection of the best yielding varieties of barley and had to work with small sample sizes. 472 Classical Statistical Inference Chap. 9 where z is obtained from the relation and Wn- l (Z) is the CDF of the t-distribution with n - 1 degrees of freedom, available in tables. These tables may be found in many sources. An abbreviated version is given in the opposite page. 0.35 0.3 0.25 0.2 0. 15 0. 1 0.05 -: .:: :::: Probability Density Function -- N(O,l) t-distribution (n::l l) - - t-distribution (n=3) - - - t-distribution (n::2) ............. .::::- -- -=-.--- - O �--�----�--�----�--�----�--�----�--�--� -5 -4 -3 -2 - 1 o 2 3 4 5 Figure 9.3. The PDF of the t-distribution with n - 1 degrees of freedom in comparison with the standard normal PDF. On the other hand, when n is moderately large (e.g., n � 50), the t­ distribution is very close to the normal distribution, and the normal tables can be used. Example 9.7. The weight of an object is measured eight times using an electronic scale that reports the true weight plus a random error that is normally distributed with zero mean and unknown variance. Assume that the errors in the observations are independent. The following results are obtained: 0.5547, 0.5404, 0.6364, 0.6438, 0.4917, 0.5674, 0.5564, 0.6066. We compute a 95% confidence interval (a = 0.05) using the t-distribution. The value of the sample mean en is 0.5747, and the estimated variance of en is � 2 n Sn = 1 � (Xi _ 8n )2 = 3.2952 . 10-4 • n n(n -1) L >=1 Sec. 9. 1 Classical Parameter Estimation 473 0. 100 0.050 0.025 O.OlD 0.005 0.001 1 3.078 6.314 12.71 31.82 63.66 318.3 2 1.886 2.920 4.303 6.965 9.925 22.33 3 1.638 2.353 3. 182 4.541 5.841 lD.21 4 1.533 2. 132 2.776 3.747 4.604 7. 173 5 1.476 2.015 2.571 3.365 4.032 5.893 6 1.440 1.943 2.447 3.143 3.707 5.208 7 1.415 1.895 2.365 2.998 3.499 4.785 8 1.397 1.860 2.306 2.896 3.355 4.501 9 1.383 1.833 2.262 2.821 3.250 4.297 lD 1.372 1.812 2.228 2.764 3. 169 4.144 11 1.363 1.796 2.201 2.718 3. lD6 4.025 12 1.356 1.782 2.179 2.681 3.055 3.930 13 1.350 1.771 2. 160 2.650 3.012 3.852 14 1.345 1.761 2.145 2.624 2.977 3.787 15 1.341 1.753 2.131 2.602 2.947 3.733 20 1.325 1.725 2.086 2.528 2.845 3.552 30 1.310 1.697 2.042 2.457 2.750 3.385 60 1.296 1.671 2.000 2.390 2.660 3.232 120 1.289 1.658 1.980 2.358 2.617 3. 160 00 1.282 1.645 1.960 2.326 2.576 3.090 The t-tables for the CDF Wn- l (Z) of the t-distribution with a given number n - 1 of degrees of freedom. The entries in this table are: Left column: Number of degrees of freedom n - 1. Top row: A desired tail probability {3. Entries under the top row: A value z such that Wn-l (Z) = 1 - {3. so that Sn / vn = 0.0182. From the t-distribution tables, we obtain 1- Wr(2.365) = 0.025 = 0,/2, so that P61 ( I� n - 81 < 2.365) = 0.95. Sn/vn - Thus, [A Sn A Sn 1 en - 2.365 vn ' en + 2.365 vn = [0.531, 0.618] is a 95% confidence intervaL It is interesting to compare it with the confidence interval [A Sn A Sn 1 en - 1.96 vn ' en + 1.96 vn = [0.539, 0.6lD] obtained from the normal tables, which is narrower and therefore more optimistic about the precision of the estimate {j = 0.5747. 474 Classical Statistical Inference Chap. 9 The approximate confidence intervals constructed so far relied on the par­ ticular estimator S� for the unknown variance v. However, different estimators or approximations of the variance are possible. For example, suppose that the observations Xl , ... , X n are Li.d. Bernoulli with unknown mean 8, and vari­ anc� v = 8(1 - 8). Then, instead of S�A' the variance could be approximated by en (1 - en ). Indeed, as n increases, en converges to 8, in probability, from which it can be shown that en (1 - en) converges to v. Another possibility is to just observe that 8( 1 - 8) < 1/4 for all 8 E [0. 1] ' and use 1/4 as a conservative estimate of the variance. The following example illustrates these alternatives. Example 9.8. Polling. Consider the polling problem of Section 5.4 (Example 5.11), where we wish to estimate the fraction e of voters who support a particular candidate for office. We collect n independent sample voter responses Xl , . . . , X n, where Xi is viewed as a Bernoulli random variable. with Xi = 1 if the ith voter sup­ ports the candidate. We estimate e with the sample mean en, and construct a con­ fidence interval based on a normal approximation and different ways of estimating or approximating the unknown variance. For concreteness, suppose that 684 out of a sample of n = 1200 voters support the candidate, so that en = 684/1200 = 0.57. (a) If we use the variance estimate = 11�9 (684 . (1 - 1 6 2 8 0�) 2 + (1200 - 684) . (0 _ 1 6 2 8 0�) 2) ;::: 0.245, and treat en as a normal random variable with mean e and variance 0.245, we obtain the 95% confidence interval [en - 1.96 7,;, en + 1.96 7,; 1 = [0.57 - 1 .96 · v'll.245 , 0.57 + 1 .9�l = [0.542, 0.598]. (b) The variance estimate A A 684 ( 684 ) en(1 - en) = 1200 ' 1 - 1200 = 0.245 is the same as the previous one (up to three decimal place accuracy), and the resulting 95% confidence interval [8n - 1.96 v'en�- en) , en + 1 .96 v'8nj,; en) 1 is again [0.542, 0.598]. Sec. 9.2 Linear Regression 475 (c) The conservative upper bound of 1/4 for the variance results in the confidence interval [en -1.96 1� , en + 1 .96 1�l = [0.57 - 1.9�2) , 0.57 + 1 .9�2)l y n y n 1200 1200 = [0.542, 0.599], which is only slightly wider, but practically the same as before. Figure 9.4 illustrates the confidence intervals obtained using methods (b) and (c), for a fixed value en = 0.57 and a range of sample sizes from n = 10 to n 10,000. We see that when n is in the hundreds, as is typically the case in voter polling, the difference is slight. On the other hand, for small values of n, the different approaches result in fairly different confidence intervals, and therefore some care is required. O.4 r--;:======::c::===========:!:=====:::::;-..........., I Confidence Intervals Based on Upper Bound I 0.3 • 0.2 0.1 o -0.1 -0.2 -0.3 • + Confidence Intervals Based on Estimated Variance I -0.4 '--------'-------........ '---------............. 1� 1� 1� 1� n Figure 9.4. The distance of the confidence interval endpoints from en for meth­ ods (b) and (c) of approximating the variance in the polling Example 9.8, when en = 0.57 and for a range of sample sizes from n = 10 to n = 10,000. 9.2 LINEAR REGRESSION In this section, we develop the linear regression methodology for building a model of the relation between two or more variables of interest on the basis of available data. An interesting feature of this methodology is that it may be explained and developed simply as a least squares approximation procedure, without any prob­ abilistic assumptions. Yet, the linear regression formulas may also be interpreted 9 in the context of various probabilistic frameworks, which provide perspective and a for first consider the case of o nly two wish to model between two �o'rc�,n in a a systemat ic , approximately linear relation between Xi and Yi . Then , it is natural to to build a where ()o In the value difference over fh are unknown parameters to be estimated . given some 00 {) 1 of v\\.JJ .... o...& JIAAp;, to Xi 1 as predicted by the is A choice a good to .... n\"n.L'e'lC' the parameter estimates 00 residuals . n n -ili )2 = - (JO - (JI X z )2 , i= 1 i= 1 : see Fig. for an illustration. o 9.5: Ill ustrat ion of a set of data small residuals motivation, the {h minimize x OO +81 X, obtai ned by over Yi ), and a linear model Y = the sum of the squares of the residuals 'J1i - Sec. 9.2 Linear Regression 477 Note that the postulated linear model may or may not be true. For exam­ ple, the true relation between the two variables may be nonlinear. The linear least squares approach aims at finding the best possible linear model. and in­ volves an implicit hypothesis that a linear model is valid. In practice, there is often an additional phase where we examine whether the hypothesis of a linear model is supported by the data and try to validate the estimated �model. � To derive the formulas for the linear regression estimates (}o and (}1 , we observe that once the data are given, the sum of the squared residuals is a quadratic function of (}o and (}1 . To perform the minimization, we set to zero the partial derivatives with respect to (}o and (}l . We obtain two linear equations in (}o and (}l , which can be solved explicitly. After some algebra, we find that the solution has a simple and appealing form, summarized below. Linear Regression Given n data pairs (Xi, Yi), the estimates that minimize the sum of the squared residuals are given by where n I)Xi - X)(Yi - y) {it = i=l n Example 9.9. The leaning tower of Pisa continuously tilts over time. Measure­ ments between years 1975 and 1987 of the \"lean\" of a fixed point on the tower (the distance in meters of the actual position of the point, and its position if the tower were straight) have produced the following table. Year 1975 1976 1977 1978 1979 1980 1981 Lean 2.9642 2.9644 2.9656 2.9667 2.9673 2.9688 2.9696 Year 1982 1983 1984 1985 1986 1987 Lean 2.9698 2.9713 2.9717 2.9725 2.9742 2.9757 Let us use linear regression to estimate the parameters 00 and 01 in a model of the form y = 00 + Ot X, where x is the year and y is the lean. Using the regression 478 Classical Statistical Inference formulas, we obtain n {h = _i=_I _n ______ = 0.0009, Bo = y - Bix = 1.1233, where _ 1 n x = � LXi = 1981, i=1 The estimated linear model is _ 1 � Y = � L Yi = 2.9694. i=1 Y = 0.0009x + 1.1233, and is illustrated in Figure 9.6. * • Data Points -- Estimated Linear Model • 2.972 • 2.97 • c: 1\\1 � * 2.968 2.966 • * 2.964 2.962 1974 1976 1978 1980 1982 1984 1986 1988 Year Chap. 9 Figure 9.6: The data and the estimated linear model for the lean of the tower of Pisa (Example 9.9) . Justification of the Least Squares Formulation t The least squares formulation can be justified on the basis of probabilistic con­ siderations in several different ways, based on different sets of assumptions. (a) Maximum likelihood (linear model, normal noise) . We assume that the Xi are given numbers (not random variables). We assume that Yi is the t This subsection can be skipped without loss of continuity. Sec. 9.2 Linear Regression 479 realization of a random variable Yi, generated according to a model of the form i = 1, ... ,n, where the Wi are i.i.d. normal random variables with mean zero and vari­ ance (72. It follows that the Yi are independent normal variables, where Yi has mean (}o + (}lXi and variance (72. The likelihood function takes the form f ( ' (}) = IIn 1 { _ (Yi - (}O - (}lXi)2 } y y, rn= exp 2 2 . i=l V 21r(7 (7 Maximizing the likelihood function is the same as maximizing the exponent in the above expression, which is equivalent to minimizing the sum of the squared residuals. Thus, the linear regression estimates can be viewed as ML estimates within a suitable linear Inormal context. In fact they can be shown to be unbiased estimates in this context. Furthermore, the variances of the estimates can be calculated using convenient formulas (see the end­ of-chapter problems) , and then used to construct confidence intervals using the methodology of Section 9. 1. (b) Approximate Bayesian linear LMS estimation (under a possibly nonlinear model). Suppose now that both Xi and Yi are realizations of random variables Xi and Yi. The different pairs (Xi , Yi) are Li.d., but with unknown joint distribution. Consider an additional independent pair (Xo, Yo ), with the same joint distribution. Suppose we observe Xo and wish to estimate Yo using a linear estimator of the form Yo = (}o + (}l XO. We know from Section 8.4 that the linear LMS estimator of Yo , given Xo , is of the form yielding E[Yi 1 cov(Xo, Yo) (X - E[X 1) o + (X ) 0 0 , var 0 (}l - cov(Xo , Yo ) - var(Xo) , Since we do not know the distribution of (Xo , Yo), we use x as an estimate of E[XoJ , Y as an estimate of E[YoJ , l:�=l (Xi - X)(Yi - min as an estimate of cov(Xo , Yo ), and l:�=l (Xi - x)2 In as an estimate of var(Xo) . By sub­ stituting these estimates into the above formulas for (}o and (}1, we recover the expressions for the linear regression parameter estimates given earlier. Note that this argument does not assume that a linear model is valid. (c) Approximate Bayesian LMS estimation (linear model). Let the pairs (Xi, Yi) be random and i.i.d. as in (b) above. Let us also make the additional assumption that the pairs satisfy a linear model of the form Yi = (}o + (}lXi + Wi , where the Wi are Li.d. , zero mean noise terms, independent of the Xi . From the least mean squares property of conditional expectations, we know that 480 Classical Statistical Inference Chap. 9 E[Yo I Xol minimizes the mean squared estimation error E[(Yo -g(XO))2], over all functions g. Under our assumptions, E[Yo I Xol = 00 +OlXO. Thus, the true parameters 00 and fh minimize over all Oh and Oi. By the weak law of large numbers, this expression is the limit as n -----t 00 of This indicates that we will obtain a good approximation of the minimizers of E[(Yo - Oh - OiXO)2] (the true parameters), by minimizing the above expression (with Xi and Yi replaced by their observed values Xi and Yi, respectively) . But minimizing this expression is the same as minimizing the sum of the squared residuals. Bayesian Linear Regression t Linear models and regression are not exclusively tied to classical inference meth­ ods. They can also be studied within a Bayesian framework, as we now explain. In particular, we may model Xl, ... ,Xn as given numbers, and Yl , ... ,Yn as the observed values of a vector Y = (Yl, \" \" Yn) of random variables that obey a linear relation Here, 8 = (80, 81 ) is the parameter to be estimated, and WI , . . . , �Vn are Li.d. random variables with mean zero and known variance (12. Consistent with the Bayesian philosophy, we model 80 and 81 as random variables. We assume that 80 ,81, WI . . . . , Wn are independent, and that 80. 81 have mean zero and variances (15, (1r. respectively. We may now derive a Bayesian estimator based on the MAP approach and the assumption that 80 , 81 , and WI , .. . , Wn are normal random variables. We maximize over 00, 01 the posterior PDF ielY(Oo, 01 I Y!, . . . , Yn)' By Bayes' rule, the posterior PDF is+ divided by a positive normalizing constant that does not depend on (Oo,Od. Under our normality assumptions, this expression can be written as { 05 } { Or} lIn { (Yi - 00 - XiOi)2 } c·exp - - ·exp - - . exp - , 2(12 2(12 2(12 o 1 i=l t This subsection can be skipped without loss of continuity. t Note that in this paragraph, we use conditional probability notation since we are dealing with a Bayesian framework. Sec. 9.2 Linear Regression 481 where c is a normalizing constant that does not depend on (00 . OJ ). Equivalently, we minimize over 00 and 01 the expression Note the similarity with the expression L�l (Yi - 00 -xiOl )2, which is minimized in the earlier classical linear regression formulation. (The two minimizations would be identical if ao and al were so large that the terms OS/2a5 and 8I/2aI could be neglected.) The minimization is carried out by setting to zero the partial derivatives with respect to 80 and 81 . After some algebra, we obtain the following solution. Bayesian Linear Regression • Model: (a) We assume a linear relation Yi = 80 + 81xi + Wi . (b) The Xi are modeled as known constants. (c) The random variables 80 , 81, WI , ... , Wn are normal and inde­ pendent. (d) The random variables 80 and 81 have mean zero and variances a5, aI, respectively. (e) The random variables Wi have mean zero and variance a2 • • Estimation Formulas: Given the data pairs (Xi , Yi), the MAP estimates of 80 and 81 are where i=l 2 A nao _ A_ 80 = 2 2 (y - 81x), a + nao 1 n X = - L Xi ' n. l= 1 482 Classical Statistical Inference Chap. 9 We make a few remarks: (a) If 0'2 is very large compared to 0'5 and O'r , we obtain Bo � 0 and Bl � o . What is happening here is that the observations are too noisy and are essentially ignored, so that the estimates become the same as the prior means, which we assumed to be zero. (b) If we let the prior variances 0'5 and O'r increase to infinity, we are indicating the absence of any useful prior information on 80 and 81. In this case, the MAP estimates become independent of 0'2, and they agree with the classical linear regression formulas that we derived earlier. (c) Suppose, for simplicity, that x = O. When estimating 81 , the values Yi of the observations Yi are weighted in proportion to the associated values Xi. This is intuitive: when Xi is large, the contribution of 81xi to Yi is relatively large, and therefore Yi contains useful information on 81 . Conversely, if Xi is zero, the observation Yi is independent of 81 and can be ignored. A A (d) The estimates ()o and ()1 are linear functions of the Yi, but not of the Xi . Recall, however, that the Xi are treated as exogenous, non-random quanti­ ties, whereas the Yi are observed values of the random variables Yi. Thus the MAP estimators 80, 81 are linear estimators, in the sense defined in Section 8.4. It follows, in view of our normality assumptions, that the esti­ mators are also Bayesian linear LMS estimators as well as LMS estimators (cf. the discussion near the end of Section 8.4). Multiple Linear Regression Our discussion of linear regression so far involved a single explanatory vari­ able, namely X, a special case known as simple regression. The objective was to build a model that explains the observed values Yi on the basis of the val­ ues Xi. Many phenomena, however, involve multiple underlying or explanatory variables. (For example, we may consider a model that tries to explain annual income as a function of both age and years of education.) Models of this type are called multiple regression models. For instance, suppose that our data consist of triples of the form (Xi , Yi, Zi) and that we wish to estimate the parameters ()j of a model of the form As an example, Yi may be the income, Xi the age, and Zi the years of education of the ith person in a random sample. We then seek to minimize the sum of the squared residuals n L(Yi - ()o - ()lXi - ()2Zi)2, i=1 over all ()o , ()1 , and ()2. More generally, there is no limit on the number of explanatory variables to be employed. The calculation of the regression estimates Sec. 9.2 Linear Regression 483 Oi is conceptually the same as for the case of a single explanatory variable, but of course the formulas are more complicated. As a special case, suppose that Zi = XT , in which case we are dealing with a model of the form Y � 00 + OI X + 02x2. Such a model would be appropriate if there are good reasons to expect a quadratic dependence of Yi on Xi. (Of course, higher order polynomial models are also pos­ sible.) While such a quadratic dependence is nonlinear, the underlying model is still said to be linear, in the sense that the unknown parameters OJ are linearly related to the observed random variables Yi. More generally, we may consider a model of the form m Y � 00 + L Ojhj (x), j=1 where the hj are functions that capture the general form of the anticipated de­ pendence of yon x. We may then obtain parameters 00, 01 , ... ,Om by minimizing over 00, 01 , . .. ,Om the expression This minimization problem is known to admit closed form as well as efficient numerical solutions. Nonlinear Regression There are nonlinear extensions of the linear regression methodology to situations where the assumed model structure is nonlinear in the unknown parameters. In particular, we assume that the variables x and Y obey a relation of the form Y � h(x; 0), where h is a given function and 0 is a parameter to be estimated. We are given data pairs (Xi, Yi), i = 1, .. . ,n, and we seek a value of 0 that minimizes the sum of the squared residuals n L (Yi - h(Xi ; 0)) 2. i=l Unlike linear regression, this minimization problem does not admit, in gen­ eral, a closed form solution. However, fairly efficient computational methods are available for solving it in practice. Similar to linear regression, nonlinear least squares can be motivated as ML estimation with a model of the form 484 Classical Statistical Inference Chap. 9 where the Wi are Li.d. normal random variables with zero mean. To see this, note that the likelihood function takes the form f ( ·e) = rrn 1 {_ (Yi - h(Xi;e))2 } y Y, rn:::. exp 2 2 ' i=l V 21T0\" 0\" where 0\"2 is the variance of Wi. Maximizing the likelihood function is the same as maximizing the exponent in the above expression, which is equivalent to minimizing the sum of the squared residuals. Practical Considerations Regression is used widely in many contexts, from engineering to the social sci­ ences. Yet its application often requires caution. We discuss here some important issues that need to be kept in mind, and the main ways in which regression may fail to produce reliable estimates. (a) Heteroskedasticity. The motivation of linear regression as ML estima­ tion in the presence of normal noise terms Wi contains the assumption that the variance of Wi is the same for all i. Quite often, however, the variance of Wi varies substantially over the data pairs. For example, the variance of Wi may be strongly affected by the value of Xi. (For a concrete example, suppose that Xi is yearly income and Yi is yearly consumption. It is natural to expect that the variance of the consumption of rich individuals is much larger than that of poorer individuals.) In this ca..c;;e, a few noise terms with large variance may end up having an undue influence on the parameter estimates. An appropriate remedy is to consider a weighted least squares criterion of the form 2:�1 ();i(Yi eo e1xi)2, where the weights ();i are smaller for those i for which the variance of Wi is large. (b) Nonlinearity. Often a variable X can explain the values of a variable y, but the effect is nonlinear. As already discussed, a regression model based on data pairs of the form (h(Xi), Yi) may be more appropriate, with a suitably chosen function h. (c) Multicollinearity. Suppose that we use two explanatory variables X and z in a model that predicts another variable y. If the two variables x and z bear a strong relation, the estimation procedure may be unable to distinguish reliably the relative effects of each explanatory variable. For an extreme example, suppose that the true relation is of the form Y = 2x + 1 and that the relation z = 2x always holds. Then� the model Y = z+ 1 is equally .valid, and no estimation procedure can discriminate between these two models. (d) Overfitting. Multiple regression with a large number of explanatory vari­ ables and a correspondingly large number of parameters to be estimated runs the danger of producing a model that fits the data well, but is oth­ erwise useless. For example, suppose that a linear model is valid but we ,... n, ... AC\" .Q to a suIting provide a nevertheless be incorrect. As a rule of thumb, there ten times) more data (e) a two x y should not be mistaken for a discovery a causal relation. A tight x has a causal on y� but be some Xi be child and Yi be the wealth of the second child in the same family. We ex pect to increase roughly linearly with Xi , but this can be traced on the of a common and a vUoUlUu.o.l. of one on the other. we will forgo traditional statistical language, plays the role of a default model, be proved or on The available observation is a vector � . .. ! Xn ) of random variables ...... ...... . J'U ........... LJ on the hypothesis. We P(X E w hen hypothesis is true . Note is not (x; X, these are not conditional probabilities, because the true hypothesis treated as a random variable. Similarly, we will use such as ) or values x of the 9.7: Classical inference framework for hy pothesis !\"'C;:n,IJI}:,.. ...... '-' .................... rule can by a partition values of the observation .. \"...\".. ..... ,...,.. X = (X 1, ... , ) into two called the and its complement , Rc , caned the (declared 9 possible IS of a decision rule 9.8: Structure of a decision rule for binary hypothesis testing. It is specified of the set of aU observations into a set R and its RC . The nul l if the realized value of the observation fal ls in the For a region are two possible of errors: (a) Rej ect Ho even though Ho is This is called a rejection, and happens with probability o:(R) = E Ho) . (b) Accept Ho even though Ho is false. This is called a j3(R) = P(X r/.: R; HI ). respective of erro r is AA AJ. J.,L,L,LAAALn ... 'U. I error, or a false II or a an analogy with x Sec. 9.3 Binary Hypothesis Testing 487 (assuming that X is discrete) . t This decision rule can be rewritten as follows: define the likelihood ratio L(x) by L(x) = pXle(x I OI ) , PXle (x I 00) and declare e = 01 to be true if the realized value x of the observation vector X satisfies where the critical value � is L(x) >�, � = pe (Oo) pe (Od · If X is continuous, the approach is the same, except that the likelihood ratio is defined as a ratio of PDFs: L(x) = !xle(x I Od . !xle (x 1 00) Motivated by the preceding form of the MAP rule, we are led to consider rejection regions of the form R = {x I L(x) >�}, where the likelihood ratio L(x) is defined similar to the Bayesian case:t L(x) _ px (x; Hd - px (x;Ho) ' or L(x) = !x (x; Hd . !x (x; Ho) The critical value � remains free to be chosen on the basis of other considerations. The special case where � = 1 corresponds to the ML rule. Example 9. 10. We have a six-sided die that we want to test for fairness, and we formulate two hypotheses for the probabilities of the six faces: Ho (fair die) : HI (loaded die): 1 px (x; Ho) = 6 . {I 4' px (x; HI ) = .! 8' x = 1, ... ,6, if x = 1, 2, if x = 3, 4, 5, 6. t In this paragraph, we use conditional probability notation since we are dealing with a Bayesian framework. t Note that we use L(x) to denote the value of the likelihood ratio based on the observed value x of the random observation X. On the other hand, before the experiment is carried out, the likelihood ratio is best viewed as a random variable, a function of the observation X, in which case it is denoted by L(X). The probability distribution of L(X) depends, of course, on which hypothesis is true. 488 Classical Statistical Inference The likelihood ratio for a single roll x of the die is { 1/4 3 , _ 1/6 = 2 ' If x= 1, 2, L(x) - 1/8 3 , 1/6 = \"4' If x = 3, 4, 5, 6. Chap, 9 SincE' thp likelihood rat io takes only two distinct values, thE're are three possibilities to considE'r for the critical value �, with three corrf'sponding rejE'ction regions: 3 � < - : 4 3 3 -< �< -: 4 2 3 2 < �: reject 110 for all x: accept 110 if x = 3, 4, 5, 6; reject Ho if x = 1, 2; accept 110 for all x. Intuitively, a roll of 1 or 2 provides evidence that favors HI , and we tend to reject Ho . On the ot her hand. if we SE't the critical value too high ({ > 3/2), we never reject Ho . In fact. for a single roll of the die, the test makes sense only in the case :�/4 < � < 'J/2, sinc£' for othE'r values of �, thE' decision does not depend on the oi>sE'rvat ion. Thf' error probabilities can be cakulatE'd from the problem data for each critical valuE'. In particular. the probability of false rejection P(Reject Ho : Ho ) is o:(�) = 1. 1 P(X = I. 2: Ho ) = 3' 0, if {< �, 'f 3 � 3 I \"4 < .\" < 2 ' 'f 3 � I - < 2 ' and the probability of false acceptance P(Accept Ho : Hd is 8({) = 0, 1 P(X = 3, 4. 5�6;HJ) = 2' 1. 'f 3 I � < 4' 'f 3 � 3 I 4 < .\" < 2 ' if � < {. Note that choosing � trades off the probabilities of the two types of errors, as illustrated by the preceding example, Indeed, as � increases, the rejection region­ becomes smaller, As a result, the false rejection probability Q( R) decreases, while the false acceptance probability j3(R) increases (see Fig. 9.9). Because of this tradeoff, there is no single best way of choosing the critical value. The most popular approach is as follows. 9.9: Error probabi lities in a likelihood ratio test. As the cri tical value � the becomes smaller. As a the false Q decreases. while the When ael:>en,aelilce of Q on { is value of � that to a a: on the the dependence of a on � may not be conti nuous . e.g. , if the likel ihood ratio L(x) can only take finitely many different val ues the figure on the • Start with a value Q for • to Q: > �j Ho) = 0:. • x of is if > Typica] Q are Q = 0. 1, Q = 0.05� or Q = 0.0 1 , depending on degree of reject ion . Note to be able to to a given problem, the (a) We be (b) is needed to rt ..... ,· ....... .......... I ..... ..... .... \"...., ..... probability Q. are required: or critical value E, that corresponds to a 489 so 9 .....,\"\", ............ ..., 9. 11, and cOI'res,Dolnd- 1 exp {-- }, )= 1 exp { } , is = exp { } { I} if > or a 1 x>v � + 2 \" is R = {x lx > 1'} some 1', to � 1 \"Y= v � + -' 2' 9. we to l' Q= - 1' =1 may /3 ( 1 + < - ::5 \"Y - Sec. 9.3 Binary Hypothesis Testing 491 When L(X) is a continuous random variable, as in the preceding example, the probability P(L(X) > �; Ho) moves continuously from 1 to 0 as � increases. Thus, we can find a value of � for which the requirement P(L(X) > �; Ho) = a is satisfied. If, however, L(X) is a discrete random variable, it may be impossible to satisfy the equality P(L(X) >�; Ho) = a exactly, no matter how � is chosen; cf. Example 9. 10. In such cases, there are several possibilities: (a) Strive for approximate equality. (b) Choose the smallest value of � that satisfies P(L(X) > �; Ho) � a. (b) Use an exogenous source of randomness to choose between two alternative candidate critical values. This variant (known as a \"randomized likelihood ratio test\" ) is of some theoretical interest. However, it is not sufficiently important in practice to deserve further discussion in this book. We have motivated so far the use of a LRT through an analogy with Bayesian inference. However, we will now provide a stronger justification: for a given false rejection probability, the LRT offers the smallest possible false accep­ tance probability. Neyman-Pearson Lemma Consider a particular choice of � in the LRT, which results in error proba­ bilities P(L(X) > �; Ho) = a, Suppose that some other test, with rejection region R, achieves a smaller or equal false rejection probability: P(X E R; Ho) < a. Then, P(X ¢ R; HI ) > (3, with strict inequality P(X ¢ R; HI ) > (3 when P(X E R; Ho ) < a. For a justification of the Neyman-Pearson Lemma, consider a hypothetical Bayesian decision problem where the prior probabilities of Ho and HI satisfy so that pe (Bo) =�, pe (BI ) � pe (Oo) = 1 + ( Then, the threshold used by the MAP rule is equal to �, as discussed in the beginning of this section, and the MAP rule is identical to the LRT rule. The error < _e_ - 1 { E 1 1 � 1 1 { ) . as R ranges over al l .... '-\"\"'W . VA ...., rE�le(:tlcm i:)Y l�ILJ';:' of the observation The efficient front ier of e is the E e such that there is no and or 0: <: a(R) and /3 � The /3(�» \"',..,. .. ... ,\"'.,. ... ..-.' ... \" 9 • 9.12 : Set of pairs (Q(R) , .B(R)) as the R ranges over all subsets of the observation space {I, ... , in 9. 10 9. 12 . The Example Comparison of Different We observe two i.i.d. nor mal random variables Xl and , with unit variance . Under Ho their common mean is 0; common mean is 2. to Q = 0.05. of {3. The likelihood ratio is of the form + (X2 - 2)2) /2} L(x) = -'-------;:---------- = exp {2(Xl + X2) - 4} . )/2 } 1 - of Comparing L(x) to a crit ical value { is equi valent to comparing Xl + X2 to , = (4 + log Thus, under the LRT, we decid e in favor of if Xl + X2 > 'j for some ,. To determ ine the exact form rejection region , we to find , so th at false rejection probability P(Xl + X2 > \"/: Ho ) is equal to 0.05. , Z = + X2)/v'2 is a .;:)!JU,J. J.'-AGl the normal we > 1.645) = 0.05, so we .... .. v''\"'.:>''\"' resulting in the , = 1.645 · = region = { I Xl + X2 > }. ,... .n' .. ' ......... l'\"\"1& ,\"'A n .. ,..;;;. of we ac- ceptance probability. Note that under Hi l Xl + X2 is normal with mean equal to equal to 2, so Z = (Xl + - 4)/V2 is a 494 given by Classical Statistical Inference (3(R) = P(XI + X2 ::; 2.33; HI ) = P ( Xl +X2 -4 < 2.33 -4 . H ) J2 - J2 , 1 = P(Z ::; -1. 18) = P(Z 2:: 1.18) = 1 - P(Z ::; 1. 18) = 1 0.88 = 0.12. Chap. 9 We now compare the performance of the LRT with that resulting from a different rejection region R'. For example, let us consider a rejection region of the form R' = { (Xl ,X2 ) I max{xl , X2 } > (} , where ( is chosen so that the false rejection probability is again 0.05. To determine the value of (, we write 0.05 = P ( max{X1 ,X2} > ( ; Ho) = 1 - p( max{ Xl , X2} ::; (; Ho) = 1 - P(XI ::; (; Ho) P(X2 ::; (j Ho ) = 1- (P(Z ::; ( ; HO )) 2 , where Z is a standard normal. This yields P(Z ::; (; Ho) = VI - 0.05 :::::: 0.975. Using the normal tables, we conclude that ( = 1.96. Let us now calculate the resulting false acceptance probability. Letting Z be again a standard normal, we have (3(R') =P ( max{Xl ,X2} ::; L96;Hl ) = (P(XI ::; 1.96; Hl )) 2 = (P(XI -2::; -0.04; Hd) 2 = (P(Z ::; -0.04)) 2 = (0.49) 2 = 0.24. We see that the false acceptance probability (3(R) = 0.12 of the LRT is much better than the false acceptance probability (3(R') = 0.24 of the alternative test. Example 9.14. A Discrete Example. Consider n = 25 independent tosses of a coin. Under hypothesis Ho (respectively, HI ), the probability of a head at each toss is equal to ()o 1/2 (respectively, ()l = 2/3). Let X be the number of heads observed. If we set the false rejection probability to 0. 1, what is the rejection region associated with the LRT? Sec. 9.4 Significance Testing We observe that when X = k, the likelihood ratio is of the form L(k) = (n) 8�( 1- 8dn-k k = ( 81 . 1 -(0 ) k. ( 1 - 8 1 ) n = 2k ( �) 25 . (n) k k 80 1 - (h 1 - 80 3 k 80 ( 1 - 80t- 495 Note that L(k) is a monotonically increasing function of k. Thus, the rejection condition L(k) > � is equivalent to a condition k > 'Y, for a suitable value of 'Y. We conclude that the LRT is of the form reject Ho if X > 'Y. To guarantee the requirement on the false rejection probability, we need to find the smallest possible value of 'Y for which P(X > 'Y; Ho) ::; 0. 1, or By evaluating numerically the right-hand side above for different choices of 'Y, we find that the required value is 'Y = 16. An alternative method for choosing 'Y involves an approximation based on the central limit theorem. Under Ho , z = X - n80 Jn80 {1 - (0) X - 12.5 J25/4 is approximately a standard normal random variable. Therefore, we need ( X - 12.5 'Y - 12.5 ) ( 2'Y ) O.l =P(X > 'Y; Ho) =P � > � ;Ho =P Z> - 5 -5 . V 25/4 V 25/4 From the normal tables, we have cI>(1 .28) = 0.9, and therefore, we should choose 'Y so that (2'Y/5) - 5 = 1.28, or 'Y = 15.7. Since X is integer-valued, we find that the LRT should reject Ho whenever X > 15. 9.4 SIGNIFICANCE TESTING Hypothesis testing problems encountered in realistic settings do not always in­ volve two well-specified alternatives, so the methodology in the preceding section cannot be applied. The purpose of this section is to introduce an approach to this more general class of problems. We caution, however, that a unique or uni­ versal methodology is not available, and that there is a significant element of judgment and art that comes into play. 496 Classical Statistical Inference For some motivation, consider problems such as the following: (i) A coin is tossed repeatedly and independently. Is the coin fair? (ii) A die is tossed repeatedly and independently. Is the die fair? Chap. 9 (iii) We observe a sequence of i.i.d. normal random variables Xl : ... l Xn . Are they standard normal? (iv) Two different drug treatments are delivered to two different groups of pa­ tients with the same disease. Is the first treatment more effective than the second? (v) On the basis of historical data (say, based on the last year), is the daily change of the Dow Jones Industrial Average normally distributed? (vi) On the basis of several sample pairs (Xi , Yi) of two random variables X and Y, can we determine whether the two random variables are independent? In all of the above casesl we are dealing with a phenomenon that involves uncertainty, presumably governed by a probabilistic model. We have a default hypothesis, usually called the null hypothesis, denoted by Ho, and we wish to determine on the basis of the observations X = (Xl, ' ... Xn ) whether the null hypothesis should be rejected or not. In order to avoid obscuring the key ideas, we will mostly restrict the scope of our discussion to situations with the following characteristics. (a) Parametric models: We assume that the observations Xl , .... Xn have a distribution governed by a joint PMF (discrete case) or a joint PDF (con­ tinuous case), which is completely determined by an unknown parameter (j (scalar or vector)l belonging to a given set M of possible parameters. (b) Simple null hypothesis: The null hypothesis asserts that the true value of (j is equal to a given element (jo of M. (c) Alternative hypothesis: The alternative hypothesis, denoted by HI , is just the statement that Ho is not true, i.e., that (j =1= (jo. In reference to the motivating examples introduced earlier, notice that ex­ amples (i)-(ii) satisfy conditions (a)-(c) above. On the other hand, in examples (iv)-(vi), the null hypothesis is not simple. violating condition (b). The General Approach We introduce the general approach through a concrete example. We then sum­ marize and comment on the various steps involved. Finally, we consider a few more examples that conform to the general approach. Example 9. 15. Is My Coin Fair? A coin is tossed independently n = 1000 times. Let () be the unknown probability of heads at each toss. The set of all Sec. 9.4 Significance Testing 491 possible parameters is M = [0, 1]. The null hypothesis Ho (\"'the coin is fair\" ) is of the form () = 1/2 . The alternative hypothesis is that () ::j:. 1/2. The observed data is a sequence Xl ..... X n. where X. equals 1 or O. de­ pending on whether the ith toss resulted in heads or tails. We choose to address the problem by considering the value of S = Xl + . . . + Xn , the number of heads observed, and using a decision rule of the form: reject Ho if Is - �I >�, where � is a suitable critical value. to be determined. We have so far defined the shape of the rejection region R (the set of data vectors that lead to rejection of the null hypothesis) . We finally choose the critical value � so that the probability of false rejection is equal to a given value 0: P(reject Ho: Ho) = 0, Typically. 0, called the significance leveL is a small number: in this example. we use ° = 0.05. The discussion so far involved only a sequence of intuitive choices. Some probabilistic calculations are now needed to determine the critical value �. Under the null hypothesis, the random variable S is binomial with parameters n = 1000 and p = 1 /2. Using the normal approximation to the binomial and the normal tables, we find that an appropriate choice is � = 31. If. for example. the observed value of S turns out to be s = 472, we have Is - 5001 = 1472 - 5001 = 28 ::; 31 and the hypothesis Ho is not rejected at the 5% significance level. Our use of the language \"not rejected\" as opposed to \"accepted.\" at the end of the preceding example is deliberate. We do Hot have any finn grounds to assert that () equals 1/2. as opposed to. say. 0.51. We can only assert that the observed value of S does not provide strong evidence against hypothesis Ho . We can now summarize and generalize the essence of the preceding example. to obtain a generic methodology. Significance Testing Methodology A statistical test of a hypothesis \"H 0 : () = ()*\" is to be performed, based on the observations Xl , ... , Xn . • The following steps are carried out before the data are observed. (a) Choose a statistic S, that is, a scalar random variable that will summarize the data to be obtained. Mathematically, this involves the choice of a function h : �n ---+ �. resulting in the statistic S = h(XI .... Xn ). 498 Classical Statistical Inference Chap. 9 (b) Determine the shape of the rejection region by specifying the set of values of 5 for which Ho will be rejected as a function of a yet undetermined critical value �. (c) Choose the significance level, i.e. , the desired probability Q of a false rejection of Ho. (d) Choose the critical value � so that the probability of false re­ jection is equal (or approximately equal) to Q. At this point, the rejection region is completely determined . • Once the values Xl , ... ,Xn of X I, ... , Xn are observed: (i) Calculate the value s = h(XI , .. . ,xn) of the statistic S. (ii) Reject the hypothesis Ho if s belongs to the rejection region. Let us add some comments and interpretation for the various elements of the above methodology. (i) There is no universal method for choosing the \"right\" statistic 5. In some cases, as in Example 9. 15, the choice is natural and can also be justified mathematically. In other cases, a meaningful choice of 5 involves a certain generalization of the likelihood ratio, to be touched upon later in this sec­ tion. Finally, in many situations, the primary consideration is whether 5 is simple enough to enable the calculations needed in step (d) of the above methodology. (ii) The set of values of 5 under which Ho is not rejected is usually an interval surrounding the peak of the distribution of 5 under Ho (see Fig. 9. 13) . In the limit of a large sample size n. the central limit theorem often applies to 5, and the symmetry of the normal distribution suggests an interval which is symmetric around the mean value of 5. Similarly, the symmetry of the rejection region in Example 9.15 is well-motivated by the fact that , under Ho , the distribution of 5 (binomial with parameter 1/2) is symmetric around its mean. In other cases, however, nonsymmetric rejection regions are more appropriate. For example� if we are certain that the coin in Example 9.15 satisfies B � 1/2, a one-sided rejection region is natural: . H'f 5 n reject 0 1 - \"2 > E,. (iii) Typical choices for the false rejection probability Q range between Q = .10 and Q = 0.01. Of course, one wishes false rejections to be rare, but in light of the tradeoff discussed in the context of simple binary hypotheses, a smaller value of Q makes it more difficult to reject a false hypothesis, i.e. , increases the probability of false acceptance. (iv) 9. 13: Two-sided and one-sided regions for Sl�111n(:an�:e \"''-''' '''AU.\"\". based on a statistic S with mean s under the null hypothesis. The significance level is the probability of false rej ection , Le. , the probability, under , that the statistic S takes a val ue within the rejection region . ..... ... '-'� .... ....... , .. Jl.U are re- �\" \"'u.U' ...... vari able such '-'''V',.;}'-' '-'' form. If n is large 1 one can often use ...... V'LIAA .. ..... ' ....... approximations, e.g. , based on the central limit theorem . On if n is di ffi cult to t his generating m eans u.oo·V' ..... . � ... ..... , ...... wit h H 0; of L(X) is a hypothesis at are highly ..... .... ..... ... JO. ..... ' ...... .. only 1 % the t ime, and thus provide strong evidence that H 0 may p-value - Equivalently, the is smaller than 0. 05. (c) , once they calculate the s defined be rejected at the Q significance level} . be 500 Classical Statistical Inference Chap. 9 A few examples illustrate the main ideas. Example 9. 16. Is the Mean of a Normal Equal to Zero? Here we assume that each Xi is an independent normal random variable, with mean 0 and known variance 0'2. The hypotheses under consideration are: Ho : 0 = 0, HI : 0 #- o. A reasonable statistic here is the sample mean (Xl + . . . + Xn )/n or its scaled version XI + ... +Xn 5= . O'Vn A natural choice for the shape of the rejection region is to reject Ho if and only if 151 > �. Because 5 has a standard normal distribution, the value of � corresponding to any particular value of u is easily found from the normal tables. For example, if u = 0.05, we use the fact that P(5 ::; 1 .96) = 0.975 to obtain a rejection region of the form reject Ho if 151 > 1.96, or equivalently, reject Ho if IXI + ... + Xn l > 1.960'Vn· In a one-sided version of this problem, the alternative hypothesis is of the form HI : 0 > O. In this case, the same statistic 5 can be used, but we will reject Ho if 5 > �, where � is chosen so that P(5 > �) = u. Once more, since 5 has a standard normal distribution, the value of � corresponding to any particular value of u is easily found from the normal tables. as Finally, if the variance 0'2 is unknown, we may replace it by an estimate such n 2 s� = _1 _ '\"' (Xi __ X_I _+_ .. _. _+_X_n ) n -l L n i=l In this case, the resulting statistic has a t-distribution (as opposed to normal). If n is relatively small, the t-tables should be used instead of the normal tables (cf. Section 9. 1). Our next example involves a composite null hypothesis Ho , in the sense that there are multiple parameter choices that are compatible with Ho . Example 9. 17. Are the Means of Two Populations Equal? We want to test whether a certain medication is equally effective for two different population groups. We draw independent samples X I, ... , X ni and YI , . .. , Yn2 from the two populations, where Xi = 1 (or Yi = 1) if the medication is effective for the ith person in the first (respectively, the second) group, and X, = 0 (or }i = 0) otherwise. We view each Xi (or Yi ) as a Bernoulli random variable with unknown mean Ox (respectively, Oy ), and we consider the hypotheses Ho : Ox = Oy , Sec. 9.4 Significance Testing 501 Note that there are multiple pairs (fJx , fJy ) that are compatible with Ha , which makes Ha a composite hypothesis. The sample means for the two populations are A reasonable estimator of fJx - fJy is ex - ey . A plausible choice is to reject Ha if and only if for a suitable threshold t to be determined on the basis of the given false rejection probability Q:. However, an appropriate choice of t is made difficult by the fact that the distribution of <3x - 8y under Ha depends on the unspecified parameters fJx and fJy . This motivates a somewhat different statistic, as we discuss next. For large nl and n2 , the sample means ex and ey are approximately normal, and because they are independent, <3 x -ey is also approximately normal with mean fJ x - fJy and variance A A A A fJ x (1 - fJ x) fJy ( 1 - fJy ) var(8x - 8y) = var(8x ) + var(8y) = + . n l n2 Under hypothesis Ha , the mean of 8x - 8y is known (equal to zero), but its variance is not, because the common value of {} x and {}y is not known. On the other hand, under Ha , the common value of {}x and (}y can be estimated by the overall sample mean 8 = _i =�l _____ i_ = _l __ n l + n2 the variance var(8x - 8y) = var(8x) + var(8y) can be approximated by A2 (1 1 ) A A (J' = -- + -- 8( 1 - 8), n l n2 and (8x - 8y )/0- is approximately a standard normal random variable. This leads us to consider a rejection region of the form and to choose � so that <I>(�) = 1 - 0:/2, where <I> is the standard normal CDF. For example, if Q: = 0.05, we obtain a rejection region of the form In a variant of the methodology in this example, we may consider the hy­ potheses Ha : fJx = fJy , 502 Classical Statistical Inference Chap. 9 which would be appropriate if we had reason to exclude the possibility Ox < Oy . Then, the corresponding rejection region should be one-sided, of the form . H 'f ex - ey & reject 0 1 A > �, (T where � is chosen so that <I>(�) = 1 - Q. The preceding example illustrates a generic issue that arises whenever the null hypothesis is composite. In order to be able to set the critical value appro­ priately, it is preferable to work with a statistic whose approximate distribution is available and is the same for all parameter values compatible with the null hypothesis, as was the case for the statistic (ex - ey )/a in Example 9. 17. Generalized Likelihood Ratio and Goodness of Fit Tests Our last topic involves testing whether a given PMF conforms with observed data. This an important problem, known as testing for goodness of fit. We will also use it as an introduction to a general methodology for significance testing in the face of a composite alternative hypothesis. Consider a random variable that takes values in the finite set {I, . . . , m}, and let (h be the probability of outcome k. Thus, the distribution (PMF) of this random variable is described by the vector parameter 0 = (01 , ... ,Om ) . We consider the hypotheses Ho : O = (Or, · ··, O�), where the Ok are given nonnegative numbers that sum to 1. We draw n inde­ pendent samples of the random variable of interest , and let N k be the number of samples that result in outcome k. Thus, our observation is X = (N1 , . . . , Nm ) and we denote its realized value by x = (nl ,\" \" nm ) . Note that Nl + .. . + Nm = nl + ... + nm = n. As a concrete example, consider n independent rolls of a die and the hy­ pothesis Ho that the die is fair. In this case, Ok = 1/6, for k = 1, .. . ,6, and Nk is the number of rolls whose result was equal to k. Note that the alternative hypothesis HI is composite, as it is compatible with multiple choices of O. The approach that we will follow is known as a generalized likelihood ratio test and involves two steps: (a) Estimate a model by ML, i.e. , determine a parameter vector 0 = (01, . . . , Om ) that maximizes the likelihood function p x (x; 0) over all vectors O. (b) Carry out a LRT that compares the likelihood px (x; 0\"' ) under Ho to the likelihood px (x; 0) corresponding to the estimated model. More concretely, form the generalized likelihood ratio px (x; 0) px (x; 0* ) ' Sec. 9.4 Significance Testing 503 and if it exceeds a critical value �, reject Ho . As in binary hypothesis test­ ing, we choose � so that the probability of false rejection is (approximately) equal to a gi ven significance level Q. In essence, this approach asks the following question: is there a model com­ patible with HI that provides a better explanation for the observed data than that provided by the model corresponding to Ho ? To answer this question, we compare the likelihood under Ho to the largest possible likelihood under models compatible with HI . The first step (ML estimation) involves a maximization over the set of probability distributions (01 , . . . , Om). The PMF of the observation vector X is multinomial (cf. Problem 27 in Chapter 2) , and the likelihood function is where c is a normalizing constant. It is easier to work with the log-likelihood function, which takes the form log px (x; 0) = log c+n1 10g 01 + . . ·+nm- 1 10g 0m- 1 +nm log(1 - 01 - .. . - Om-I ), where we have also used the fact 01 + ... + Om = 1 to eliminate Om . Assuming that the vector 0 that maximizes the log-likelihood has positive components, it can be found by setting the derivatives with respect to 01 , .. . ,Om-1 of the above expression to zero, which yields � �, 1 - 01 - . .. - Om- 1 for k = 1, . .. , m - 1. Since the term on the right-hand side is equal to nm/Om 1 we conclude that all ratios nk/Ok must be equal. Using also the fact n1 + .. . +nm = n, it follows that k = 1, ... ,m . It can be shown that these are the correct ML estimates even if some of the nk happen to be zero, in which case the corresponding Ok are also zero. The resulting generalized likelihood ratio test is of the form t reject Ho if where � is the critical value. By taking logarithms, the test reduces to m reject Ho if L nk log (:::*) > log �. k=l k t We adopt the convention that 0° = 1 and 0 . log 0 = 0 504 Classical Statistical Inference Chap. 9 We need to determine � by taking into account the required significance level, that is, where P(S > log �; Ho) = ct, m N S = � N k log (nO� ) . k=l k This may be problematic because the distribution of S under Ho is not readily available and can only be simulated. Fortunately, major simplifications are possible when n is large. In this case, the observed frequencies ih = nk/n will be close to Ok under Ho, with high probability. Then, a second order Taylor series expansion shows that our statistic S can be approximated well by T /2, where T is given by t T = � (Nk - nOk)2 L nO. k=l k Furthermore. when n is large, it is known that under the hypothesis Ho. the distribution of T (and consequently the distribution of 2S) approaches a so-called \"X2 distribution with m - 1 degrees of freedom.\" t The CDF of this distribution t We note that the second order Taylor series expansion ofthe function y log(y/y* ) around any y* > 0 is of the form y log (.JL) � y _ y * + ! (y - y.) 2 , y* 2 y* and is valid when y/y. � 1. Thus, T 2 :I: The X2 distribution with f degrees of freedom is defined as the distribution of the random variable i=l where Zl , ... ,Ze are independent standard normal random variables (zero mean and unit variance). Some intuition for why T is approximately X2 can be gained from the fact that as n -+ 00, Nk/n not only converges to Ok but is also asymptotically normal. Thus, T is equal to the sum of the squares of m zero mean normal random variables, namely (Nk - nOk)/ ;nor. The reason that T has m - 1, instead of m. degrees of freedom is related to the fact that L��l J'h = n, so that. these In random variables are actually dependent. Sec. 9.4 Significance Testing 505 is available in tables� similar to the normal tables. Thus, approximately correct values of P(T > ')'; Ho ) or P(28 > ')'; Ho) can be obtained from the X2 tables and can be used to determine a suitable critical value that corresponds to the given significance level Q. Putting everything together 1 we have the following test for large values of n. The Chi-Square Test: • Use the statistic (or possibly the related statistic T) and a rejection region of the form reject Ho if 28 > ')' (or T > \" respectively). • The critical value ')' is determined from the CDF tables for the X2 distribution with m - 1 degrees of freedom so that P(28 > 1; Ho) = Q, where Q is a given significance level. Example 9.18. Is My Die Fair? A die is rolled independently 600 times and the number of times that the numbers 1, 2. 3. 4, 5, 6 come up are nl = 92, n2 = 120, n3 = 88, n4 = 98, ns = 95, n6 107, respectively. Let us test the hypothesis Ho that the die is fair by using the chi­ square test based on the statistic T, at a level of significance a: = 0.05. From the tables for the X2 with 5 degrees of freedom, we obtain that for P(T > t; Ho) 0.05 we must have t = 1 l . l . With Oi = .. . = 06 = 1/6. n = 600, nOZ = 100, and the given values nk , the value of the statistic T is � (nk - nOk )2 _ (92 - 100)2 (1 20 - 100)2 (88 - 100)2 L- nO; - 100 + 100 + 100 k=l (98 - 100) 2 (95 100)2 (107 100) 2 + 100 + 100 + 100 = 6.86. Since T = 6.86 < 11.1. the hypothesis that the die is fair is not rejected . If we use instead the statistic 8. then a calculation using the data yields 28 = 6.68, which 506 Classical Statistical Inference Chap. 9 is both close to T and also well below the critical value 'Y = 11 .1. If the level of significance were a = 0.25, the corresponding value of 'Y would be 6.63. In this case, the hypothesis that the die is fair would be rejected since T = 6.86 > 6.63 and 2S = 6.68 > 6.63. 9.5 SUMMARY AND DISCUSSION Classical inference methods, in contrast with Bayesian methods, treat () as an unknown constant. Classical parameter estimation aims at estimators with fa­ vorable properties such as a small bias and a satisfactory confidence interval, for all possible values of (). We first focused on ML estimation, which is related to the (Bayesian) MAP method and selects an estimate of () that maximizes the likelihood function given x. It is a general estimation method and has several desirable characteristics, particularly when the number of observations is large. Then, we discussed the special but practically important case of estimating an unknown mean and constructing confidence intervals. Much of the methodology here relies on the central limit theorem. We finally discussed the linear regression method that aims to match a linear model to the observations in a least squares sense. It requires no probabilistic assumptions for its application, but it is also related to ML and Bayesian LMS estimation under certain conditions. Classical hypothesis testing methods aim at small error probabilities, com­ bined with simplicity and convenience of calculation. We have focused on tests that reject the null hypothesis when the observations fall within a simple type of rejection region. The likelihood ratio test is the primary approach for the case of two competing simple hypotheses, and derives strong theoretical support from the Neyman-Pearson Lemma. We also addressed significance testing, which ap­ plies when one (or both) of the competing hypotheses is composite. The main approach here involves a suitably chosen statistic that summarizes the observa­ tions, and a rejection region whose probability under the null hypothesis is set to a desired significance level. In our brief introduction to statistics, we aimed at illustrating the central concepts and the most common methodologies, but we have barely touched the surface of a very rich subject. For example, we have not discussed important topics such as estimation in time-varying environments (time series analysis, and filtering), nonparametric estimation (e.g. , the problem of estimating an unknown PDF on the basis of empirical data) , further developments in linear and nonlinear regression (e.g. , testing whether the assumptions underlying a regression model are valid), methods for designing statistical experiments, methods for validating the conclusions of a statistical study, computational methods, and many others. Yet, we hope to have kindled the reader's interest in the subject and to have provided some general understanding of the conceptual framework. Sec. 9.5 Problems 507 PROBLEMS SECTION 9.1. Classical Parameter Estimation Problem 1. Alice models the time that she spends each week on homework as an exponentially distributed random variable with unknown parameter O. Homework times in different weeks are independent. After spending 10, 14, 18, 8, and 20 hours in the first 5 weeks of the semester, what is her ML estimate of O? Problem 2. Consider a sequence of independent coin tosses, and let 0 be the proba­ bility of heads at each toss. (a) Fix some k and let N be the number of tosses until the kth head occurs. Find the ML estimator of 0 based on N. (b) Fix some n and let K be the number of heads observed in n tosses. Find the ML estimator of 0 based on K. Problem 3. Sampling and estimation of sums. We have a box with k balls; k of them are white and k - k are red. Both k and k are assumed known. Each white ball has a nonzero number on it, and each red ball has zero on it. We want to calculate the sum of all the ball numbers, but because k is very large, we resort to estimating it by sampling. This problem aims to quantify the advantages of sampling only white balls/nonzero numbers and exploiting the knowledge of k. In particular, we wish to compare the error variance when we sample n balls with the error variance when we sample a smaller number m of white balls. (a) Suppose we draw balls sequentially and independently, according to a uniform distribution (with replacement). Denote by Xi the number on the ith ball drawn, and by Y, the number on the ith white ball drawn. We fix two positive integers n and m , and denote - n - k � s= N L- Xi , i= l - m - k � S = m L- }li , i= l where N is the (random) number of white balls drawn in the first n samples. Show that 5, S, and S are unbiased estimators of the sum of all the ball numbers. (b) Calculate the variances of S and 5, and show that in order for them to be approximately equal, we must have m '\" np � p + r(l -p)' where p = k/k and r = E[y1 2j/var(Yl). Show also that when m = n, var(S) var(5) p p+r(l -p)\" 508 Classical Statistical Inference ( c) Calculate the variance of S, and show that for large n, var(S) 1 var(S) � P + r(1 - p) ' Chap. 9 Problem 4. Mixture models. Let the PDF of a random variable X be the mixture of m components: where m m fx(x) = L Pjfy) (x) . j=l Pj � 0, for j = 1, .. . , m. Thus, X can be viewed as being generated by a two-step process: first draw j randomly according to probabilities Pj , then draw randomly according to the distribution of lj. Assume that each Y; is normal with mean J-lJ and variance o} , and that we have a set of Li.d. observations XI .. .. ,Xn, each with PDF fx . (a) Write down the likelihood and log-likelihood functions. (b) Consider the case m = 2 and n = 1, and assume that J-l1, J-l2 , 0'1 , and 0'2 are known. Find the ML estimates of PI and P2. (c) Consider the case m = 2 and n = 1, and assume that PI , P2, 0'1 , and 0'2 are known. Find the ML estimates of J-li and J-l2. (d) Consider the case m � 2 and general n, and assume that all parameters are unknown. Show that the likelihood function can be made arbitrarily large by choosing J-ll = XI and letting O'f decrease to zero. Note: This is an example where the ML approach is problematic. Problem 5. Unstable particles are emitted from a source and decay at a distance X, which is exponentially distributed with unknown parameter (J. A special device is used to detect the first n decay events that occur in the interval [m l , m2j . Suppose that these events are recorded at distances X = (XI , ... ,Xn). (a) Give the form of the likelihood and log-likelihood functions. (b) Assume that ml = 1, m2 = 20, n = 6, and x = (1.5, 2, 3, 4, 5, 12). Plot the likeli­ hood and log-likelihood as functions of (J. Find approximately the ML estimate of (J based on your plot. Problem 6. Consider a study of student heights in a middle school. Assume that the height of a female student is normally distributed with mean J-li and variance ai , and that the height of a male student is normally distributed with mean J-l2 and variance o'� . Assume that a student is equally likely to be male or female. A sample of size n = 10 was collected. and the fullowing values were recorded (in centimeters): 164, 167, 163, 158, 170, 183, 176, 159, 170, 167. Sec. 9.5 Problems 509 (a) Assume that ILl, IL2 . 0'1 . and 0'2 are unknown. Write down the likelihood function. (b) Assume we know that O't = 9 and /JI = 164. Find numerically the ML estimates of 0'2 and /J2 . (c) Assume we know that O'r = O'� 9. Find numerically the IvIL estimates of /Jl and /J2 . (d) Treating the estimates obtained in part (c) as exact values, describe the MAP rule for deciding a student's gender based on the student's height. Problem 7. Estimating the parameter of a Poisson random variable. De­ rive the ML estimator of the parameter of a Poisson random variable based on LLd. observations Xl , ... , Xn . Is the estimator unbiased and consistent? Problem 8. Estimating the parameter of a uniform random variable I. We are given i.i.d. observations Xl , ... ! Xn that are uniformly distributed over the interval [0, OJ. What is the ML estimator of 9? Is it consistent? Is it unbiased or asymptotically unbiased? Can you construct alternative estimators that are unbiased? Problem 9. Estimating the parameter of a uniform random variable II. We are given i.i.d. observations Xl , ... , X n that are uniformly distributed over the interval [9, 9+ 1]. Find a ML estimator of 9. Is it consistent? Is it unbiased or asymptotically unbiased? Problem 10. A source emits a random number of photons K each time that it is triggered. We assume that the PMF of K is k = 0. 1 , 2, .... where 0 is the inverse of the temperature of the source and c( 9) is a normalization factor. We also assume that the photon emissions each time that the source is triggered are independent. We want to estimate the temperature of the source by triggering it repeatedly and counting the number of emitted photons. (a) Determine the normalization factor c(9) . (b) Find the expected value and the variance of the number K of photons emitted if the source is triggered once. (c) Derive the ML estimator for the temperature 'I/J = 1/9, based on Kl .... , Kn , the numbers of photons emitted when the source is triggered n times. (d) Show that the ML estimator is consistent. Problem 11. II< Sufficient statistics - factorization criterion. Consider an obser­ vation model of the following type. Assuming for simplicity that all random variables are discrete, an initial observation T is generated according to a PMF PT (t; 9). Having observed T, an additional observation Y is generated according to a conditional PMF PYIT(Y I t) that does not involve the unknown parameter O. Intuition suggests that out of the overall observation vector X = (T, Y), only T is useful for estimating O. This problem formalizes this idea. Given observations X = ( Xl , ... , Xn ) . we say that a (scalar or vector) function q( X) is a sufficient statistic for the parameter 9 if the conditional distribution of X 510 Classical Statistical Inference Chap. 9 given the random variable T = q(X) does not depend on 0, i.e., for every event D and possible value t of the random variable T, Pe (XED IT=t) is the same for all ° for which the above conditional probability is well-defined [i.e. , for all ° for which the PMF pr(t; 0) or the PDF !r(t; 0) is positivej . Assume that either X is discrete (in which case, T is also discrete), or that both X and T are continuous random variables. (a) Show that T = q(X) is a sufficient statistic for ° if and only if it satisfies the following factorization criterion: the likelihood function px (x; 0) (discrete case) or !x (x; 0) (continuous case) can be written as r (q(x), O) s(x) for some functions r and s. (b) Show that if q(X) is a sufficient statistic for 0, then for any function h of 0, q(X) is a sufficient statistic for the parameter ( = h(O). (c) Show that if q(X) is a sufficient statistic for 0, a ML estimate of ° can be written as en = ¢( q(X)) for some function ¢. Note: This supports the idea that a sufficient statistic captures all essential information about ° provided by X. Solution. (a) We consider only the discrete case; the proof for the continuous case is similar. Assume that the likelihood function can be written as r(q(x), O) s(x). We will show that T = q(X) is a sufficient statistic. Fix some t and consider some ° for which Pe(T = t) > 0. For any x for which q(x) =j:. t, we have P6(X = x I T = t) = 0, which is trivially the same for all 0. Consider now any x for which q(x) = t. Using the fact Pe (X = x, T = t) = Pe (X = x, q(X) = q(x)) = Pe (X = x) , we have P (X I T ) Pe(X = x, T = t) Pe(X = x) e - x - t - - -....;,-----,'-- - - Pe (T = t) - Pe(T = t) r(t, O)s(x) r(t, O)s(x) L r (q(z), O) s(z) r(t, O) L {z I q(z)=t} s(x) L s(z) {z I q(z) =t} {z I q(z)=t} s(z) so Pe(X = x I T = t) does not depend on 0. This implies that for any event D, the conditional probability Pe(X E D I T = t) is the same for all ° for which Pe (T = t) > 0, so T is a sufficient statistic. Conversely, assume that T = q(X) is a sufficient statistic. For any x with px (x; 0) > 0, the likelihood function is px (x; O) = Pe (X = x I q(X) = q(x)) Pe (q(X) = q(x)) . Since T is a sufficient statistic, the first term on the right-hand side does not depend on 0, and is of the form s(x). The second term depends on x through q(x), and is of Sec. 9.5 Problems 511 the form r(q(x), 9). This establishes that the likelihood function can be factored as claimed. (b) This is evident from the definition of a sufficient statistic, since for ( = h(9), we have so P < (X E D I T = t) is the same for all (. (c) By part (a) , the likelihood function can be factored as r(q(x),9)s(x). Thus, a ML estimate maximizes r(q(x),9) over 9 [if s(x) > 0] or minimizes r(q(x), 9) over 9 [if s(x) < 0] , and therefore depends on x only through q(x). Problem 12. * Examples of a sufficient statistic I. Show that q(X) = E�l Xi is a sufficient statistic in the following cases: (a) Xl , .. . , Xn are LLd. Bernoulli random variables with parameter 9. (b) Xl , . .. , Xn are LLd. Poisson random variables with parameter 9. Solution. (a) The likelihood function is so it can be factored as the product of the function 9Q(x) (1 - 9)U-Q(x) , which depends on x only through q(x), and the constant function s(x) == 1. The result follows from the factorization criterion for a sufficient statistic. (b) The likelihood function is so it can be factored as the product of the function e-99Q(x) , which depends on x only through q(x) , and the function s(x) = 1/ TI�1 Xi !, which depends only on x. The result follows from the factorization criterion for a sufficient statistic. Problem 13. * Examples of a sufficient statistic II. Let X I , . . . , X n be i.i.d. normal random variables with mean J..l and variance a2 • Show that: (a) If a2 is known, q(X) = E�l Xi is a sufficient statistic for J..l. (b) If J..l is known, q(X) = E�l (Xi - J..l)2 is a sufficient statistic for a2 • (a) If both J..l and a2 are unknown, q(X) = (L�l Xi , E�l Xl) is a sufficient statis- tic for (J..l, a2) . Solution. Use the calculations in Example 9.4, and the factorization criterion. Problem 14. * Rao-Blackwell theorem. This problem shows that a general esti­ mator can be modified into one that only depends on a sufficient statistic, without loss of performance. Given observations X = (Xl , ... , Xn ), let T = q(X) be a sufficient statistic for the parameter 9, and let g(X) be an estimator for 9. 512 Classical Statistical Inference Chap. 9 (a) Show that Ee [g(X) I T] is the same for all values of 8. Thus, we can suppress the subscript 8, and view g(X) = E [g(X) IT] as a new estimator of 8, which depends on X only through T. (b) Show that the estimators g(X) and g(X) have the same bias. (c) Show that for any 8 with varo (g(X)) < 00, for all 8. Furthermore, for a given 8, this inequality is strict if and only if Eo [var(g(X) I T)] > O. Solution. (a) Since T q(X) is a sufficient statistic, the conditional distribution Pe(X = x I T = t) does not depend on 8, so the same is true for Eo [g(X) IT]. (b) We have by the law of iterated expectations so the biases of g(X) and g(X) are equal . (c) Fix some 8 and let bo denote the common bias of g(X) and g(X) . We have, using the law of total variance, Eo [(g(X) - 8)2] = varo (g(X)) + b� = Eo [var(g(X) I T)] + varo (E [g(X) I T]) + b� = E8 [var(g(X) I T)] + var8 (g(X)) + b� = Eo [var(g(X) I T)] + Eo [(g(X) 8)2] � E8 [(g(X) _8)2, with the inequality being strict if and only if Eo [var(g(X) IT)] > O. Problem 15.* Let Xl , ... , Xn be i.i.d. random variables that are uniformly dis­ tributed over the interval [0, 8]. (a) Show that T = maxi= l , ... , n Xi is a sufficient statistic. (b) Show that g(X) = (2jn) E�l Xi is an unbiased estimator. (c) Find the form of the estimator g(X) = E [g(X) IT], and then calculate and compare Eo [(g(X) - 8) 2] with E8 [(g(X) _ 0) 2] . Sec. 9.5 Problems Solution. (a) The likelihood function is 513 if ° � maxi=l, ... ,n Xi � 0 � 1, otherwise, and depends on X only through q(x) = maxi=l ..... n Xi. The result follows from the factorization criterion for a sufficient statistic. (b) We have 2 � 2 � O Eo [g(X)] = n L- Eo[Xi] = n L- \"2 = o. i=l i=l (c) Conditioned on the event {T = t}, one of the observations Xi is equal to t. The remaining n -1 observations are uniformly distributed over the interval [0, t] , and have a conditional expectation equal to tj2. Thus, n [ ] 2 [� ] 2 ( (n - 1)t) n+1 E g(X)I T=t = nE L- Xi /T =t = n t+ 2 = -n-t, l=l and g(X) = E [g(X) I TJ = (n + 1)T/n. We will now calculate the mean squared error of the two estimators g(X) and g(X), as functions of O. To this end, we evaluate the first and second moment of g(X). We have Eo 19(X)] = Eo [E [g(X) I T] J = Eo [g(X)] = o. To find the second moment, we first determine the PDF of T. For t E [0, 0], we have poeT � t) = (tjo)n, and by differentiating, !r(t; 0) = ntn-1 jon . Thus, Since g( X) has mean 0, its mean squared error is equal to its variance, and Eo [(g(X») 2] Similarly, the mean squared error of g(X) is equal to its variance, and 2 4 2: n 4 02 1 2 Eo [(g(X) - 0) J = - varo(Xi) = - . n · - = -0 . � � 12 3n i=l 1 1 It can be seen that - 3 � ( for all positive integers n. It follows that n n n+ which is consistent with the Rao-Blackwell theorem. 514 Classical Statistical Inference Chap. 9 SECTION 9.2. Linear Regression Problem 16. An electric utility company tries to estimate the relation between the daily amount of electricity used by customers and the daily summer temperature. It has collected the data shown on the table below. Temperature 96 89 81 86 83 Electricity 23.67 20.45 21.86 23.28 20.71 Temperature 73 78 74 76 78 Electrici ty 18.21 18.85 20. 10 18.48 17.94 (a) Set up and estimate the parameters of a linear model that can be used to predict electricity consumption as a function of temperature. (b) If the temperature on a given day is 90 degrees, predict the amount of electricity consumed on that day. Problem 17. Given the five data pairs (Xi, Yi) in the table below, X Y 0.798 -2.373 2.546 20.906 5.005 7.261 103.544 215.775 9.131 333.911 we want to construct a model relating X and y. We consider a linear model i = 1, ... ,5, and a quadratic model i = 1, ... ,5, where Wi and Vi represent additive noise terms, modeled by independent normal ran­ dom variables with mean zero and variance O'f and O'� , respectively. (a) Find the ML estimates of the linear model parameters. (b) Find the ML estimates of the quadratic model parameters. (c) Assume that the two estimated models are equally likely to be true, and that the noise terms Wi and Vi have the same variance: O'r = O'� . Use the MAP rule to choose between the two models. Problem 18. * Unbiased ness and consistency in linear regression. In a prob­ abilistic framework for regression, let us assume that Yi = ()o + ()IXi + Wi, i = 1, ... ,n , where WI , ... , Wn are LLd. normal random variables with mean zero and variance 0'2 . Then, given Xi and the realized values Yi of Yi, i = 1, ... , n, the ML estimates of ()o and ()1 are given by the linear regression formulas, as discussed in Section 9.2. (a) Show that the ML estimators 80 and 8 1 are unbiased. Sec. 9.5 Problems (b) Show that the variances of the estimators 80 and 81 are n (72 LX? var(80 ) = n ,= 1 n L(Xi - xl i=1 respectively, and their covariance is (72 var(8I ) = - n---- L(Xi - X)2 i=1 (72 X cov(80, (1 ) = - -n---- L(Xi - X)2 i=1 515 (c) Show that if L�=I (Xi - X)2 -+ 00 and X2 is bounded by a constant as n -+ 00, we have var(80) -+ 0 and var(8I ) -+ O. (This, together with Chebyshev's inequality, implies that the estimators 80 and 81 are consistent.) Note: Although the assumption that the W, are normal is needed for our estimators to be ML estimators, the argument below shows that these estimators remain unbiased and consistent without this assumption. Solution. (a) Let the true values of 00 and 01 be 00 and Or , respectively. We have n 81 = _,=_1 ______ _ n where Y = ( L�=I Yi) / n, and where we treat XI , . .. ,Xn as constant. Denoting W = ( L�=I Wi)/n, we have Y = O� + O�x + W, and Thus, n n 81 = ..:..i=--=-I ---- n-------- = O� + _i=--=-I - n ------ n L(Xi - X)Wi = O� + ..:..i=_!=---___ _ L(Xi _ x)2 i=1 516 Classical Statistical Inference Chap. 9 where we have used the fact E�=l (Xi - x) = O. Since E[Wi] = 0, it follows that Also and using the facts E[el] = 8i and E[W] = 0, we obtain E[eoJ = (Jo· Thus, the estimators eo and 81 are unbiased. (b) We now calculate the variance of the estimators. Using the formula for Eh derived in part (a) and the independence of the Wt , we have n Similarly, using the formula for eo derived in part (a) , � - � - 2 � -� var(eo) = var(W - elx) = var(W) + x var(ed - 2Xcov(W, ed . Since E�=l (Xi - x) = 0 and E[WWi] = 0'2 In for all i, we obtain _ • E [w t(Xi - x) Wi] :: t(x. - x) cov(W, el ) = -=---n..;..--=-----� - -n-=--=----- = O. L(Xi - X)2 i=1 Combining the last three equations, we obtain By expanding the quadratic forms (Xi - X)2, we also have n n L(Xt _x)2 +nx2 = LX;. i=l i=I n L(Xi - X)2 + nx2 Sec. 9.5 Problems By combining the preceding two equations, or n O'2Lx; var(80) = n i=l n L(Xi - X)2 i=1 We finally calculate the covariance of 80 and 81. We have cov(80, 8 d = -x var(8I) + cov(W, 8I) . Since, as shown earlier, cov(W, 8I) = 0, we finally obtain xO'2 cov(80, 8t) = - -n---- L(Xl - X) 2 i=l 517 (c) If L::l (Xi - x) 2 --+ CX), the expression for var(8t) --+ 0 derived in part (b) goes to zero. Then, the formula A - 2 A var(So) = var(W) + X var(SI), from part (b) , together with the assumption that X2 is bounded by a constant, implies that yare 80) -- O. Problem 19.* Variance estimate in linear regression. Under the same assump­ tions as in the preceding problem, show that is an unbiased estimator of 0'2 . Solution. Let V n = L:�=1 (Yt - 80 - 81 xd2 • Using the formula 80 = Y - 81X and the expression for 81 , we have i= 1 n n n '\"'\" - 2 A '\"'\" - A 2 '\"'\" 2 = L.)Yi - Y) - 281 L..\"cYi - Y)(Xi - x) + 81 L)Xi - x) i=1 i=1 n n '\"'\" 2 -2 A 2 '\"'\" 2 = L..... Yi -nY - 8 1 L..... ( Xi - X) . i=1 t= 1 i=1 518 Classical Statistical Inference Chap. 9 Taking expectation of both sides, we obtain We also have n n E[Vn] = L E[�2] _nE[y2] - L(Xi -X)2E[ei] . i =1 i=1 E[�2] = var(Yi) + (E[YiJ)2 = u2 + (80 + 8�Xi)2, 2 E[V2] = var(Y) + (E[y])2 = � + (80 + 8;X)2, n 2 u2 E[ei] = var(e .) + (E[ed) = n + (8�)2. L (Xi - X)2 i= l Combining the last four equations and simplifying, we obtain SECTION 9.3. Binary Hypothesis Testing Problem 20. A random variable X is characterized by a normal PDF with mean 1-£0 = 20, and a variance that is either u5 = 16 (hypothesis Ho) or u� = 25 (hypothesis Hd . We want to test Ho against HI , using three sample values XI, X2 , X3 , and a rejection region of the form for some scalar 'Y. Determine the value of 'Y so that the probability of false rejection is 0.05. What is the corresponding probability of false acceptance? Problem 21. A normal random variable X is known to have a mean of 60 and a standard deviation equal to 5 (hypothesis Ho) or 8 (hypothesis Hd. (a) Consider a hypothesis test using a single sample x. Let the rejection region be of the form R = { X I Ix - 601 > 'Y } for some scalar 'Y. Determine 'Y so that the probability of false rejection of Ho is 0.1. What is the corresponding false acceptance probability? Would the rejection region change if we were to use the LRT with the same false rejection probability? (b) Consider a hypothesis test using n independent samples Xl , ••. ,xn. Let the rejection region be of the form where 'Y is chosen so that the probability of false rejection of Ho is 0.1. How does the false acceptance probability change with n? What can you conclude about the appropriateness of this type of test? Sec. 9.5 Problems 519 (c) Derive the structure of the LRT using n independent samples Xl, • •• , Xn • Problem 22. There are two hypotheses about the probability of heads for a given coin: 0 = 0.5 (hypothesis Ho ) and 0 = 0.6 (hypothesis HI ) . Let X be the number of heads obtained in n tosses, where n is large enough so that normal approximations are appropriate. We test Ho against HI by rejecting Ho if X is greater than some suitably chosen threshold kn. (a) What should be the value of kn so that the probability of false rejection is less than or equal to 0.05? (b) What is the smallest value of n for which both probabilities of false rejection and false acceptance can be made less than or equal to 0.05? (c) For the value of n found in part (b) , what would be the probability of false acceptance if we were to use a LRT with the same probability of false rejection? Problem 23. The number of phone cans received by a ticket agency on any one day is Poisson distributed. On an ordinary day, the expected value of the number of calls is AO, and on a day where there is a popular show in town, the expected value of the number of calls is AI, with Al > Ao . Describe the LRT for deciding whether there is a popular show in town based on the number of calls received. Assume a given probability of false rejection, and find an expression for the critical value €. Problem 24. We have received a shipment of light bulbs whose lifetimes are modeled as independent, exponentially distributed random variables, with parameter equal to Ao (hypothesis Ho ) or equal to Al (hypothesis HI ). We measure the lifetimes of n light bulbs. Describe the LRT for selecting one of the two hypotheses. Assume a given probability of false rejection of Ho and give an analytical expression for the critical value �. SECTION 9.4. Significance Testing Problem 25. Let X be a normal random variable with mean t-t and unit variance. We want to test the hypothesis t-t = 5 at the 5% level of Significance, using n independent samples of X. (a) What is the range of values of the sample mean for which the hypothesis is accepted? (b) Let n = 10. Calculate the probability of accepting the hypothesis t-t = 5 when the true value of t-t is 4. Problem 26. We have five observations drawn independently from a normal distri­ bution with unknown mean t-t and unknown variance (j2 . (a) Estimate t-t and (j2 if the observation values are 8.47, 10.91, 10.87, 9.46, 10.40. (b) Use the t-distribution tables to test the hypothesis t-t = 9 at the 95% significance level, using the estimates of part (a) . 520 Classical Statistical Inference Chap. 9 Problem 27. A plant grows on two distant islands. Suppose that its life span (measured in days) on the first (or the second) island is normally distributed with unknown mean J-lx (or J-lY ) and known variance 01 = 32 (or O'� = 29 . respectively). \\Ve wish to test the hypothesis J-lx = J-lY . based on 10 independent samples from each island. The corresponding sample means are x = 181 and y = 177. Do the data support the hypothesis at the 95% significance level? Problem 28. A company considers buying a machine to manufacture a certain item. \\Vhen tested. 28 out of 600 items produccd by the machine were found defective. Do the data support the hypothesis that the defect rate of the machine' is smaller than 3 percent. at the 5% significance level? Problem 29. The values of five independent samples of a Poisson random variable turned out to be 34, 35, 29. 31. and 30. Test the hypothesis that the mean is equal to 35 at the 570 level of significance. Problem 30. A surveillance camcra periodically checks a certain area and records a signal X = a\" if there is no intruder (this is the null hypothesis Ho). If there is an intruder the signal is X = () + IV . where () is unknown with () > O. We assume that W is a normal random variable wit h mean 0 and known variance v = 0.5. (a) \\\\le obt ain a single signal value X = 0.96. Should Ho be rejected at the 5% level of significance? (b) We obtain five independent signal values X = 0.96, -0.34, 0.85, 0.51, -0 .24 . Should Ho be rejected at the 5% level of significance? (c) Repeat part (b) . using the t-distribution, and assuming the variance v is un­ known. INDEX A Absorbing state, 346, 362 Absorption probabilities, 362, 397 Acceptance region, 486 Accessible state, 347 Additivity axiom, 9 Almost surely, 281 Aperiodic recurrent class, 350 Asymptotic normality, 465, 470 Axioms, 9, 17 B Balance equations, 353, 375, 399 dependence, 393 local, 359, 377, 393 uniqueness of solutions, 354, 389 Bayes, 17 Bayes' rule, 31, 413 continuous, 178 Bayesian inference, 408, 411 Bernoulli, Daniel, 17 problem of joint lives, 128 Bernoulli·Laplace model of diffusion, 386 Bernoulli, Jacob, 17 Bernoulli process, 297 alternative description, 302 definition, 297 fresh·start at random time, 301 fresh-start property, 299 independence, 298 interarrival times, 302 memorylessness, 298 merging, 305 number of successes, 298 Poisson approximation, 305 random incidence in, 327 relation to uniform r.v., 328 splitting, 305 time until first success, 298 time until kth success, 303 Bernoulli r.v., 75, 116 mean, 88 sum of, 96, 261 transform, 237, 239 variance, 88 Bernoulli trial, 41 Bertrand 's paradox, 16 Beta density, 194, 417 function, 417 moments, 194 posterior, 425, 434 prior, 417 Bias, 225, 46 1 Binomial coefficient, 43, 48, 65 formula, 43, 48 probabilities, 43 Binomial r.v., 77, 116, 298 de Moivre.Laplace approximation, 277 mean, 96 Poisson approximation, 79, 121 recursive calculation of PMF, 120 transform, 237, 239 variance, 113 Birth-death process, 359, 377 Birthday problem, 67 Bivariate normal, 254 Bonferroni's inequality, 55 Borel·Cantelli lemma, 66 Buffon's needle, 161, 190, 45 1 c Cantor's diagonalization, 53 Cardano, 17 Cauchy r.v. , 247 Causality, 485 CDF, 148 joint, 162 properties, 150 Central limit theorem, 158, 264, 273 history, 17 proof, 290 Chain, see Markov chain Chapman-Kolmogorov equation, 345, 353 Chebyshev, 17 Chebyshev inequality, 267, 268 Chernoff bound, 284 Chi-square distribution, 504 test, 505 Classical inference, 408, 459 Classification of states, 346 521 522 Collectively exhaustive, 7 Combination, 46, 47 Competing exponentials, 247, 319 Composite hypothesis, 459, 500, 502 Conditional expectation, see expectation, conditional independence, 36, 110 mean squared error, 425, 430 PDF, see conditional PDF PMF, see conditional PMF probability, 18 variance, 104, 226 Conditioning continuous r.v. on an event, 165 continuous r.v. on another, 169 discrete r. v. on an event , 98 discrete r. v. on another, 99 Confidence interval, 468 approximate, 470 Confidence level, 468 Consistent, 461 Continuity property of probabilities, 56 Continuous random variable, see random variable Convergence in probability, 271 , 282, 288 in the mean square, 289 of a deterministic sequence, 271 with probability one, 281 Convolution, 213 graphical calculation, 216 Correlation coefficient , 219, 250 Covariance, 218 Countably infinite, 3, 82 Counting, 44 principle, 44 Critical value, 487, 497, 498 Cumulative distribution function, see CDF D De Mere, 62, 67 De Moivre, 17 De Moivre-Laplace approximation, 277 De Morgan's laws, 5, 53 Decomposition, Markov chains, 349 Density, see PDF Derived distributions, 202 of function of two r.v. 's, 209 of monotonic function , 207 Detection, 22, 33, 157, 180, 428, 490 Difference of independent r.v. 's, 216 Diffusion Bernoulli-Laplace model, 386 Ehrenfest model, 386 Discrete probability law, 11 Discrete uniform probability law, 11 Index Discrete random variable, see random variable Discrete uniform random variable, see uniform Distribution posterior, 409, 412 prior, 409 Doubly stochastic, 391 E Efficient frontier, 492 Ehrenfest model of diffusion , 836 Empirical frequency, 270 Entropy, 135 Erlang process, 337 Erlang r.v., 316 Error Type 1, 486 Type II error, 486 Estimate, 422, 423 point, 422 Estimation error, 225,435, 436,461 of mean, 468 of mean of Bernoulli, 463 of mean of normal, 415, 421, 464 of multiple parameters, 436, 442 of variance, 468 of variance of normal , 464 parameter, 411, 459 parameter of exponential, 464 parameter of Poisson, 449 point, 422 problem, 410 Estimator, 225, 423, 460 bias, 461 conditional expectation, 423 consistent, 461 linear, 438 LMS, 424 MAP, 423 unbiased, 436, 461 asymptotically, 461 Event , 6, 7 independent, 34 Expectation as center of gravity, 83 conditional, 104, 179, 225 as estimator, 225, 423 linearity, 87, 94, 96, 97, 130, 145, 163, 164 of continuous r.v. , 144, 184 Index of discrete r.v. , 81, 82, 184 of function of r.v., see expected value rule well-defined , 82, 144 Expected time to absorption, 366 Expected value, see expectation Expected value rule for continuous r.v.'s, 145, 163, 173, 185 for discrete r.v.'s, 84, 94, 96, 97, 130 Experiment, 6 Exponential random variable, 146, 182 CDF, 152 in Markov chain, 370 in Poisson process, 312 linear function of, 206 maximum of, 332 mean, 147 memorylessness, 165 minimum of, 247, 319 moments, 256 relation to geometric, 152 sum of geomet ric number, 243, 335 transform, 23 1, 239 tw().sided, 193, 213 variance, 147 F Factorization criterion, 509 False acceptance, 486 False-positive puzzle, 33 False rejection, 486 Fermat, 17, 62 First passage time, 367, 398 Flat prior, 463 Frequency interpretation of probabilities, 2, 9, 17, 270, 281 Frequentist approach, 408 Function of a r.v., 74, 80, see also derived distributions mean, see expected value rule Function of multiple r.v.'s continuous case, 164 discrete case, 93 G Gambler's ruin, 63, 364 Gauss, 17 Gaussian r.v. , see normal r.v. Generalized likelihood ratio test, 502 Geometric r.v. , 77, 116, 134, 298 CDF, 151 mean, 105 relation to exponential, 151 sum of a geometric number, 244, 328 transform, 235, 239 variance, 105 Goodness of fit, 502 Grade of service, 43 H Hat problem, 96, 221 Heteroskedasticity, 484 History of probability, 17 Hypergeometric probabilities, 69 Hypothesis alternative, 485, 496 composite, 459, 500, 502 null, 485, 496 simple, 496 Hypothesis testing, 411, 459 Bayesian, 420, 425 binary, 411, 485 for equality of means, 500 for zero mean, 500 m-ary, 411 I i.i.d., 458 Inclusion-exclusion formula, 55, 126 Independence conditional, 36, 111 of cont inuous r.v. 's, 175 of discrete r.v.'s, 111 of events, 34 of functions of r.v.'s, 11 1, 134, 177 of r. v. from an event, 109 of several events, 38 pairwise, 39 Independent trials, 41 IndistingUishable objects, 69 Inequality Chebyshev, 267 Chernoff bound, 284 Jensen, 287 Markov, 265 Schwarz, 250 Inference, 179, 181 Bayesian, 408, 411 Classical, 408, 459 multiparameter, 418 recursive, 416 Invariance principle, 465 Inversion property, 234, 240 Iterated expectations, law of, 223 523 524 J Jensen inequality, 287 Joint PDF, 158 Joint PMF, 92 K Kelly strategy, 251 King's sibling, 61 L Lagrange, 17 Laplace, 17, 161, 190 Laplace r.v., 184, 213 Laplace transform, 230 Laplace's rule of succession, 64 Law of iterated expectations, 223 Law of large numbers weak, 269 strong, 280, 294, 403, Law of total variance, 226 Least mean squares estimator, 424, 431 estimation, 412, 430 multiple observations, 436 multiple parameters, 436 Least squares estimation, 17 Likelihood function, 462 Likelihood ratio, 487 Likelihood ratio test, 460, 489 generalized, 502 Limit, see convergence Linear least mean squares estimation, 412, 437, 438, 412, 437, 438 and regression, 479 error, 439 formulas, 439 multiple observations, 442, 453 multiple parameters, 442 normal models, 443 properties, 455, 457 two observations, 452 Linear regression, see regression Legendre, 17 Leibnitz, 17 Linear function of r.v.'s mean, 87, see also expectation, linearity normal, 154 PDF, 205 transform, 231 variance, 87, 145 LMS, see least mean squares Local balance equations, 359, 377, 393 Localization, 418 Log-likelihood function, 462 LRT, see likelihood ratio test Lyapunov, 17 M MAP estimator, 423 MAP rule, 41 1, 420, 421 for hypothesis testing, 426 Marginal PDF, 159 PMF, 93 Markov, 17 Markov chain in continuous time, 369 alternative description, 373 assumptions, 370 balance equations, 375 birth-death, 377 definition, 370 discrete-time approximation, 372 embedded chain, 370 local balance equations, 377 steady-state, 375 Index steady-state convergence theorem, 375 transition rate, 371 Markov chain in discrete time, 340 absorption probabilities, 362, 397 balance equations, 353, 389 birth-death, 359 Chapman-Kolmogorov equation, 345, 353 classification, 346 decomposition, 349 definition, 341 expected state frequencies, 357, 390 expected time to absorption, 366 expected transition frequencies, 358 first passage time, 398, 367 local balance equations, 359, 393 mUltiple recurrent classes, 398 n-step transition probability, 345 normalization equation, 354 periodicity, 351 , 383 probability of a path, 343 recurrence time, 367, 399 sampled, 394 stationary distribution, 353 steady-state, 352 steady-state convergence theorem, 352, 387 strong law of large numbers, 402 transition graph, 341 transition matrix, 341, 345 transition probability, 340 Markov inequality, 265 Index Markov model, 341 Markov property, 340 Matchbox problem, 120 Matched filter, 428 Matrix doubly stochastic, 391 transition, 341, 345 Maximum a Posteriori, see MAP Maximum likelihood, 459, 462 asymptotic normality, 465 consistency, 465 in regression, 478 invariance principle, 465 Maximum of r.v. 's, 150 Mean, see expectation Mean first passage time, 367, 398 Mean recurrence time, 367, 399 Mean squared error, 430, 431 conditional, 425, 430 Measurement, 412 Merging Bernoulli processes, 305 Poisson processes, 319 Minimum of r.v. 's, 124 Mixed r.v., 186 Mixture of distributions, 236 ML, see maximum likelihood Model inference, 409 Moment, 83, 145 calculation using transforms, 232 Moment generating function, 229, 232 see also transform Monotone convergence theorem, 293 Monotonic function of a r.v., 207 Monty Hall problem, 27 Multicollinearity, 484 Multiple regression, 482 Multinomial coefficient, 49 distribution, 124, 503 Multiplication rule for PDFs, 172, 194 for PMFs, 101 , 103, 131 for probabilities, 24 Multivariate transform, 240 Mutual information, 137 Mutually exclusive, 7 N Negative binomial r.v., 327 Neyman-Pearson lemma, 491 Nonlinear regression, 483 Nonnegativity axiom, 9 Nonparametric problem , 411 Normal approximation, 275 Normal r.v. bi variate, 254 CDF, 154 central limit theorem, 273 confidence interval, 469 estimation, 415, 421, 449, 464 independent, 176 linear function of, 154, 206 mean, 153 model, 443 normalization property, 153, 189 standard, 154 sum of, 214, 238 table, 155 transform, 231, 239 uncorrelated, 254 variance, 153 Normalization axiom, 9 525 Normalization equation, in Markov chains, 354 Null hypothesis, 485, 496 o Observation, 412 Ordered pair, 5 Outcome, 6 mutually exclusive, 7 Overfitting, 484 p p-value, 499 Pairwise independence, 39 Paradox Bertrand's, 16 of induction, 58 random incidence, 322 St. Petersburg, 123 two-envelopes, 106 Parallel connection, 41 Parametric model, 496 Partition, 4, 49 Pascal, 17, 62, 65 Pascal r.v., 303, 327 Pascal triangle, 65 PDF, 140 conditional, 165, 167, 169, 172 joint, 158 marginal, 159 of function of r.v. 's, see derived distri butions of linear function of r. v. 's, 205 of monotonic function of r.v. 's, 207 526 properties, 144 spherically invariant, 451 Periodic class, 35 1, 383 Permutation, 46, 69 k-permutation, 46 Perron-Frobenius theorem, 354 Piecewise constant PDF, 142 mean, 174 variance, 174 PMF, 74 calculation of, 75 conditional, 98, 100 summary, 103 joint, 92 marginal, 93 Point estimate, 422 Poisson, 17 Poisson process, 297, 309 alternative description, 316 arrival rate, 310 definition, 310 independence, 310, 314 intensity, 310 interarrival times, 315 memorylessness, 314 merging, 319 number of arrivals, 31 1, 335 random incidence, 322 small interval probabilities, 310 splitting, 318, 336 time-homogeneity, 310 time until first arrival, 312 time until kth arrival, 316 Poisson random variable, 78, 117, 312 approximation of binomial, 79, 121 mean, 90 parameter estimation, 449 splitting, 132 sum of, 237, 247, 313 transform, 230, 239 variance, 113 Polling, 270, 276, 474 Posterior, 32, 409, 412 Prior, 32, 409 fiat, 463 Prisoner's dilemma, 58 Probabilistic model, 6 Probability conditional, 18 history, 17 steady-state, see steady-state probability subjective, 3 Probability density function, see PDF Probability mass function, see PMF Probability law, 6, 8 of random variable, 148 properties, 14 Problem of joint lives, 128 Problem of points, 62 Process arrival, 296 Bernoulli, 297 birth-death, 359, 377 Erlang, 337 Markov, 297 Poisson, 297, 309 Q Queueing, 336, 348, 365, 373, 392 Quiz problem, 91, 125 R Random incidence in Bernoulli process, 327 in Erlang process, 337 in Poisson process, 322 in non-Poisson process, 323 Random variable continuous, 140 definition, 73 discrete, 73, 74 function of, 73, 74, 80, 93, 202 independent, 110, 175, 177 mixed, 186 Random walk, 360 Rao-Blackwell theorem, 511 Rayleigh r.v., 248 Recurrence time, 367, 399 Recurrent class, 348 aperiodic, 350 mUltiple, 398 periodic, 350 state, 347, 382 existence, 381 Recursive inference, 416 Regression Bayesian, 480, 481 causality, 485 consistency, 514 formulas, 477 heteroskedasticity, 484 linear, 459, 475 multicollinearity, 484 nonlinear, 483 nonlinearity, 484 overfitting, 484 Index Index multiple, 482 simple, 482 unbiasedness, 514 variance estimate, 518 Rejection region, 486, 497, 498 Relative frequency, 9, 17, see also frequency interpretation Reliability, 40, 61 Residual, 476 Reversibility, 394 s Sample mean, 114, 264, 466 mean, 114,264 unbiased, 466 variance, 114, 264 Sample space, 6 uncountable, 7 Schwartz inequality, 250 Sequential model, 8, 22 Sequential method, 52 Series connection, 41 Set, 3 complement, 4 countably infinite, 3 disjoint, 4 element of, 3 empty, 3 intersection, 4 partition, 4 uncountable, 4 union, 4 universal, 4 Shannon, 136 Signal detection, see detection Significance level, 497, 498 Significance testing, 459, 460, 495 Simulation, 115, 188, 190, 196, 489, 499 Spherically invariant PDF, 451 Splitting Bernoulli process, 305 Poisson r.v. , 132 Poisson process, 318, 336 St. Petersburg paradox, 123 Standard deviation, 83, 86 Standard normal random variable, 154 Standard normal table, 155 use for calculating normal CDF, 156 State absorbing, 346, 362 accessible, 347 classification, 346 of Markov chain, 340 recurrent, 347, 381, 382 transient, 347, 381 State space, 340 Stationary distribution, 353 Statistic, 497 sufficient, 509, 511 Statistics, 408 Bayesian, 408, 411, 412 classical, 408, 459 frequentist, 408 non parametric, 411 527 Steady-state, in Markov chains, 352, 375 Steady-state convergence theorem, 352, 375, 387 Steady-state probability, 352, 375 Stochastic process, 296 Strong law of large numbers, 280 for Markov chains, 402 proof, 294 Subset, 4 Sufficient statistic, 509, 511 Sum of random number of r.v.'s, 240 geometric number of exponential r.v. 's, 243, 335 geometric number of geometric r.v. 's, 244, 328 mean, 197, 241 variance, 197, 241 transform, 241 Sum of random variables of Bernoulli, 261 convolution, 213 expectation, see expectation, linearity of normal, 214, 238 of Poisson, 237, 313 transform, 237 variability extremes, 135 variance, 111, 112, 113, 178, 220 T t-distribution, 471, 500 tables, 473 Tabular method, 93, 94 Total expectation theorem for continuous r. v. 's, 173 for discrete r. v.'s, 104 Total probability theorem, 28 conditional version, 59 for PDFs, 167 for PMFs, 103 Transient state, 347, 381 Transition graph, 341 528 matrix, 341, 345 probability, 340 rate, 371 Transform, 229 inversion property, 234, 240 multivariate, 240 of linear function, 231 of mixture, 236 of sum of r.v.'s 237 of sum of random number of r.v.'s, 241 table, 239 Trial Bernoulli, 41 independent, 41 Two-envelopes paradox, 106 Two-envelopes puzzle, 58 Type I error, 486 Type II error, 486 u Unbiased, 436, 461 asymptotically, 461 Uncountable, 4, 7, 13, 53 Uncorrelated, 218, 225, 254, 436 Uniform r.v. continuous, 141, 182 mean, 145 relation to Bernoulli process, 328 transform, 239, 258 variance, 145 discrete, 116 mean, 88 transform, 239, 258 variance, 88 two-di mensional conti nuous, 159 v Value of a r.v., 72 Variability extremes, 135 Variable inference, 410 Variance, 83, 86, 145 conditional, 104, 226 estimation, 468 law of total, 226 of linear function of r.v. 's, 87, 145 of product of r.v. 's, 192, 252 Index of sum of r.v.'s, 111, 11 2, 11 3, 178, 220 in terms of moments, 87, 145 Venn diagram , 5, 15 w Weak law of large numbers, 269 z z-transform, 230 Summary of Results for Special Discrete Random Variables Discrete Uniform over [a, b] : if k = a, a + 1, . .. . b� otherwise� E[X] = a + 2 b . (b - a) (b - a + 2) esa (es(b-a+l ) - 1) var(X) = 12 . lvfx (s) = (b - a + 1)(es - 1) \" Bernoulli with Parameter p: (Describes the success or failure in a single trial. ) px (k) = { P l '- p. if k = 1� if k = O. E[X] =p. var(X) = p( 1 - p). Alx(s) = 1 - p + pes . Binomial with Parameters p and n: (Describes the number of successes in n independent Bernoulli trials. ) px(k) = (�) pk (1 - p) n- k , E[X] = np� var(X) = np(1 - p) . k=O, l . . .. . n. Geometric with Parameter p: (Describes the number of trials until the first success, in a sequence of independent Bernoulli trials.) E[X] = �, p px (k) = (1 - p)k- lp. I- p var(X) = -2- � P k = 1. 2 ..... peS Alx(s) = ---­ I- (l -p)es Poisson with Parameter .A: (Approximates the binomial PMF when n is large, p is small, and .A = np.) k = 0. 1. ... . var(X) = .A, Summary of Results for Special Continuous Random Variables Continuous Uniform Over [a, b]: fx(x) = { b�a ' if a < x ::; b, 0, otherwise, (b - a)2 var(X) = 12 ) Exponential with Parameter A: e·\"Ib esa �fx (s) = s(b - a) fx (x) = { Ae-Ax , if x > 0, 0, otherwise, Fx (x) = { 1 - e-AX , if x > �, 0, otherwIse, 1 E[X] = A ' 1 var(X) = A2 ' Alx (s} Normal with Parameters f.1 and a2 > 0: E[X] = f.1, fx (x) = 1 e-(x-Il)2j2(J'2 , J21r a var(X) = a2 , A A -S ' (S <A). .00 .01 .02 .03 .04 .05 .06 .07 .08 .09 0.0 .5000 .5040 .5080 .5120 .5160 .5199 .5239 .5279 .5319 .5359 0. 1 .5398 .5438 .5478 .5517 .5557 .5596 .5636 .5675 .5714 .5753 0.2 .5793 .5832 .5871 .5910 .5948 .5987 .6026 .6064 .6103 .6141 0.3 .6179 .6217 .6255 .6293 .6331 .6368 .6406 .6443 .6480 .6517 0.4 .6554 .6591 .6628 .6664 .6700 .6736 .6772 .6808 .6844 .6879 0.5 .6915 .6950 .6985 .7019 .7054 .7088 .7123 .7157 .7190 .7224 0.6 .7257 .7291 .7324 .7357 .7389 .7422 .7454 .7486 .7517 .7549 0.7 .7580 .7611 .7642 .7673 .7704 .7734 .7764 .7794 .7823 .7852 0.8 .7881 .7910 .7939 .7967 .7995 .8023 .8051 .8078 .8106 .8133 0.9 .8159 .8186 .82 12 .8238 .8264 .8289 .8315 .8340 .8365 .8389 1.0 .84 13 .8438 .8461 .8485 .8508 .8531 .8554 .8577 .8599 .862 1 1.1 .8643 .8665 .8686 .8708 .8729 .8749 .8770 .8790 .8810 .8830 1.2 .8849 .8869 .8888 .8907 .8925 .8944 .8962 .8980 .8997 .9015 1.3 .9032 .9049 .9066 .9082 .9099 .9115 .9131 .9147 .9162 .9177 1.4 .9192 .9207 .9222 .9236 .9251 .9265 .9279 .9292 .9306 .9319 1.5 .9332 .9345 .9357 .9370 .9382 .9394 .9406 .9418 .9429 .9441 1.6 .9452 .9463 .9474 .9484 .9495 .9505 .9515 .9525 .9535 .9545 1.7 .9554 .9564 .9573 .9582 .9591 .9599 .9608 .9616 .9625 .9633 1.8 .9641 .9649 .9656 .9664 .9671 .9678 .9686 .9693 .9699 .9706 1.9 .9713 .9719 .9726 .9732 .9738 .9744 .9750 .9756 .9761 .9767 2.0 .9772 .9778 .9783 .9788 .9793 .9798 .9803 .9808 .9812 .9817 2.1 .9821 .9826 .9830 .9834 .9838 .9842 .9846 .9850 .9854 .9857 2.2 .9861 .9864 .9868 .9871 .9875 .9878 .9881 .9884 .9887 .9890 2.3 .9893 .9896 .9898 .9901 .9904 .9906 .9909 .9911 .9913 .9916 2.4 .9918 .9920 .9922 .9925 .9927 .9929 .9931 .9932 .9934 .9936 2.5 .9938 .9940 .994 1 .9943 .9945 .9946 .9948 .9949 .9951 .9952 2.6 .9953 .9955 .9956 .9957 .9959 .9960 .9961 .9962 .9963 .9964 2.7 .9965 .9966 .9967 .9968 .9969 .9970 .9971 .9972 .9973 .9974 2.8 .9974 .9975 .9976 .9977 .9977 .9978 .9979 .9979 .9980 .9981 2.9 .9981 .9982 .9982 .9983 .9984 .9984 .9985 .9985 .9986 .9986 3.0 .9987 .9987 .9987 .9988 .9988 .9989 .9989 .9989 .9990 .9990 3. 1 .9990 .9991 .9991 .9991 .9992 .9992 .9992 .9992 .9993 .9993 3.2 .9993 .9993 .9994 .9994 .9994 .9994 .9994 .9995 .9995 .9995 3.3 .9995 .9995 .9995 .9996 .9996 .9996 .9996 .9996 .9996 .9997 3.4 .9997 .9997 .9997 .9997 .9997 .9997 .9997 .9997 .9997 .9998 The standard normal table. The entries in this table provide the numerical values of CP(y) = P(Y � y), where Y is a standard normal random variable, for y between 0 and 3.49. Example of use: To find cp( 1.71), we look at the row corresponding to 1.7 and the column corresponding to 0.01 , so that cp(1.71) = .9564. When y is negative, the value of cp(y) can be found using the formula cp(y) = 1 - cp( -y) . ATHENA SCIENTIFIC BOOKS OPTIMIZATION AND COMPUTATION SERIES 1. Introduction to Probability, 2nd Edition, by Dimitri P. Bertsekas and John N. Tsitsiklis, 2008, ISBN 978-1-886529-23-6, 544 pages 2. Dynamic Programming and Optimal Control, Two-Volume Set, by Dimitri P. Bertsekas, 2007, ISBN 1-886529-08-6, 1020 pages 3. Convex Analysis and Optimization, by Dimitri P. Bertsekas, with An­ gelia Nedic and Asuman E. Ozdaglar, 2003, ISBN 1-886529-45-0, 560 pages 4. Nonlinear Programming, 2nd Edition, by Dimitri P. Bertsekas, 1999, ISBN 1-886529-00-0, 791 pages 5. Network Optimization: Continuous and Discrete Models, by Dimitri P. Bertsekas, 1998, ISBN 1-886529-02-7, 608 pages 6. Network Flows and Monotropic Optimization, by R. Tyrrell Rockafel­ lar, 1998, ISBN 1-886529-06-X, 634 pages 7. Introduction to Linear Optimization, by Dimitris Bertsimas and John N. Tsitsiklis, 1997, ISBN 1-886529- 19-1, 608 pages 8. Parallel and Distributed Computation: Numerical Methods, by Dim­ itri P. Bertsekas and John N. Tsitsiklis, 1997, ISBN 1-886529-01-9, 718 pages 9. Neuro-Dynamic Programming, by Dimitri P. Bertsekas and John N. Tsitsiklis, 1996, ISBN 1-886529- 10-8, 512 pages 10. Constrained Optimization and Lagrange Multiplier Methods, by Dim­ itri P. Bertsekas, 1996, ISBN 1-886529-04-3, 410 pages 11. Stochastic Optimal Control: The Discrete-Time Case, by Dimitri P. Bertsekas and Steven E. Shreve, 1996, ISBN 1-886529-03-5, 330 pages","libVersion":"0.3.2","langs":""}